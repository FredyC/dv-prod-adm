(window.webpackJsonp=window.webpackJsonp||[]).push([[180],{7658:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var a=n(5),r=n(0),i=n.n(r),c=n(26),o=n(7664),l=n(20);function u(){var e=Object(a.a)(["\n  height: 100%;\n"]);return u=function(){return e},e}function d(){var e=Object(a.a)(["\n  position: fixed;\n  bottom: 0.5rem;\n  width: ",";\n  left: ",";\n  top: ",";\n"]);return d=function(){return e},e}var s=c.c.div(d(),function(e){return void 0!==e.widthInColumns?"calc(("+e.widthInColumns+" * 6.22vw) - "+l.d.LayoutGridCellMargin+")":"calc(100vh - (2 * "+l.d.LayoutGridCellMargin+"))"},function(e){return void 0!==e.column?"calc(("+e.column+" * 6.22vw) + "+l.d.LayoutGridCellMargin+")":l.d.LayoutGridCellMargin},function(e){return void 0!==e.row?"calc(("+e.row+" * 3.9375rem) + "+l.d.LayoutGridCellMargin+")":"calc(3.9375rem + "+l.d.LayoutGridCellMargin+")"}),m=c.c.div(u()),f=function(e){var t=e.children,n=e.row,a=void 0===n?1:n,r=e.column,c=void 0===r?0:r,l=e.widthInColumns,u=void 0===l?16:l,d=e.withScrollArea,f=void 0!==d&&d,p=e.scrollAreaId;return i.a.createElement(s,{column:c,row:a,widthInColumns:u,withScrollArea:f},f?i.a.createElement(o.a,{id:p},t):i.a.createElement(m,null,t))}},7659:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n(5);function r(){var e=Object(a.a)(["\n  display: flex;\n  flex-direction: row;\n  justify-content: ",";\n"]);return r=function(){return e},e}var i=n(26).c.div(r(),function(e){var t=e.justify;return void 0===t?"space-between":t})},7661:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n(5);function r(){var e=Object(a.a)(["\n  height: ",";\n"]);return r=function(){return e},e}var i=n(26).c.div(r(),function(e){var t=e.size,n=void 0===t?1:t,a=e.sizeUnit,r=void 0===a?"rem":a;return"".concat(n).concat(r)});i.displayName="VerticalGap"},7664:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n(5);function r(){var e=Object(a.a)(["\n  overflow-y: auto;\n  -webkit-overflow-scrolling: touch;\n  height: 100%;\n"]);return r=function(){return e},e}var i=n(26).c.div(r())},7665:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n(5),r=n(26);function i(){var e=Object(a.a)(["\n  position: absolute;\n  ",";\n  ",";\n"]);return i=function(){return e},e}var c=Object(r.c)("div")(i(),function(e){var t=e.position,n=void 0===t?"BottomRight":t;return"BottomLeft"===n||"TopLeft"===n?"left: 0":"right: 0"},function(e){var t=e.position,n=void 0===t?"BottomRight":t;return"BottomRight"===n||"BottomLeft"===n?"bottom: 0":"top: 0"})},7696:function(e,t,n){"use strict";function a(e){var t=e.toLocaleLowerCase();return function(e){return e.toLocaleLowerCase().includes(t)}}n.d(t,"a",function(){return a})},7707:function(e,t,n){"use strict";n.d(t,"a",function(){return b});var a=n(51),r=n(60),i=n(65),c=n(72),o=n(71),l=n(73),u=n(0),d=n.n(u),s=n(7647),m=n(32),f=n(42),p=n(7662),b=function(e){function t(){var e,n;Object(r.a)(this,t);for(var a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];return(n=Object(c.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(i)))).validate=function(e){var t=n.props,a=t.isRequired,r=t.isMulti,i=t.validationName;if(a){if(r&&(!Array.isArray(e)||0===e.length))return f.b._("{validationName} must have at least option selected",{validationName:i});if(!r&&(null===e||void 0===e))return f.b._("{validationName} must have a selection",{validationName:i})}return null},n}return Object(l.a)(t,e),Object(i.a)(t,[{key:"getControlProps",value:function(e){var t=this.props,n=t.isMulti,a=t.items,r=t.defaultSelection,i=t.getItemId,c=e.value||r;if(n){return{selectedItems:Array.isArray(c)?a.filter(function(e){return c.includes(i(e))}):[],onMultiSelection:function(t){e.setValue(t.map(i)),e.setTouched(!0)}}}return{selectedItem:c&&a.find(function(e){return i(e)===c}),onSingleSelection:function(t){e.setValue(t?i(t):null),e.setTouched(!0)}}}},{key:"render",value:function(){var e=this,t=this.props,n=t.field,r=t.fieldIsPure,i=void 0!==r&&r,c=t.isRequired,o=void 0!==c&&c,l=t.isClearable,u=void 0!==l&&l,m=Object(a.a)(t,["field","fieldIsPure","isRequired","isClearable"]);return d.a.createElement(s.Field,{field:n,pure:i,validate:this.validate},function(t){return d.a.createElement(p.a,Object.assign({},e.getControlProps(t),{isInvalid:Boolean(t.error),isClearable:u&&!o},m))})}}]),t}(d.a.Component);b.defaultProps={validationName:f.b._("Value"),getItemId:m.a.prop("id")}},7708:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var a=n(5),r=n(0),i=n.n(r),c=n(26),o=n(20);function l(){var e=Object(a.a)(["\n  width: 40px;\n  height: 40px;\n  margin: 100px auto;\n  background-color: ",";\n\n  border-radius: 100%;\n  -webkit-animation: sk-scaleout 1s infinite ease-in-out;\n  animation: sk-scaleout 1s infinite ease-in-out;\n\n  @-webkit-keyframes sk-scaleout {\n    0% {\n      -webkit-transform: scale(0);\n    }\n    100% {\n      -webkit-transform: scale(1);\n      opacity: 0;\n    }\n  }\n\n  @keyframes sk-scaleout {\n    0% {\n      -webkit-transform: scale(0);\n      transform: scale(0);\n    }\n    100% {\n      -webkit-transform: scale(1);\n      transform: scale(1);\n      opacity: 0;\n    }\n  }\n"]);return l=function(){return e},e}var u=c.c.div(l(),o.a.orange),d=function(e){return i.a.createElement(u,null,i.a.createElement("div",{className:"bounce1"}),i.a.createElement("div",{className:"bounce2"}),i.a.createElement("div",{className:"bounce3"}))}},7713:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var a=n(43),r=n(51),i=n(0),c=n.n(i),o=n(75),l=n(82),u=n(7714),d=function(e){var t=e.to,n=e.from,a=Object(r.a)(e,["to","from"]);return c.a.createElement(o.Route,{children:function(e){var r=e.location;return c.a.createElement(l.b,Object.assign({to:s(t,n||"".concat(r.pathname,"/"))},a))}})};function s(e,t){if("string"===typeof e)return Object(u.a)(e,t);var n=Object(u.a)(e.pathname||"",t);return Object(a.a)({},e,{pathname:n})}},7714:function(e,t,n){"use strict";function a(e){return"/"===e.charAt(0)}function r(e,t){for(var n=t,a=n+1,r=e.length;a<r;n+=1,a+=1)e[n]=e[a];e.pop()}t.a=function(e,t){void 0===t&&(t="");var n,i=e&&e.split("/")||[],c=t&&t.split("/")||[],o=e&&a(e),l=t&&a(t),u=o||l;if(e&&a(e)?c=i:i.length&&(c.pop(),c=c.concat(i)),!c.length)return"/";if(c.length){var d=c[c.length-1];n="."===d||".."===d||""===d}else n=!1;for(var s=0,m=c.length;m>=0;m--){var f=c[m];"."===f?r(c,m):".."===f?(r(c,m),s++):s&&(r(c,m),s--)}if(!u)for(;s--;s)c.unshift("..");!u||""===c[0]||c[0]&&a(c[0])||c.unshift("");var p=c.join("/");return n&&"/"!==p.substr(-1)&&(p+="/"),p}},7715:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var a=n(5),r=n(0),i=n.n(r),c=n(7690),o=n(26),l=n(124);function u(){var e=Object(a.a)(["\n  padding: 1rem 0.4rem;\n  cursor: grab;\n"]);return u=function(){return e},e}var d=o.c.div(u()),s=Object(c.SortableHandle)(function(){return i.a.createElement(d,null,i.a.createElement(l.a,{iconName:"reorder"}))})},7727:function(e,t,n){"use strict";function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}n.d(t,"a",function(){return a})},7764:function(e,t,n){"use strict";n.d(t,"a",function(){return v});var a=n(43),r=n(51),i=n(60),c=n(65),o=n(72),l=n(71),u=n(73),d=n(0),s=n.n(d),m=n(7647),f=n(32),p=n(42),b=n(7652),v=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(o.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).validate=function(e){return n.props.isRequired&&!e?p.b._("{0} must be selected",{0:n.props.validatioName}):null},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"getControlProps",value:function(e){var t=this.props,n=t.isMulti,a=t.options,r=t.getOptionValue,i=t.defaultValue,c=e.value||i;if(n){var o=Array.isArray(c)?function(e){return c.includes(r(e))}:f.a.F;return{value:Array.isArray(a)?a.filter(o):[],onChange:function(t){e.setValue(t.map(r))}}}return{value:c&&a.find(function(e){return r(e)===c}),onChange:function(t){e.setValue(r(t))}}}},{key:"render",value:function(){var e=this,t=this.props,n=t.field,i=t.fieldIsPure,c=void 0!==i&&i,o=(t.isRequired,t.defaultValue,Object(r.a)(t,["field","fieldIsPure","isRequired","defaultValue"]));return s.a.createElement(m.Field,{field:n,validate:this.validate,pure:c},function(t){return s.a.createElement(b.a,Object.assign({},e.getControlProps(t),{onFocus:function(){return t.setTouched(!0)},styles:{control:function(e){return Boolean(t.error)?Object(a.a)({},e,{borderColor:"red"}):e}}},o))})}}]),t}(s.a.Component);v.defaultProps={validatioName:"Value",getItemId:f.a.prop("id")}},7797:function(e,t,n){},7934:function(e,t,n){t.pictograms=n(7935)},7935:function(e,t){e.exports=["pizza","beans","cheese","hot-pepper","smoking-barbecue","meat-pie","sausage","hot-dog","fruit","fruit-1","fruit-2","strawberry","soup","noodles","ramen","rice","spaghetti","food","piece-of-cake","beer","marshmallow","cake","banana-split","ice-cream","cookie","doughnut","cupcake","kebab","steak","fish","fondue","shrimp","berry","food","food-1","food-2","food-3","food-4","food-5","food-6","food-7","food-8","food-9","food-10","food-11","food-12","food-13","food-14","food-15","food-16","food-17","food-18","food-19","food-20","food-21","food-22","food-23","food-24","food-25","food-26","food-27","food-28","food-29","food-30","drink","drink-1","drink-2","drink-3","drink-4","drink-5","cup","cup-1","cup-2","whisky"]},7936:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(4);t.isApolloError=function(e){return e.hasOwnProperty("graphQLErrors")};var r=function(e){var t="";return Array.isArray(e.graphQLErrors)&&0!==e.graphQLErrors.length&&e.graphQLErrors.forEach(function(e){var n=e?e.message:"Error message not found.";t+="GraphQL error: "+n+"\n"}),e.networkError&&(t+="Network error: "+e.networkError.message+"\n"),t=t.replace(/\n$/,"")},i=function(e){function t(n){var a=n.graphQLErrors,i=n.networkError,c=n.errorMessage,o=n.extraInfo,l=e.call(this,c)||this;return l.graphQLErrors=a||[],l.networkError=i||null,l.message=c||r(l),l.extraInfo=o,l.__proto__=t.prototype,l}return a.__extends(t,e),t}(Error);t.ApolloError=i},7939:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(75),c=n(193),o=n(109),l=n(5),u=n(26),d=n(188),s=n(7663),m=n(7659),f=n(7661),p=n(40),b=n(42),v=n(189),h=n(7658),g=n(7689),E=n(21),y=n.n(E),w=n(33),O=n(99),j=n(69),k=n(7655),C=n(81),I=n(351),x=n(43),T=n(51),R=(n(7797),n(7702)),S=n(7713),_=n(327),L=n(140),D=function(e){var t=e.target,n=e.Link,a=void 0===n?S.a:n,i=Object(T.a)(e,["target","Link"]);return r.a.createElement(a,{to:t},r.a.createElement(_.a,null,r.a.createElement(L.a,Object.assign({iconName:"mode_edit"},i))))},N=n(7727),W=function(e){var t=Object(N.a)({},e);return r.a.createElement(_.a,null,r.a.createElement(L.a,Object.assign({iconName:"remove_circle_outline"},t)))},F=n(20),B=function(e){var t=e.isVisible,n=Object(T.a)(e,["isVisible"]);return r.a.createElement(_.a,null,r.a.createElement(L.a,Object.assign({iconName:"remove_red_eye",iconColor:t?F.a.white:F.a.greyMiddle,color:F.a.greyMiddle},n)))},P=n(7708),V=n(7649),M=n(7656);function A(){var e=Object(l.a)(["\n  color: ",";\n"]);return A=function(){return e},e}var q=u.c.div(A(),F.a.greyMiddle);function K(){var e=Object(l.a)(["\n  padding: 1rem;\n  color: ",";\n  font-style: 'italic';\n"]);return K=function(){return e},e}var H=function(e){var t=e.items,n=e.heightStretch,a=void 0!==n&&n,i=e.fullHeight,c=void 0!==i&&i,o=e.rowHeight,l=void 0===o?60:o,u=e.isLoading,d=void 0!==u&&u,s=e.children,m=Object(T.a)(e,["items","heightStretch","fullHeight","rowHeight","isLoading","children"]),f=r.a.useCallback(function(e){var n=e.index;return t[n]},[t]),p=r.a.useCallback(function(){return d?r.a.createElement(P.a,null):null},[d]),b=function(e,n){return r.a.createElement(R.h,Object.assign({autoHeight:!a&&!c,width:e,height:n,headerHeight:50,rowCount:t?t.length:0,rowHeight:l,rowGetter:f,noRowsRenderer:p,style:{outline:"none"}},m),s)};return c?r.a.createElement(R.a,{disableHeight:!0},function(e){var n=e.width;return b(n,t.length*l)}):a?r.a.createElement(R.a,null,function(e){var t=e.width,n=e.height;return b(t,n)}):r.a.createElement(R.i,{scrollElement:window},function(e){var t=e.height;return r.a.createElement(R.a,{disableHeight:!0},function(e){var n=e.width;return b(n,t)})})};function U(e,t){var n=e.canQuery,a=e.canMutate;return function(e){var i=t(e);return n&&(i=r.a.createElement(M.a,{queryName:n},i)),a&&(i=r.a.createElement(V.a,{mutationName:a},i)),i}}function Q(e){var t=e.cellData;return r.a.createElement(D,{target:t})}function z(e){var t=e.cellData,n=e.columnData;return r.a.createElement(W,{onClick:function(){return n.onRemove&&n.onRemove(t)}})}function G(e){var t=e.cellData,n=e.columnData,a=e.rowData;return r.a.createElement(B,{isVisible:t,onClick:function(){return n.onToggle(a.id,!t)}})}function $(e){var t=e.cellData,n=e.rowData,a=e.columnData;return r.a.createElement(r.a.Fragment,null,t,r.a.createElement(q,null,n[a.noteKey]))}var J=Object(u.c)(function(e){var t=e.text,n=void 0===t?b.b._("Table is empty"):t,a=Object(T.a)(e,["text"]);return r.a.createElement("div",a,n)})(K(),F.a.greyMiddle),Z=n(7715),Y=n(142),X=n(60),ee=n(65),te=n(72),ne=n(71),ae=n(73),re=n(7690),ie=Object(re.SortableElement)(function(e){var t=e.columns,n=e.style,a=e.className;return r.a.createElement("div",{style:n,className:a},t)}),ce=Object(re.SortableContainer)(H),oe=function(e){function t(){var e,n;Object(X.a)(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(n=Object(te.a)(this,(e=Object(ne.a)(t)).call.apply(e,[this].concat(i)))).state={sortedItems:n.props.items},n.rowRenderer=function(e){return r.a.createElement(ie,e)},n.onHandleSorting=function(){var e=Object(w.a)(y.a.mark(function e(t){var a,r,i,c,o;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.newIndex,r=t.oldIndex,a!==r){e.next=3;break}return e.abrupt("return");case 3:if(i=Object(Y.a)(n.state.sortedItems),c=Object(re.arrayMove)(n.state.sortedItems,r,a),n.setState({sortedItems:c}),!n.props.onSort){e.next=15;break}if(o=n.props.onSort({item:i[r],items:c,offset:a-r,newIndex:a,oldIndex:r}),e.t0=o,!e.t0){e.next=13;break}return e.next=12,o;case 12:e.t0=!e.sent;case 13:if(!e.t0){e.next=15;break}n.setState({sortedItems:i});case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n}return Object(ae.a)(t,e),Object(ee.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.items,Object(T.a)(e,["items"]));return r.a.createElement(ce,Object.assign({lockAxis:"y",useDragHandle:!0,onSortEnd:this.onHandleSorting,rowRenderer:this.rowRenderer},t,{items:this.state.sortedItems}))}}]),t}(r.a.PureComponent);oe.getDerivedStateFromProps=function(e){return{sortedItems:e.items}};var le=function(e){var t=e.categories,n=e.onToggle,a=e.onRemove,i=e.onSort,c=e.showEditColumn,o=void 0===c||c,l=e.showRemoveColumn,u=void 0!==l&&l,d=e.showVisibilityColumn,s=void 0!==d&&d,m=e.showHeader,f=void 0===m||m,p=e.isSortable,v=void 0!==p&&p,h=e.isLoading,g=void 0!==h&&h,E=e.heightStretch,y=void 0!==E&&E,w=e.fullHeight,O=void 0!==w&&w,j=e.noRowsDisplay,k=void 0===j?r.a.createElement(J,{text:b.b._("No recipes in category")}):j,C={isLoading:g,items:t,disableHeader:!f,heightStretch:y,fullHeight:O,noRowsRenderer:function(){return k}},T=[o&&r.a.createElement(R.d,{dataKey:"id",width:F.d.ButtonColumnWidthPx,minWidth:F.d.ButtonColumnWidthPx,cellRenderer:U({canQuery:"wareCategory"},Q),cellDataGetter:function(e){var t=e.rowData;return Object(I.b)(t.id,t.categoryType.enum)}}),u&&r.a.createElement(R.d,{dataKey:"id",width:F.d.ButtonColumnWidthPx,minWidth:F.d.ButtonColumnWidthPx,cellRenderer:z,columnData:{onRemove:a}}),s&&r.a.createElement(R.d,{dataKey:"visible",width:F.d.ButtonColumnWidthPx,minWidth:F.d.ButtonColumnWidthPx,cellRenderer:U({canMutate:"updateWareCategory"},G),columnData:{onToggle:n}}),r.a.createElement(R.d,{dataKey:"nameLabel",width:300,label:b.b._("Name"),cellRenderer:$,columnData:{noteKey:"internalNoteLabel"}}),r.a.createElement(R.d,{dataKey:"countRecipes",label:b.b._("Recipe count"),width:100,cellRenderer:function(e){var t=e.cellData;return"".concat(t," ").concat(b.b._("Recipes").toLocaleLowerCase())}}),v&&r.a.createElement(R.d,{dataKey:"id",width:50,cellRenderer:function(){return r.a.createElement(Z.a,null)}})];return v?r.a.createElement.apply(r.a,[oe,Object(x.a)({onSort:i},C)].concat(T)):r.a.createElement.apply(r.a,[H,C].concat(T))};function ue(){var e=Object(l.a)(["\n  position: absolute;\n  right: 0;\n  z-index: 5;\n"]);return ue=function(){return e},e}var de=u.c.div(ue()),se=function(e){var t=e.routeTo,n=void 0===t?"create":t,a=e.onClick;return r.a.createElement(de,null,r.a.createElement(S.a,{to:n,onClick:a},r.a.createElement(_.a,null,r.a.createElement(L.a,{iconName:"add_circle",color:F.a.green}))))},me=Object(j.observer)(function(e){var t=e.headline,n=e.subHeadline,a=void 0!==n&&n,i=e.categoryType,c=Object(C.b)().settings,o=Object(p.Z)({branchId:c.branchId,categoryType:i}),l=o.data,u=o.loading,d=o.updateQuery,f=o.refetch,b=Object(p.H)(),v=Object(O.a)(b,1)[0],h=l&&l.categories||[];return r.a.createElement(r.a.Fragment,null,r.a.createElement(m.a,null,r.a.createElement(s.a,{widthGrowIndex:1},r.a.createElement(k.a,null,t),a&&r.a.createElement(k.a,{size:"smaller"},a)),r.a.createElement(s.a,{fixedWidth:!0},r.a.createElement(se,{routeTo:Object(I.b)("create",i)}))),r.a.createElement(le,{isLoading:u,categories:h,onToggle:function(e,t){v({categoryId:e,visible:t},{optimisticResponse:{updateWareCategory:{__typename:"WareCategory",id:e,visible:t}}})},isSortable:!0,showHeader:!1,fullHeight:!0,showVisibilityColumn:!0,onSort:function(){var e=Object(w.a)(y.a.mark(function e(t){var n,a,r,i;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.item,a=t.items,r=t.offset,d(function(){return{categories:a}}),e.next=4,c.menu.category.sortCategory(n.id,r);case 4:if(!(i=e.sent)){e.next=8;break}return e.next=8,f();case 8:return e.abrupt("return",i);case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}))}),fe=n(95);function pe(){var e=Object(l.a)(["\n  white-space: nowrap;\n  margin-left: 2rem;\n  & a {\n    text-decoration: none;\n    color: ",";\n    padding: 1rem;\n  }\n"]);return pe=function(){return e},e}var be=Object(u.c)(L.a)(pe(),F.a.black),ve=Object(j.observer)(function(){var e=Object(C.b)().settings,t=Object(p.ab)({branchId:e.branchId}),n=t.loading,a=t.data;return n||!(a&&a.companyBranch&&a.companyBranch.foodMenuUrl)?null:r.a.createElement(be,{color:F.a.greyMiddle},r.a.createElement("a",{href:a.companyBranch.foodMenuUrl,target:"_blank"},r.a.createElement(fe.Trans,{id:"Menu codes manual"})))});function he(){var e=Object(l.a)(["\n  height: calc(100% - 3.5rem);\n  padding-top: 1rem;\n  overflow-y: scroll;\n  overflow-x: hidden;\n  -webkit-overflow-scrolling: touch;\n"]);return he=function(){return e},e}var ge=u.c.div(he()),Ee=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{pageTitle:b.b._("Category overview"),useBackButton:!0}),r.a.createElement(h.a,null,r.a.createElement(d.a,{stretchToParent:!0},r.a.createElement(m.a,{justify:"start"},r.a.createElement(s.a,null,r.a.createElement(g.a,{width:20})),r.a.createElement(s.a,null,r.a.createElement(ve,null))),r.a.createElement(ge,null,r.a.createElement(me,{categoryType:p.t.Main,headline:b.b._("Category of recipes")}),r.a.createElement(f.a,{size:1.5}),r.a.createElement(me,{categoryType:p.t.SideDish,headline:b.b._("Category of sidedish")}),r.a.createElement(f.a,{size:1.5}),r.a.createElement(me,{categoryType:p.t.Cover,headline:b.b._("Category of covers")})))))},ye=n(7647);function we(){var e=Object(l.a)(["\n  position: fixed;\n  z-index: 500;\n  right: 0;\n  top: 0rem;\n  width: 10rem;\n  opacity: 0.96;\n  background: ",";\n  border-radius: ",";\n"]);return we=function(){return e},e}var Oe,je,ke=u.c.div(we(),F.a.black,F.c.Button),Ce=function(e){var t=e.type,n=e.isMain,a=e.isSideDish,i=e.isCover,c=e.children;return!0===n&&t===p.t.Main||!0===a&&t===p.t.SideDish||!0===i&&t===p.t.Cover?r.a.createElement(r.a.Fragment,null,c):null},Ie=n(190),xe=n(239),Te=(Oe={},Object(Ie.a)(Oe,p.t.Main,Object(xe.i18nMark)("Ware categories")),Object(Ie.a)(Oe,p.t.SideDish,Object(xe.i18nMark)("Sidedish categories")),Object(Ie.a)(Oe,p.t.Cover,Object(xe.i18nMark)("Cover categories")),Oe),Re=(je={},Object(Ie.a)(je,p.t.Main,Object(xe.i18nMark)("Ware recipe")),Object(Ie.a)(je,p.t.SideDish,Object(xe.i18nMark)("Sidedish recipe")),Object(Ie.a)(je,p.t.Cover,Object(xe.i18nMark)("Cover recipe")),je);function Se(e){return b.b._(Te[e])}function _e(e){return b.b._(Re[e])}var Le=n(7674),De=n(7673),Ne=function(e){var t=e.isCreate,n=void 0!==t&&t;return r.a.createElement(ye.FormApi,{render:function(e){return r.a.createElement(De.a,{id:"form-submit"},function(e,t){if(!Object(Le.a)(e))return b.b._("Fix form errors");return t?b.b._("Create"):b.b._("Save")}(e,n))}})};var We=n(7665);function Fe(){var e=Object(l.a)(["\n  flex: none;\n  margin-right: 1rem;\n"]);return Fe=function(){return e},e}function Be(){var e=Object(l.a)(["\n  margin: 0.6rem;\n  display: flex;\n"]);return Be=function(){return e},e}var Pe=u.c.form(Be()),Ve=u.c.div(Fe()),Me=n(7712),Ae=n(141),qe=n(115),Ke=function(e){var t=e.observe,n=e.render;return r.a.createElement(qe.a,{observe:t,render:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=e.settings;return n(t)})})},He=n(7934);function Ue(){var e=Object(l.a)(["\n  &:before {\n    font-size: "," !important;\n    margin-left: 0.5rem !important;\n  }\n"]);return Ue=function(){return e},e}var Qe=u.c.div(Ue(),function(e){var t=e.fontSize,n=void 0===t?2:t,a=e.fontSizeUnit,r=void 0===a?"rem":a;return"".concat(n).concat(r)}),ze=function(e){var t=e.pictogramId,n=e.fontSize,a=void 0===n?2:n,i=e.fontSizeUnit,c=void 0===i?"rem":i;return r.a.createElement(Qe,{className:Ge(t),fontSize:a,fontSizeUnit:c})};function Ge(e){return"flaticon-".concat(e)}var $e=n(7652),Je=n(32),Ze=function(e){var t=e.field;return r.a.createElement(ye.Field,{field:t,pure:!0},function(e){return r.a.createElement($e.a,{value:e.value?{pictogram:e.value}:null,onChange:function(t){t&&!Array.isArray(t)&&e.setValue(t.pictogram)},options:He.pictograms.map(function(e){return{pictogram:e}}),getOptionValue:Je.a.prop("pictogram"),formatOptionLabel:function(e){var t=e.pictogram;return r.a.createElement(ze,{pictogramId:t,fontSize:2})},components:{SingleValue:function(e){var t=e.data;return r.a.createElement(ze,{pictogramId:t.pictogram,fontSize:4})}},styles:{container:function(e){return Object(x.a)({},e,{width:"8rem"})},menuList:function(e){return Object(x.a)({},e,{maxHeight:"35rem"})}},isClearable:!1,isSearchable:!1,minWidth:8})})},Ye=n(7683),Xe=function(e){var t=e.confirmText,n=e.onDelete;return r.a.createElement(ye.Field,{field:"id"},function(e){return"NEW"!==e.value&&r.a.createElement(i.Route,null,function(a){var i=a.history;return r.a.createElement(Ye.a,{confirmText:t,onDelete:Object(w.a)(y.a.mark(function t(){return y.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n(e.value);case 2:i.goBack();case 3:case"end":return t.stop()}},t,this)}))})})})},et=n(7653),tt=n(7650),nt=function(e){var t=e.field,n=void 0===t?"internalNote":t,a=(e.icon,e.label),i=void 0===a?b.b._("Internal note").toLocaleLowerCase():a,c=Object(T.a)(e,["field","icon","label"]);return r.a.createElement(tt.a,{label:i,labelWidth:7},r.a.createElement(et.a,Object.assign({field:n,inputFullWidth:!0},c)))},at=function(e){var t=e.field,n=void 0===t?"nameLabel":t,a=e.icon,i=void 0===a?"label":a,c=Object(T.a)(e,["field","icon"]);return r.a.createElement(tt.a,{icon:i,labelWidth:7},r.a.createElement(et.a,Object.assign({field:n,inputFullWidth:!0,isRequired:!0,validatioName:b.b._("Name")},c)))},rt=function(e){var t=e.categoryType;return r.a.createElement(Pe,null,r.a.createElement(Ve,null,r.a.createElement(Ae.a,{width:22},r.a.createElement(at,{placeholder:b.b._("Category name"),inputFullWidth:!0})),r.a.createElement(Ae.a,{width:22},r.a.createElement(nt,{placeholder:b.b._("Category internal note")})),r.a.createElement(Me.a,{field:"visible",label:b.b._("To show this category")})),t===p.t.Main?r.a.createElement(Ve,null,r.a.createElement(Ze,{field:"pictogram"})):null,r.a.createElement(We.a,{position:"BottomRight"},r.a.createElement(Ke,{render:function(e){var n=e.menu;return r.a.createElement(Xe,{confirmText:b.b._("Remove this category?"),onDelete:function(e){return n.category.deleteCategory(e,t)}})}})))},it=n(123),ct=n(7936);function ot(e){var t=e.shouldLoad,n=e.loader,i=Object(T.a)(e,["shouldLoad","loader"]),c=Object(a.useState)(null),o=Object(O.a)(c,2),l=o[0],u=o[1];return Object(a.useEffect)(function(){t&&n().then(u)},[t]),r.a.createElement(ye.Form,Object.assign({values:l},i))}var lt=function(e){var t=e.render;return r.a.createElement(i.Route,null,function(e){var n=e.history;return t?t(function(){return n.goBack()}):(n.goBack(),null)})},ut=n(38);function dt(){var e=Object(l.a)(["\n  color: red;\n  padding: 1rem;\n  max-width: 30rem;\n  overflow-wrap: break-word;\n"]);return dt=function(){return e},e}var st=u.c.div(dt()),mt=function(e){function t(){var e,n;Object(X.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(te.a)(this,(e=Object(ne.a)(t)).call.apply(e,[this].concat(r)))).state={submitError:null,validationErrors:null},n}return Object(ae.a)(t,e),Object(ee.a)(t,[{key:"renderErrors",value:function(){var e=this.state,t=e.submitError,n=e.validationErrors;return t?this.renderSubmitError(t):n?this.renderValidationErrors(n):null}},{key:"renderSubmitError",value:function(e){var t=[b.b._("Unexpected error while sending form. Out team was notified about the issue.")];if(Object(ct.isApolloError)(e)){var n=Je.a.propEq("showToUser",!0),a=e.graphQLErrors.filter(n).map(Je.a.prop("message"));a.length&&(t=a)}return this.renderPopover(t)}},{key:"renderValidationErrors",value:function(e){return null}},{key:"renderPopover",value:function(e){var t=this;return r.a.createElement(it.g,{open:!0,anchorEl:function(){return document.getElementById("submit-button")},onClose:function(){return t.setState({submitError:null,validationErrors:null})},anchorOrigin:{vertical:"bottom",horizontal:"center"}},e.map(function(e,t){return r.a.createElement(st,{key:t},e)}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.isCreate,a=t.onCreate,i=t.onUpdate,c=t.getDefaultValues,o=t.loadValues,l=t.loadDefaults,u=t.children;return r.a.createElement(lt,{render:function(t){return r.a.createElement(ot,{shouldLoad:!0,defaultValues:c(),loader:Object(w.a)(y.a.mark(function e(){var t,a,r;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=c(),!l){e.next=6;break}return e.next=4,l();case 4:a=e.sent,Object.assign(t,a);case 6:if(!n){e.next=8;break}return e.abrupt("return",t);case 8:return e.next=10,o();case 10:return r=e.sent,e.abrupt("return",Object.assign({},t,r));case 12:case"end":return e.stop()}},e,this)})),onChange:function(e){return Object(ut.d)("new values",e.values)},onSubmit:function(){var e=Object(w.a)(y.a.mark(function e(r){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=5;break}return e.next=3,a(r);case 3:e.next=7;break;case 5:return e.next=7,i(r);case 7:t();case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),onSubmitFailure:function(t,n){e.setState({validationErrors:t,submitError:n}),Object.keys(t).length&&Object(ut.c)("validation errors",t),n&&Object(ut.c)("submit error",n)}},u,e.renderErrors())}})}}]),t}(r.a.Component);function ft(){return Object(C.b)().settings.menu}var pt=function(e){var t=e.categoryId,n=e.categoryType,a=e.children,i=ft();return r.a.createElement(mt,{isCreate:null===t,onCreate:function(e){return i.category.createCategory(e,n)},onUpdate:function(e){return i.category.updateCategory(e,n)},getDefaultValues:function(){return function(e){return{id:"NEW",visible:!0,internalNoteLabel:"",pictogram:"",nameLabel:"",minCount:0,maxCount:0,categoryType:{enum:e},recipes:[]}}(n)},loadValues:Object(w.a)(y.a.mark(function e(){var n,a;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.client.query({query:p.q,variables:{categoryId:t},fetchPolicy:"no-cache"});case 2:return n=e.sent,a=n.data,e.abrupt("return",a.category);case 5:case"end":return e.stop()}},e,this)}))},a)};function bt(e){var t=e.items,n=e.renderItem,a=(e.isLoading,e.heightStretch),i=void 0!==a&&a,c=e.rowHeight,o=void 0===c?60:c,l=Object(T.a)(e,["items","renderItem","isLoading","heightStretch","rowHeight"]),u=r.a.useCallback(function(e){var a=e.key,i=e.style,c=e.index;return r.a.createElement("div",{key:a,style:i},n(t[c],c))},[n,t]),d=function(e,n){return r.a.createElement(R.g,Object.assign({width:e,height:n,headerHeight:50,rowHeight:o,rowCount:t?t.length:0,rowRenderer:u,style:{outline:"none"}},l))};return i?r.a.createElement(R.a,null,function(e){var t=e.width,n=e.height;return d(t,n)}):r.a.createElement(R.i,{scrollElement:window},function(e){var t=e.height;return r.a.createElement(R.a,{disableHeight:!0},function(e){var n=e.width;return d(n,t)})})}var vt=n(7667),ht=n.n(vt),gt=n(484),Et=function(e){return void 0===e||Object(vt.isEmpty)(e+"")||!Object(gt.b)(e+"")?b.b._("Price must be a number"):null},yt=function(e){var t=e.field,n=void 0===t?"price.value":t,a=e.icon,i=void 0===a?"toll":a,c=Object(T.a)(e,["field","icon"]);return r.a.createElement(tt.a,{icon:i},r.a.createElement(Ae.a,{width:5},r.a.createElement(et.a,Object.assign({field:n,inputFullWidth:!0,validate:Et},c))))},wt=n(192),Ot=n(7707),jt=n(6),kt=n.n(jt),Ct=n(194);function It(){var e=Object(l.a)(["\n  query GVats($branchId: ID!) {\n    vats(companyBranch: $branchId) {\n      id\n      vat\n    }\n  }\n"]);return It=function(){return e},e}var xt=kt()(It()),Tt=Object(Ct.a)(xt);function Rt(){var e=Object(l.a)(["\n  margin-left: 5rem;\n"]);return Rt=function(){return e},e}var St=Object(wt.a)(Rt()),_t=function(e){var t=e.field,n=void 0===t?"price.vat":t,a=Object(C.b)().settings;return Object(j.useObserver)(function(){return r.a.createElement(Tt,{variables:{branchId:a.branchId},fetchPolicy:"cache-and-network",renderLoading:!1,render:function(e){var t=e.vats;return r.a.createElement(tt.a,{className:St,label:"".concat(b.b._("VAT"),":")},t&&r.a.createElement(Ot.a,{field:n,items:t,formatItem:function(e){var t=e.vat;return"".concat(t,"%")},isRequired:!0,validationName:b.b._("VAT")}))}})})};function Lt(){var e=Object(l.a)(["\n  padding: 0.5rem;\n"]);return Lt=function(){return e},e}var Dt=Object(u.c)(function(e){var t=e.field,n=e.className;return r.a.createElement(ye.Field,{field:t},function(e){return r.a.createElement("span",{className:n},e.value)})})(Lt()),Nt=function(e){var t=e.priceType,n=e.label;return r.a.createElement(r.a.Fragment,null,r.a.createElement(k.a,null,n),r.a.createElement(ye.NestedField,{field:["prices",t]},r.a.createElement(m.a,{justify:"flex-start"},r.a.createElement(yt,{field:"value"}),r.a.createElement(Dt,{field:"currencyCode"}),r.a.createElement(_t,{field:"vatId"}))))},Wt=n(88);function Ft(e){var t=e.onAdd,n=e.addLabel,i=void 0===n?b.b._("Add"):n,c=e.addButtonText,o=void 0===c?b.b._("Add"):c,l=Object(T.a)(e,["onAdd","addLabel","addButtonText"]),u=Object(Wt.useStateRef)(null),d=Object(O.a)(u,2),f=d[0],p=d[1],v=Object(a.useCallback)(function(){var e=f();null!==e&&(t(e),p(null))},[t]),h=Object(a.useCallback)(function(e){"Enter"===e.key&&v()},[]),g=Object(a.useCallback)(function(e){p(e||null)},[]);return r.a.createElement(m.a,{justify:"flex-start"},r.a.createElement(s.a,{fixedWidth:!0,width:"4rem",margin:"auto 0"},i),r.a.createElement(s.a,{fixedWidth:!0,width:"20rem",margin:"auto 0"},r.a.createElement($e.a,Object.assign({value:f(),onChange:g,onKeyDown:h,isMulti:!1,isClearable:!1,getOptionValue:Je.a.prop("id"),getOptionLabel:Je.a.prop("nameLabel")},l))),r.a.createElement(s.a,{fixedWidth:!0,width:"10rem",margin:"auto 0"},r.a.createElement(L.a,{text:o,disabled:null===f(),onClick:v})))}var Bt=function(e){var t=e.recipes,n=e.onRemove;return r.a.createElement(H,{items:t,disableHeader:!0},r.a.createElement(R.d,{dataKey:"associatedRecipe",width:F.d.ButtonColumnWidthPx,minWidth:F.d.ButtonColumnWidthPx,cellRenderer:function(e){var t=e.cellData;return r.a.createElement(W,{onClick:function(){return n(t)}})}}),r.a.createElement(R.d,{dataKey:"nameLabel",width:300,label:b.b._("Name"),cellRenderer:$,columnData:{noteKey:"internalNote"}}),r.a.createElement(R.d,{dataKey:"formattedPrice",width:100,label:b.b._("Price")}))},Pt=n(345),Vt=function(e){var t=e.priceType,n=e.recipeId;return r.a.createElement(ye.Field,{field:"associatedRecipes"},function(e){var a=Je.a.filter(Je.a.propEq("warePriceType",t),e.value),i=Je.a.reject(function(e){return e.id===n||(t=e.id,a.some(Je.a.propEq("associatedRecipe",t)));var t}),c=function(n){e.setValue(e.value.concat({warePriceType:t,associatedRecipe:n.id,nameLabel:n.nameLabel,formattedPrice:"?"}))};return r.a.createElement(r.a.Fragment,null,r.a.createElement(Bt,{recipes:a,onRemove:function(n){e.setValue(Je.a.reject(function(e){var a=e.associatedRecipe,r=e.warePriceType;return a===n&&r===t},e.value))}}),r.a.createElement(Ke,{render:function(e){return r.a.createElement(Pt.c,{variables:{branchId:e.branchId},fetchPolicy:"cache-and-network",render:function(e){var t=e.recipes;return r.a.createElement(Ft,{options:i(t),onAdd:c})}})}}),r.a.createElement(f.a,null))})},Mt=[{priceType:p.u.Delivery,label:Object(xe.i18nMark)("Delivery sale")},{priceType:p.u.Inhouse,label:Object(xe.i18nMark)("Local sale")}],At=function(e){var t=e.recipeType,n=e.recipeId;return r.a.createElement(r.a.Fragment,null,Mt.map(function(e){var i=e.priceType,c=e.label;return r.a.createElement(a.Fragment,{key:i},r.a.createElement(Nt,{priceType:i,label:b.b._(c)}),r.a.createElement(f.a,null),t===p.t.Main&&r.a.createElement(Vt,{priceType:i,recipeId:n}))}))},qt=Object(j.observer)(function(e){var t=e.categoryType,n=e.filterRecipes,a=e.onAdd,i=Object(C.b)().settings,c=Object(p.bb)({branchId:i.branchId,categoryType:t}),o=c.data,l=c.loading;return r.a.createElement(Ft,{isLoading:l,options:l?[]:n(o.recipes),onAdd:a})});function Kt(){var e=Object(l.a)(["\n  cursor: move;\n"]);return Kt=function(){return e},e}function Ht(){var e=Object(l.a)(["\n  display: grid;\n  grid-gap: 1rem;\n  grid-template-columns: ","px 100px 3fr 1fr 1fr 50px;\n"]);return Ht=function(){return e},e}function Ut(){var e=Object(l.a)(["\n  flex: 1 1 0;\n  margin: 1rem 0 0 1rem;\n"]);return Ut=function(){return e},e}function Qt(){var e=Object(l.a)(["\n  flex: 0 0 auto;\n"]);return Qt=function(){return e},e}function zt(){var e=Object(l.a)(["\n  display: flex;\n  flex-direction: column;\n  height: calc(100% - 2rem);\n  width: 100%;\n"]);return zt=function(){return e},e}var Gt=u.c.div(zt()),$t=u.c.div(Qt()),Jt=u.c.div(Ut()),Zt=Object(re.SortableContainer)(Jt),Yt=u.c.div(Ht(),F.d.ButtonColumnWidthPx),Xt=u.c.div(Kt()),en=Object(re.SortableElement)(function(e){var t=e.recipe,n=e.onRemove,a=Mt.map(function(e){var n=e.priceType,a=e.label,i=t.prices.find(Je.a.pathEq(["priceType","enum"],n));return r.a.createElement(Xt,{key:n},r.a.createElement(q,null,b.b._(a)),i?i.price.formattedValue:r.a.createElement("i",null,b.b._("Not set").toLocaleLowerCase()))});return r.a.createElement(Yt,null,r.a.createElement("div",null,r.a.createElement(W,{onClick:n})),r.a.createElement(Xt,null,t.code),r.a.createElement(Xt,null,t.nameLabel,r.a.createElement(q,null,t.internalNote)),a,r.a.createElement(Z.a,null))}),tn=function(e){var t=e.categoryType;return r.a.createElement(ye.Field,{field:"recipes"},function(e){var n=e.value,a=function(){var t=Object(w.a)(y.a.mark(function t(a){var r,i,c;return y.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=a.newIndex,i=a.oldIndex,r!==i){t.next=3;break}return t.abrupt("return");case 3:c=Object(re.arrayMove)(n,i,r),e.setValue(c);case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}();return r.a.createElement(Gt,null,r.a.createElement($t,null,r.a.createElement(qt,{categoryType:t,filterRecipes:Je.a.without(e.value),onAdd:function(t){return e.setValue(e.value.concat(t))}})),r.a.createElement(Zt,{lockAxis:"y",lockToContainerEdges:!0,onSortEnd:a},r.a.createElement(bt,{items:e.value,heightStretch:!0,rowHeight:60,renderItem:function(t,n){return r.a.createElement(en,{recipe:t,onRemove:function(){e.setValue(Je.a.reject(Je.a.propEq("id",t.id),e.value))},index:n})},rowCount:e.value.length})))})},nn=n(178),an=n.n(nn),rn=n(7662),cn=n(7654),on=n(7795);function ln(){var e=Object(l.a)(["\n  display: flex;\n  align-items: center;\n  & > label {\n    min-width: 5rem;\n  }\n  & > * {\n    margin: 0.2rem 0.5rem;\n  }\n  input.count {\n    font-size: 1.5rem;\n    line-height: 1.5rem;\n    text-align: center;\n  }\n"]);return ln=function(){return e},e}var un=u.c.div(ln()),dn=function(e){var t=e.count,n=e.label,a=e.enabled,i=e.onChange,c=e.id,o=r.a.useRef(t);return r.a.createElement(un,null,r.a.createElement("label",{htmlFor:c},n),r.a.createElement(Ae.a,{width:3},r.a.createElement(cn.a,{id:c,value:0===t?"":t,onChange:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){e.target.validity.valid&&i(Number.parseInt(e.target.value,10))}),onFocus:function(e){e.target.select()},disabled:0===t||!a,inputFullWidth:!0,type:"tel",pattern:"^[1-9]\\d*$",className:"count"})),r.a.createElement(Ae.a,{width:4},r.a.createElement(L.a,{disabled:!a||t<=0,onClick:function(){return i(t-1)}},"\u2796")),r.a.createElement(Ae.a,{width:4},r.a.createElement(L.a,{disabled:!a,onClick:function(){return i(t+1)}},"\u2795")),r.a.createElement("div",null,r.a.createElement(on.a,null,r.a.createElement("input",{type:"checkbox",id:"".concat(c,"-nolimit"),checked:0===t,disabled:!a,onChange:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){0===t?i(o.current||1):(o.current=t,i(0))})}),r.a.createElement("label",{htmlFor:"".concat(c,"-nolimit")},r.a.createElement(fe.Trans,{id:"Unlimited"})))))},sn=function(){return{noLimit:{label:b.b._("No limitation"),min:0,max:0},optional:{label:b.b._("One at most"),min:0,max:1},required:{label:b.b._("One at least"),min:1,max:0},onlyOne:{label:b.b._("Exactly one"),min:1,max:1},custom:{label:b.b._("Custom range")}}},mn=function(e){var t=e.formApi,n=r.a.useMemo(sn,[]),a=r.a.useState("noLimit"),i=Object(O.a)(a,2),c=i[0],o=i[1],l=t.getValue("minCount"),u=t.getValue("maxCount");r.a.useEffect(function(){if("custom"!==c){var e=an.a.findKey(n,function(e){var t=e.min,n=e.max;return t===l&&n===u});e&&o(e)}},[c,l,u]);var d=function(e){return t.setValue("minCount",e)},s=function(e){return t.setValue("maxCount",e)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(rn.a,{items:Object.keys(n),formatItem:function(e){return n[e].label},onSingleSelection:function(e){if(e){o(e);var t=n[e];d(t.min||0),s(t.max||0)}},selectedItem:c}),r.a.createElement(dn,{id:"minCount",count:l,label:r.a.createElement(fe.Trans,{id:"Minimum"}),enabled:"custom"===c,onChange:d}),r.a.createElement(dn,{id:"maxCount",count:u,label:r.a.createElement(fe.Trans,{id:"Maximum"}),enabled:"custom"===c,onChange:s}))};function fn(){var e=Object(l.a)(["\n  flex: 1 1 0;\n  min-height: 0;\n  position: relative;\n"]);return fn=function(){return e},e}function pn(){var e=Object(l.a)(["\n  flex: 0 0 8rem;\n"]);return pn=function(){return e},e}function bn(){var e=Object(l.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  width: 100%;\n"]);return bn=function(){return e},e}var vn=u.c.div(bn()),hn=u.c.div(pn()),gn=u.c.div(fn()),En=function(e){var t=e.categoryId,n=e.categoryType;return r.a.createElement(pt,{categoryId:t,categoryType:n},r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{pageTitle:Se(n),hideLogoutWidget:!0,useBackButton:!0}),r.a.createElement(h.a,null,r.a.createElement(vn,null,r.a.createElement(hn,null,r.a.createElement(d.a,null,r.a.createElement(rt,{categoryType:n}))),r.a.createElement(Ce,{isSideDish:!0,type:n},r.a.createElement(hn,null,r.a.createElement(d.a,null,r.a.createElement(k.a,null,r.a.createElement(fe.Trans,{id:"Required amounts of recipes to be picked"})),r.a.createElement(ye.FormApi,{component:mn})))),r.a.createElement(gn,null,r.a.createElement(d.a,{stretchToParent:!0},r.a.createElement(k.a,null,r.a.createElement(fe.Trans,{id:"Recipes assigned to this category"})),r.a.createElement(tn,{categoryType:n}))))),r.a.createElement(ke,null,r.a.createElement(V.a,{mutationName:null===t?"createWareCategory":"updateWareCategory"},r.a.createElement(Ne,{isCreate:null===t})))))};function yn(){var e=Object(l.a)(["\n  height: calc(100% - 4.5rem);\n  padding-top: 2rem;\n"]);return yn=function(){return e},e}var wn=u.c.div(yn()),On=Object(j.observer)(function(){var e=Object(C.b)().settings.menu.recipe,t=Object(p.Y)({branchId:e.branchId}),n=t.data,a=t.loading;return r.a.createElement(Ae.a,{width:17},r.a.createElement($e.a,{key:e.branchId,onChange:function(t){e.setCategoryFilter(t?t.id:null)},options:function(){if(!n||!n.categories)return[];var e=Je.a.groupBy(function(e){return e.categoryType.enum.toString()},n.categories);return Object.keys(e).map(function(t){return{label:Se(t),options:e[t]}})}(),isMulti:!1,isClearable:!0,isSearchable:!0,isLoading:a,placeholder:b.b._("Filter by category"),getOptionValue:Je.a.prop("id"),getOptionLabel:Je.a.prop("nameLabel")}))}),jn=n(122),kn=function(e){var t=e.modelType,n=Object(C.b)().settings.menu[t],a=Object(Wt.useDebounceCallback)(n.setFilterInput);return r.a.createElement(tt.a,{icon:jn.m},r.a.createElement(Ae.a,{width:17},r.a.createElement(cn.a,{defaultValue:n.filterInput,inputFullWidth:!0,onChange:function(e){return a(e.target.value)},placeholder:b.b._("Filter by name or code")})))},Cn=n(7714),In=n(352),xn=function(){var e=r.a.useState(!1),t=Object(O.a)(e,2),n=t[0],a=t[1],i=Object(Wt.useRouterContext)().history,c=function(e){return function(){var t=Object(In.b)(Object(Cn.a)("create","".concat(location.pathname,"/")),e);i.push(t)}};return r.a.createElement(r.a.Fragment,null,r.a.createElement(se,{onClick:function(e){e.preventDefault(),a(!0)}}),r.a.createElement(it.c,{open:n,onClose:function(){return a(!1)}},r.a.createElement(it.f,null,"Select item type"),r.a.createElement(L.a,{onClick:c(p.t.Main)},r.a.createElement(fe.Trans,{id:"Ware"})),r.a.createElement(L.a,{onClick:c(p.t.SideDish)},r.a.createElement(fe.Trans,{id:"Sidedish"})),r.a.createElement(L.a,{onClick:c(p.t.Cover)},r.a.createElement(fe.Trans,{id:"Cover"}))))},Tn=n(7696),Rn=n(7796),Sn=function(e){var t=e.recipes,n=e.onToggle,a=e.onRemove,i=e.showEditColumn,c=void 0===i||i,o=e.showRemoveColumn,l=void 0!==o&&o,u=e.showVisibilityColumn,d=void 0===u||u,s=e.showTypeColumn,m=void 0!==s&&s,f=e.isLoading,v=void 0!==f&&f,h=e.heightStretch,g={isLoading:v,items:t,heightStretch:void 0!==h&&h,noRowsRenderer:function(){return v?r.a.createElement(Rn.a,null):r.a.createElement(k.a,null,b.b._("No recipes has been found"))}};return r.a.createElement(H,g,c&&r.a.createElement(R.d,{dataKey:"id",width:F.d.ButtonColumnWidthPx,minWidth:F.d.ButtonColumnWidthPx,cellRenderer:U({canQuery:"recipe"},Q),cellDataGetter:function(e){var t=e.rowData;return Object(In.b)(t.id,t.recipeType.enum)}}),l&&r.a.createElement(R.d,{dataKey:"id",width:F.d.ButtonColumnWidthPx,minWidth:F.d.ButtonColumnWidthPx,cellRenderer:z,columnData:{onRemove:a}}),d&&r.a.createElement(R.d,{dataKey:"visible",width:F.d.ButtonColumnWidthPx,minWidth:F.d.ButtonColumnWidthPx,cellRenderer:U({canMutate:"updateRecipe"},G),columnData:{onToggle:n}}),m&&r.a.createElement(R.d,{dataKey:"recipeType",width:100,label:b.b._("Type"),cellRenderer:Ln}),r.a.createElement(R.d,{dataKey:"code",width:100,label:b.b._("Code")}),r.a.createElement(R.d,{dataKey:"nameLabel",width:600,flexGrow:2,label:b.b._("Name"),cellRenderer:$,columnData:{noteKey:"internalNote"}}),r.a.createElement(R.d,{dataKey:"prices",width:150,label:b.b._("Delivery sale"),cellRenderer:_n,columnData:{priceType:p.u.Delivery}}),r.a.createElement(R.d,{dataKey:"prices",width:150,label:b.b._("Local sale"),cellRenderer:_n,columnData:{priceType:p.u.Inhouse}}),r.a.createElement(R.d,{dataKey:"availableAmount",label:b.b._("recipe.list.availableAmount",{},{defaults:"Stock"}),width:100}),r.a.createElement(R.d,{dataKey:"internalNote",label:b.b._("Internal note"),width:200}))};function _n(e){var t=e.cellData,n=e.columnData.priceType,a=t.find(Je.a.pathEq(["priceType","enum"],n));return a?a.price.formattedValue:r.a.createElement("i",null,b.b._("Not set").toLocaleLowerCase())}function Ln(e){var t=e.rowData.recipeType.enum;return t===p.t.SideDish?b.b._("Sidedish").toLocaleLowerCase():t===p.t.Cover?b.b._("Cover").toLocaleLowerCase():b.b._("Ware").toLocaleLowerCase()}var Dn=Object(j.observer)(function(){var e=Object(C.b)().settings,t=Object(p.bb)({branchId:e.branchId,categoryId:e.menu.recipe.categoryFilterId}),n=t.data,a=t.loading,i=Object(j.useComputed)(function(){if(!n||!n.recipes||0===n.recipes.length)return[];var t=Object(Tn.a)(e.menu.recipe.filterInput);return n.recipes.filter(Je.a.cond([[Je.a.propSatisfies(t,"code"),Je.a.T],[Je.a.propSatisfies(t,"nameLabel"),Je.a.T]]))},[n&&n.recipes]);return r.a.createElement(Sn,{recipes:i,onToggle:e.menu.recipe.changeVisibility,isLoading:a,heightStretch:!0,showTypeColumn:!0})}),Nn=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{pageTitle:b.b._("Recipe overview"),useBackButton:!0}),r.a.createElement(h.a,null,r.a.createElement(d.a,{stretchToParent:!0},r.a.createElement(m.a,{justify:"start"},r.a.createElement(s.a,null,r.a.createElement(g.a,{width:20})),r.a.createElement(s.a,null,r.a.createElement(kn,{modelType:"recipe"})),r.a.createElement(s.a,null,r.a.createElement(On,null))),r.a.createElement(V.a,{mutationName:"createRecipe"},r.a.createElement(xn,null)),r.a.createElement(wn,null,r.a.createElement(Dn,null)))))},Wn=Object(j.observer)(function(e){var t=e.categoryType,n=e.currentCategories,a=e.addButtonText,i=e.onAdd,c=Object(C.b)().settings,o=Object(p.Z)({branchId:c.branchId,categoryType:t}),l=o.data,u=o.loading,d=l&&l.categories||[];return r.a.createElement(Ft,{isLoading:u,options:Je.a.without(n,d),addButtonText:a,onAdd:i})}),Fn=function(e){var t=e.categoryType,n=e.addButtonText,a=e.noRowsText,i=e.field;return r.a.createElement(ye.Field,{field:i},function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(le,{categories:e.value,showRemoveColumn:!0,showEditColumn:!1,showHeader:!1,onRemove:function(t){return e.setValue(Je.a.reject(Je.a.propEq("id",t),e.value))},noRowsDisplay:r.a.createElement(J,{text:a})}),r.a.createElement(Wn,{addButtonText:n,categoryType:t,currentCategories:e.value,onAdd:function(t){return e.setValue(e.value.concat(t))}}))})},Bn=function(e){var t=e.field,n=void 0===t?"code":t,a=(e.icon,e.isRequired,Object(T.a)(e,["field","icon","isRequired"]));return r.a.createElement(tt.a,{label:b.b._("Code").toLocaleLowerCase(),labelWidth:7},r.a.createElement(Ae.a,{width:9},r.a.createElement(et.a,Object.assign({field:n,inputFullWidth:!0,isRequired:!0,validatioName:b.b._("Code")},a))))},Pn=function(e){var t=e.field,n=void 0===t?"descriptionLabel":t,a=(e.icon,Object(T.a)(e,["field","icon"]));return r.a.createElement(tt.a,{label:b.b._("Public note").toLocaleLowerCase(),labelWidth:7},r.a.createElement(et.a,Object.assign({field:n,inputFullWidth:!0},a)))};function Vn(){var e=Object(l.a)(["\n  query GAllergens {\n    allergens {\n      ...FMenuAllergen\n    }\n  }\n  ","\n"]);return Vn=function(){return e},e}var Mn=kt()(Vn(),p.c),An=Object(Ct.a)(Mn);function qn(){var e=Object(l.a)(["\n    color: ",";\n    background-color: ",";\n  "]);return qn=function(){return e},e}function Kn(){var e=Object(l.a)(["\n  float: left;\n  width: 2.3rem;\n  height: 2.3rem;\n  border: 1px solid ",";\n  margin: 0.3rem 0.6rem 0.3rem ",";\n  font-size: 1.5rem;\n  text-align: center;\n  vertical-align: middle;\n  cursor: default;\n  ",";\n"]);return Kn=function(){return e},e}var Hn=u.c.div(Kn(),F.a.greyMiddle,F.d.MarginAroundFormComponents,function(e){var t=e.active;return Object(u.b)(qn(),t?F.a.black:F.a.greyMiddle,t?F.a.yellow:F.a.white)}),Un=function(e){var t=e.selected,n=e.onToggle;return r.a.createElement(An,{render:function(e){var a=e.allergens;return r.a.createElement(r.a.Fragment,null,a.map(function(e){var a={active:t.includes(e.enum),onClick:n&&function(){return n(e.enum)}};return r.a.createElement(Hn,Object.assign({key:e.enum,title:e.code},a),e.category)}))}})},Qn=function(){return r.a.createElement(ye.Field,{field:"ingredients"},function(e){var t=e.value,n=an.a.uniq(an.a.flatten(t.map(Je.a.prop("allergens"))));return r.a.createElement(Un,{selected:n})})},zn=function(e){var t=e.recipeType,n=t===p.t.Main;return r.a.createElement(Pe,null,r.a.createElement(Ve,null,r.a.createElement(at,{placeholder:b.b._("Recipe name")}),r.a.createElement(Bn,{placeholder:b.b._("Recipe code")}),r.a.createElement(nt,{placeholder:b.b._("Recipe internal note")}),n&&r.a.createElement(Pn,{placeholder:b.b._("Public note for customers, allergens")}),r.a.createElement(Ce,{type:t,isMain:!0},r.a.createElement(tt.a,{labelWidth:7,icon:"error_outline"},b.b._("Allergens based on stock cards"),r.a.createElement("br",null),r.a.createElement(Qn,null))),r.a.createElement(tt.a,{labelWidth:7},r.a.createElement(Me.a,{field:"visible",label:b.b._("To show this recipe")}))),r.a.createElement(We.a,{position:"BottomRight"},r.a.createElement(Ke,{render:function(e){var t=e.menu;return r.a.createElement(Xe,{confirmText:b.b._("Remove this recipe?"),onDelete:function(e){return t.recipe.deleteRecipe(e)}})}})))},Gn=function(e){var t=e.recipeId,n=e.recipeType,a=e.children,i=ft();return r.a.createElement(mt,{isCreate:null===t,onCreate:function(e){return i.recipe.createRecipe(e,n)},onUpdate:function(e){return i.recipe.updateRecipe(e)},getDefaultValues:function(){return Jn(n)},loadDefaults:Object(w.a)(y.a.mark(function e(){var t,a,r,c;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.recipe.queryDefaults();case 2:return t=e.sent,a=t.vats,r=t.currencyCode,(c=Object(x.a)({},Jn(n))).prices=$n(function(e){return{value:0,vatId:a[e],currencyCode:r}}),e.abrupt("return",c);case 8:case"end":return e.stop()}},e,this)})),loadValues:Object(w.a)(y.a.mark(function e(){var n,a;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.client.query({query:Pt.b,variables:{recipeId:t},fetchPolicy:"no-cache"});case 2:return n=e.sent,a=n.data,e.abrupt("return",Zn(a.recipe));case 5:case"end":return e.stop()}},e,this)}))},a)};function $n(e){return[p.u.Delivery,p.u.Inhouse].reduce(function(t,n){return t[n]=e(n),t},{})}function Jn(e){return{id:"NEW",code:"",nameLabel:"",internalNote:"",descriptionLabel:"",image:"",visible:!0,recipeType:{enum:e},sourcePrices:[],prices:$n(function(){return{value:0,vatId:null,currencyCode:""}}),sourceAssociatedRecipes:[],associatedRecipes:[],sourceIngredients:[],ingredients:[],sideDishes:[],categories:[]}}function Zn(e){return Object(x.a)({},e,{associatedRecipes:e.sourceAssociatedRecipes.map(function(e){var t=e.priceType,n=e.recipe;return{warePriceType:t.enum,nameLabel:n.nameLabel,associatedRecipe:n.id,formattedPrice:"?"}}),ingredients:e.sourceIngredients.map(function(e){var t=e.quantity,n=e.stockItem,a=n.id,r=n.label,i=n.allergens;return{stockItem:a,label:r,quantity:t,unitLabel:n.wareUnit.code,allergens:i.map(Je.a.prop("enum"))}}),prices:$n(function(t){var n=e.sourcePrices.find(Je.a.pathEq(["priceType","enum"],t));return n?{value:n.price.value,vatId:n.vat.id,currencyCode:n.price.currency.code}:{value:0,vatId:null,currencyCode:""}})})}var Yn=function(e){var t=e.ingredients,n=e.onRemove,a=e.isLoading,i=void 0!==a&&a;return r.a.createElement(H,{isLoading:i,items:t,disableHeader:!0,noRowsRenderer:function(){return r.a.createElement(J,{text:b.b._("Recipe has no ingredients")})}},r.a.createElement(R.d,{dataKey:"stockItem",width:F.d.ButtonColumnWidthPx,minWidth:F.d.ButtonColumnWidthPx,cellRenderer:z,columnData:{onRemove:n}}),r.a.createElement(R.d,{dataKey:"label",width:300,label:b.b._("Name")}),r.a.createElement(R.d,{dataKey:"quantity",width:60,label:b.b._("Quantity"),cellRenderer:function(e){var t=e.rowIndex;return r.a.createElement(Ae.a,{width:2.5},r.a.createElement(et.a,{field:["ingredients",t,"quantity"],validate:Xn,inputFullWidth:!0}))}}),r.a.createElement(R.d,{dataKey:"unitLabel",width:100,label:b.b._("Ware unit")}))};function Xn(e){var t=b.b._("Quantity");return ht.a.isEmpty(e+"")?b.b._("{fieldName} must be entered",{fieldName:t}):ht.a.isFloat(e+"",{min:0})?null:b.b._("{fieldName} must be a positive number",{fieldName:t})}var ea=Je.a.differenceWith(function(e,t){return e.id===t.stockItem}),ta=Object(j.observer)(function(e){var t=e.ingredients,n=e.onAdd,a=e.onRemove,i=Object(C.b)().settings,c=Object(p.db)({branchId:i.branchId}),o=c.data,l=c.loading;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Yn,{ingredients:t,onRemove:a}),r.a.createElement(Ft,{isLoading:l,addButtonText:b.b._("Add ingredient"),options:l?[]:ea(o.stockItems,t),onAdd:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){n({stockItem:e.id,label:e.nameLabel,quantity:1,unitLabel:e.wareUnit.code,allergens:e.allergens.map(Je.a.prop("enum"))})})}))}),na=function(){return r.a.createElement(ye.Field,{field:"ingredients"},function(e){return r.a.createElement(ta,{ingredients:e.value,onAdd:function(t){e.setValue(Object(Y.a)(e.value).concat([t]))},onRemove:function(t){e.setValue(Je.a.reject(Je.a.propEq("stockItem",t),e.value))}})})};function aa(){var e=Object(l.a)(["\n  margin: 0 1.25rem 0 0;\n"]);return aa=function(){return e},e}var ra=Object(u.c)("div")(aa()),ia=function(e){var t=e.recipeId,n=e.recipeType;return r.a.createElement(Gn,{recipeId:t,recipeType:n},r.a.createElement(ra,null,r.a.createElement(v.a,{width:16,pageTitle:_e(n),hideLogoutWidget:!0,useBackButton:!0},r.a.createElement(d.a,null,r.a.createElement(zn,{recipeType:n})),r.a.createElement(d.a,null,r.a.createElement(At,{recipeType:n,recipeId:t})),r.a.createElement(d.a,null,r.a.createElement(k.a,null,r.a.createElement(fe.Trans,{id:"Recipe ingredients"})),r.a.createElement(f.a,null),r.a.createElement(na,null)),r.a.createElement(Ce,{type:n,isMain:!0},r.a.createElement(d.a,null,r.a.createElement(k.a,null,r.a.createElement(fe.Trans,{id:"Sidedish categories"})),r.a.createElement(q,null,r.a.createElement(fe.Trans,{id:"These sidedish are presented with recipe"})),r.a.createElement(Fn,{categoryType:p.t.SideDish,field:"sideDishes",addButtonText:b.b._("Attach sidedish category"),noRowsText:b.b._("Recipe has no sidedish category attached")})),r.a.createElement(d.a,null,r.a.createElement(k.a,null,r.a.createElement(fe.Trans,{id:"Category assignments"})),r.a.createElement(q,null,r.a.createElement(fe.Trans,{id:"Recipe is in these categories"})),r.a.createElement(Fn,{categoryType:p.t.Main,field:"categories",addButtonText:b.b._("Add to category"),noRowsText:b.b._("Recipe is not in any category")})))),r.a.createElement(ke,null,r.a.createElement(V.a,{mutationName:null===t?"createRecipe":"updateRecipe"},r.a.createElement(Ne,{isCreate:null===t})))))},ca=n(121),oa=n.n(ca),la=n(238),ua=function(e){var t=e.wareUnit,n=e.quantity,a=e.onConfirm;return r.a.createElement(L.a,{disabled:null===t,onClick:a},t?r.a.createElement(fe.Trans,{id:"Add {0} {1}",values:{0:oa()(n).format(la.h),1:t.code}}):r.a.createElement(fe.Trans,{id:"No stock card selected"}))},da=r.a.forwardRef(function(e,t){var n=e.value,a=e.onFilter,i=e.onConfirm;return r.a.createElement(tt.a,{label:b.b._("Stock card"),labelWidth:7},r.a.createElement(cn.a,{ref:t,autoFocus:!0,placeholder:"".concat(b.b._("Code").toLocaleLowerCase()," / ").concat(b.b._("PLU")," / ").concat(b.b._("Title").toLocaleLowerCase()),value:n,onChange:function(e){a(e.target.value)},onKeyPressCapture:function(e){"Enter"===e.key&&(e.preventDefault(),i())}}))}),sa=r.a.forwardRef(function(e,t){var n=e.enabled,a=e.onChange,i=e.onConfirm;return r.a.createElement(cn.a,{ref:t,disabled:!n,onChange:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=oa()(e.target.value).value();a(t)}),onKeyPressCapture:function(e){"Enter"===e.key&&(e.preventDefault(),i())}})});function ma(){var e=Object(l.a)(["\n  background-color: ",";\n"]);return ma=function(){return e},e}var fa=function(e){var t=e.stockItems,n=e.searchValue,a=e.onSelect;return r.a.createElement(wn,null,r.a.createElement(H,{items:t,heightStretch:!1},r.a.createElement(R.d,{dataKey:"id",width:F.d.ButtonColumnWidthPx,minWidth:F.d.ButtonColumnWidthPx,cellRenderer:pa,columnData:{onSelect:a}}),r.a.createElement(R.d,{dataKey:"quantity",width:100,label:b.b._("Card stock"),cellRenderer:ha}),r.a.createElement(R.d,{dataKey:"code",width:100,label:b.b._("Card code"),cellRenderer:va(n)}),r.a.createElement(R.d,{dataKey:"nameLabel",width:300,label:b.b._("Card name"),cellRenderer:va(n)}),r.a.createElement(R.d,{dataKey:"note",width:300,label:b.b._("Card note")})))};function pa(e){var t=e.rowData,n=e.columnData.onSelect;return r.a.createElement(_.a,null,r.a.createElement(L.a,{iconName:"done",onClick:function(){return n(t)}}))}var ba=u.c.span(ma(),F.a.yellow);function va(e){return function(t){var n=t.cellData,a=n.toLocaleLowerCase().indexOf(e.toLocaleLowerCase());if(-1===a)return n;var i=n.substring(0,a),c=n.substring(a,a+e.length),o=n.substring(a+e.length);return r.a.createElement(r.a.Fragment,null,i,r.a.createElement(ba,null,c),o)}}function ha(e){var t=e.cellData,n=e.rowData;return"".concat(t," ").concat(n.wareUnit.code)}var ga=function(e){function t(){var e,n;Object(X.a)(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(n=Object(te.a)(this,(e=Object(ne.a)(t)).call.apply(e,[this].concat(i)))).state={targetStockItem:null,filteredStockItems:[],searchValue:"",inputQuantity:0},n.filterInputRef=r.a.createRef(),n.quantityInputRef=r.a.createRef(),n.onFilter=function(e){if(""!==e.trim()){var t=Object(Tn.a)(e),a=n.props.stockItems.filter(Je.a.cond([[Je.a.propEq("plu",e),Je.a.T],[Je.a.propSatisfies(t,"code"),Je.a.T],[Je.a.propSatisfies(t,"nameLabel"),Je.a.T]])),r=null;1===a.length&&(r=Je.a.head(a)),n.setState({filteredStockItems:a,searchValue:e,targetStockItem:r})}else n.setState({filteredStockItems:[],searchValue:"",targetStockItem:null})},n.onConfirmFilter=function(){1===n.state.filteredStockItems.length&&n.quantityInputRef.current.focus()},n.onQuantity=function(e){n.setState({inputQuantity:e})},n.onSelectStockItem=function(e){n.setState({targetStockItem:e,filteredStockItems:[e]},function(){n.quantityInputRef.current.focus()})},n.onConfirm=function(){var e=n.state,t=e.targetStockItem,a=e.inputQuantity;t&&0!==a&&n.props.onDeposit(t,a),n.setState({targetStockItem:null,searchValue:"",inputQuantity:0},function(){n.quantityInputRef.current.value="",n.filterInputRef.current.focus()})},n}return Object(ae.a)(t,e),Object(ee.a)(t,[{key:"componentDidUpdate",value:function(e){e.stockItems!==this.props.stockItems&&this.onFilter(this.state.searchValue)}},{key:"render",value:function(){var e=this.state,t=e.searchValue,n=e.filteredStockItems,a=e.targetStockItem,i=e.inputQuantity,c=""!==t.trim(),o=0===n.length,l=n.length>1;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Pe,null,r.a.createElement(Ve,null,r.a.createElement(da,{onFilter:this.onFilter,onConfirm:this.onConfirmFilter,value:t,ref:this.filterInputRef})),r.a.createElement(Ve,null,r.a.createElement(sa,{enabled:null!==a,onChange:this.onQuantity,onConfirm:this.onConfirm,ref:this.quantityInputRef})),r.a.createElement(Ve,null,r.a.createElement(ua,{cardName:a?a.nameLabel:"",quantity:i,wareUnit:a?a.wareUnit:null,onConfirm:this.onConfirm}))),r.a.createElement(k.a,null,c&&l&&r.a.createElement(fe.Trans,{id:"Continue typing to find single stock card or select one from the list"}),c&&o&&r.a.createElement(fe.Trans,{id:"No stock card found from entered search value"}),c&&a&&r.a.createElement(fe.Trans,{id:"Stock card <0>{0}</0> is selected",values:{0:a.nameLabel},components:[r.a.createElement("b",null)]})),c&&r.a.createElement(fa,{searchValue:t,stockItems:n,onSelect:this.onSelectStockItem}))}}]),t}(r.a.Component),Ea=Object(j.observer)(function(e){var t=e.children,n=Object(C.b)().settings,a=Object(p.cb)({branchId:n.branchId}),r=a.data,i=a.loading,c=Object(p.I)(),o=Object(O.a)(c,1)[0];return t(i?[]:r.stockItems,function(e,t){o({stockItem:e.id,quantityChange:t})})}),ya=function(e){return r.a.createElement(v.a,{width:16,pageTitle:b.b._("Stock deposit"),useBackButton:!0},r.a.createElement(d.a,null,r.a.createElement(g.a,null),r.a.createElement(Ea,null,function(e,t){return r.a.createElement(ga,{stockItems:e,onDeposit:t})})))},wa=n(329),Oa=function(e){var t=e.stockItems,n=e.isLoading;return r.a.createElement(H,{items:t,heightStretch:!0,noRowsRenderer:function(){return n?r.a.createElement(wa.a,null):r.a.createElement("h3",null,r.a.createElement(fe.Trans,{id:"Selected branch has no stock cards"}))}},r.a.createElement(R.d,{dataKey:"id",width:F.d.ButtonColumnWidthPx,minWidth:F.d.ButtonColumnWidthPx,cellRenderer:U({canQuery:"stockItem"},Q)}),r.a.createElement(R.d,{dataKey:"code",width:100,label:b.b._("Card code")}),r.a.createElement(R.d,{dataKey:"nameLabel",width:300,minWidth:30,flexGrow:2,label:b.b._("Card name")}),r.a.createElement(R.d,{dataKey:"quantity",width:100,label:b.b._("Card stock"),cellRenderer:ja}),r.a.createElement(R.d,{dataKey:"allowNegative",width:300,label:b.b._("Negative stock"),cellRenderer:ka}),r.a.createElement(R.d,{dataKey:"note",width:300,label:b.b._("Card note")}))};function ja(e){var t=e.cellData,n=e.rowData;return"".concat(t," ").concat(n.wareUnit.code)}function ka(e){return!0===e.cellData?r.a.createElement(fe.Trans,{id:"Permitted"}):r.a.createElement(fe.Trans,{id:"Forbidden"})}var Ca=Object(j.observer)(function(){var e=Object(C.b)().settings,t=Object(p.db)({branchId:e.branchId}),n=t.data,a=t.loading,i=Object(j.useComputed)(function(){if(!n||!n.stockItems||0===n.stockItems.length)return[];var t=e.menu.stock.filterInput,a=Object(Tn.a)(t);return n.stockItems.filter(Je.a.cond([[Je.a.propEq("plu",t),Je.a.T],[Je.a.propSatisfies(a,"code"),Je.a.T],[Je.a.propSatisfies(a,"nameLabel"),Je.a.T]]))},[n&&n.stockItems]);return r.a.createElement(Oa,{stockItems:i,isLoading:a})}),Ia=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{pageTitle:b.b._("Stock overview"),useBackButton:!0}),r.a.createElement(h.a,null,r.a.createElement(d.a,{stretchToParent:!0},r.a.createElement(m.a,{justify:"start"},r.a.createElement(s.a,null,r.a.createElement(g.a,{width:20})),r.a.createElement(s.a,null,r.a.createElement(kn,{modelType:"stock"}))),r.a.createElement(V.a,{mutationName:"createStockItem"},r.a.createElement(se,{routeTo:"create"})),r.a.createElement(wn,null,r.a.createElement(Ca,null)))))};function xa(){var e=Object(l.a)(["\n  query GMenuStockDefaults($branchId: ID!) {\n    companyBranch(id: $branchId) {\n      id\n      allowNegative: stockItemsCanBeNegative\n    }\n  }\n"]);return xa=function(){return e},e}function Ta(){var e=Object(l.a)(["\n  query GMenuStockForm($stockId: ID!) {\n    stockItem(id: $stockId) {\n      id\n      code\n      plu\n      note\n      nameLabel: label\n      allowNegative\n      wareUnit {\n        ...FMenuWareUnit\n      }\n      allergens {\n        ...FMenuAllergen\n      }\n      companyBranch {\n        id\n        allowNegative: stockItemsCanBeNegative\n      }\n    }\n  }\n  ","\n  ","\n"]);return Ta=function(){return e},e}var Ra=kt()(Ta(),p.c,p.f),Sa=kt()(xa()),_a=(Object(Ct.a)(Ra),function(e){var t=e.stockId,n=e.children,a=ft();return r.a.createElement(mt,{isCreate:null===t,onCreate:function(e){return a.stock.createItem(e)},onUpdate:function(e){return a.stock.updateItem(e)},getDefaultValues:La,loadDefaults:Object(w.a)(y.a.mark(function e(){var t,n;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.client.query({query:Sa,variables:{branchId:a.stock.branchId},fetchPolicy:"no-cache"});case 2:return t=e.sent,n=t.data,e.abrupt("return",{allowNegativeDefault:Da(n.companyBranch.allowNegative)});case 5:case"end":return e.stop()}},e,this)})),loadValues:Object(w.a)(y.a.mark(function e(){var n,r;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.client.query({query:Ra,variables:{stockId:t},fetchPolicy:"no-cache"});case 2:return n=e.sent,r=n.data,e.abrupt("return",{id:(i=r.stockItem).id,internalNote:"TBD",nameLabel:i.nameLabel,code:i.code,note:i.note,plu:i.plu||"",wareUnit:i.wareUnit.enum,allergens:i.allergens.map(Je.a.prop("enum")),allowNegative:i.allowNegative,allowNegativeDefault:Da(i.companyBranch.allowNegative)});case 5:case"end":return e.stop()}var i},e,this)}))},n)});function La(){return{id:"NEW",internalNote:"",nameLabel:"",code:"",plu:"",note:"",wareUnit:null,allergens:[],allowNegative:p.i.Default,allowNegativeDefault:p.i.Default}}function Da(e){return e?p.i.Default:p.i.Disabled}var Na=function(e){var t=e.field,n=void 0===t?"allergens":t,a=e.icon,i=void 0===a?"error_outline":a;return r.a.createElement(ye.Field,{field:n},function(e){return r.a.createElement(tt.a,{icon:i,labelWidth:7},r.a.createElement(Un,{selected:e.value,onToggle:function(t){var n=e.value;n.includes(t)?e.setValue(Je.a.without([t],n)):e.setValue(Object(Y.a)(n).concat([t]))}}))})};var Wa=[{type:p.i.Enabled,label:Object(xe.i18nMark)("Permit")},{type:p.i.Disabled,label:Object(xe.i18nMark)("Forbid")}],Fa=function(e){!function(e){if(null==e)throw new TypeError("Cannot destructure undefined")}(e);var t=Object(a.useMemo)(function(){return" (".concat(b.b._("Is default setting").toLocaleLowerCase(),")")},[]);return r.a.createElement(ye.FormApi,null,function(e){var n=e.values.allowNegativeDefault;return r.a.createElement(tt.a,{label:b.b._("Negative stock"),labelWidth:7},r.a.createElement(Ot.a,{field:"allowNegative",items:Wa,formatItem:function(e){return e.type===n?r.a.createElement("span",null,b.b._(e.label),r.a.createElement("i",null,t)):b.b._(e.label)},getItemId:function(e){return e.type}}))})},Ba=function(e){var t=e.field,n=void 0===t?"plu":t,a=e.icon,i=void 0===a?"fingerprint":a,c=Object(T.a)(e,["field","icon"]);return r.a.createElement(tt.a,{icon:i,labelWidth:7},r.a.createElement(Ae.a,{width:9},r.a.createElement(et.a,Object.assign({field:n,inputFullWidth:!0},c))))},Pa=n(7764);function Va(){var e=Object(l.a)(["\n  query GWareUnits {\n    wareUnits {\n      id\n      code\n      enum\n    }\n  }\n"]);return Va=function(){return e},e}var Ma=kt()(Va()),Aa=Object(Ct.a)(Ma),qa=function(e){var t=e.field,n=void 0===t?"wareUnit":t,a=e.icon,i=void 0===a?"select_all":a,c=Object(T.a)(e,["field","icon"]);return r.a.createElement(Aa,{renderLoading:!1,render:function(e,t){var a=e.wareUnits,o=t.loading;return r.a.createElement(tt.a,{icon:i,labelWidth:7},r.a.createElement(Pa.a,Object.assign({field:n,options:a||[],isLoading:o,isRequired:!0,validatioName:b.b._("Ware unit"),getOptionLabel:Je.a.prop("code"),getOptionValue:Je.a.prop("enum"),width:12},c)))}})},Ka=function(e){return r.a.createElement(Pe,null,r.a.createElement(Ve,null,r.a.createElement(at,{placeholder:b.b._("Card name")}),r.a.createElement(Bn,{placeholder:b.b._("Card code")}),r.a.createElement(qa,{placeholder:b.b._("Choose unit")}),r.a.createElement(Ba,{placeholder:b.b._("PLU")}),r.a.createElement(nt,{placeholder:b.b._("Card note"),field:"note",label:b.b._("Card note")}),r.a.createElement(Na,null),r.a.createElement(Fa,null)),r.a.createElement(We.a,{position:"BottomRight"},r.a.createElement(V.a,{mutationName:"destroyStockItem"},r.a.createElement(Ke,{render:function(e){var t=e.menu;return r.a.createElement(Xe,{confirmText:b.b._("Remove this card?"),onDelete:function(e){return t.stock.deleteItem(e)}})}}))))},Ha=function(e){var t=e.stockId,n=Object(p.sb)({stockId:t}),a=n.data;if(n.loading)return r.a.createElement(P.a,null);var i=a.stockItem.ingredients;return 0===i.length?r.a.createElement(k.a,null,r.a.createElement(fe.Trans,{id:"No recipes are using stock card"})):r.a.createElement(r.a.Fragment,null,r.a.createElement(k.a,null,r.a.createElement(fe.Trans,{id:"Recipes using this card"})),r.a.createElement(H,{items:Object(Y.a)(i),disableHeader:!0,fullHeight:!0},r.a.createElement(R.d,{dataKey:"",cellDataGetter:function(e){var t=e.rowData;return{pathname:"/settings/menu/recipe/".concat(t.recipe.id),state:{recipeType:t.recipe.recipeType.enum}}},cellRenderer:Q,width:100}),r.a.createElement(R.d,{dataKey:"recipe",width:300,label:b.b._("Name"),cellRenderer:function(e){var t=e.rowData;return r.a.createElement(r.a.Fragment,null,t.recipe.nameLabel,r.a.createElement(q,null,t.recipe.descriptionLabel))}})))},Ua=function(e){var t=e.stockId;return r.a.createElement(v.a,{width:16,pageTitle:b.b._("Stock card"),hideLogoutWidget:!0,useBackButton:!0},r.a.createElement(_a,{stockId:t},r.a.createElement(r.a.Fragment,null,r.a.createElement(ke,null,r.a.createElement(V.a,{mutationName:null===t?"createStockItem":"updateStockItem"},r.a.createElement(Ne,{isCreate:null===t}))),r.a.createElement(d.a,null,r.a.createElement(Ka,null),t&&r.a.createElement(M.a,{queryName:"recipes"},r.a.createElement(Ha,{stockId:t}))))))};n.d(t,"MenuRoutes",function(){return Qa});var Qa=function(e){var t=e.match;return r.a.createElement(i.Switch,null,r.a.createElement(o.a,{exact:!0,path:t.path,render:function(){return r.a.createElement(i.Redirect,{to:"".concat(t.path,"/category")})}}),r.a.createElement(o.a,{exact:!0,path:"".concat(t.path,"/category"),component:Ee}),r.a.createElement(o.a,{path:"".concat(t.path,"/category/:categoryId"),render:function(e){var t=e.match.params,n=e.location.state;return r.a.createElement(En,{categoryId:"create"===t.categoryId?null:t.categoryId,categoryType:n.categoryType})}}),r.a.createElement(o.a,{exact:!0,path:"".concat(t.path,"/recipe"),component:Nn}),r.a.createElement(o.a,{path:"".concat(t.path,"/recipe/:recipeId"),render:function(e){var t=e.match.params,n=e.location.state;return r.a.createElement(ia,{recipeId:"create"===t.recipeId?null:t.recipeId,recipeType:n.recipeType})}}),r.a.createElement(o.a,{exact:!0,path:"".concat(t.path,"/stock"),component:Ia}),r.a.createElement(o.a,{path:"".concat(t.path,"/stock/deposit"),component:ya}),r.a.createElement(o.a,{path:"".concat(t.path,"/stock/:stockId"),render:function(e){var t=e.match.params;return r.a.createElement(Ua,{stockId:"create"===t.stockId?null:t.stockId})}}),r.a.createElement(i.Route,{component:c.a}))};t.default=Qa}}]);
//# sourceMappingURL=180.72c1a202.chunk.js.map