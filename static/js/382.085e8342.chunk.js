(this.webpackJsonpspeedlo=this.webpackJsonpspeedlo||[]).push([[382],{1368:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(60),r=n(0),c=n.n(r),i=n(1360),u=n(1370),l=Object(a.b)((function(e){var t=e.mutationName,n=e.children;return Object(i.b)(t)?c.a.createElement(c.a.Fragment,null,n):c.a.createElement(u.a,null,"No access to mutation ".concat(t))}))},1375:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(4);function r(){var e=Object(a.a)(["\n  flex: ",";\n  padding: ",";\n  margin: ",";\n"]);return r=function(){return e},e}var c=n(18).c.div(r(),(function(e){var t=e.fixedWidth,n=void 0!==t&&t,a=e.width,r=e.widthGrowIndex,c=void 0===r?0:r;return n?a?"0 0 ".concat(a):"0 0":"".concat(c," 0")}),(function(e){var t=e.padding;return void 0===t?"0.25rem":t}),(function(e){var t=e.margin;return void 0===t?"":t}))},1386:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return f}));var a=n(132),r=n(46),c=n(64),i=n(1357),u=n(60),l=n(0),o=n.n(l),s=n(1363);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var m=o.a.forwardRef((function(e,t){var n=e.fieldName,a=e.fullWidth,r=e.validate,i=e.addHiddenLabelWithPlaceholderText,l=void 0===i||i,d=Object(c.a)(e,["fieldName","fullWidth","validate","addHiddenLabelWithPlaceholderText"]),m=f({fieldName:n,validate:r});return Object(u.g)((function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(s.b,Object.assign({},m(),{inputFullWidth:a,ref:t},d)),l&&d.placeholder&&o.a.createElement("label",{hidden:!0,htmlFor:m().id},d.placeholder))}))}));function f(e){var t=e.fieldName,n=e.validate,c=Object(i.i)(),u=Object(i.e)(t,{validate:n}),l=Object(r.a)(u,2),o=l[0],s=l[1];return function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(n,!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},s(),{disabled:c.isSubmitting,invalid:o.touched&&Boolean(o.error)})}}},1388:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(0),r=n.n(a),c=function(e){var t=e.text,n=void 0===t?"...":t;return r.a.createElement("h1",null,n)}},1415:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(64),r=n(1640),c=n(0),i=n.n(c),u=n(438),l=n(14),o=n(131),s=function(e){var t=e.onDelete,n=e.confirmText,c=Object(a.a)(e,["onDelete","confirmText"]);return i.a.createElement(u.a,null,i.a.createElement(o.a,Object.assign({className:"delete-button",icon:r.a,color:l.a.greyMiddle,onClick:function(e){e.preventDefault(),n&&!window.confirm(n)||t()}},c)))}},1418:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(60),r=n(0),c=n.n(r),i=n(1360),u=n(1370),l=Object(a.b)((function(e){var t=e.queryName,n=e.children;return Object(i.c)(t)?c.a.createElement(c.a.Fragment,null,n):c.a.createElement(u.a,null,"No access to query ".concat(t))}))},1430:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(64),r=n(2775),c=n(1362),i=n(1357),u=n(60),l=n(0),o=n.n(l),s=n(131),d=n(14),m=function(e){var t=e.children,n=e.id,l=void 0===n?"form-submit":n,m=Object(a.a)(e,["children","id"]),f=Object(i.i)();return Object(u.g)((function(){return o.a.createElement(s.a,Object.assign({id:l,type:"submit",color:d.a.green,disabled:f.isSubmitting,icon:f.isValid?void 0:r.a,iconSize:1.1,iconColor:d.a.red},m,{className:Object(c.b)(m.className,"animated","infinite",{heartBeat:f.isSubmitting})}),o.a.createElement(o.a.Fragment,null,t))}))}},1443:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(1515),r=n(1378),c=n(0),i=n.n(c),u=n(125),l=function(e){var t=e.children;return i.a.createElement(r.a,{utils:a.a,locale:u.b},t)}},1497:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a=n(18).c.div.withConfig({displayName:"FlexDiv",componentId:"dwel3j-0"})(["display:flex;"])},1567:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(4),r=n(18),c=n(14),i=n(1497);function u(){var e=Object(a.a)(["\n  flex-direction: row;\n  justify-content: space-between;\n  border-bottom: 1px solid ",";\n  padding: 0.1rem 0 0.1rem 0;\n"]);return u=function(){return e},e}var l=Object(r.c)(i.a)(u(),c.a.greyMiddle)},1571:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(40);function r(){return Object(a.b)().settings}},1579:function(e,t,n){"use strict";var a=n(64),r=n(1357),c=n(60),i=n(0),u=n.n(i),l=n(380),o=n(2793),s=n(1443),d=function(e){return u.a.createElement(s.a,null,u.a.createElement(o.a,Object.assign({variant:"inline",format:"PPP",maxDateMessage:l.i18n._("Date is too much in the future"),minDateMessage:l.i18n._("Date is too much in the past")},e)))};n.d(t,"a",(function(){return m}));var m=u.a.memo((function(e){var t=e.fieldName,n=Object(a.a)(e,["fieldName"]),i=Object(r.d)(t),l=Object(r.i)();return Object(c.g)((function(){return u.a.createElement(d,Object.assign({value:i.value,onChange:i.setValue,onOpen:i.setTouched,disabled:l.isSubmitting},n))}))}))},2808:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(58),i=n(259),u=n(124),l=n(442),o=n(79),s=n(1368),d=n(1418),m=n(255),f=n(1372),b=n(441),p=n(36),h=n(257),v=n(1431),E=n(70),O=n.n(E),j=n(161),g=n(113),w=n(46),y=n(15),D=n(60),A=n(1388),k=n(40),x=n(159),N=n(78),T=n(1359),I=n(178),S=n(256),H=n(131),C=n(14),W=n(125),M=n(20),P=n(4),F=n(1640),B=n(1554),_=n(18),R=n(438),L=n(2795),q=n(1443),V=function(e){return r.a.createElement(q.a,null,r.a.createElement(L.a,Object.assign({format:"p",variant:"inline",ampm:!1},e)))};function z(){var e=Object(P.a)(["\n  & input {\n    width: 5rem;\n  }\n"]);return z=function(){return e},e}var G=_.c.div(z()),J=r.a.memo((function(e){var t=e.hour;return Object(D.g)((function(){return r.a.createElement(G,null,r.a.createElement(V,{value:t.openAt,onChange:function(e){return t.openAt=e},label:r.a.createElement(o.Trans,{id:"input.timespan.from"}),fullWidth:!1}),r.a.createElement(V,{value:t.closeAt,onChange:function(e){return t.closeAt=e},label:r.a.createElement(o.Trans,{id:"input.timespan.to"}),fullWidth:!1}))}))}));function Q(){var e=Object(P.a)(["\n  display: flex;\n  align-items: baseline;\n  margin: 0 0 0.3rem 0;\n  h5 {\n    width: 5rem;\n  }\n  & .range {\n    display: flex;\n    margin: 0 2rem 0 0;\n    padding-right: 1rem;\n    background: ",";\n    border-radius: ",";\n  }\n  .remove-btn {\n    margin-right: 1rem;\n  }\n"]);return Q=function(){return e},e}var U=_.c.article(Q(),C.a.white,C.c.Button),Y=function(e){var t=e.weekday,n=e.hours,a=e.onAdd,c=e.onRemove,i=function(e){return r.a.createElement("div",{key:e.id,"data-testid":"bh-range",className:"range"},r.a.createElement(R.a,{className:"remove-btn"},r.a.createElement(H.a,{title:p.b._("Remove business hour"),role:"button",onClick:function(){return c(e.id)}},r.a.createElement(F.a,null))),r.a.createElement(J,{hour:e}))};return Object(D.g)((function(){return r.a.createElement(U,null,r.a.createElement("h5",null,t.code),0===n.length?r.a.createElement("em",null,r.a.createElement(o.Trans,{id:"Closed"})):n.map(i),r.a.createElement(R.a,null,r.a.createElement(H.a,{title:p.b._("Add business hour"),role:"button",onClick:a},r.a.createElement(B.a,null))))}))},K=W.c.parse(new Date,"H:mm"),X=Object(D.b)((function(){var e=Object(k.b)().settings,t=Object(N.jc)({branchId:e.branchId}),n=t.data,a=t.loading,c=r.a.useState((function(){return Object(y.observable)(new Map)})),i=Object(w.a)(c,1)[0],u=Object(N.A)(),l=Object(w.a)(u,1)[0];r.a.useEffect((function(){if(void 0!==n)return 0===i.size&&n.weekDays.forEach((function(e){i.set(e.enum,y.observable.array([]))})),n.businessHours.forEach((function(e){var t=e.id,n=e.openAt,a=e.closeAt,r=e.weekDay;r&&i.get(r.enum).push({id:t,openAt:K(n),closeAt:K(a),weekDay:r.enum})})),function(){i.forEach((function(e){e.clear()}))}}),[i,n,e.branchId]);var o=r.a.useRef(0),s=function(e){return function(t){var n=i.get(e),a=n.findIndex(M.a.propEq("id",t));a>=0&&n.splice(a,1)}},d=Object(S.a)().enqueueSuccess,m=r.a.useCallback(Object(g.a)(O.a.mark((function t(){var n;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],i.forEach((function(e,t){n.push.apply(n,Object(j.a)(e.map((function(e){return{openAt:Object(I.h)(e.openAt),closeAt:Object(I.h)(e.closeAt),weekDay:t}}))))})),t.next=4,l({branchId:e.branchId,hours:n});case 4:t.sent&&d(p.b._("Regular business hours has been updated"));case 6:case"end":return t.stop()}}),t)}))),[i,d,e.branchId,l]);return a?r.a.createElement(A.a,null):r.a.createElement("div",null,n&&n.weekDays.map((function(e){return r.a.createElement(Y,{key:e.enum,weekday:e,hours:i.get(e.enum)||T.a,onAdd:(t=e.enum,function(){i.get(t).push({weekDay:t,id:"L".concat(o.current++),openAt:W.c.startOfDay(new Date),closeAt:W.c.endOfDay(new Date)})}),onRemove:s(e.enum)});var t})),r.a.createElement(x.a,{width:20},r.a.createElement(b.a,{margin:"1rem"},r.a.createElement(H.a,{text:p.b._("Save regular hours"),color:C.a.green,onClick:m}))))})),Z=n(47),$=n(1357),ee=n(89),te=n(142),ne=n(269),ae=n(270),re=n(1386),ce=n(1579),ie=n(64),ue=r.a.memo((function(e){var t=e.fieldName,n=Object(ie.a)(e,["fieldName"]),a=Object($.d)(t),c=Object($.i)();return Object(D.g)((function(){return r.a.createElement(V,Object.assign({value:a.value,onChange:a.setValue,onOpen:a.setTouched,disabled:c.isSubmitting},n))}))}));function le(){var e=Object(P.a)(["\n  width: 5rem;\n  display: inline-block;\n"]);return le=function(){return e},e}var oe,se=_.c.div(le()),de=function(e){var t=e.fieldFrom,n=e.fieldTo;return r.a.createElement(r.a.Fragment,null,r.a.createElement(se,null,r.a.createElement(ue,{fieldName:t,label:r.a.createElement(o.Trans,{id:"input.timespan.from"}),fullWidth:!1})),r.a.createElement(se,null,r.a.createElement(ue,{fieldName:n,label:r.a.createElement(o.Trans,{id:"input.timespan.to"}),fullWidth:!1})))},me=n(1430),fe=n(132),be=n(380),pe=n(1391),he=n(1571),ve=n(430),Ee=(oe={},Object(fe.a)(oe,ve.a.TIMESPAN,Object(be.i18nMark)("Open between")),Object(fe.a)(oe,ve.a.FULLDAY,Object(be.i18nMark)("Closed")),oe),Oe=r.a.memo((function(){var e=Object(he.a)().businessHours;return Object(D.g)((function(){return r.a.createElement(pe.a,{items:[ve.a.TIMESPAN,ve.a.FULLDAY],selectedItem:e.specificMode,formatItem:function(e){return p.b._(Ee[e])},onSingleSelection:function(t){return e.changeSpecificMode(t)}})}))}));function je(){var e=Object(P.a)(["\n  display: inline-block;\n  width: 16rem;\n  min-height: 6rem;\n  margin: 0rem 0 0 1rem;\n  vertical-align: top;\n"]);return je=function(){return e},e}function ge(){var e=Object(P.a)(["\n  display: inline-block;\n  width: 13rem;\n  margin-left: 1rem;\n  margin-top: 2rem;\n"]);return ge=function(){return e},e}var we=_.c.div(ge()),ye=_.c.div(je()),De=function(){var e,t=Object(Z.h)(),n=Object(k.b)().settings,a=Object(N.lb)(),c=Object(w.a)(a,1)[0],i=r.a.useCallback((function(e){var t=n.businessHours.isTimespanMode&&e.openAt?e.openAt:Object(ee.a)(e.date),a=n.businessHours.isTimespanMode&&e.closeAt?e.closeAt:Object(te.a)(e.date);c({input:{companyBranch:n.branchId,specificDate:e.date,closed:!n.businessHours.isTimespanMode,closedNote:e.note,openAt:Object(I.h)(t),closeAt:Object(I.h)(a)}},{refetchQueries:[{query:N.l,variables:{branchId:n.branchId}}]})}),[c,n]);return r.a.createElement($.a,{onSubmit:i,initialValues:(e=t(),{date:e,openAt:Object(ne.a)(Object(ae.a)(e,0),9),closeAt:Object(ne.a)(Object(ae.a)(e,0),20),note:""})},r.a.createElement(we,null,r.a.createElement(ce.a,{fieldName:"date",format:I.j,minDate:new Date,fullWidth:!0,label:r.a.createElement(o.Trans,{id:"Date"})})),r.a.createElement(ye,null,r.a.createElement(Oe,null),r.a.createElement(D.a,null,(function(){return n.businessHours.isTimespanMode?r.a.createElement(de,{fieldFrom:"openAt",fieldTo:"closeAt"}):r.a.createElement(x.a,{width:13},r.a.createElement(re.a,{fieldName:"note",fullWidth:!0,placeholder:p.b._("Closing reason")}))}))),r.a.createElement(me.a,{width:"9rem"},r.a.createElement(o.Trans,{id:"Add"})))};var Ae=n(267),ke=n(2779),xe=n(1360),Ne=n(1375),Te=n(1567),Ie=n(1415),Se=function(e){var t=e.bsHour,n=e.canDelete,a=e.onDelete;return r.a.createElement(Te.a,null,r.a.createElement(Ne.a,{fixedWidth:!0},n&&r.a.createElement(Ie.a,{onDelete:a,confirmText:"".concat(p.b._("Really remove specific business hour {0}?",{0:Object(I.c)(t.specificDate)}))})),r.a.createElement(Ne.a,{fixedWidth:!0,width:"14rem"},Object(I.c)(t.specificDate)),r.a.createElement(Ne.a,{fixedWidth:!0,width:"10rem"},"".concat(t.openAt," - ").concat(t.closeAt)),r.a.createElement(Ne.a,{fixedWidth:!0,width:"10rem"},t.closed?r.a.createElement(o.Trans,{id:"Closed"}):r.a.createElement(o.Trans,{id:"Open"})),r.a.createElement(Ne.a,{widthGrowIndex:1},t.closedNote))},He=M.a.sort(M.a.ascend(M.a.or(M.a.prop("specificDate"),M.a.not))),Ce=function(e){var t=e.specificDate;return null===t||Object(Ae.a)(t,Object(ee.a)(new Date))},We=Object(D.b)((function(){var e=Object(k.b)().settings,t=Object(N.kc)({branchId:e.branchId}),n=t.getStash,a=t.updateQuery,c=Object(xe.b)("destroyBusinessHour"),i=Object(N.mb)(),u=Object(w.a)(i,1)[0],l=n((function(e){return He(M.a.reject(Ce,e.businessHours))}));return null===l?null:0===l.length?r.a.createElement(b.a,{margin:1},r.a.createElement(o.Trans,{id:"No specific business hours defined"})):r.a.createElement(r.a.Fragment,null,l.map((function(e){return r.a.createElement(Se,{key:e.id,bsHour:e,canDelete:c,onDelete:Object(g.a)(O.a.mark((function t(){return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u({id:e.id});case 2:a(Me(e.id));case 3:case"end":return t.stop()}}),t)})))})})))}));function Me(e){return Object(ke.a)((function(t){t.businessHours.splice(t.businessHours.findIndex(Object(M.c)(e)),1)}))}var Pe=function(){return r.a.createElement(h.a,{pageTitle:p.b._("Business hours"),useBackButton:!0},r.a.createElement(m.a,null,r.a.createElement(v.a,null),r.a.createElement(d.a,{queryName:"businessHours"},r.a.createElement(f.a,null,r.a.createElement(b.a,{margin:"1rem 0"},r.a.createElement(o.Trans,{id:"Regular business hours"}))),r.a.createElement(X,null)),r.a.createElement(f.a,null,r.a.createElement(b.a,{margin:"1rem 0"},r.a.createElement(o.Trans,{id:"Specific business hours"}))),r.a.createElement(We,null),r.a.createElement(s.a,{mutationName:"addSpecialBusinessHour"},r.a.createElement(f.a,null,r.a.createElement(b.a,{margin:"1rem 0"},r.a.createElement(o.Trans,{id:"Add specific business hour"}))),r.a.createElement(De,null))))};n.d(t,"BusinessHoursRouting",(function(){return Fe}));var Fe=function(){return r.a.createElement(c.e,null,r.a.createElement(u.a,{exact:!0,path:l.b,component:Pe}),r.a.createElement(c.c,{component:i.a}))};t.default=Fe}}]);
//# sourceMappingURL=382.085e8342.chunk.js.map