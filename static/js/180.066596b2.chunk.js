(window.webpackJsonp=window.webpackJsonp||[]).push([[180],{6836:function(e,t,n){"use strict";n.d(t,"a",function(){return b});var a=n(5),r=n(27),i=n(0),c=n.n(i),l=n(52),o=n(6846),u=n(135),d=n(20);function s(){var e=Object(a.a)(["\n    margin: 0;\n    grid-row: "," ;\n    grid-column: span 16;\n    height: "," ;\n    position: relative;\n  "]);return s=function(){return e},e}function m(){var e=Object(a.a)(["\n  position: fixed;\n  bottom: 0.5rem;\n  width: ",";\n  left: ",";\n  top: ",";"]);return m=function(){return e},e}var f=r.default.div.withConfig({displayName:"PageLayoutFullHeightItem__StyledPageLayoutFullHeightItem",componentId:"sc-1mean6j-0"})([""," ",""],Object(l.c)(m(),function(e){return void 0!==e.widthInColumns?"calc(("+e.widthInColumns+" * 6.22vw) - "+d.d.LayoutGridCellMargin+")":"calc(100vh - (2 * "+d.d.LayoutGridCellMargin+"))"},function(e){return void 0!==e.column?"calc(("+e.column+" * 6.22vw) + "+d.d.LayoutGridCellMargin+")":d.d.LayoutGridCellMargin},function(e){return void 0!==e.row?"calc(("+e.row+" * 3.9375rem) + "+d.d.LayoutGridCellMargin+")":"calc(3.9375rem + "+d.d.LayoutGridCellMargin+")"}),Object(l.d)(s(),function(e){return e.rowInMobile},function(e){var t=e.forcePercentHeightInMobile;return t?"calc(".concat(t,"vh - ").concat(d.d.PageHeaderHeight+.25+d.d.DefaultSizeUnit,")"):"unset"})),b=function(e){var t=e.children,n=e.row,a=void 0===n?1:n,r=e.rowInMobile,i=void 0===r?16:r,l=e.column,d=void 0===l?0:l,s=e.widthInColumns,m=void 0===s?16:s,b=e.withScrollArea,p=void 0!==b&&b,v=e.scrollAreaId,h=e.forcePercentHeightInMobile;return c.a.createElement(f,{column:d,row:a,rowInMobile:i,widthInColumns:m,withScrollArea:p,forcePercentHeightInMobile:h},p?c.a.createElement(o.a,{id:v},t):c.a.createElement(u.a,{height:100,heightUnit:"%"},t))}},6837:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n(5);function r(){var e=Object(a.a)(["\n  display: flex;\n  flex-direction: row;\n  flex-wrap: ",";\n  justify-content: ",";\n"]);return r=function(){return e},e}var i=n(27).default.div(r(),function(e){var t=e.flexWrap;return void 0===t?"unset":t},function(e){var t=e.justify;return void 0===t?"space-between":t})},6841:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n(5);function r(){var e=Object(a.a)(["\n  height: ",";\n"]);return r=function(){return e},e}var i=n(27).default.div(r(),function(e){var t=e.size,n=void 0===t?1:t,a=e.sizeUnit,r=void 0===a?"rem":a;return"".concat(n).concat(r)});i.displayName="VerticalGap"},6845:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n(5),r=n(27);function i(){var e=Object(a.a)(["\n  position: absolute;\n  ",";\n  ",";\n"]);return i=function(){return e},e}var c=Object(r.default)("div")(i(),function(e){var t=e.position,n=void 0===t?"BottomRight":t;return"BottomLeft"===n||"TopLeft"===n?"left: 0":"right: 0"},function(e){var t=e.position,n=void 0===t?"BottomRight":t;return"BottomRight"===n||"BottomLeft"===n?"bottom: 0":"top: 0"})},6846:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n(5);function r(){var e=Object(a.a)(["\n  overflow-y: auto;\n  -webkit-overflow-scrolling: touch;\n  height: 100%;\n"]);return r=function(){return e},e}var i=n(27).default.div(r())},6882:function(e,t,n){"use strict";function a(e){var t=e.toLocaleLowerCase();return function(e){return e.toLocaleLowerCase().includes(t)}}n.d(t,"a",function(){return a})},6903:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var a=n(119),r=n(0),i=n.n(r),c=n(6827),l=n(43),o=n(6842),u=function(e){var t=e.items,n=e.field,r=e.fieldIsPure,u=void 0!==r&&r,d=e.isClearable,s=void 0!==d&&d,m=e.isMulti,f=void 0!==m&&m,b=e.isRequired,p=void 0!==b&&b,v=e.validationName,h=void 0===v?l.b._("Value"):v,g=e.getItemId,E=void 0===g?a.idProp:g;return i.a.createElement(c.Field,{field:n,pure:u,validate:function(e){if(p){if(f&&(!Array.isArray(e)||0===e.length))return l.b._("{validationName} must have at least option selected",{validationName:h});if(!f&&(null===e||void 0===e))return l.b._("{validationName} must have a selection",{validationName:h})}return null}},function(n){return i.a.createElement(o.a,Object.assign({},function(e){var n=e.value;if(f)return{selectedItems:Array.isArray(n)?t.filter(function(e){return n.includes(E(e))}):[],onMultiSelection:function(t){e.setValue(t.map(E)),e.setTouched(!0)}};return{selectedItem:n&&t.find(function(e){return E(e)===n}),onSingleSelection:function(t){e.setValue(t?E(t):null),e.setTouched(!0)}}}(n),{isInvalid:Boolean(n.error),isClearable:s&&!p},e))})}},6904:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var a=n(5),r=n(0),i=n.n(r),c=n(27),l=n(20);function o(){var e=Object(a.a)(["\n  width: 40px;\n  height: 40px;\n  margin: 100px auto;\n  background-color: ",";\n\n  border-radius: 100%;\n  -webkit-animation: sk-scaleout 1s infinite ease-in-out;\n  animation: sk-scaleout 1s infinite ease-in-out;\n\n  @-webkit-keyframes sk-scaleout {\n    0% {\n      -webkit-transform: scale(0);\n    }\n    100% {\n      -webkit-transform: scale(1);\n      opacity: 0;\n    }\n  }\n\n  @keyframes sk-scaleout {\n    0% {\n      -webkit-transform: scale(0);\n      transform: scale(0);\n    }\n    100% {\n      -webkit-transform: scale(1);\n      transform: scale(1);\n      opacity: 0;\n    }\n  }\n"]);return o=function(){return e},e}var u=c.default.div(o(),l.a.orange),d=function(e){return i.a.createElement(u,null,i.a.createElement("div",{className:"bounce1"}),i.a.createElement("div",{className:"bounce2"}),i.a.createElement("div",{className:"bounce3"}))}},6910:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var a=n(63),r=n(54),i=n(0),c=n.n(i),l=n(79),o=n(82),u=n(6911),d=function(e){var t=e.to,n=e.from,a=Object(r.a)(e,["to","from"]);return c.a.createElement(l.Route,{children:function(e){var r=e.location;return c.a.createElement(o.b,Object.assign({to:s(t,n||"".concat(r.pathname,"/"))},a))}})};function s(e,t){if("string"===typeof e)return Object(u.a)(e,t);var n=Object(u.a)(e.pathname||"",t);return Object(a.a)({},e,{pathname:n})}},6911:function(e,t,n){"use strict";function a(e){return"/"===e.charAt(0)}function r(e,t){for(var n=t,a=n+1,r=e.length;a<r;n+=1,a+=1)e[n]=e[a];e.pop()}t.a=function(e,t){void 0===t&&(t="");var n,i=e&&e.split("/")||[],c=t&&t.split("/")||[],l=e&&a(e),o=t&&a(t),u=l||o;if(e&&a(e)?c=i:i.length&&(c.pop(),c=c.concat(i)),!c.length)return"/";if(c.length){var d=c[c.length-1];n="."===d||".."===d||""===d}else n=!1;for(var s=0,m=c.length;m>=0;m--){var f=c[m];"."===f?r(c,m):".."===f?(r(c,m),s++):s&&(r(c,m),s--)}if(!u)for(;s--;s)c.unshift("..");!u||""===c[0]||c[0]&&a(c[0])||c.unshift("");var b=c.join("/");return n&&"/"!==b.substr(-1)&&(b+="/"),b}},6912:function(e,t,n){"use strict";n.d(t,"a",function(){return v});var a=n(63),r=n(54),i=n(70),c=n(75),l=n(85),o=n(83),u=n(84),d=n(0),s=n.n(d),m=n(6827),f=n(32),b=n(43),p=n(6832),v=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(l.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(r)))).validate=function(e){return n.props.isRequired&&!e?b.b._("{0} must be selected",{0:n.props.validatioName}):null},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"getControlProps",value:function(e){var t=this.props,n=t.isMulti,a=t.options,r=t.getOptionValue,i=t.defaultValue,c=e.value||i;if(n){var l=Array.isArray(c)?function(e){return c.includes(r(e))}:f.a.F;return{value:Array.isArray(a)?a.filter(l):[],onChange:function(t){e.setValue(t.map(r))}}}return{value:c&&a.find(function(e){return r(e)===c}),onChange:function(t){e.setValue(r(t))}}}},{key:"render",value:function(){var e=this,t=this.props,n=t.field,i=t.fieldIsPure,c=void 0!==i&&i,l=(t.isRequired,t.defaultValue,Object(r.a)(t,["field","fieldIsPure","isRequired","defaultValue"]));return s.a.createElement(m.Field,{field:n,validate:this.validate,pure:c},function(t){return s.a.createElement(p.a,Object.assign({},e.getControlProps(t),{onFocus:function(){return t.setTouched(!0)},styles:{control:function(e){return Boolean(t.error)?Object(a.a)({},e,{borderColor:"red"}):e}}},l))})}}]),t}(s.a.Component);v.defaultProps={validatioName:"Value",getItemId:f.a.prop("id")}},6913:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var a=n(5),r=n(0),i=n.n(r),c=n(6873),l=n(27),o=n(177);function u(){var e=Object(a.a)(["\n  padding: 1rem 0.4rem;\n  cursor: grab;\n"]);return u=function(){return e},e}var d=l.default.div(u()),s=Object(c.SortableHandle)(function(){return i.a.createElement(d,null,i.a.createElement(o.a,{iconName:"reorder"}))})},6925:function(e,t,n){"use strict";function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}n.d(t,"a",function(){return a})},6995:function(e,t,n){},7984:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1);t.isApolloError=function(e){return e.hasOwnProperty("graphQLErrors")};var r=function(e){var t="";return Array.isArray(e.graphQLErrors)&&0!==e.graphQLErrors.length&&e.graphQLErrors.forEach(function(e){var n=e?e.message:"Error message not found.";t+="GraphQL error: "+n+"\n"}),e.networkError&&(t+="Network error: "+e.networkError.message+"\n"),t=t.replace(/\n$/,"")},i=function(e){function t(n){var a=n.graphQLErrors,i=n.networkError,c=n.errorMessage,l=n.extraInfo,o=e.call(this,c)||this;return o.graphQLErrors=a||[],o.networkError=i||null,o.message=c||r(o),o.extraInfo=l,o.__proto__=t.prototype,o}return a.__extends(t,e),t}(Error);t.ApolloError=i},7987:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(79),c=n(208),l=n(122),o=n(5),u=n(27),d=n(203),s=n(6843),m=n(6837),f=n(6841),b=n(40),p=n(43),v=n(204),h=n(6836),g=n(6872),E=n(26),y=n.n(E),w=n(38),j=n(90),O=n(61),C=n(54),k=(n(6995),n(6888)),I=n(6910),x=n(346),T=n(133),R=function(e){var t=e.target,n=e.Link,a=void 0===n?I.a:n,i=Object(C.a)(e,["target","Link"]);return r.a.createElement(a,{to:t},r.a.createElement(x.a,null,r.a.createElement(T.a,Object.assign({iconName:"mode_edit"},i))))},S=n(6925),L=function(e){var t=Object(S.a)({},e);return r.a.createElement(x.a,null,r.a.createElement(T.a,Object.assign({iconName:"remove_circle_outline"},t)))},_=n(20),D=function(e){var t=e.isVisible,n=Object(C.a)(e,["isVisible"]);return r.a.createElement(x.a,null,r.a.createElement(T.a,Object.assign({iconName:"remove_red_eye",iconColor:t?_.a.white:_.a.greyMiddle,color:_.a.greyMiddle},n)))},N=n(6904),W=n(6830),F=n(6840);function M(){var e=Object(o.a)(["\n  color: ",";\n"]);return M=function(){return e},e}var P=u.default.div(M(),_.a.greyMiddle);function B(){var e=Object(o.a)(["\n  padding: 1rem;\n  color: ",";\n  font-style: 'italic';\n"]);return B=function(){return e},e}var V=function(e){var t=e.items,n=e.heightStretch,a=void 0!==n&&n,i=e.fullHeight,c=void 0!==i&&i,l=e.rowHeight,o=void 0===l?60:l,u=e.isLoading,d=void 0!==u&&u,s=e.children,m=Object(C.a)(e,["items","heightStretch","fullHeight","rowHeight","isLoading","children"]),f=r.a.useCallback(function(e){var n=e.index;return t[n]},[t]),b=r.a.useCallback(function(){return d?r.a.createElement(N.a,null):null},[d]),p=function(e,n){return r.a.createElement(k.h,Object.assign({autoHeight:!a&&!c,width:e,height:n,headerHeight:50,rowCount:t?t.length:0,rowHeight:o,rowGetter:f,noRowsRenderer:b,style:{outline:"none"}},m),s)};return c?r.a.createElement(k.a,{disableHeight:!0},function(e){var n=e.width;return p(n,t.length*o)}):a?r.a.createElement(k.a,null,function(e){var t=e.width,n=e.height;return p(t,n)}):r.a.createElement(k.i,{scrollElement:window},function(e){var t=e.height;return r.a.createElement(k.a,{disableHeight:!0},function(e){var n=e.width;return p(n,t)})})};function A(e,t){var n=e.canQuery,a=e.canMutate;return function(e){var i=t(e);return n&&(i=r.a.createElement(F.a,{queryName:n},i)),a&&(i=r.a.createElement(W.a,{mutationName:a},i)),i}}function q(e){var t=e.cellData;return r.a.createElement(R,{target:t})}function K(e){var t=e.cellData,n=e.columnData;return r.a.createElement(L,{onClick:function(){return n.onRemove&&n.onRemove(t)}})}function H(e){var t=e.cellData,n=e.columnData,a=e.rowData;return r.a.createElement(D,{isVisible:t,onClick:function(){return n.onToggle(a.id,!t)}})}function U(e){var t=e.cellData,n=e.rowData,a=e.columnData;return r.a.createElement(r.a.Fragment,null,t,r.a.createElement(P,null,n[a.noteKey]))}var Q=Object(u.default)(function(e){var t=e.text,n=void 0===t?p.b._("Table is empty"):t,a=Object(C.a)(e,["text"]);return r.a.createElement("div",a,n)})(B(),_.a.greyMiddle),z=n(6835),G=n(53),$=n(373),J=n(63),X=n(6913),Y=n(205),Z=n(70),ee=n(75),te=n(85),ne=n(83),ae=n(84),re=n(6873),ie=Object(re.SortableElement)(function(e){var t=e.columns,n=e.style,a=e.className;return r.a.createElement("div",{style:n,className:a},t)}),ce=Object(re.SortableContainer)(V),le=function(e){function t(){var e,n;Object(Z.a)(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(n=Object(te.a)(this,(e=Object(ne.a)(t)).call.apply(e,[this].concat(i)))).state={sortedItems:n.props.items},n.rowRenderer=function(e){return r.a.createElement(ie,e)},n.onHandleSorting=function(){var e=Object(w.a)(y.a.mark(function e(t){var a,r,i,c,l;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.newIndex,r=t.oldIndex,a!==r){e.next=3;break}return e.abrupt("return");case 3:if(i=Object(Y.a)(n.state.sortedItems),c=Object(re.arrayMove)(n.state.sortedItems,r,a),n.setState({sortedItems:c}),!n.props.onSort){e.next=15;break}if(l=n.props.onSort({item:i[r],items:c,offset:a-r,newIndex:a,oldIndex:r}),e.t0=l,!e.t0){e.next=13;break}return e.next=12,l;case 12:e.t0=!e.sent;case 13:if(!e.t0){e.next=15;break}n.setState({sortedItems:i});case 15:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n}return Object(ae.a)(t,e),Object(ee.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.items,Object(C.a)(e,["items"]));return r.a.createElement(ce,Object.assign({lockAxis:"y",useDragHandle:!0,onSortEnd:this.onHandleSorting,rowRenderer:this.rowRenderer},t,{items:this.state.sortedItems}))}}]),t}(r.a.PureComponent);le.getDerivedStateFromProps=function(e){return{sortedItems:e.items}};var oe=function(e){var t=e.categories,n=e.children,a=e.onToggle,i=e.onRemove,c=e.onSort,l=e.showEditColumn,o=void 0===l||l,u=e.showRemoveColumn,d=void 0!==u&&u,s=e.showVisibilityColumn,m=void 0!==s&&s,f=e.showHeader,b=void 0===f||f,v=e.isSortable,h=void 0!==v&&v,g=e.isLoading,E=void 0!==g&&g,y=e.heightStretch,w=void 0!==y&&y,j=e.fullHeight,O=void 0!==j&&j,C=e.noRowsDisplay,I=void 0===C?r.a.createElement(Q,{text:p.b._("No recipes in category")}):C,x={isLoading:E,items:t,disableHeader:!b,heightStretch:w,fullHeight:O,noRowsRenderer:function(){return I}},T=[o&&r.a.createElement(k.d,{dataKey:"id",width:_.d.ButtonColumnWidthPx,minWidth:_.d.ButtonColumnWidthPx,cellRenderer:A({canQuery:"wareCategory"},q),cellDataGetter:function(e){var t=e.rowData;return Object($.b)(t.id,t.categoryType.enum)}}),d&&r.a.createElement(k.d,{dataKey:"id",width:_.d.ButtonColumnWidthPx,minWidth:_.d.ButtonColumnWidthPx,cellRenderer:K,columnData:{onRemove:i}}),m&&r.a.createElement(k.d,{dataKey:"visible",width:_.d.ButtonColumnWidthPx,minWidth:_.d.ButtonColumnWidthPx,cellRenderer:A({canMutate:"updateWareCategory"},H),columnData:{onToggle:a}}),r.a.createElement(k.d,{dataKey:"nameLabel",width:300,label:p.b._("Name"),cellRenderer:U,columnData:{noteKey:"internalNoteLabel"}}),r.a.createElement(k.d,{dataKey:"countRecipes",label:p.b._("Recipe count"),width:100,cellRenderer:function(e){var t=e.cellData;return"".concat(t," ").concat(p.b._("Recipes").toLocaleLowerCase())}}),n,h&&r.a.createElement(k.d,{dataKey:"id",width:50,cellRenderer:function(){return r.a.createElement(X.a,null)}})];return h?r.a.createElement.apply(r.a,[le,Object(J.a)({onSort:c},x)].concat(T)):r.a.createElement.apply(r.a,[V,x].concat(T))};function ue(){var e=Object(o.a)(["\n  position: absolute;\n  right: 0;\n  z-index: 5;\n"]);return ue=function(){return e},e}var de=u.default.div(ue()),se=function(e){var t=e.routeTo,n=void 0===t?"create":t,a=e.onClick;return r.a.createElement(de,null,r.a.createElement(I.a,{to:n,onClick:a},r.a.createElement(x.a,null,r.a.createElement(T.a,{iconName:"add_circle",color:_.a.green}))))};function me(){var e=Object(o.a)(["\n  .origins span {\n    display: inline-block;\n    margin: 0.2rem;\n    padding: 0.2rem;\n    background-color: ",";\n  }\n"]);return me=function(){return e},e}var fe=u.default.div(me(),_.a.greyLight),be=Object(O.observer)(function(e){var t=e.headline,n=e.subHeadline,a=void 0!==n&&n,i=e.categoryType,c=Object(G.b)().settings,l=Object(b.bb)({branchId:c.branchId,categoryType:i}),o=l.data,u=l.loading,d=l.updateQuery,f=l.refetch,p=Object(b.cb)().data,v=r.a.useMemo(function(){return p&&p.origins?p.origins.reduce(function(e,t){return e[t.enum]=t.code,e},{}):{}},[p]),h=r.a.useCallback(function(e){var t=e.cellData;return t.sort(),t.map(function(e){return r.a.createElement("span",{key:e},v[e])})},[p]),g=Object(b.I)(),E=Object(j.a)(g,1)[0],O=u?[]:o.categories;return r.a.createElement(fe,null,r.a.createElement(m.a,null,r.a.createElement(s.a,{widthGrowIndex:1},r.a.createElement(z.a,null,t),a&&r.a.createElement(z.a,{size:"smaller"},a)),r.a.createElement(s.a,{fixedWidth:!0},r.a.createElement(se,{routeTo:Object($.b)("create",i)}))),r.a.createElement(oe,{isLoading:u,categories:O,onToggle:function(e,t){E({categoryId:e,visible:t},{optimisticResponse:{updateWareCategory:{__typename:"WareCategory",id:e,visible:t}}})},isSortable:!0,showHeader:!1,fullHeight:!0,showVisibilityColumn:!0,onSort:function(){var e=Object(w.a)(y.a.mark(function e(t){var n,a,r,i;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.item,a=t.items,r=t.offset,d(function(){return{categories:a}}),e.next=4,c.menu.category.sortCategory(n.id,r);case 4:if(!(i=e.sent)){e.next=8;break}return e.next=8,f();case 8:return e.abrupt("return",i);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},r.a.createElement(k.d,{dataKey:"origins",width:300,className:"origins",cellRenderer:h,style:{fontSize:"0.8rem"}})))}),pe=n(93);function ve(){var e=Object(o.a)(["\n  white-space: nowrap;\n  margin-left: 2rem;\n  & a {\n    text-decoration: none;\n    color: ",";\n    padding: 1rem;\n  }\n"]);return ve=function(){return e},e}var he=Object(u.default)(T.a)(ve(),_.a.black),ge=Object(O.observer)(function(){var e=Object(G.b)().settings,t=Object(b.db)({branchId:e.branchId}),n=t.loading,a=t.data;return n||!(a&&a.companyBranch&&a.companyBranch.foodMenuUrl)?null:r.a.createElement(he,{color:_.a.greyMiddle},r.a.createElement("a",{href:a.companyBranch.foodMenuUrl,target:"_blank"},r.a.createElement(pe.Trans,{id:"Menu codes manual"})))});function Ee(){var e=Object(o.a)(["\n  height: calc(100% - 3.5rem);\n  padding-top: 1rem;\n  overflow-y: scroll;\n  overflow-x: hidden;\n  -webkit-overflow-scrolling: touch;\n"]);return Ee=function(){return e},e}var ye=u.default.div(Ee()),we=function(){return r.a.createElement(v.a,{pageTitle:p.b._("Category overview"),useBackButton:!0},r.a.createElement(h.a,{forcePercentHeightInMobile:100},r.a.createElement(d.a,{stretchToParent:!0},r.a.createElement(m.a,{justify:"start"},r.a.createElement(s.a,null,r.a.createElement(g.a,{width:20})),r.a.createElement(s.a,null,r.a.createElement(ge,null))),r.a.createElement(ye,null,r.a.createElement(be,{categoryType:b.u.Main,headline:p.b._("Category of recipes")}),r.a.createElement(f.a,{size:1.5}),r.a.createElement(be,{categoryType:b.u.SideDish,headline:p.b._("Category of sidedish")}),r.a.createElement(f.a,{size:1.5}),r.a.createElement(be,{categoryType:b.u.Cover,headline:p.b._("Category of covers")})))))},je=n(6827);function Oe(){var e=Object(o.a)(["\n  position: fixed;\n  z-index: 500;\n  right: 0;\n  top: 0rem;\n  width: 10rem;\n  opacity: 0.96;\n  background: ",";\n  border-radius: ",";\n"]);return Oe=function(){return e},e}var Ce,ke,Ie=u.default.div(Oe(),_.a.black,_.c.Button),xe=function(e){var t=e.type,n=e.isMain,a=e.isSideDish,i=e.isCover,c=e.children;return!0===n&&t===b.u.Main||!0===a&&t===b.u.SideDish||!0===i&&t===b.u.Cover?r.a.createElement(r.a.Fragment,null,c):null},Te=n(206),Re=n(260),Se=(Ce={},Object(Te.a)(Ce,b.u.Main,Object(Re.i18nMark)("Ware categories")),Object(Te.a)(Ce,b.u.SideDish,Object(Re.i18nMark)("Sidedish categories")),Object(Te.a)(Ce,b.u.Cover,Object(Re.i18nMark)("Cover categories")),Ce),Le=(ke={},Object(Te.a)(ke,b.u.Main,Object(Re.i18nMark)("Ware recipe")),Object(Te.a)(ke,b.u.SideDish,Object(Re.i18nMark)("Sidedish recipe")),Object(Te.a)(ke,b.u.Cover,Object(Re.i18nMark)("Cover recipe")),ke);function _e(e){return p.b._(Se[e])}function De(e){return p.b._(Le[e])}var Ne=n(6855),We=n(6854),Fe=function(e){var t=e.isCreate,n=void 0!==t&&t;return r.a.createElement(je.FormApi,{render:function(e){return r.a.createElement(We.a,{id:"form-submit"},function(e,t){if(!Object(Ne.a)(e))return p.b._("Fix form errors");return t?p.b._("Create"):p.b._("Save")}(e,n))}})};var Me=n(6845);function Pe(){var e=Object(o.a)(["\n  flex: none;\n  margin-right: 1rem;\n"]);return Pe=function(){return e},e}function Be(){var e=Object(o.a)(["\n  margin: 0.6rem;\n  display: flex;\n"]);return Be=function(){return e},e}var Ve=u.default.form(Be()),Ae=u.default.div(Pe()),qe=n(6909),Ke=n(135),He=n(369),Ue=function(e){var t=e.observe,n=e.render;return r.a.createElement(He.a,{observe:t,render:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=e.settings;return n(t)})})},Qe=n(6984);function ze(){var e=Object(o.a)(["\n  &:before {\n    font-size: "," !important;\n    margin-left: 0.5rem !important;\n  }\n"]);return ze=function(){return e},e}var Ge=u.default.div(ze(),function(e){var t=e.fontSize,n=void 0===t?2:t,a=e.fontSizeUnit,r=void 0===a?"rem":a;return"".concat(n).concat(r)}),$e=function(e){var t=e.pictogramId,n=e.fontSize,a=void 0===n?2:n,i=e.fontSizeUnit,c=void 0===i?"rem":i;return r.a.createElement(Ge,{className:Je(t),fontSize:a,fontSizeUnit:c})};function Je(e){return"flaticon-".concat(e)}var Xe=n(6832),Ye=n(32),Ze=function(e){var t=e.field;return r.a.createElement(je.Field,{field:t,pure:!0},function(e){return r.a.createElement(Xe.a,{value:e.value?{pictogram:e.value}:null,onChange:function(t){t&&!Array.isArray(t)&&e.setValue(t.pictogram)},options:Qe.pictograms.map(function(e){return{pictogram:e}}),getOptionValue:Ye.a.prop("pictogram"),formatOptionLabel:function(e){var t=e.pictogram;return r.a.createElement($e,{pictogramId:t,fontSize:2})},components:{SingleValue:function(e){var t=e.data;return r.a.createElement($e,{pictogramId:t.pictogram,fontSize:4})}},styles:{container:function(e){return Object(J.a)({},e,{width:"8rem"})},menuList:function(e){return Object(J.a)({},e,{maxHeight:"35rem"})}},isClearable:!1,isSearchable:!1,minWidth:8})})},et=n(6864),tt=function(e){var t=e.confirmText,n=e.onDelete;return r.a.createElement(je.Field,{field:"id"},function(e){return"NEW"!==e.value&&r.a.createElement(i.Route,null,function(a){var i=a.history;return r.a.createElement(et.a,{confirmText:t,onDelete:Object(w.a)(y.a.mark(function t(){return y.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n(e.value);case 2:i.goBack();case 3:case"end":return t.stop()}},t)}))})})})},nt=n(6833),at=n(6829),rt=function(e){var t=e.field,n=void 0===t?"internalNote":t,a=(e.icon,e.label),i=void 0===a?p.b._("Internal note").toLocaleLowerCase():a,c=Object(C.a)(e,["field","icon","label"]);return r.a.createElement(at.a,{label:i,labelWidth:7},r.a.createElement(nt.a,Object.assign({field:n,inputFullWidth:!0},c)))},it=function(e){var t=e.field,n=void 0===t?"nameLabel":t,a=e.icon,i=void 0===a?"label":a,c=Object(C.a)(e,["field","icon"]);return r.a.createElement(at.a,{icon:i,labelWidth:7},r.a.createElement(nt.a,Object.assign({field:n,inputFullWidth:!0,isRequired:!0,validatioName:p.b._("Name")},c)))},ct=n(119),lt=n(6912),ot=function(){var e=Object(b.cb)(),t=e.data,n=e.loading;return r.a.createElement(at.a,{label:p.b._("cat. origins"),labelWidth:7},r.a.createElement(lt.a,{field:"origins",isMulti:!0,isLoading:n,isSearchable:!0,options:n?[]:t.origins,getOptionLabel:ct.RM.prop("code"),getOptionValue:ct.RM.prop("enum")}))},ut=function(e){var t=e.categoryType;return r.a.createElement(Ve,null,r.a.createElement(Ae,null,r.a.createElement(Ke.a,{width:30},r.a.createElement(it,{placeholder:p.b._("Category name"),inputFullWidth:!0})),r.a.createElement(Ke.a,{width:30},r.a.createElement(rt,{placeholder:p.b._("Category internal note")})),r.a.createElement(Ke.a,{width:30},r.a.createElement(ot,null)),r.a.createElement(qe.a,{field:"visible",label:p.b._("To show this category")})),t===b.u.Main?r.a.createElement(Ae,null,r.a.createElement(Ze,{field:"pictogram"})):null,r.a.createElement(Me.a,{position:"BottomRight"},r.a.createElement(Ue,{render:function(e){var n=e.menu;return r.a.createElement(tt,{confirmText:p.b._("Remove this category?"),onDelete:function(e){return n.category.deleteCategory(e,t)}})}})))},dt=n(136),st=n(7984);function mt(e){var t=e.shouldLoad,n=e.loader,i=Object(C.a)(e,["shouldLoad","loader"]),c=Object(a.useState)(null),l=Object(j.a)(c,2),o=l[0],u=l[1];return Object(a.useEffect)(function(){t&&n().then(u)},[t]),r.a.createElement(je.Form,Object.assign({values:o},i))}var ft=function(e){var t=e.render;return r.a.createElement(i.Route,null,function(e){var n=e.history;return t?t(function(){return n.goBack()}):(n.goBack(),null)})},bt=n(66);function pt(){var e=Object(o.a)(["\n  color: red;\n  padding: 1rem;\n  max-width: 30rem;\n  overflow-wrap: break-word;\n"]);return pt=function(){return e},e}var vt=u.default.div(pt()),ht=function(e){function t(){var e,n;Object(Z.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(te.a)(this,(e=Object(ne.a)(t)).call.apply(e,[this].concat(r)))).state={submitError:null,validationErrors:null},n}return Object(ae.a)(t,e),Object(ee.a)(t,[{key:"renderErrors",value:function(){var e=this.state,t=e.submitError,n=e.validationErrors;return t?this.renderSubmitError(t):n?this.renderValidationErrors(n):null}},{key:"renderSubmitError",value:function(e){var t=[p.b._("Unexpected error while sending form. Out team was notified about the issue.")];if(Object(st.isApolloError)(e)){var n=Ye.a.propEq("showToUser",!0),a=e.graphQLErrors.filter(n).map(Ye.a.prop("message"));a.length&&(t=a)}return this.renderPopover(t)}},{key:"renderValidationErrors",value:function(e){return null}},{key:"renderPopover",value:function(e){var t=this;return r.a.createElement(dt.g,{open:!0,anchorEl:function(){return document.getElementById("submit-button")},onClose:function(){return t.setState({submitError:null,validationErrors:null})},anchorOrigin:{vertical:"bottom",horizontal:"center"}},e.map(function(e,t){return r.a.createElement(vt,{key:t},e)}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.isCreate,a=t.onCreate,i=t.onUpdate,c=t.getDefaultValues,l=t.loadValues,o=t.loadDefaults,u=t.children;return r.a.createElement(ft,{render:function(t){return r.a.createElement(mt,{shouldLoad:!0,defaultValues:c(),loader:Object(w.a)(y.a.mark(function e(){var t,a,r;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=c(),!o){e.next=6;break}return e.next=4,o();case 4:a=e.sent,Object.assign(t,a);case 6:if(!n){e.next=8;break}return e.abrupt("return",t);case 8:return e.next=10,l();case 10:return r=e.sent,e.abrupt("return",Object.assign({},t,r));case 12:case"end":return e.stop()}},e)})),onChange:function(e){return Object(bt.d)("new values",e.values)},onSubmit:function(){var e=Object(w.a)(y.a.mark(function e(r){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=5;break}return e.next=3,a(r);case 3:e.next=7;break;case 5:return e.next=7,i(r);case 7:t();case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),onSubmitFailure:function(t,n){e.setState({validationErrors:t,submitError:n}),Object.keys(t).length&&Object(bt.c)("validation errors",t),n&&Object(bt.c)("submit error",n)}},u,e.renderErrors())}})}}]),t}(r.a.Component);function gt(){return Object(G.b)().settings.menu}var Et=function(e){var t=e.categoryId,n=e.categoryType,a=e.children,i=gt();return r.a.createElement(ht,{isCreate:null===t,onCreate:function(e){return i.category.createCategory(e,n)},onUpdate:function(e){return i.category.updateCategory(e,n)},getDefaultValues:function(){return function(e){return{id:"NEW",visible:!0,internalNoteLabel:"",pictogram:"",nameLabel:"",minCount:0,maxCount:0,categoryType:{enum:e},recipes:[],origins:[]}}(n)},loadValues:Object(w.a)(y.a.mark(function e(){var n,a;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.client.query({query:b.r,variables:{categoryId:t},fetchPolicy:"no-cache"});case 2:return n=e.sent,a=n.data,e.abrupt("return",Object(J.a)({},a.category,{origins:a.category.origins}));case 5:case"end":return e.stop()}},e)}))},a)};function yt(e){var t=e.items,n=e.renderItem,a=(e.isLoading,e.heightStretch),i=void 0!==a&&a,c=e.rowHeight,l=void 0===c?60:c,o=Object(C.a)(e,["items","renderItem","isLoading","heightStretch","rowHeight"]),u=r.a.useCallback(function(e){var a=e.key,i=e.style,c=e.index;return r.a.createElement("div",{key:a,style:i},n(t[c],c))},[n,t]),d=function(e,n){return r.a.createElement(k.g,Object.assign({width:e,height:n,headerHeight:50,rowHeight:l,rowCount:t?t.length:0,rowRenderer:u,style:{outline:"none"}},o))};return i?r.a.createElement(k.a,null,function(e){var t=e.width,n=e.height;return d(t,n)}):r.a.createElement(k.i,{scrollElement:window},function(e){var t=e.height;return r.a.createElement(k.a,{disableHeight:!0},function(e){var n=e.width;return d(n,t)})})}var wt=n(6848),jt=n.n(wt),Ot=n(504),Ct=function(e){return void 0===e||Object(wt.isEmpty)(e+"")||!Object(Ot.b)(e+"")?p.b._("Price must be a number"):null},kt=function(e){var t=e.field,n=void 0===t?"price.value":t,a=e.icon,i=void 0===a?"toll":a,c=Object(C.a)(e,["field","icon"]);return r.a.createElement(at.a,{icon:i},r.a.createElement(Ke.a,{width:5},r.a.createElement(nt.a,Object.assign({field:n,inputFullWidth:!0,validate:Ct},c))))},It=n(209),xt=n(6903),Tt=n(6),Rt=n.n(Tt),St=n(210);function Lt(){var e=Object(o.a)(["\n  query GVats($branchId: ID!) {\n    vats(companyBranch: $branchId) {\n      id\n      vat\n    }\n  }\n"]);return Lt=function(){return e},e}var _t=Rt()(Lt()),Dt=Object(St.a)(_t);function Nt(){var e=Object(o.a)(["\n  margin-left: 5rem;\n"]);return Nt=function(){return e},e}var Wt=Object(It.a)(Nt()),Ft=function(e){var t=e.field,n=void 0===t?"price.vat":t,a=Object(G.b)().settings;return Object(O.useObserver)(function(){return r.a.createElement(Dt,{variables:{branchId:a.branchId},fetchPolicy:"cache-and-network",renderLoading:!1,render:function(e){var t=e.vats;return r.a.createElement(at.a,{className:Wt,label:"".concat(p.b._("VAT"),":")},t&&r.a.createElement(xt.a,{field:n,items:t,formatItem:function(e){var t=e.vat;return"".concat(t,"%")},isRequired:!0,validationName:p.b._("VAT")}))}})})};function Mt(){var e=Object(o.a)(["\n  padding: 0.5rem;\n"]);return Mt=function(){return e},e}var Pt=Object(u.default)(function(e){var t=e.field,n=e.className;return r.a.createElement(je.Field,{field:t},function(e){return r.a.createElement("span",{className:n},e.value)})})(Mt()),Bt=function(e){var t=e.priceType,n=e.label;return r.a.createElement(r.a.Fragment,null,r.a.createElement(z.a,null,n),r.a.createElement(je.NestedField,{field:["prices",t]},r.a.createElement(m.a,{justify:"flex-start"},r.a.createElement(kt,{field:"value"}),r.a.createElement(Pt,{field:"currencyCode"}),r.a.createElement(Ft,{field:"vatId"}))))},Vt=n(50);function At(e){var t=e.onAdd,n=e.addLabel,i=void 0===n?p.b._("Add"):n,c=e.addButtonText,l=void 0===c?p.b._("Add"):c,o=Object(C.a)(e,["onAdd","addLabel","addButtonText"]),u=Object(Vt.useStateRef)(null),d=Object(j.a)(u,2),f=d[0],b=d[1],v=Object(a.useCallback)(function(){var e=f();null!==e&&(t(e),b(null))},[t]),h=Object(a.useCallback)(function(e){"Enter"===e.key&&v()},[]),g=Object(a.useCallback)(function(e){b(e||null)},[]);return r.a.createElement(m.a,{justify:"flex-start"},r.a.createElement(s.a,{fixedWidth:!0,width:"4rem",margin:"auto 0"},i),r.a.createElement(s.a,{fixedWidth:!0,width:"20rem",margin:"auto 0"},r.a.createElement(Xe.a,Object.assign({value:f(),onChange:g,onKeyDown:h,isMulti:!1,isClearable:!1,getOptionValue:Ye.a.prop("id"),getOptionLabel:Ye.a.prop("nameLabel")},o))),r.a.createElement(s.a,{fixedWidth:!0,width:"10rem",margin:"auto 0"},r.a.createElement(T.a,{text:l,disabled:null===f(),onClick:v})))}var qt=function(e){var t=e.recipes,n=e.onRemove;return r.a.createElement(V,{items:t,disableHeader:!0},r.a.createElement(k.d,{dataKey:"associatedRecipe",width:_.d.ButtonColumnWidthPx,minWidth:_.d.ButtonColumnWidthPx,cellRenderer:function(e){var t=e.cellData;return r.a.createElement(L,{onClick:function(){return n(t)}})}}),r.a.createElement(k.d,{dataKey:"nameLabel",width:300,label:p.b._("Name"),cellRenderer:U,columnData:{noteKey:"internalNote"}}),r.a.createElement(k.d,{dataKey:"formattedPrice",width:100,label:p.b._("Price")}))},Kt=n(365),Ht=function(e){var t=e.priceType,n=e.recipeId;return r.a.createElement(je.Field,{field:"associatedRecipes"},function(e){var a=Ye.a.filter(Ye.a.propEq("warePriceType",t),e.value),i=Ye.a.reject(function(e){return e.id===n||(t=e.id,a.some(Ye.a.propEq("associatedRecipe",t)));var t}),c=function(n){e.setValue(e.value.concat({warePriceType:t,associatedRecipe:n.id,nameLabel:n.nameLabel,formattedPrice:"?"}))};return r.a.createElement(r.a.Fragment,null,r.a.createElement(qt,{recipes:a,onRemove:function(n){e.setValue(Ye.a.reject(function(e){var a=e.associatedRecipe,r=e.warePriceType;return a===n&&r===t},e.value))}}),r.a.createElement(Ue,{render:function(e){return r.a.createElement(Kt.c,{variables:{branchId:e.branchId},fetchPolicy:"cache-and-network",render:function(e){var t=e.recipes;return r.a.createElement(At,{options:i(t),onAdd:c})}})}}),r.a.createElement(f.a,null))})},Ut=[{priceType:b.v.Delivery,label:Object(Re.i18nMark)("Delivery sale")},{priceType:b.v.Inhouse,label:Object(Re.i18nMark)("Local sale")}],Qt=function(e){var t=e.recipeType,n=e.recipeId;return r.a.createElement(r.a.Fragment,null,Ut.map(function(e){var i=e.priceType,c=e.label;return r.a.createElement(a.Fragment,{key:i},r.a.createElement(Bt,{priceType:i,label:p.b._(c)}),r.a.createElement(f.a,null),t===b.u.Main&&r.a.createElement(Ht,{priceType:i,recipeId:n}))}))},zt=Object(O.observer)(function(e){var t=e.categoryType,n=e.filterRecipes,a=e.onAdd,i=Object(G.b)().settings,c=Object(b.eb)({branchId:i.branchId,categoryType:t}),l=c.data,o=c.loading;return r.a.createElement(At,{isLoading:o,options:o?[]:n(l.recipes),onAdd:a})});function Gt(){var e=Object(o.a)(["\n  cursor: move;\n"]);return Gt=function(){return e},e}function $t(){var e=Object(o.a)(["\n  display: grid;\n  grid-gap: 1rem;\n  grid-template-columns: ","px 100px 3fr 1fr 1fr 50px;\n"]);return $t=function(){return e},e}function Jt(){var e=Object(o.a)(["\n  flex: 1 1 0;\n  margin: 1rem 0 0 1rem;\n"]);return Jt=function(){return e},e}function Xt(){var e=Object(o.a)(["\n  flex: 0 0 auto;\n"]);return Xt=function(){return e},e}function Yt(){var e=Object(o.a)(["\n  display: flex;\n  flex-direction: column;\n  height: calc(100% - 2rem);\n  width: 100%;\n"]);return Yt=function(){return e},e}var Zt=u.default.div(Yt()),en=u.default.div(Xt()),tn=u.default.div(Jt()),nn=Object(re.SortableContainer)(tn),an=u.default.div($t(),_.d.ButtonColumnWidthPx),rn=u.default.div(Gt()),cn=Object(re.SortableElement)(function(e){var t=e.recipe,n=e.onRemove,a=Ut.map(function(e){var n=e.priceType,a=e.label,i=t.prices.find(Ye.a.pathEq(["priceType","enum"],n));return r.a.createElement(rn,{key:n},r.a.createElement(P,null,p.b._(a)),i?i.price.formattedValue:r.a.createElement("i",null,p.b._("Not set").toLocaleLowerCase()))});return r.a.createElement(an,null,r.a.createElement("div",null,r.a.createElement(L,{onClick:n})),r.a.createElement(rn,null,t.code),r.a.createElement(rn,null,t.nameLabel,r.a.createElement(P,null,t.internalNote)),a,r.a.createElement(X.a,null))}),ln=function(e){var t=e.categoryType;return r.a.createElement(je.Field,{field:"recipes"},function(e){var n=e.value,a=function(){var t=Object(w.a)(y.a.mark(function t(a){var r,i,c;return y.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=a.newIndex,i=a.oldIndex,r!==i){t.next=3;break}return t.abrupt("return");case 3:c=Object(re.arrayMove)(n,i,r),e.setValue(c);case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();return r.a.createElement(Zt,null,r.a.createElement(en,null,r.a.createElement(zt,{categoryType:t,filterRecipes:Ye.a.without(e.value),onAdd:function(t){return e.setValue(e.value.concat(t))}})),r.a.createElement(nn,{lockAxis:"y",lockToContainerEdges:!0,onSortEnd:a},r.a.createElement(yt,{items:e.value,heightStretch:!0,rowHeight:60,renderItem:function(t,n){return r.a.createElement(cn,{recipe:t,onRemove:function(){e.setValue(Ye.a.reject(Ye.a.propEq("id",t.id),e.value))},index:n})},rowCount:e.value.length})))})},on=n(190),un=n.n(on),dn=n(6842),sn=n(6834),mn=n(6993);function fn(){var e=Object(o.a)(["\n  display: flex;\n  align-items: center;\n  & > label {\n    min-width: 5rem;\n  }\n  & > * {\n    margin: 0.2rem 0.5rem;\n  }\n  input.count {\n    font-size: 1.5rem;\n    line-height: 1.5rem;\n    text-align: center;\n  }\n"]);return fn=function(){return e},e}var bn=u.default.div(fn()),pn=function(e){var t=e.count,n=e.label,a=e.enabled,i=e.onChange,c=e.id,l=r.a.useRef(t);return r.a.createElement(bn,null,r.a.createElement("label",{htmlFor:c},n),r.a.createElement(Ke.a,{width:3},r.a.createElement(sn.a,{id:c,value:0===t?"":t,onChange:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){e.target.validity.valid&&i(Number.parseInt(e.target.value,10))}),onFocus:function(e){e.target.select()},disabled:0===t||!a,inputFullWidth:!0,type:"tel",pattern:"^[1-9]\\d*$",className:"count"})),r.a.createElement(Ke.a,{width:4},r.a.createElement(T.a,{disabled:!a||t<=0,onClick:function(){return i(t-1)}},"\u2796")),r.a.createElement(Ke.a,{width:4},r.a.createElement(T.a,{disabled:!a,onClick:function(){return i(t+1)}},"\u2795")),r.a.createElement("div",null,r.a.createElement(mn.a,null,r.a.createElement("input",{type:"checkbox",id:"".concat(c,"-nolimit"),checked:0===t,disabled:!a,onChange:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){0===t?i(l.current||1):(l.current=t,i(0))})}),r.a.createElement("label",{htmlFor:"".concat(c,"-nolimit")},r.a.createElement(pe.Trans,{id:"Unlimited"})))))},vn=function(){return{noLimit:{label:p.b._("No limitation"),min:0,max:0},optional:{label:p.b._("One at most"),min:0,max:1},required:{label:p.b._("One at least"),min:1,max:0},onlyOne:{label:p.b._("Exactly one"),min:1,max:1},custom:{label:p.b._("Custom range")}}},hn=function(e){var t=e.formApi,n=r.a.useMemo(vn,[]),a=r.a.useState("noLimit"),i=Object(j.a)(a,2),c=i[0],l=i[1],o=t.getValue("minCount"),u=t.getValue("maxCount");r.a.useEffect(function(){if("custom"!==c){var e=un.a.findKey(n,function(e){var t=e.min,n=e.max;return t===o&&n===u});e&&l(e)}},[c,o,u]);var d=function(e){return t.setValue("minCount",e)},s=function(e){return t.setValue("maxCount",e)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(dn.a,{items:Object.keys(n),formatItem:function(e){return n[e].label},onSingleSelection:function(e){if(e){l(e);var t=n[e];d(t.min||0),s(t.max||0)}},selectedItem:c}),r.a.createElement(pn,{id:"minCount",count:o,label:r.a.createElement(pe.Trans,{id:"Minimum"}),enabled:"custom"===c,onChange:d}),r.a.createElement(pn,{id:"maxCount",count:u,label:r.a.createElement(pe.Trans,{id:"Maximum"}),enabled:"custom"===c,onChange:s}))};function gn(){var e=Object(o.a)(["\n  flex: 1 1 0;\n  min-height: 0;\n  position: relative;\n"]);return gn=function(){return e},e}function En(){var e=Object(o.a)(["\n  flex: 0 0 8rem;\n"]);return En=function(){return e},e}function yn(){var e=Object(o.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  width: 100%;\n"]);return yn=function(){return e},e}var wn=u.default.div(yn()),jn=u.default.div(En()),On=u.default.div(gn()),Cn=function(e){var t=e.categoryId,n=e.categoryType;return r.a.createElement(Et,{categoryId:t,categoryType:n},r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{pageTitle:_e(n),hideLogoutWidget:!0,useBackButton:!0}),r.a.createElement(h.a,null,r.a.createElement(wn,null,r.a.createElement(jn,null,r.a.createElement(d.a,null,r.a.createElement(ut,{categoryType:n}))),r.a.createElement(xe,{isSideDish:!0,type:n},r.a.createElement(jn,null,r.a.createElement(d.a,null,r.a.createElement(z.a,null,r.a.createElement(pe.Trans,{id:"Required amounts of recipes to be picked"})),r.a.createElement(je.FormApi,{component:hn})))),r.a.createElement(On,null,r.a.createElement(d.a,{stretchToParent:!0},r.a.createElement(z.a,null,r.a.createElement(pe.Trans,{id:"Recipes assigned to this category"})),r.a.createElement(ln,{categoryType:n}))))),r.a.createElement(Ie,null,r.a.createElement(W.a,{mutationName:null===t?"createWareCategory":"updateWareCategory"},r.a.createElement(Fe,{isCreate:null===t})))))};function kn(){var e=Object(o.a)(["\n  height: calc(100% - 4.5rem);\n  padding-top: 2rem;\n"]);return kn=function(){return e},e}var In=u.default.div(kn()),xn=Object(O.observer)(function(){var e=Object(G.b)().settings.menu.recipe,t=Object(b.ab)({branchId:e.branchId}),n=t.data,a=t.loading;return r.a.createElement(Ke.a,{width:17},r.a.createElement(Xe.a,{key:e.branchId,onChange:function(t){e.setCategoryFilter(t?t.id:null)},options:function(){if(!n||!n.categories)return[];var e=Ye.a.groupBy(function(e){return e.categoryType.enum.toString()},n.categories);return Object.keys(e).map(function(t){return{label:_e(t),options:e[t]}})}(),isMulti:!1,isClearable:!0,isSearchable:!0,isLoading:a,placeholder:p.b._("Filter by category"),getOptionValue:Ye.a.prop("id"),getOptionLabel:Ye.a.prop("nameLabel")}))}),Tn=n(103),Rn=function(e){var t=e.modelType,n=Object(G.b)().settings.menu[t],a=Object(Vt.useDebounceCallback)(n.setFilterInput);return r.a.createElement(at.a,{icon:Tn.o},r.a.createElement(Ke.a,{width:17},r.a.createElement(sn.a,{defaultValue:n.filterInput,inputFullWidth:!0,onChange:function(e){return a(e.target.value)},placeholder:p.b._("Filter by name or code")})))},Sn=n(6911),Ln=n(372),_n=function(){var e=r.a.useState(!1),t=Object(j.a)(e,2),n=t[0],a=t[1],i=Object(Vt.useRouterContext)().history,c=function(e){return function(){var t=Object(Ln.b)(Object(Sn.a)("create","".concat(location.pathname,"/")),e);i.push(t)}};return r.a.createElement(r.a.Fragment,null,r.a.createElement(se,{onClick:function(e){e.preventDefault(),a(!0)}}),r.a.createElement(dt.c,{open:n,onClose:function(){return a(!1)}},r.a.createElement(dt.f,null,"Select item type"),r.a.createElement(T.a,{onClick:c(b.u.Main)},r.a.createElement(pe.Trans,{id:"Ware"})),r.a.createElement(T.a,{onClick:c(b.u.SideDish)},r.a.createElement(pe.Trans,{id:"Sidedish"})),r.a.createElement(T.a,{onClick:c(b.u.Cover)},r.a.createElement(pe.Trans,{id:"Cover"}))))},Dn=n(6882),Nn=n(6994),Wn=function(e){var t=e.recipes,n=e.onToggle,a=e.onRemove,i=e.showEditColumn,c=void 0===i||i,l=e.showRemoveColumn,o=void 0!==l&&l,u=e.showVisibilityColumn,d=void 0===u||u,s=e.showTypeColumn,m=void 0!==s&&s,f=e.isLoading,v=void 0!==f&&f,h=e.heightStretch,g={isLoading:v,items:t,heightStretch:void 0!==h&&h,noRowsRenderer:function(){return v?r.a.createElement(Nn.a,null):r.a.createElement(z.a,null,p.b._("No recipes has been found"))}};return r.a.createElement(V,g,c&&r.a.createElement(k.d,{dataKey:"id",width:_.d.ButtonColumnWidthPx,minWidth:_.d.ButtonColumnWidthPx,cellRenderer:A({canQuery:"recipe"},q),cellDataGetter:function(e){var t=e.rowData;return Object(Ln.b)(t.id,t.recipeType.enum)}}),o&&r.a.createElement(k.d,{dataKey:"id",width:_.d.ButtonColumnWidthPx,minWidth:_.d.ButtonColumnWidthPx,cellRenderer:K,columnData:{onRemove:a}}),d&&r.a.createElement(k.d,{dataKey:"visible",width:_.d.ButtonColumnWidthPx,minWidth:_.d.ButtonColumnWidthPx,cellRenderer:A({canMutate:"updateRecipe"},H),columnData:{onToggle:n}}),m&&r.a.createElement(k.d,{dataKey:"recipeType",width:100,label:p.b._("Type"),cellRenderer:Mn}),r.a.createElement(k.d,{dataKey:"code",width:100,label:p.b._("Code")}),r.a.createElement(k.d,{dataKey:"nameLabel",width:600,flexGrow:2,label:p.b._("Name"),cellRenderer:U,columnData:{noteKey:"internalNote"}}),r.a.createElement(k.d,{dataKey:"prices",width:150,label:p.b._("Delivery sale"),cellRenderer:Fn,columnData:{priceType:b.v.Delivery}}),r.a.createElement(k.d,{dataKey:"prices",width:150,label:p.b._("Local sale"),cellRenderer:Fn,columnData:{priceType:b.v.Inhouse}}),r.a.createElement(k.d,{dataKey:"availableAmount",label:p.b._("recipe.list.availableAmount",{},{defaults:"Stock"}),width:100}),r.a.createElement(k.d,{dataKey:"internalNote",label:p.b._("Internal note"),width:200}))};function Fn(e){var t=e.cellData,n=e.columnData.priceType,a=t.find(Ye.a.pathEq(["priceType","enum"],n));return a?a.price.formattedValue:r.a.createElement("i",null,p.b._("Not set").toLocaleLowerCase())}function Mn(e){var t=e.rowData.recipeType.enum;return t===b.u.SideDish?p.b._("Sidedish").toLocaleLowerCase():t===b.u.Cover?p.b._("Cover").toLocaleLowerCase():p.b._("Ware").toLocaleLowerCase()}var Pn=Object(O.observer)(function(){var e=Object(G.b)().settings,t=Object(b.eb)({branchId:e.branchId,categoryId:e.menu.recipe.categoryFilterId}),n=t.data,a=t.loading,i=Object(O.useComputed)(function(){if(!n||!n.recipes||0===n.recipes.length)return[];var t=Object(Dn.a)(e.menu.recipe.filterInput);return n.recipes.filter(Ye.a.cond([[Ye.a.propSatisfies(t,"code"),Ye.a.T],[Ye.a.propSatisfies(t,"nameLabel"),Ye.a.T]]))},[n&&n.recipes]);return r.a.createElement(Wn,{recipes:i,onToggle:e.menu.recipe.changeVisibility,isLoading:a,heightStretch:!0,showTypeColumn:!0})}),Bn=function(e){return r.a.createElement(v.a,{pageTitle:p.b._("Recipe overview"),useBackButton:!0},r.a.createElement(h.a,{forcePercentHeightInMobile:100},r.a.createElement(d.a,{stretchToParent:!0},r.a.createElement(m.a,{justify:"start",flexWrap:"wrap"},r.a.createElement(s.a,null,r.a.createElement(g.a,{width:20})),r.a.createElement(s.a,null,r.a.createElement(Rn,{modelType:"recipe"})),r.a.createElement(s.a,null,r.a.createElement(xn,null))),r.a.createElement(W.a,{mutationName:"createRecipe"},r.a.createElement(_n,null)),r.a.createElement(In,null,r.a.createElement(Pn,null)))))},Vn=n(351),An=Object(O.observer)(function(e){var t=e.categoryType,n=e.currentCategories,a=e.addButtonText,i=e.onAdd,c=Object(G.b)().settings,l=Object(b.bb)({branchId:c.branchId,categoryType:t}),o=l.data,u=l.loading,d=o&&o.categories||[];return r.a.createElement(At,{isLoading:u,options:Ye.a.without(n,d),addButtonText:a,onAdd:i})}),qn=function(e){var t=e.categoryType,n=e.addButtonText,a=e.noRowsText,i=e.field;return r.a.createElement(je.Field,{field:i},function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(oe,{categories:e.value,showRemoveColumn:!0,showEditColumn:!1,showHeader:!1,onRemove:function(t){return e.setValue(Ye.a.reject(Ye.a.propEq("id",t),e.value))},noRowsDisplay:r.a.createElement(Q,{text:a})}),r.a.createElement(An,{addButtonText:n,categoryType:t,currentCategories:e.value,onAdd:function(t){return e.setValue(e.value.concat(t))}}))})},Kn=function(e){var t=e.field,n=void 0===t?"code":t,a=(e.icon,e.isRequired,Object(C.a)(e,["field","icon","isRequired"]));return r.a.createElement(at.a,{label:p.b._("Code").toLocaleLowerCase(),labelWidth:7},r.a.createElement(Ke.a,{width:9},r.a.createElement(nt.a,Object.assign({field:n,inputFullWidth:!0,isRequired:!0,validatioName:p.b._("Code")},a))))},Hn=function(e){var t=e.field,n=void 0===t?"descriptionLabel":t,a=(e.icon,Object(C.a)(e,["field","icon"]));return r.a.createElement(at.a,{label:p.b._("Public note").toLocaleLowerCase(),labelWidth:7},r.a.createElement(nt.a,Object.assign({field:n,inputFullWidth:!0},a)))};function Un(){var e=Object(o.a)(["\n  query GAllergens {\n    allergens {\n      ...FMenuAllergen\n    }\n  }\n  ","\n"]);return Un=function(){return e},e}var Qn=Rt()(Un(),b.d),zn=Object(St.a)(Qn);function Gn(){var e=Object(o.a)(["\n    color: ",";\n    background-color: ",";\n  "]);return Gn=function(){return e},e}function $n(){var e=Object(o.a)(["\n  float: left;\n  width: 2.3rem;\n  height: 2.3rem;\n  border: 1px solid ",";\n  margin: 0.3rem 0.6rem 0.3rem ",";\n  font-size: 1.5rem;\n  text-align: center;\n  vertical-align: middle;\n  cursor: default;\n  ",";\n"]);return $n=function(){return e},e}var Jn=u.default.div($n(),_.a.greyMiddle,_.d.MarginAroundFormComponents,function(e){var t=e.active;return Object(u.css)(Gn(),t?_.a.black:_.a.greyMiddle,t?_.a.yellow:_.a.white)}),Xn=function(e){var t=e.selected,n=e.onToggle;return r.a.createElement(zn,{render:function(e){var a=e.allergens;return r.a.createElement(r.a.Fragment,null,a.map(function(e){var a={active:t.includes(e.enum),onClick:n&&function(){return n(e.enum)}};return r.a.createElement(Jn,Object.assign({key:e.enum,title:e.code},a),e.category)}))}})},Yn=function(){return r.a.createElement(je.Field,{field:"ingredients"},function(e){var t=e.value,n=un.a.uniq(un.a.flatten(t.map(Ye.a.prop("allergens"))));return r.a.createElement(Xn,{selected:n})})},Zn=function(e){var t=e.recipeType,n=t===b.u.Main;return r.a.createElement(Ve,null,r.a.createElement(Ae,null,r.a.createElement(it,{placeholder:p.b._("Recipe name")}),r.a.createElement(Kn,{placeholder:p.b._("Recipe code")}),r.a.createElement(rt,{placeholder:p.b._("Recipe internal note")}),n&&r.a.createElement(Hn,{placeholder:p.b._("Public note for customers, allergens")}),r.a.createElement(xe,{type:t,isMain:!0},r.a.createElement(at.a,{labelWidth:7,icon:"error_outline"},p.b._("Allergens based on stock cards"),r.a.createElement("br",null),r.a.createElement(Yn,null))),r.a.createElement(at.a,{labelWidth:7},r.a.createElement(qe.a,{field:"visible",label:p.b._("To show this recipe")}))),r.a.createElement(Me.a,{position:"BottomRight"},r.a.createElement(Ue,{render:function(e){var t=e.menu;return r.a.createElement(tt,{confirmText:p.b._("Remove this recipe?"),onDelete:function(e){return t.recipe.deleteRecipe(e)}})}})))},ea=function(e){var t=e.recipeId,n=e.recipeType,a=e.children,i=gt();return r.a.createElement(ht,{isCreate:null===t,onCreate:function(e){return i.recipe.createRecipe(e,n)},onUpdate:function(e){return i.recipe.updateRecipe(e)},getDefaultValues:function(){return na(n)},loadDefaults:Object(w.a)(y.a.mark(function e(){var t,a,r,c;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.recipe.queryDefaults();case 2:return t=e.sent,a=t.vats,r=t.currencyCode,(c=Object(J.a)({},na(n))).prices=ta(function(e){return{value:0,vatId:a[e],currencyCode:r}}),e.abrupt("return",c);case 8:case"end":return e.stop()}},e)})),loadValues:Object(w.a)(y.a.mark(function e(){var n,a;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.client.query({query:Kt.b,variables:{recipeId:t},fetchPolicy:"no-cache"});case 2:return n=e.sent,a=n.data,e.abrupt("return",aa(a.recipe));case 5:case"end":return e.stop()}},e)}))},a)};function ta(e){return[b.v.Delivery,b.v.Inhouse].reduce(function(t,n){return t[n]=e(n),t},{})}function na(e){return{id:"NEW",code:"",nameLabel:"",internalNote:"",descriptionLabel:"",image:"",visible:!0,recipeType:{enum:e},sourcePrices:[],prices:ta(function(){return{value:0,vatId:null,currencyCode:""}}),sourceAssociatedRecipes:[],associatedRecipes:[],sourceIngredients:[],ingredients:[],sideDishes:[],categories:[]}}function aa(e){return Object(J.a)({},e,{associatedRecipes:e.sourceAssociatedRecipes.map(function(e){var t=e.priceType,n=e.recipe;return{warePriceType:t.enum,nameLabel:n.nameLabel,associatedRecipe:n.id,formattedPrice:"?"}}),ingredients:e.sourceIngredients.map(function(e){var t=e.quantity,n=e.stockItem,a=n.id,r=n.label,i=n.allergens;return{stockItem:a,label:r,quantity:t,unitLabel:n.wareUnit.code,allergens:i.map(Ye.a.prop("enum"))}}),prices:ta(function(t){var n=e.sourcePrices.find(Ye.a.pathEq(["priceType","enum"],t));return n?{value:n.price.value,vatId:n.vat.id,currencyCode:n.price.currency.code}:{value:0,vatId:null,currencyCode:""}})})}var ra=function(e){var t=e.ingredients,n=e.onRemove,a=e.isLoading,i=void 0!==a&&a;return r.a.createElement(V,{isLoading:i,items:t,disableHeader:!0,noRowsRenderer:function(){return r.a.createElement(Q,{text:p.b._("Recipe has no ingredients")})}},r.a.createElement(k.d,{dataKey:"stockItem",width:_.d.ButtonColumnWidthPx,minWidth:_.d.ButtonColumnWidthPx,cellRenderer:K,columnData:{onRemove:n}}),r.a.createElement(k.d,{dataKey:"label",width:300,label:p.b._("Name")}),r.a.createElement(k.d,{dataKey:"quantity",width:60,label:p.b._("Quantity"),cellRenderer:function(e){var t=e.rowIndex;return r.a.createElement(Ke.a,{width:2.5},r.a.createElement(nt.a,{field:["ingredients",t,"quantity"],validate:ia,inputFullWidth:!0}))}}),r.a.createElement(k.d,{dataKey:"unitLabel",width:100,label:p.b._("Ware unit")}))};function ia(e){var t=p.b._("Quantity");return jt.a.isEmpty(e+"")?p.b._("{fieldName} must be entered",{fieldName:t}):jt.a.isFloat(e+"",{min:0})?null:p.b._("{fieldName} must be a positive number",{fieldName:t})}var ca=Ye.a.differenceWith(function(e,t){return e.id===t.stockItem}),la=Object(O.observer)(function(e){var t=e.ingredients,n=e.onAdd,a=e.onRemove,i=Object(G.b)().settings,c=Object(b.gb)({branchId:i.branchId}),l=c.data,o=c.loading;return r.a.createElement(r.a.Fragment,null,r.a.createElement(ra,{ingredients:t,onRemove:a}),r.a.createElement(At,{isLoading:o,addButtonText:p.b._("Add ingredient"),options:o?[]:ca(l.stockItems,t),onAdd:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){n({stockItem:e.id,label:e.nameLabel,quantity:1,unitLabel:e.wareUnit.code,allergens:e.allergens.map(Ye.a.prop("enum"))})})}))}),oa=function(){return r.a.createElement(je.Field,{field:"ingredients"},function(e){return r.a.createElement(la,{ingredients:e.value,onAdd:function(t){e.setValue(Object(Y.a)(e.value).concat([t]))},onRemove:function(t){e.setValue(Ye.a.reject(Ye.a.propEq("stockItem",t),e.value))}})})},ua=function(e){var t=e.recipeId,n=e.recipeType;return r.a.createElement(ea,{recipeId:t,recipeType:n},r.a.createElement(Vn.a,{margin:"0 1.25rem 0 0"},r.a.createElement(v.a,{pageTitle:De(n),hideLogoutWidget:!0,useBackButton:!0},r.a.createElement(d.a,null,r.a.createElement(Zn,{recipeType:n})),r.a.createElement(d.a,null,r.a.createElement(Qt,{recipeType:n,recipeId:t})),r.a.createElement(d.a,null,r.a.createElement(z.a,null,r.a.createElement(pe.Trans,{id:"Recipe ingredients"})),r.a.createElement(f.a,null),r.a.createElement(oa,null)),r.a.createElement(xe,{type:n,isMain:!0},r.a.createElement(d.a,null,r.a.createElement(z.a,null,r.a.createElement(pe.Trans,{id:"Sidedish categories"})),r.a.createElement(P,null,r.a.createElement(pe.Trans,{id:"These sidedish are presented with recipe"})),r.a.createElement(qn,{categoryType:b.u.SideDish,field:"sideDishes",addButtonText:p.b._("Attach sidedish category"),noRowsText:p.b._("Recipe has no sidedish category attached")})),r.a.createElement(d.a,null,r.a.createElement(z.a,null,r.a.createElement(pe.Trans,{id:"Category assignments"})),r.a.createElement(P,null,r.a.createElement(pe.Trans,{id:"Recipe is in these categories"})),r.a.createElement(qn,{categoryType:b.u.Main,field:"categories",addButtonText:p.b._("Add to category"),noRowsText:p.b._("Recipe is not in any category")})))),r.a.createElement(Ie,null,r.a.createElement(W.a,{mutationName:null===t?"createRecipe":"updateRecipe"},r.a.createElement(Fe,{isCreate:null===t})))))},da=n(134),sa=n.n(da),ma=n(176),fa=function(e){var t=e.wareUnit,n=e.quantity,a=e.onConfirm;return r.a.createElement(T.a,{disabled:null===t,onClick:a},t?r.a.createElement(pe.Trans,{id:"Add {0} {1}",values:{0:sa()(n).format(ma.h),1:t.code}}):r.a.createElement(pe.Trans,{id:"No stock card selected"}))},ba=r.a.forwardRef(function(e,t){var n=e.value,a=e.onFilter,i=e.onConfirm;return r.a.createElement(at.a,{label:p.b._("Stock card"),labelWidth:7},r.a.createElement(sn.a,{ref:t,autoFocus:!0,placeholder:"".concat(p.b._("Code").toLocaleLowerCase()," / ").concat(p.b._("PLU")," / ").concat(p.b._("Title").toLocaleLowerCase()),value:n,onChange:function(e){a(e.target.value)},onKeyPressCapture:function(e){"Enter"===e.key&&(e.preventDefault(),i())}}))}),pa=r.a.forwardRef(function(e,t){var n=e.enabled,a=e.onChange,i=e.onConfirm;return r.a.createElement(sn.a,{ref:t,disabled:!n,onChange:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=sa()(e.target.value).value();a(t)}),onKeyPressCapture:function(e){"Enter"===e.key&&(e.preventDefault(),i())}})});function va(){var e=Object(o.a)(["\n  background-color: ",";\n"]);return va=function(){return e},e}var ha=function(e){var t=e.stockItems,n=e.searchValue,a=e.onSelect;return r.a.createElement(In,null,r.a.createElement(V,{items:t,heightStretch:!1},r.a.createElement(k.d,{dataKey:"id",width:_.d.ButtonColumnWidthPx,minWidth:_.d.ButtonColumnWidthPx,cellRenderer:ga,columnData:{onSelect:a}}),r.a.createElement(k.d,{dataKey:"quantity",width:100,label:p.b._("Card stock"),cellRenderer:wa}),r.a.createElement(k.d,{dataKey:"code",width:100,label:p.b._("Card code"),cellRenderer:ya(n)}),r.a.createElement(k.d,{dataKey:"nameLabel",width:300,label:p.b._("Card name"),cellRenderer:ya(n)}),r.a.createElement(k.d,{dataKey:"note",width:300,label:p.b._("Card note")})))};function ga(e){var t=e.rowData,n=e.columnData.onSelect;return r.a.createElement(x.a,null,r.a.createElement(T.a,{iconName:"done",onClick:function(){return n(t)}}))}var Ea=u.default.span(va(),_.a.yellow);function ya(e){return function(t){var n=t.cellData,a=n.toLocaleLowerCase().indexOf(e.toLocaleLowerCase());if(-1===a)return n;var i=n.substring(0,a),c=n.substring(a,a+e.length),l=n.substring(a+e.length);return r.a.createElement(r.a.Fragment,null,i,r.a.createElement(Ea,null,c),l)}}function wa(e){var t=e.cellData,n=e.rowData;return"".concat(t," ").concat(n.wareUnit.code)}var ja=function(e){function t(){var e,n;Object(Z.a)(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(n=Object(te.a)(this,(e=Object(ne.a)(t)).call.apply(e,[this].concat(i)))).state={targetStockItem:null,filteredStockItems:[],searchValue:"",inputQuantity:0},n.filterInputRef=r.a.createRef(),n.quantityInputRef=r.a.createRef(),n.onFilter=function(e){if(""!==e.trim()){var t=Object(Dn.a)(e),a=n.props.stockItems.filter(Ye.a.cond([[Ye.a.propEq("plu",e),Ye.a.T],[Ye.a.propSatisfies(t,"code"),Ye.a.T],[Ye.a.propSatisfies(t,"nameLabel"),Ye.a.T]])),r=null;1===a.length&&(r=Ye.a.head(a)),n.setState({filteredStockItems:a,searchValue:e,targetStockItem:r})}else n.setState({filteredStockItems:[],searchValue:"",targetStockItem:null})},n.onConfirmFilter=function(){1===n.state.filteredStockItems.length&&n.quantityInputRef.current.focus()},n.onQuantity=function(e){n.setState({inputQuantity:e})},n.onSelectStockItem=function(e){n.setState({targetStockItem:e,filteredStockItems:[e]},function(){n.quantityInputRef.current.focus()})},n.onConfirm=function(){var e=n.state,t=e.targetStockItem,a=e.inputQuantity;t&&0!==a&&n.props.onDeposit(t,a),n.setState({targetStockItem:null,searchValue:"",inputQuantity:0},function(){n.quantityInputRef.current.value="",n.filterInputRef.current.focus()})},n}return Object(ae.a)(t,e),Object(ee.a)(t,[{key:"componentDidUpdate",value:function(e){e.stockItems!==this.props.stockItems&&this.onFilter(this.state.searchValue)}},{key:"render",value:function(){var e=this.state,t=e.searchValue,n=e.filteredStockItems,a=e.targetStockItem,i=e.inputQuantity,c=""!==t.trim(),l=0===n.length,o=n.length>1;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ve,null,r.a.createElement(Ae,null,r.a.createElement(ba,{onFilter:this.onFilter,onConfirm:this.onConfirmFilter,value:t,ref:this.filterInputRef})),r.a.createElement(Ae,null,r.a.createElement(pa,{enabled:null!==a,onChange:this.onQuantity,onConfirm:this.onConfirm,ref:this.quantityInputRef})),r.a.createElement(Ae,null,r.a.createElement(fa,{cardName:a?a.nameLabel:"",quantity:i,wareUnit:a?a.wareUnit:null,onConfirm:this.onConfirm}))),r.a.createElement(z.a,null,c&&o&&r.a.createElement(pe.Trans,{id:"Continue typing to find single stock card or select one from the list"}),c&&l&&r.a.createElement(pe.Trans,{id:"No stock card found from entered search value"}),c&&a&&r.a.createElement(pe.Trans,{id:"Stock card <0>{0}</0> is selected",values:{0:a.nameLabel},components:[r.a.createElement("b",null)]})),c&&r.a.createElement(ha,{searchValue:t,stockItems:n,onSelect:this.onSelectStockItem}))}}]),t}(r.a.Component),Oa=Object(O.observer)(function(e){var t=e.children,n=Object(G.b)().settings,a=Object(b.fb)({branchId:n.branchId}),r=a.data,i=a.loading,c=Object(b.J)(),l=Object(j.a)(c,1)[0];return t(i?[]:r.stockItems,function(e,t){l({stockItem:e.id,quantityChange:t})})}),Ca=function(e){return r.a.createElement(v.a,{pageTitle:p.b._("Stock deposit"),useBackButton:!0},r.a.createElement(d.a,null,r.a.createElement(g.a,null),r.a.createElement(Oa,null,function(e,t){return r.a.createElement(ja,{stockItems:e,onDeposit:t})})))},ka=n(350),Ia=function(e){var t=e.stockItems,n=e.isLoading;return r.a.createElement(V,{items:t,heightStretch:!0,noRowsRenderer:function(){return n?r.a.createElement(ka.a,null):r.a.createElement("h3",null,r.a.createElement(pe.Trans,{id:"Selected branch has no stock cards"}))}},r.a.createElement(k.d,{dataKey:"id",width:_.d.ButtonColumnWidthPx,minWidth:_.d.ButtonColumnWidthPx,cellRenderer:A({canQuery:"stockItem"},q)}),r.a.createElement(k.d,{dataKey:"code",width:100,label:p.b._("Card code")}),r.a.createElement(k.d,{dataKey:"nameLabel",width:300,minWidth:30,flexGrow:2,label:p.b._("Card name")}),r.a.createElement(k.d,{dataKey:"quantity",width:100,label:p.b._("Card stock"),cellRenderer:xa}),r.a.createElement(k.d,{dataKey:"allowNegative",width:300,label:p.b._("Negative stock"),cellRenderer:Ta}),r.a.createElement(k.d,{dataKey:"note",width:300,label:p.b._("Card note")}))};function xa(e){var t=e.cellData,n=e.rowData;return"".concat(t," ").concat(n.wareUnit.code)}function Ta(e){return!0===e.cellData?r.a.createElement(pe.Trans,{id:"Permitted"}):r.a.createElement(pe.Trans,{id:"Forbidden"})}var Ra=Object(O.observer)(function(){var e=Object(G.b)().settings,t=Object(b.gb)({branchId:e.branchId}),n=t.data,a=t.loading,i=Object(O.useComputed)(function(){if(!n||!n.stockItems||0===n.stockItems.length)return[];var t=e.menu.stock.filterInput,a=Object(Dn.a)(t);return n.stockItems.filter(Ye.a.cond([[Ye.a.propEq("plu",t),Ye.a.T],[Ye.a.propSatisfies(a,"code"),Ye.a.T],[Ye.a.propSatisfies(a,"nameLabel"),Ye.a.T]]))},[n&&n.stockItems]);return r.a.createElement(Ia,{stockItems:i,isLoading:a})}),Sa=function(e){return r.a.createElement(v.a,{pageTitle:p.b._("Stock overview"),useBackButton:!0},r.a.createElement(h.a,{forcePercentHeightInMobile:100},r.a.createElement(d.a,{stretchToParent:!0},r.a.createElement(m.a,{justify:"start",flexWrap:"wrap"},r.a.createElement(s.a,null,r.a.createElement(g.a,{width:20})),r.a.createElement(s.a,null,r.a.createElement(Rn,{modelType:"stock"}))),r.a.createElement(W.a,{mutationName:"createStockItem"},r.a.createElement(se,{routeTo:"create"})),r.a.createElement(In,null,r.a.createElement(Ra,null)))))};function La(){var e=Object(o.a)(["\n  query GMenuStockDefaults($branchId: ID!) {\n    companyBranch(id: $branchId) {\n      id\n      allowNegative: stockItemsCanBeNegative\n    }\n  }\n"]);return La=function(){return e},e}function _a(){var e=Object(o.a)(["\n  query GMenuStockForm($stockId: ID!) {\n    stockItem(id: $stockId) {\n      id\n      code\n      plu\n      note\n      nameLabel: label\n      allowNegative\n      wareUnit {\n        ...FMenuWareUnit\n      }\n      allergens {\n        ...FMenuAllergen\n      }\n      companyBranch {\n        id\n        allowNegative: stockItemsCanBeNegative\n      }\n    }\n  }\n  ","\n  ","\n"]);return _a=function(){return e},e}var Da=Rt()(_a(),b.d,b.g),Na=Rt()(La()),Wa=(Object(St.a)(Da),function(e){var t=e.stockId,n=e.children,a=gt();return r.a.createElement(ht,{isCreate:null===t,onCreate:function(e){return a.stock.createItem(e)},onUpdate:function(e){return a.stock.updateItem(e)},getDefaultValues:Fa,loadDefaults:Object(w.a)(y.a.mark(function e(){var t,n;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.client.query({query:Na,variables:{branchId:a.stock.branchId},fetchPolicy:"no-cache"});case 2:return t=e.sent,n=t.data,e.abrupt("return",{allowNegativeDefault:Ma(n.companyBranch.allowNegative)});case 5:case"end":return e.stop()}},e)})),loadValues:Object(w.a)(y.a.mark(function e(){var n,r;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.client.query({query:Da,variables:{stockId:t},fetchPolicy:"no-cache"});case 2:return n=e.sent,r=n.data,e.abrupt("return",{id:(i=r.stockItem).id,internalNote:"TBD",nameLabel:i.nameLabel,code:i.code,note:i.note,plu:i.plu||"",wareUnit:i.wareUnit.enum,allergens:i.allergens.map(Ye.a.prop("enum")),allowNegative:i.allowNegative,allowNegativeDefault:Ma(i.companyBranch.allowNegative)});case 5:case"end":return e.stop()}var i},e)}))},n)});function Fa(){return{id:"NEW",internalNote:"",nameLabel:"",code:"",plu:"",note:"",wareUnit:null,allergens:[],allowNegative:b.j.Default,allowNegativeDefault:b.j.Default}}function Ma(e){return e?b.j.Default:b.j.Disabled}var Pa=function(e){var t=e.field,n=void 0===t?"allergens":t,a=e.icon,i=void 0===a?"error_outline":a;return r.a.createElement(je.Field,{field:n},function(e){return r.a.createElement(at.a,{icon:i,labelWidth:7},r.a.createElement(Xn,{selected:e.value,onToggle:function(t){var n=e.value;n.includes(t)?e.setValue(Ye.a.without([t],n)):e.setValue(Object(Y.a)(n).concat([t]))}}))})};var Ba=[{type:b.j.Enabled,label:Object(Re.i18nMark)("Permit")},{type:b.j.Disabled,label:Object(Re.i18nMark)("Forbid")}],Va=function(e){!function(e){if(null==e)throw new TypeError("Cannot destructure undefined")}(e);var t=Object(a.useMemo)(function(){return" (".concat(p.b._("Is default setting").toLocaleLowerCase(),")")},[]);return r.a.createElement(je.FormApi,null,function(e){var n=e.values.allowNegativeDefault;return r.a.createElement(at.a,{label:p.b._("Negative stock"),labelWidth:7},r.a.createElement(xt.a,{field:"allowNegative",items:Ba,formatItem:function(e){return e.type===n?r.a.createElement("span",null,p.b._(e.label),r.a.createElement("i",null,t)):p.b._(e.label)},getItemId:function(e){return e.type}}))})},Aa=function(e){var t=e.field,n=void 0===t?"plu":t,a=e.icon,i=void 0===a?"fingerprint":a,c=Object(C.a)(e,["field","icon"]);return r.a.createElement(at.a,{icon:i,labelWidth:7},r.a.createElement(Ke.a,{width:9},r.a.createElement(nt.a,Object.assign({field:n,inputFullWidth:!0},c))))};function qa(){var e=Object(o.a)(["\n  query GWareUnits {\n    wareUnits {\n      id\n      code\n      enum\n    }\n  }\n"]);return qa=function(){return e},e}var Ka=Rt()(qa()),Ha=Object(St.a)(Ka),Ua=function(e){var t=e.field,n=void 0===t?"wareUnit":t,a=e.icon,i=void 0===a?"select_all":a,c=Object(C.a)(e,["field","icon"]);return r.a.createElement(Ha,{renderLoading:!1,render:function(e,t){var a=e.wareUnits,l=t.loading;return r.a.createElement(at.a,{icon:i,labelWidth:7},r.a.createElement(lt.a,Object.assign({field:n,options:a||[],isLoading:l,isRequired:!0,validatioName:p.b._("Ware unit"),getOptionLabel:Ye.a.prop("code"),getOptionValue:Ye.a.prop("enum"),width:12},c)))}})},Qa=function(e){return r.a.createElement(Ve,null,r.a.createElement(Ae,null,r.a.createElement(it,{placeholder:p.b._("Card name")}),r.a.createElement(Kn,{placeholder:p.b._("Card code")}),r.a.createElement(Ua,{placeholder:p.b._("Choose unit")}),r.a.createElement(Aa,{placeholder:p.b._("PLU")}),r.a.createElement(rt,{placeholder:p.b._("Card note"),field:"note",label:p.b._("Card note")}),r.a.createElement(Pa,null),r.a.createElement(Va,null)),r.a.createElement(Me.a,{position:"BottomRight"},r.a.createElement(W.a,{mutationName:"destroyStockItem"},r.a.createElement(Ue,{render:function(e){var t=e.menu;return r.a.createElement(tt,{confirmText:p.b._("Remove this card?"),onDelete:function(e){return t.stock.deleteItem(e)}})}}))))},za=function(e){var t=e.stockId,n=Object(b.vb)({stockId:t}),a=n.data;if(n.loading)return r.a.createElement(N.a,null);var i=a.stockItem.ingredients;return 0===i.length?r.a.createElement(z.a,null,r.a.createElement(pe.Trans,{id:"No recipes are using stock card"})):r.a.createElement(r.a.Fragment,null,r.a.createElement(z.a,null,r.a.createElement(pe.Trans,{id:"Recipes using this card"})),r.a.createElement(V,{items:Object(Y.a)(i),disableHeader:!0,fullHeight:!0},r.a.createElement(k.d,{dataKey:"",cellDataGetter:function(e){var t=e.rowData;return{pathname:"/settings/menu/recipe/".concat(t.recipe.id),state:{recipeType:t.recipe.recipeType.enum}}},cellRenderer:q,width:100}),r.a.createElement(k.d,{dataKey:"recipe",width:300,label:p.b._("Name"),cellRenderer:function(e){var t=e.rowData;return r.a.createElement(r.a.Fragment,null,t.recipe.nameLabel,r.a.createElement(P,null,t.recipe.descriptionLabel))}})))},Ga=function(e){var t=e.stockId;return r.a.createElement(v.a,{pageTitle:p.b._("Stock card"),hideLogoutWidget:!0,useBackButton:!0},r.a.createElement(Wa,{stockId:t},r.a.createElement(r.a.Fragment,null,r.a.createElement(Ie,null,r.a.createElement(W.a,{mutationName:null===t?"createStockItem":"updateStockItem"},r.a.createElement(Fe,{isCreate:null===t}))),r.a.createElement(d.a,null,r.a.createElement(Qa,null),t&&r.a.createElement(F.a,{queryName:"recipes"},r.a.createElement(za,{stockId:t}))))))};n.d(t,"MenuRoutes",function(){return $a});var $a=function(e){var t=e.match;return r.a.createElement(i.Switch,null,r.a.createElement(l.a,{exact:!0,path:t.path,render:function(){return r.a.createElement(i.Redirect,{to:"".concat(t.path,"/category")})}}),r.a.createElement(l.a,{exact:!0,path:"".concat(t.path,"/category"),component:we}),r.a.createElement(l.a,{path:"".concat(t.path,"/category/:categoryId"),render:function(e){var t=e.match.params,n=e.location.state;return r.a.createElement(Cn,{categoryId:"create"===t.categoryId?null:t.categoryId,categoryType:n.categoryType})}}),r.a.createElement(l.a,{exact:!0,path:"".concat(t.path,"/recipe"),component:Bn}),r.a.createElement(l.a,{path:"".concat(t.path,"/recipe/:recipeId"),render:function(e){var t=e.match.params,n=e.location.state;return r.a.createElement(ua,{recipeId:"create"===t.recipeId?null:t.recipeId,recipeType:n.recipeType})}}),r.a.createElement(l.a,{exact:!0,path:"".concat(t.path,"/stock"),component:Sa}),r.a.createElement(l.a,{path:"".concat(t.path,"/stock/deposit"),component:Ca}),r.a.createElement(l.a,{path:"".concat(t.path,"/stock/:stockId"),render:function(e){var t=e.match.params;return r.a.createElement(Ga,{stockId:"create"===t.stockId?null:t.stockId})}}),r.a.createElement(i.Route,{component:c.a}))};t.default=$a}}]);
//# sourceMappingURL=180.066596b2.chunk.js.map