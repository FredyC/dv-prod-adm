(this.webpackJsonpspeedlo=this.webpackJsonpspeedlo||[]).push([[380],{1378:function(e,t,a){"use strict";a.d(t,"a",function(){return c});var n=a(4);function r(){var e=Object(n.a)(["\n  height: ",";\n"]);return r=function(){return e},e}var c=a(18).c.div(r(),function(e){var t=e.size,a=void 0===t?1:t,n=e.sizeUnit,r=void 0===n?"rem":n;return"".concat(a).concat(r)});c.displayName="VerticalGap"},1381:function(e,t,a){"use strict";a.d(t,"a",function(){return m}),a.d(t,"b",function(){return b});var n=a(132),r=a(48),c=a(63),i=a(1352),l=a(59),o=a(0),u=a.n(o),s=a(1358);function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}var m=u.a.forwardRef(function(e,t){var a=e.fieldName,n=e.fullWidth,r=e.validate,i=e.addHiddenLabelWithPlaceholderText,o=void 0===i||i,d=Object(c.a)(e,["fieldName","fullWidth","validate","addHiddenLabelWithPlaceholderText"]),m=b({fieldName:a,validate:r});return Object(l.g)(function(){return u.a.createElement(u.a.Fragment,null,u.a.createElement(s.b,Object.assign({},m(),{inputFullWidth:n,ref:t},d)),o&&d.placeholder&&u.a.createElement("label",{hidden:!0,htmlFor:m().id},d.placeholder))})});function b(e){var t=e.fieldName,a=e.validate,c=Object(i.i)(),l=Object(i.e)(t,{validate:a}),o=Object(r.a)(l,2),u=o[0],s=o[1];return function(){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},s(),{disabled:c.isSubmitting,invalid:u.touched&&Boolean(u.error)})}}},1411:function(e,t,a){"use strict";a.d(t,"a",function(){return s});var n=a(63),r=a(1637),c=a(0),i=a.n(c),l=a(434),o=a(14),u=a(131),s=function(e){var t=e.onDelete,a=e.confirmText,c=Object(n.a)(e,["onDelete","confirmText"]);return i.a.createElement(l.a,null,i.a.createElement(u.a,Object.assign({className:"delete-button",icon:r.a,color:o.a.greyMiddle,onClick:function(e){e.preventDefault(),a&&!window.confirm(a)||t()}},c)))}},1415:function(e,t,a){"use strict";a.d(t,"a",function(){return f});var n=a(132),r=a(63),c=a(1352),i=a(59),l=a(0),o=a.n(l),u=a(1357),s=a(1380),d=a(1446),m=a(20);function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}var f=function(e){var t=e.fieldName,a=e.getOptionValue,l=void 0===a?m.b:a,f=e.getOptionFilter,p=Object(r.a)(e,["fieldName","getOptionValue","getOptionFilter"]),g=Object(c.i)(),h=Object(c.d)(t);return Object(i.g)(function(){var e=Object(s.a)({getOptionFilter:f}),t=Object(d.a)(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},p,{onSelectionChange:h.setValue,selected:h.value,getOptionValue:l}));return o.a.createElement(u.a,Object.assign({},t,e,p,{onFocus:function(){return h.setTouched()},invalid:h.touched&&h.hasError,isDisabled:g.isSubmitting,getOptionValue:l}))})}},1424:function(e,t,a){"use strict";a.d(t,"a",function(){return c});var n=a(0),r=a.n(n);function c(e){var t=e.options,a=e.selected,n=e.onSelectionChange,c=e.getOptionValue;return{value:r.a.useMemo(function(){return null===a?null:null===t?null:t.find(function(e){return c(e)===a})||null},[a,t,c]),onChange:function(e){n(e?c(e):null)}}}},1425:function(e,t,a){"use strict";a.d(t,"a",function(){return m});var n=a(63),r=a(2773),c=a(1356),i=a(1352),l=a(59),o=a(0),u=a.n(o),s=a(131),d=a(14),m=function(e){var t=e.children,a=e.id,o=void 0===a?"form-submit":a,m=Object(n.a)(e,["children","id"]),b=Object(i.i)();return Object(l.g)(function(){return u.a.createElement(s.a,Object.assign({id:o,type:"submit",color:d.a.green,disabled:b.isSubmitting,icon:b.isValid?void 0:r.a,iconSize:1.1,iconColor:d.a.red},m,{className:Object(c.b)(m.className,"animated","infinite",{heartBeat:b.isSubmitting})}),u.a.createElement(u.a.Fragment,null,t))})}},1446:function(e,t,a){"use strict";a.d(t,"a",function(){return i});var n=a(0),r=a.n(n),c=a(1354);function i(e){var t=e.options,a=e.selected,n=e.onSelectionChange,i=e.getOptionValue;return{value:r.a.useMemo(function(){return Array.isArray(a)?null===t?c.a:t.filter(function(e){return a.includes(i(e))}):null},[a,t,i]),onChange:function(e){n(e?e.map(i):c.a)},isMulti:!0}}},1491:function(e,t,a){"use strict";a.d(t,"a",function(){return n});var n=a(18).c.div.withConfig({displayName:"FlexDiv",componentId:"dwel3j-0"})(["display:flex;"])},1522:function(e,t,a){"use strict";a.d(t,"a",function(){return l});var n=a(1352),r=a(59),c=a(0),i=a.n(c),l=function(e){var t=e.fieldName,a=e.className,c=Object(n.f)(t);return Object(r.g)(function(){return i.a.createElement("span",{className:a},c.value)})}},1523:function(e,t,a){"use strict";a.d(t,"a",function(){return m});var n=a(4),r=a(2796),c=a(0),i=a.n(c),l=a(1466),o=a(18),u=a(239);function s(){var e=Object(n.a)(["\n  padding: 1rem 0.4rem;\n  cursor: grab;\n"]);return s=function(){return e},e}var d=o.c.div(s()),m=Object(l.c)(function(){return i.a.createElement(d,null,i.a.createElement(u.a,{icon:r.a}))})},1555:function(e,t,a){"use strict";a.d(t,"a",function(){return i}),a.d(t,"b",function(){return l});var n=a(18),r=(a(1556),a(14)),c=function(e){var t=e.fontSize,a=void 0===t?2:t,n=e.fontSizeUnit,c=void 0===n?r.d.DefaultSizeUnit:n;return"".concat(a).concat(c)},i=n.c.div.attrs(function(e){return{className:l(e.pictogramId)}}).withConfig({displayName:"PictogramDisplay",componentId:"sc-6st3s9-0"})(["&:before{font-size:"," !important;margin-left:0.5rem !important;}"],c);function l(e){return"flaticon-".concat(e)}},1571:function(e,t,a){"use strict";a.d(t,"a",function(){return m});var n=a(69),r=a.n(n),c=a(112),i=a(49),l=a(1352),o=a(0),u=a.n(o),s=(a(42),a(254)),d=void 0;function m(e){var t=e.onSubmit,a=e.initialValues,n=e.loadValues,o=e.validationSchema,m=e.submitMessage,b=e.submitRedirectPath,f=Object(i.l)().history,p=Object(s.a)(),g=p.enqueueSuccess,h=p.enqueueWarning,v=u.a.useCallback(function(){var e=Object(c.a)(r.a.mark(function e(a){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(a);case 2:m&&g(m),b&&f.push(b);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[g,f,t,m,b]),y=u.a.useCallback(function(e,t){var a=!0,n=!1,r=void 0;try{for(var c,i=t.values()[Symbol.iterator]();!(a=(c=i.next()).done);a=!0){var l=c.value;l&&h(l)}}catch(o){n=!0,r=o}finally{try{a||null==i.return||i.return()}finally{if(n)throw r}}},[h]),O=u.a.useRef(!1),E=u.a.useCallback(function(){O.current=!1},[]),j=Object(l.g)({onSubmit:v,onSubmitFailed:y,onReset:E,validationSchema:o,initialValues:a,initialValidationEnabled:void 0===n,ignoreUnknownFieldsInValidation:!0,onFormChanges:d});return u.a.useEffect(function(){O.current||(n&&Promise.resolve(n(j.state.initialValues)).then(function(e){e&&(j.api.mergeValues(e),j.state.pristineValues=j.state.values),j.api.enableValidation()}),O.current=!0)},[n,j]),j}},1572:function(e,t,a){"use strict";a.d(t,"a",function(){return f});var n=a(132),r=a(63),c=a(1352),i=a(59),l=a(0),o=a.n(l),u=a(1357),s=a(1380),d=a(1424),m=a(20);function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}var f=function(e){var t=e.fieldName,a=e.getOptionValue,l=void 0===a?m.b:a,f=e.getOptionFilter,p=Object(r.a)(e,["fieldName","getOptionValue","getOptionFilter"]),g=Object(c.i)(),h=Object(c.d)(t);return Object(i.g)(function(){var e=Object(d.a)(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},p,{onSelectionChange:h.setValue,selected:h.value,getOptionValue:l})),t=Object(s.a)({getOptionFilter:f});return o.a.createElement(u.a,Object.assign({},e,t,p,{onFocus:function(){return h.setTouched()},invalid:h.touched&&h.hasError,isDisabled:g.isSubmitting}))})}},2801:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(57),i=a(257),l=a(124),o=a(1416),u=a(4),s=a(18),d=a(253),m=a(1370),b=a(1368),f=a(1378),p=a(77),g=a(36),h=a(255),v=a(1371),y=a(1426),O=a(438),E=a(78),j=a(59),w=a(40),C=a(131),k=a(14);function x(){var e=Object(u.a)(["\n  white-space: nowrap;\n  margin-left: 2rem;\n  & a {\n    text-decoration: none;\n    color: ",";\n    padding: 1rem;\n  }\n"]);return x=function(){return e},e}var P=Object(s.c)(C.a)(x(),k.a.black),T=Object(j.b)(function(){var e=Object(w.b)().settings,t=Object(p.Mb)({branchId:e.branchId},{fetchPolicy:"cache-first"}),a=t.loading,n=t.data;return!a&&n&&n.companyBranch.foodMenuUrl?r.a.createElement(P,{color:k.a.greyMiddle},r.a.createElement("a",{href:n.companyBranch.foodMenuUrl,target:"_blank",rel:"noopener noreferrer"},r.a.createElement(E.Trans,{id:"Menu codes manual"}))):null}),R=a(69),L=a.n(R),S=a(112),I=a(48),N=a(1392),D=a(1366),W=a(1568),_=a(1391),M=a(132),B=a(1523),V=a(63),F=a(160),U=a(75),q=a(86),A=a(93),K=a(92),z=a(94),H=a(1466),G=Object(H.b)(function(e){var t=e.columns,a=e.style,n=e.className;return r.a.createElement("div",{style:a,className:n},t)}),Q=Object(H.a)(N.f),J=function(e){function t(){var e,a;Object(U.a)(this,t);for(var n=arguments.length,c=new Array(n),i=0;i<n;i++)c[i]=arguments[i];return(a=Object(A.a)(this,(e=Object(K.a)(t)).call.apply(e,[this].concat(c)))).state={sortedItems:a.props.items},a.rowRenderer=function(e){return r.a.createElement(G,e)},a.onHandleSorting=function(){var e=Object(S.a)(L.a.mark(function e(t){var n,r,c,i,l;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.newIndex,r=t.oldIndex,n!==r){e.next=3;break}return e.abrupt("return");case 3:if(c=Object(F.a)(a.state.sortedItems),i=Object(H.d)(a.state.sortedItems,r,n),a.setState({sortedItems:i}),!a.props.onSort){e.next=15;break}if(l=a.props.onSort({item:c[r],items:i,offset:n-r,newIndex:n,oldIndex:r}),e.t0=l,!e.t0){e.next=13;break}return e.next=12,l;case 12:e.t0=!e.sent;case 13:if(!e.t0){e.next=15;break}a.setState({sortedItems:c});case 15:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(z.a)(t,e),Object(q.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.items,Object(V.a)(e,["items"]));return r.a.createElement(Q,Object.assign({lockAxis:"y",useDragHandle:!0,onSortEnd:this.onHandleSorting,rowRenderer:this.rowRenderer},t,{items:this.state.sortedItems}))}}]),t}(r.a.PureComponent);function X(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function Y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?X(a,!0).forEach(function(t){Object(M.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):X(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}J.getDerivedStateFromProps=function(e){return{sortedItems:e.items}};var Z=function(e){var t=e.categories,a=e.children,n=e.onToggle,c=e.onRemove,i=e.onSort,l=e.showEditColumn,o=void 0===l||l,u=e.showRemoveColumn,s=void 0!==u&&u,d=e.showVisibilityColumn,m=void 0!==d&&d,b=e.showHeader,f=void 0===b||b,p=e.isSortable,h=void 0!==p&&p,v=e.isLoading,y=void 0!==v&&v,O=e.heightStretch,E=void 0!==O&&O,j=e.fullHeight,w=void 0!==j&&j,C=e.noRowsDisplay,x=void 0===C?r.a.createElement(N.g,{text:g.b._("No recipes in category")}):C,P={isLoading:y,items:t,disableHeader:!f,heightStretch:E,fullHeight:w,noRowsRenderer:function(){return x}},T=Object(_.a)().getCategoryEditRoute,R=[o&&r.a.createElement(N.a,{dataKey:"id",width:k.d.ButtonColumnWidthPx,minWidth:k.d.ButtonColumnWidthPx,cellRenderer:Object(N.h)({canQuery:"wareCategory"},N.b),cellDataGetter:function(e){var t=e.rowData;return T(t.id,t.categoryType.enum)}}),s&&r.a.createElement(N.a,{dataKey:"id",width:k.d.ButtonColumnWidthPx,minWidth:k.d.ButtonColumnWidthPx,cellRenderer:N.c,columnData:{onRemove:c}}),m&&r.a.createElement(N.a,{dataKey:"visible",width:k.d.ButtonColumnWidthPx,minWidth:k.d.ButtonColumnWidthPx,cellRenderer:Object(N.h)({canMutate:"updateWareCategory"},N.d),columnData:{onToggle:n}}),r.a.createElement(N.a,{dataKey:"nameLabel",width:300,label:g.b._("Name"),cellRenderer:N.e,columnData:{noteKey:"internalNote"}}),r.a.createElement(N.a,{dataKey:"countRecipes",label:g.b._("Recipe count"),width:100,cellRenderer:function(e){var t=e.cellData;return"".concat(t," ").concat(g.b._("Recipes").toLocaleLowerCase())}}),a,h&&r.a.createElement(N.a,{dataKey:"id",width:50,cellRenderer:function(){return r.a.createElement(B.a,null)}})];return h?r.a.createElement.apply(r.a,[J,Y({onSort:i},P)].concat(R)):r.a.createElement.apply(r.a,[N.f,P].concat(R))};function $(){var e=Object(u.a)(["\n  .origins span {\n    display: inline-block;\n    margin: 0.2rem;\n    padding: 0.2rem;\n    background-color: ",";\n  }\n"]);return $=function(){return e},e}var ee=s.c.div($(),k.a.greyLight),te=Object(j.b)(function(e){var t=e.headline,a=e.subHeadline,n=void 0!==a&&a,c=e.categoryType,i=Object(w.b)().settings,l=Object(p.Kb)({branchId:i.branchId,categoryType:c}),o=l.getStash,u=l.loading,s=l.updateQuery,d=l.refetch,f=Object(p.Lb)({},{fetchPolicy:"cache-first"}).data,g=r.a.useMemo(function(){return f&&f.origins?f.origins.reduce(function(e,t){return e[t.enum]=t.code,e},{}):{}},[f]),h=r.a.useCallback(function(e){var t=e.cellData;return t.sort(),t.map(function(e){return r.a.createElement("span",{key:e},g[e])})},[g]),v=Object(p.U)(),y=Object(I.a)(v,1)[0],O=r.a.useCallback(function(e,t){y({categoryId:e,visible:t},{optimisticResponse:{updateWareCategory:{__typename:"WareCategory",id:e,visible:t}}})},[y]),E=Object(p.S)(),j=Object(I.a)(E,1)[0],C=r.a.useCallback(function(){var e=Object(S.a)(L.a.mark(function e(t){var a,n,r,c;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.item,n=t.items,r=t.offset,s(function(){return{categories:n}}),e.next=4,j({categoryId:a.id,offset:r});case 4:if(!(c=e.sent)){e.next=9;break}return e.next=8,d();case 8:return e.abrupt("return",c.success);case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[d,j,s]),k=o(function(e){return e.categories}),x=Object(_.a)().getCategoryCreateRoute;return r.a.createElement(ee,null,r.a.createElement(b.a,null,r.a.createElement(m.a,{widthGrowIndex:1},r.a.createElement(D.a,null,t),n&&r.a.createElement(D.a,{size:"smaller"},n)),r.a.createElement(m.a,{fixedWidth:!0},r.a.createElement(W.a,{routeTo:x(c)}))),r.a.createElement(Z,{isLoading:u,categories:k||[],onToggle:O,isSortable:!0,showHeader:!1,fullHeight:!0,showVisibilityColumn:!0,onSort:C},r.a.createElement(N.a,{dataKey:"origins",width:300,className:"origins",cellRenderer:h,style:{fontSize:"0.8rem"}})))});function ae(){var e=Object(u.a)(["\n  height: calc(100% - 3.5rem);\n  padding-top: 1rem;\n  overflow-y: scroll;\n  overflow-x: hidden;\n  -webkit-overflow-scrolling: touch;\n"]);return ae=function(){return e},e}var ne=s.c.div(ae()),re=function(){return r.a.createElement(h.a,{pageTitle:g.b._("Category overview"),useBackButton:!0,backRoute:O.a},r.a.createElement(v.a,{forcePercentHeightInMobile:100},r.a.createElement(d.a,{stretchToParent:!0},r.a.createElement(b.a,{justify:"start"},r.a.createElement(m.a,null,r.a.createElement(y.a,{width:20})),r.a.createElement(m.a,null,r.a.createElement(T,null))),r.a.createElement(ne,null,r.a.createElement(te,{categoryType:p.n.Main,headline:g.b._("Category of recipes")}),r.a.createElement(f.a,{size:1.5}),r.a.createElement(te,{categoryType:p.n.SideDish,headline:g.b._("Category of sidedish")}),r.a.createElement(f.a,{size:1.5}),r.a.createElement(te,{categoryType:p.n.Cover,headline:g.b._("Category of covers")})))))};function ce(){var e=Object(u.a)(["\n  position: fixed;\n  z-index: 500;\n  right: 0.5rem;\n  top: 0.5rem;\n  width: 10rem;\n  opacity: 0.96;\n  background: ",";\n  border-radius: ",";\n"]);return ce=function(){return e},e}var ie=s.c.div(ce(),k.a.black,k.c.Button),le=a(1352);function oe(){return Object(le.f)("itemType").value}var ue=function(e){var t=e.isMain,a=e.isSideDish,n=e.isCover,c=e.children,i=oe();return!0===t&&i===p.n.Main||!0===a&&i===p.n.SideDish||!0===n&&i===p.n.Cover?r.a.createElement(r.a.Fragment,null,c):null},se=a(1425),de=a(1355),me=function(e){var t=e.isCreate,a=e.createMutation,n=e.updateMutation;return Object(de.b)(t?a:n)?r.a.createElement(se.a,null,t?r.a.createElement(E.Trans,{id:"Create"}):r.a.createElement(E.Trans,{id:"Save"})):null},be=a(1521),fe=a(20),pe=a(1385);function ge(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}var he=fe.a.propEq("language");function ve(){var e=Object(pe.a)(),t=Object(le.f)("translations").value,a=r.a.useCallback(function(e){return t&&t.find(he(e))},[t]),n=r.a.useCallback(function(e){return a(e)},[a]),c=r.a.useCallback(function(e,r){var c=a(e);return c||(t.push(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ge(a,!0).forEach(function(t){Object(M.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ge(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({language:e},r)),n(e))},[a,n,t]),i=r.a.useCallback(function(e){return!!a(e)},[a]);return{shouldLoadTranslation:r.a.useCallback(function(){return!(e.isDefaultLanguageSelected||i(e.currentLanguage))},[i,e]),findTranslation:a,hasTranslation:i,getTranslation:n,initTranslation:c}}var ye=Object(j.b)(function(e){var t=e.categoryId,a=e.isCreate,n=Object(pe.a)(),c=ve(),i=c.shouldLoadTranslation,l=c.initTranslation,o=n.currentLanguage,u=(0,Object(p.Jb)({language:o,categoryId:t},{fetchPolicy:"no-cache",skip:a||!i()}).getStash)(function(e){var t=e.category;return{nameLabel:t.nameLabel,internalNoteLabel:t.internalNoteLabel}});return r.a.useEffect(function(){u&&l(o,u)},[l,o,u]),null}),Oe=a(1571);function Ee(e){var t=e.isCreate,a=e.initialValues,n=e.loadCreateDefaults,c=e.loadUpdateValues,i=e.onCreate,l=e.onUpdate,o=e.createSuccessMessage,u=e.updateSuccessMessage,s=e.successRedirectPath,d=e.validationSchema,m=e.children,b=Object(Oe.a)({initialValues:a,validationSchema:d,onSubmit:t?i:l,loadValues:t?n:c,submitMessage:t?o:u,submitRedirectPath:s});return r.a.createElement(le.b,{xform:b},m)}function je(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function we(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?je(a,!0).forEach(function(t){Object(M.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):je(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var Ce=function(e){var t=e.isCreate,a=e.categoryId,n=e.categoryType,c=e.children,i=Object(pe.a)(),l=Object(_.a)().redirectToCategoryList,u=Object(le.c)(function(e){return{nameLabel:e.string().required(g.b._("Category name in default language must be entered."))}}),s=Object(p.r)(),d=Object(I.a)(s,1)[0],m=r.a.useCallback(function(){var e=Object(S.a)(L.a.mark(function e(t){var r;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d({categoryId:a,language:i.defaultLanguage},{fetchPolicy:"no-cache"});case 2:if(null!==(r=e.sent)){e.next=6;break}return l(),e.abrupt("return",t);case 6:return e.abrupt("return",we({},r.category,{itemType:n,origins:Object(F.a)(r.category.origins)}));case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[a,n,i.defaultLanguage,d,l]),b=Object(p.T)(),f=Object(I.a)(b,1)[0],h=r.a.useCallback(function(e,t){return f({categoryId:e,category:we({},xe(t),{translations:t.translations})})},[f]),v=r.a.useCallback(function(e){return h(a,e)},[a,h]),y=Object(p.Q)(),O=Object(I.a)(y,1)[0],E=r.a.useCallback(function(){var e=Object(S.a)(L.a.mark(function e(t){var a,r;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O({category:we({companyBranch:i.branchId,wareCategoryType:n},xe(t))});case 2:(a=e.sent)&&t.translations&&t.translations.length>0&&(r=a.createCategory.id,h(r,t));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[n,O,h,i]);return r.a.createElement(Ee,{isCreate:t,onCreate:E,onUpdate:v,initialValues:ke(n),loadUpdateValues:m,validationSchema:u,successRedirectPath:o.b},r.a.createElement(r.a.Fragment,null,r.a.createElement(ye,{categoryId:a,isCreate:t}),c))};function ke(e){return{id:"NEW",itemType:e,visible:!0,internalNoteLabel:"",pictogram:"",nameLabel:"",minCount:0,maxCount:0,recipes:[],origins:[],translations:[]}}function xe(e){return{nameLabel:e.nameLabel,internalNoteLabel:e.internalNoteLabel,enabled:e.visible,pictogram:e.pictogram,recipes:e.recipes.map(fe.b),minCount:e.minCount,maxCount:e.maxCount,orderOriginCategories:e.origins}}var Pe=a(1382),Te=a(1353),Re=a(49),Le=a(1411),Se=Object(j.b)(function(e){var t=e.fieldName,a=void 0===t?"id":t,n=e.mutationName,c=e.confirmText,i=e.onDelete,l=Object(le.d)(a),o=Object(de.a)([],n?[n]:[]),u=Object(Re.l)().history,s=Object(le.i)().isSubmitting;return o&&"NEW"!==l.value?r.a.createElement(Le.a,{type:"button",disabled:s,confirmText:c,onDelete:Object(S.a)(L.a.mark(function e(){return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(l.value);case 2:u.goBack();case 3:case"end":return e.stop()}},e)}))}):null}),Ie=a(1517),Ne=a(44);function De(){var e=Object(u.a)(["\n    grid-template-columns: "," 1fr ",";\n    grid-template-rows: auto auto auto auto;\n    grid-row-gap: ",";\n    grid-template-areas:\n      '. contentTopRight    contentTopRight'\n      '. contentPrimary     .'\n      '. contentSecondary   .'\n      '. contentBottomRight contentBottomRight'\n  "]);return De=function(){return e},e}var We=s.c.div.withConfig({displayName:"StyledFormLayoutGrid",componentId:"sc-1lamm5d-0"})(["display:grid;margin:-",";grid-column-gap:",";grid-template-columns:"," "," "," auto;grid-template-rows:"," auto 1fr auto ",";grid-template-areas:'. .              .                contentTopRight' '. contentPrimary contentSecondary contentTopRight' '. contentPrimary contentSecondary .' '. contentPrimary contentSecondary contentBottomRight' '. .              .                contentBottomRight';.contentPrimary{grid-area:contentPrimary;}.contentSecondary{grid-area:contentSecondary;}.contentTopRight{grid-area:contentTopRight;justify-self:end;align-self:start;}.contentBottomRight{grid-area:contentBottomRight;justify-self:end;align-self:end;}",";"],k.d.Middle,k.d.Middle,k.d.Middle,function(e){return e.primaryColumnWidth},function(e){return e.secondaryColumnWidth},k.d.Middle,k.d.Middle,Object(Ne.d)(De(),k.d.Middle,k.d.Middle,k.d.Middle)),_e=function(e){var t=e.contentPrimary,a=e.contentSecondary,n=e.contentTopRight,c=e.contentBottomRight,i=e.primaryColumnWidth,l=void 0===i?"1fr":i,o=e.secondaryColumnWidth,u=void 0===o?"0":o;return r.a.createElement(We,{primaryColumnWidth:l,secondaryColumnWidth:u},r.a.createElement("div",{className:"contentPrimary"},t),r.a.createElement("div",{className:"contentSecondary"},a),r.a.createElement("div",{className:"contentTopRight"},n),r.a.createElement("div",{className:"contentBottomRight"},c))},Me=a(1415),Be=a(1354),Ve=function(){var e=Object(p.Lb)(),t=e.data,a=e.loading;return r.a.createElement(Te.a,{label:g.b._("cat. origins"),labelWidth:7},r.a.createElement(Me.a,{fieldName:"origins",isLoading:a,options:t?t.origins:Be.a,getOptionLabel:fe.a.prop("code"),getOptionValue:fe.a.prop("enum")}))},Fe=a(1431),Ue=a(1555),qe=a(1357);function Ae(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function Ke(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ae(a,!0).forEach(function(t){Object(M.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ae(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var ze=function(){var e=Object(le.d)("pictogram");return Object(j.g)(function(){return r.a.createElement(qe.a,{value:e.value?{pictogram:e.value}:null,onChange:function(t){t&&e.setValue(t.pictogram)},options:Fe.pictograms.map(function(e){return{pictogram:e}}),getOptionValue:fe.a.prop("pictogram"),formatOptionLabel:function(e){var t=e.pictogram;return r.a.createElement(Ue.a,{pictogramId:t,fontSize:2})},components:{SingleValue:function(e){var t=e.data;return r.a.createElement(Ue.a,{pictogramId:t.pictogram,fontSize:4})}},styles:{container:function(e){return Ke({},e,{width:"8rem"})},menuList:function(e){return Ke({},e,{maxHeight:"35rem"})}},isClearable:!1,isSearchable:!1,minWidth:8})})},He=a(1381),Ge=a(1358),Qe=s.c.div.withConfig({displayName:"StyledMenuTranslationInput",componentId:"sc-1soh2vg-0"})(["position:relative;.original{font-size:0.9rem;padding:0.3rem 0;opacity:0.7;}.original img{width:1.5rem;margin:0 0.6rem;}.current-language{width:1.5rem;position:absolute;right:0.5rem;top:0.8rem;border:1px #aaa solid;box-sizing:content-box;}"]),Je=Object(j.b)(function(e){var t=e.fieldName,a=e.placeholder,n=Object(le.i)().isSubmitting,c=Object(le.e)(t),i=Object(I.a)(c,2),l=i[0],o=i[1],u=Object(pe.a)(),s=ve(),d=s.getTranslation,m=s.findTranslation,b=!u.isDefaultLanguageSelected,f=m(u.currentLanguage),p=b?f&&f[l.name]:l.value,h=o();return r.a.createElement(Qe,null,r.a.createElement(Ge.b,Object.assign({},h,{disabled:n,value:p||"",onChange:b?function(e){var t=e.target.value;d(u.currentLanguage)[l.name]=t}:h.onChange,inputFullWidth:!0,invalid:!b&&l.touched&&l.hasError,placeholder:a})),r.a.createElement("img",{className:"current-language",src:Object(Fe.getFlag)(u.currentLanguage),alt:"translation"}),b&&r.a.createElement("div",{className:"original",onClick:function(){return u.setLanguage(u.defaultLanguage)}},r.a.createElement("img",{src:Object(Fe.getFlag)(u.defaultLanguage),alt:"original text"}),l.value||r.a.createElement("i",null,g.b._("No text is filled"))))}),Xe=function(e){var t=e.fieldName,a=void 0===t?"internalNote":t,n=e.label,c=void 0===n?r.a.createElement(E.Trans,{id:"Internal note"}):n,i=e.placeholder,l=e.localized,o=void 0!==l&&l,u={fieldName:a,placeholder:i,fullWidth:!0};return r.a.createElement(Te.a,{label:c,labelWidth:7},o?r.a.createElement(Je,u):r.a.createElement(He.a,u))},Ye=a(1356),Ze=Object(s.c)(Ye.a).withConfig({displayName:"StyledLanguagePicker",componentId:"sc-1hgrqes-0"})(["transform:scale(2) translateY(0.5rem);transform-origin:right;height:2.5rem;"]),$e=Object(j.b)(function(){var e=Object(pe.a)();return r.a.createElement("div",null,r.a.createElement(Ze,{availableLanguages:e.supportedLanguages,selectedLanguage:e.currentLanguage,onChange:e.setLanguage,formatLanguage:fe.a.identity,arrowColor:k.a.greyMiddle}))}),et=a(2794);function tt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}var at=function(e){var t=e.fieldName,a=void 0===t?"nameLabel":t,n=e.localized,c=void 0!==n&&n,i=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?tt(a,!0).forEach(function(t){Object(M.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):tt(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({fieldName:a},Object(V.a)(e,["fieldName","localized"]));return r.a.createElement(Te.a,{icon:et.a,labelWidth:k.d.DefaultLabelWidth},c?r.a.createElement(Je,i):r.a.createElement(He.a,i))},nt=function(){var e=Object(p.R)(),t=Object(I.a)(e,1)[0];return r.a.createElement(_e,{primaryColumnWidth:"minmax(10rem, 45rem)",secondaryColumnWidth:"14rem",contentPrimary:r.a.createElement(Pe.a,null,r.a.createElement(at,{placeholder:g.b._("Category name"),localized:!0}),r.a.createElement(Xe,{placeholder:g.b._("Category internal note"),fieldName:"internalNoteLabel",localized:!0}),r.a.createElement(Ve,null),r.a.createElement(Te.a,null,r.a.createElement(Ie.a,{fieldName:"visible",label:g.b._("To show this category")}))),contentSecondary:r.a.createElement(ue,{isMain:!0},r.a.createElement(ze,null)),contentTopRight:r.a.createElement($e,null),contentBottomRight:r.a.createElement(Se,{mutationName:"destroyWareCategory",confirmText:g.b._("Remove this category?"),onDelete:function(e){return t({categoryId:e})}})})},rt=a(1656),ct=a(1520),it=a(176);function lt(){var e=Object(w.b)().settings;return Object(j.g)(function(){return e.branchId})}var ot=a(1566);function ut(e){var t=e.onAdd,a=e.addLabel,c=void 0===a?g.b._("Add"):a,i=e.addButtonText,l=void 0===i?g.b._("Add"):i,o=e.isLoading,u=void 0!==o&&o,s=Object(V.a)(e,["onAdd","addLabel","addButtonText","isLoading"]),d=Object(Re.n)(null),f=Object(I.a)(d,2),p=f[0],h=f[1],v=Object(n.useCallback)(function(){var e=p();null!==e&&(t(e),h(null))},[p,t,h]),y=Object(n.useCallback)(function(e){"Enter"===e.key&&v()},[v]),O=Object(n.useCallback)(function(e){h(e||null)},[h]);return r.a.createElement(b.a,{justify:"flex-start"},r.a.createElement(m.a,{fixedWidth:!0,width:"4rem",margin:"auto 0"},c),r.a.createElement(m.a,{fixedWidth:!0,width:"20rem",margin:"auto 0"},r.a.createElement(qe.a,Object.assign({value:p(),onChange:O,onKeyDown:y,isLoading:u,isMulti:!1,isClearable:!1,getOptionValue:fe.a.prop("id"),getOptionLabel:fe.a.propOr("","nameLabel")},s))),r.a.createElement(m.a,{fixedWidth:!0,width:"10rem",margin:"auto 0"},r.a.createElement(C.a,{text:l,disabled:null===p(),onClick:v})))}var st=[p.o.Delivery,p.o.Inhouse];function dt(){var e=r.a.useMemo(be.b,[]);return{priceTypes:st,priceTypeLabels:e}}function mt(){var e=Object(u.a)(["\n      cursor: move;\n    "]);return mt=function(){return e},e}var bt=s.c.div.withConfig({displayName:"StyledCategoryRecipesView",componentId:"sc-1g4q35k-0"})(["display:flex;flex-direction:column;height:calc(100% - 2rem);width:100%;& .fixed-row{flex:0 0 auto;}& .move-cell{","}"],Object(Ne.c)(mt())),ft=s.c.div.withConfig({displayName:"StyledFormStretchedRow",componentId:"sc-1g4q35k-1"})(["flex:1 1 0;margin:1rem 0 0 1rem;"]),pt=Object(H.a)(ft),gt=s.c.div.withConfig({displayName:"StyledRecipeRow",componentId:"sc-1g4q35k-2"})(["display:grid;grid-gap:1rem;grid-template-columns:","px 100px 3fr 1fr 1fr 50px;"],k.d.ButtonColumnWidthPx),ht=Object(H.b)(function(e){var t=e.recipe,a=e.onRemove,n=dt(),c=n.priceTypes,i=n.priceTypeLabels,l=c.map(function(e){var a=t.prices.find(fe.a.pathEq(["priceType","enum"],e));return r.a.createElement("div",{className:"move-cell",key:e},r.a.createElement(ct.a,null,i[e]),a?Object(it.g)(a.price.value,a.price.currency.code):r.a.createElement("i",null,g.b._("Not set").toLocaleLowerCase()))});return r.a.createElement(gt,null,r.a.createElement("div",null,r.a.createElement(ot.a,{onClick:a})),r.a.createElement("div",{className:"move-cell"},t.code),r.a.createElement("div",{className:"move-cell"},t.nameLabel,r.a.createElement(ct.a,null,t.internalNote||"")),l,r.a.createElement(B.a,null))}),vt=function(){var e=lt(),t=oe(),a=Object(p.Pb)({branchId:e,categoryType:t}),n=a.data,c=a.loading,i=Object(le.d)("recipes"),l=r.a.useCallback(function(){var e=Object(S.a)(L.a.mark(function e(t){var a,n;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.newIndex,n=t.oldIndex,a!==n){e.next=3;break}return e.abrupt("return");case 3:i.setValue(Object(H.d)(i.value,n,a));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[i]),o=fe.a.differenceWith(fe.a.eqProps("id")),u=Object(Ne.f)().isDesktop,s=Object(le.i)();return Object(j.g)(function(){return r.a.createElement(bt,null,r.a.createElement("div",{className:"fixed-row"},r.a.createElement(ut,{isLoading:c,isDisabled:s.isSubmitting,options:n?o(n.recipes,i.value):Be.a,onAdd:function(e){return i.value.push(e)},getOptionLabel:function(e){var t=e.nameLabel,a=e.code;return"".concat(a," - ").concat(t)}})),r.a.createElement(pt,{lockAxis:"y",lockToContainerEdges:!0,onSortEnd:l,useDragHandle:!u},r.a.createElement(rt.a,{items:i.value,heightStretch:!0,rowHeight:60,renderItem:function(e,t){return r.a.createElement(ht,{recipe:e,onRemove:function(){i.setValue(fe.a.reject(Object(fe.c)(e.id),i.value))},index:t})}})))})},yt=a(247),Ot=a.n(yt),Et=a(1387),jt=a(158),wt=a(1518);function Ct(){var e=Object(u.a)(["\n  display: flex;\n  align-items: center;\n  & > label {\n    min-width: 5rem;\n  }\n  & > * {\n    margin: 0.2rem 0.5rem;\n  }\n  input.count {\n    font-size: 1.5rem;\n    line-height: 1.5rem;\n    text-align: center;\n  }\n"]);return Ct=function(){return e},e}var kt=s.c.div(Ct()),xt=function(e){var t=e.count,a=e.label,n=e.enabled,c=e.onChange,i=e.id,l=r.a.useRef(t);return r.a.createElement(kt,null,r.a.createElement("label",{htmlFor:i},a),r.a.createElement(jt.a,{width:3},r.a.createElement(Ge.a,{id:i,value:0===t?"":t,onChange:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){e.target.validity.valid&&c(Number.parseInt(e.target.value,10))}),onFocus:function(e){e.target.select()},disabled:0===t||!n,inputFullWidth:!0,type:"tel",pattern:"^[1-9]\\d*$",className:"count"})),r.a.createElement(jt.a,{width:4},r.a.createElement(C.a,{disabled:!n||t<=0,onClick:function(){return c(t-1)}},"\u2796")),r.a.createElement(jt.a,{width:4},r.a.createElement(C.a,{disabled:!n,onClick:function(){return c(t+1)}},"\u2795")),r.a.createElement("div",null,r.a.createElement(wt.a,null,r.a.createElement("input",{type:"checkbox",id:"".concat(i,"-nolimit"),checked:0===t,disabled:!n,onChange:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){0===t?c(l.current||1):(l.current=t,c(0))})}),r.a.createElement("label",{htmlFor:"".concat(i,"-nolimit")},r.a.createElement(E.Trans,{id:"Unlimited"})))))},Pt=function(){return{noLimit:{label:g.b._("No limitation"),min:0,max:0},optional:{label:g.b._("One at most"),min:0,max:1},required:{label:g.b._("One at least"),min:1,max:0},onlyOne:{label:g.b._("Exactly one"),min:1,max:1},custom:{label:g.b._("Custom range")}}},Tt=Object(j.b)(function(){var e=r.a.useMemo(Pt,[]),t=Object(j.e)(function(){return{currentRule:"noLimit"}}),a=function(e){t.currentRule=e},n=Object(le.d)("minCount"),c=Object(le.d)("maxCount");return Object(Re.e)(function(){if("custom"!==t.currentRule){var r=Ot.a.findKey(e,function(e){var t=e.min,a=e.max;return t===n.value&&a===c.value});r&&a(r)}}),r.a.createElement(r.a.Fragment,null,r.a.createElement(Et.a,{items:Object.keys(e),formatItem:function(t){return e[t].label},onSingleSelection:function(t){if(t){a(t);var r=e[t];n.setValue(r.min||0),c.setValue(r.max||0)}},selectedItem:t.currentRule}),r.a.createElement(xt,{id:"minCount",count:n.value,label:r.a.createElement(E.Trans,{id:"Minimum"}),enabled:"custom"===t.currentRule,onChange:n.setValue}),r.a.createElement(xt,{id:"maxCount",count:c.value,label:r.a.createElement(E.Trans,{id:"Maximum"}),enabled:"custom"===t.currentRule,onChange:c.setValue}))}),Rt=s.c.div.withConfig({displayName:"FormContainer",componentId:"sc-154ix5u-0"})(["display:flex;flex-direction:column;height:100%;width:100%;"]),Lt=s.c.div.withConfig({displayName:"FormFixedRow",componentId:"sc-154ix5u-1"})(["flex:0 0 8rem;"]),St=s.c.div.withConfig({displayName:"FormStretchedRow",componentId:"sc-154ix5u-2"})(["flex:1 1 0;min-height:0;position:relative;"]),It=function(e){var t=e.match.params.categoryId,a=Object(_.a)(t),n=a.isCreate,c=a.itemType,i=a.redirectToCategoryList;return null===c?(i(),null):r.a.createElement(Ce,{isCreate:n,categoryId:t,categoryType:c},r.a.createElement(h.a,{pageTitle:Object(be.a)(c),hideLogoutWidget:!0,useBackButton:!0},r.a.createElement(v.a,{withScrollArea:!0},r.a.createElement(Rt,null,r.a.createElement(Lt,null,r.a.createElement(d.a,null,r.a.createElement(nt,null))),r.a.createElement(ue,{isSideDish:!0},r.a.createElement(Lt,null,r.a.createElement(d.a,null,r.a.createElement(D.a,null,r.a.createElement(E.Trans,{id:"Required amounts of recipes to be picked"})),r.a.createElement(Tt,null)))),r.a.createElement(St,null,r.a.createElement(d.a,{stretchToParent:!0,minHeight:25},r.a.createElement(D.a,null,r.a.createElement(E.Trans,{id:"Recipes assigned to this category"})),r.a.createElement(vt,null))))),r.a.createElement(ie,null,r.a.createElement(me,{isCreate:n,createMutation:"createWareCategory",updateMutation:"updateWareCategory"}))))},Nt=a(1524),Dt=a(437),Wt=a(1655),_t=Object(j.b)(function(e){var t=e.categoryType,a=e.currentCategories,n=e.addButtonText,c=e.onAdd,i=Object(w.b)().settings,l=Object(p.Kb)({branchId:i.branchId,categoryType:t}),o=l.data,u=l.loading,s=o&&o.categories||[],d=Object(le.i)().isSubmitting;return r.a.createElement(ut,{isLoading:u,isDisabled:d,options:fe.a.without(a,s),addButtonText:n,onAdd:c})}),Mt=function(e){var t=e.categoryType,a=e.addButtonText,n=e.noRowsText,c=e.fieldName,i=Object(le.d)(c);return Object(j.g)(function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Z,{categories:Array.from(i.value),showRemoveColumn:!0,showEditColumn:!1,showHeader:!1,noRowsDisplay:r.a.createElement(N.g,{text:n}),onRemove:function(e){return i.value.remove(i.value.find(Object(fe.c)(e)))}}),r.a.createElement(_t,{addButtonText:a,categoryType:t,currentCategories:Array.from(i.value),onAdd:function(e){return i.value.push(e)}}))})},Bt=a(65),Vt=a(256),Ft=Object(j.b)(function(e){var t=e.recipeId,a=e.isCreate,n=Object(pe.a)(),c=ve(),i=c.shouldLoadTranslation,l=c.initTranslation,o=n.currentLanguage,u=(0,Object(p.Ob)({language:o,recipeId:t},{fetchPolicy:"no-cache",skip:a||!i()}).getStash)(function(e){var t=e.recipe;return{nameLabel:t.nameLabel,descriptionLabel:t.descriptionLabel}});return r.a.useEffect(function(){u&&l(o,u)},[l,o,u]),null});function Ut(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function qt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ut(a,!0).forEach(function(t){Object(M.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ut(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var At=function(e){var t=e.isCreate,a=e.recipeId,n=e.recipeType,c=e.children,i=Object(pe.a)(),l=Object(_.a)().redirectToRecipeList,u=dt().priceTypeLabels,s=Object(le.c)(function(e){return{nameLabel:e.string().required(Object(Be.c)(g.b._("Recipe name in default language"))),code:e.string().required(Object(Be.c)(g.b._("Recipe code"))),prices:e.object(Ht(function(t){var a=u[t].toLocaleLowerCase(),n=g.b._("Recipe price for {priceType}",{priceType:a});return e.object({value:Object(Be.e)(n)})}))}}),d=Object(p.s)(),m=Object(I.a)(d,1)[0],b=r.a.useCallback(Object(S.a)(L.a.mark(function e(){var t;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m({branchId:i.branchId},{fetchPolicy:"cache-first"});case 2:if(null===(t=e.sent)){e.next=5;break}return e.abrupt("return",Qt(t.defaults));case 5:return e.abrupt("return");case 6:case"end":return e.stop()}},e)})),[i,m]),f=Object(p.t)(),h=Object(I.a)(f,1)[0],v=r.a.useCallback(Object(S.a)(L.a.mark(function e(){var t;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h({recipeId:a,language:i.defaultLanguage},{fetchPolicy:"no-cache"});case 2:if(null!==(t=e.sent)){e.next=6;break}return l(),e.abrupt("return");case 6:return e.abrupt("return",Jt(t.recipe));case 7:case"end":return e.stop()}},e)})),[i.defaultLanguage,h,a,l]),y=Object(p.X)(),O=Object(I.a)(y,1)[0],E=r.a.useCallback(function(e,t){return O({recipeId:e,recipe:qt({},Kt(t),{translations:t.translations,image:zt(t)})},Bt.disableBatching)},[O]),j=r.a.useCallback(function(e){return E(a,e)},[E,a]),w=Object(p.V)(),C=Object(I.a)(w,1)[0],k=r.a.useCallback(function(){var e=Object(S.a)(L.a.mark(function e(t){var a,r;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C({recipe:qt({},Kt(t),{companyBranch:i.branchId,wareCategoryType:n,image:t.image})},Bt.disableBatching);case 2:(a=e.sent)&&t.translations&&t.translations.length>0&&(r=a.recipe.id,E(r,t));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[C,E,i,n]);return r.a.createElement(Ee,{isCreate:t,onCreate:k,onUpdate:j,initialValues:Gt(n),loadCreateDefaults:b,loadUpdateValues:v,validationSchema:s,successRedirectPath:o.c},r.a.createElement(r.a.Fragment,null,c,r.a.createElement(Ft,{recipeId:a,isCreate:t})))};function Kt(e){return{code:e.code,nameLabel:e.nameLabel||"",internalNote:e.internalNote,descriptionLabel:e.descriptionLabel,enabled:e.visible,prices:Object.keys(e.prices).map(function(t){return{warePriceType:t,price:{value:Object(Vt.b)(e.prices[t].value)},vat:e.prices[t].vatId}}),sideDishCategories:e.sideDishes.map(fe.a.prop("id")),wareCategories:e.categories.map(fe.a.prop("id")),associatedRecipes:e.associatedRecipes.map(fe.a.pick(["associatedRecipe","warePriceType"])),ingredients:e.ingredients.map(function(e){var t=e.stockItem,a=e.quantity;return{stockItem:t,quantity:Object(Vt.b)(a)}})}}function zt(e){var t=e.image;return"string"===typeof t?null:null===t?{delete:!0}:{file:t,delete:!1}}function Ht(e){return st.reduce(function(t,a){return t[a]=e(a),t},{})}function Gt(e){return{id:"NEW",itemType:e,visible:!0,code:"",nameLabel:"",internalNote:"",internalCode:"",descriptionLabel:"",image:null,prices:Ht(function(){return{value:"0",vatId:null,currencyCode:""}}),associatedRecipes:[],ingredients:[],sideDishes:[],categories:[],translations:[]}}function Qt(e){var t=e.vats.reduce(function(e,t){var a=t.vatId;return e[t.priceType.enum]=a,e},{});return{prices:Ht(function(a){return{value:"0",vatId:t[a],currencyCode:e.currency.code}})}}function Jt(e){return qt({},e,{itemType:e.recipeType.enum,internalNote:e.internalNote||"",descriptionLabel:e.descriptionLabel||"",associatedRecipes:e.sourceAssociatedRecipes.map(function(e){var t=e.priceType,a=e.recipe;return{warePriceType:t.enum,nameLabel:a.nameLabel,associatedRecipe:a.id,formattedPrice:"?"}}),ingredients:e.sourceIngredients.map(function(e){var t=e.quantity,a=e.stockItem,n=a.id,r=a.label,c=a.allergens,i=a.wareUnit;return{stockItem:n,label:r,quantity:Object(it.f)(t),unitLabel:i.code,allergens:c.map(fe.a.prop("enum"))}}),prices:Ht(function(t){var a=e.sourcePrices.find(fe.a.pathEq(["priceType","enum"],t));return a?{value:Object(it.g)(a.price.value),vatId:a.vat.id,currencyCode:a.price.currency.code}:{value:"0",vatId:null,currencyCode:""}})})}var Xt=a(1491),Yt=a(1522),Zt=a(2797),$t=function(e){var t=e.fieldName,a=Object(V.a)(e,["fieldName"]);return r.a.createElement(Te.a,{icon:Zt.a},r.a.createElement(jt.a,{width:5},r.a.createElement(He.a,Object.assign({fieldName:t,fullWidth:!0},a))))},ea=function(e){var t=e.items,a=e.fieldName,n=e.isClearable,c=void 0!==n&&n,i=e.getItemId,l=void 0===i?fe.b:i,o=Object(le.d)(a),u=Object(le.i)();return Object(j.g)(function(){return r.a.createElement(Et.a,Object.assign({selectedItem:o.value&&t.find(function(e){return l(e)===o.value}),onSingleSelection:function(e){o.setValue(e?l(e):null),o.setTouched()},disabled:u.isSubmitting,isInvalid:o.hasError,isClearable:c,isMulti:!1},e))})},ta=function(e){var t=e.fieldName,a=lt(),n=Object(p.Sb)({branchId:a},{fetchPolicy:"cache-first"}).data;return n?r.a.createElement(Te.a,{label:"".concat(g.b._("VAT"),":")},r.a.createElement(ea,{fieldName:t,items:n.vats,formatItem:function(e){var t=e.vat;return"".concat(t,"%")}})):null};var aa=function(e){var t=e.recipes,a=e.onRemove;return r.a.createElement(N.f,{items:t,disableHeader:!0},r.a.createElement(N.a,{dataKey:"associatedRecipe",width:k.d.ButtonColumnWidthPx,minWidth:k.d.ButtonColumnWidthPx,cellRenderer:function(e){var t=e.cellData;return r.a.createElement(ot.a,{onClick:function(){return a(t)}})}}),r.a.createElement(N.a,{dataKey:"nameLabel",width:300,label:g.b._("Name"),cellRenderer:N.e,columnData:{noteKey:"internalNote"}}),r.a.createElement(N.a,{dataKey:"formattedPrice",width:100,label:g.b._("Price")}))},na=Object(j.b)(function(e){var t=e.priceType,a=Object(le.f)("associatedRecipes"),n=Object(le.f)("id").value,c=lt(),i=Object(p.Nb)({branchId:c}),l=i.data,o=i.loading,u=fe.a.propEq("warePriceType",t),s=fe.a.propEq("associatedRecipe"),d=fe.a.filter(u,a.value),m=r.a.useCallback(function(e){a.value.push({warePriceType:t,associatedRecipe:e.id,nameLabel:e.nameLabel,formattedPrice:"?"})},[t,a]),b=r.a.useCallback(function(e){a.value.remove(a.value.find(fe.a.both(s(e),u)))},[s,u,a.value]),f=Object(le.i)().isSubmitting;return r.a.createElement(r.a.Fragment,null,r.a.createElement(aa,{recipes:d,onRemove:b}),r.a.createElement(ut,{options:l?fe.a.reject(function(e){return e.id===n||(t=e.id,d.some(s(t)));var t},l.recipes):Be.a,onAdd:m,isLoading:o,isDisabled:f}))}),ra=Object(s.c)(Yt.a).withConfig({displayName:"FormPricingCurrencyCode",componentId:"sc-5x5h5x-0"})(["padding:0.5rem;"]),ca=function(){var e=dt(),t=e.priceTypes,a=e.priceTypeLabels;return r.a.createElement(r.a.Fragment,null,t.map(function(e){var t=["prices",e];return r.a.createElement(n.Fragment,{key:e},r.a.createElement(D.a,null,a[e]),r.a.createElement(Xt.a,null,r.a.createElement($t,{fieldName:[].concat(t,["value"])}),r.a.createElement(ra,{fieldName:[].concat(t,["currencyCode"])}),r.a.createElement(Dt.a,{left:5},r.a.createElement(ta,{fieldName:[].concat(t,["vatId"])}))),r.a.createElement(f.a,null),r.a.createElement(ue,{isMain:!0},r.a.createElement(na,{priceType:e}),r.a.createElement(f.a,null)))}))},ia=function(e){var t=e.placeholder;return r.a.createElement(Te.a,{label:r.a.createElement(E.Trans,{id:"Code"}),labelWidth:k.d.DefaultLabelWidth},r.a.createElement(jt.a,{width:9},r.a.createElement(He.a,{fieldName:"code",fullWidth:!0,placeholder:t})))},la=function(e){return r.a.createElement(Te.a,{label:g.b._("External ID"),labelWidth:7},r.a.createElement(He.a,{fieldName:"internalCode",disabled:!0}))},oa=function(e){var t=e.label;return r.a.createElement(Ie.a,{fieldName:"visible",label:t})},ua=a(2773);function sa(){var e=Object(u.a)(["\n  float: left;\n  width: 2.3rem;\n  height: 2.3rem;\n  border: 1px solid ",";\n  margin: 0.3rem 0.6rem 0.3rem ",";\n  font-size: 1.5rem;\n  text-align: center;\n  vertical-align: middle;\n  cursor: default;\n  color: ",";\n  background-color: ",";\n  &.active {\n    color: ",";\n    background-color: ",";\n  }\n"]);return sa=function(){return e},e}var da=s.c.div(sa(),k.a.greyMiddle,k.d.MarginAroundFormComponents,k.a.greyMiddle,k.a.white,k.a.black,k.a.yellow),ma=function(e){var t=e.selected,a=e.onToggle,n=Object(p.Hb)({},{fetchPolicy:"cache-first"}),c=n.data;return n.loading||!c?null:r.a.createElement(r.a.Fragment,null,c.allergens.map(function(e){return r.a.createElement(da,{key:e.enum,title:e.code,className:Object(Ye.b)({active:t.includes(e.enum)}),onClick:a&&function(){return a(e.enum)}},e.category)}))},ba=s.c.div.withConfig({displayName:"StyledAllergenLabel",componentId:"sc-1bpzlke-0"})(["margin:0.7rem 0 0 0.2rem;"]),fa=Object(j.b)(function(){var e=Object(le.f)("ingredients"),t=fe.a.uniq(fe.a.flatten(fe.a.map(fe.a.prop("allergens"),e.value)));return r.a.createElement(Te.a,{labelWidth:k.d.DefaultLabelWidth,icon:ua.a},r.a.createElement(ba,null,r.a.createElement(E.Trans,{id:"Allergens based on stock cards"})),r.a.createElement(ma,{selected:t}))}),pa=function(){return r.a.createElement(Te.a,{label:r.a.createElement(E.Trans,{id:"Public note"}),labelWidth:k.d.DefaultLabelWidth},r.a.createElement(Je,{fieldName:"descriptionLabel",placeholder:g.b._("Public note for customers, allergens")}))},ga=a(2784),ha=a(254),va=(a(2781),a(1349)),ya=a(2789),Oa=a(1337),Ea=a(1338),ja=a(2782),wa=a.n(ja),Ca=function(e){var t=e.image,a=e.onConfirm,n=e.onCancel,c=r.a.useState({unit:"%",width:50,aspect:1}),i=Object(I.a)(c,2),l=i[0],o=i[1],u=r.a.useCallback(function(e){o(e)},[]),s=r.a.useRef(),d=r.a.useCallback(function(){s.current&&function(e,t){var a=document.createElement("canvas"),n=e.naturalWidth/e.width,r=e.naturalHeight/e.height;return a.width=t.width,a.height=t.height,a.getContext("2d").drawImage(e,t.x*n,t.y*r,t.width*n,t.height*r,0,0,t.width,t.height),new Promise(function(e,t){a.toBlob(function(a){a?e(a):t(new Error("Canvas is empty"))},"image/jpeg")})}(s.current,l).then(a)},[l,a]),m=r.a.useCallback(function(e){s.current=e},[]),b=r.a.useMemo(function(){return URL.createObjectURL(t)},[t]);return r.a.useEffect(function(){return function(){URL.revokeObjectURL(b)}},[b]),r.a.useEffect(function(){return function(){s.current=void 0}},[]),r.a.createElement(va.a,{open:!0,fullWidth:!0},r.a.createElement(ya.a,null,r.a.createElement(E.Trans,{id:"Choose the most significant part of the image"})),r.a.createElement(Oa.a,null,r.a.createElement(wa.a,{src:b,crop:l,onChange:u,onImageLoaded:m,keepSelection:!0,ruleOfThirds:!0,imageStyle:{width:"100%"}})),r.a.createElement(Ea.a,null,r.a.createElement(C.a,{onClick:n},r.a.createElement(E.Trans,{id:"Cancel"})),r.a.createElement(C.a,{onClick:d,color:k.a.green},r.a.createElement(E.Trans,{id:"Confirm"}))))};var ka=s.c.div.withConfig({displayName:"StyledRecipeImageUploader",componentId:"sc-1fnjy10-0"})(["border:1px dotted ",";background:",";color:",";width:16rem;height:16rem;cursor:pointer;& section{height:100%;width:100%;}& div.container{height:100%;width:100%;padding:0.4rem;}& img{height:100%;width:100%;object-fit:contain;}& div.hint{margin:6rem 0;text-align:center;}& .delete-button{position:relative;top:",";left:12.5rem;}"],k.a.greyMiddle,k.a.white,k.a.greyMiddle,"-".concat(k.d.ButtonHeight).concat(k.d.DefaultSizeUnit)),xa=Object(j.b)(function(){var e=Object(ha.a)().enqueueWarning,t=Object(le.i)().isSubmitting,a=r.a.useState(),n=Object(I.a)(a,2),c=n[0],i=n[1],l=Object(ga.a)({disabled:t,accept:"image/*",multiple:!1,onDropAccepted:function(e){var t=Object(I.a)(e,1)[0];i(t)},onDropRejected:function(){e(g.b._("Supplied file is not recognized as image."))}}),o=l.isDragActive,u=l.getRootProps,s=l.getInputProps,d=Object(le.d)("image"),m=r.a.useMemo(function(){var e=d.value;return null===e?null:"string"!==typeof d.value?URL.createObjectURL(e):d.value},[d.value]);return r.a.useEffect(function(){return function(){m&&URL.revokeObjectURL(m)}},[m]),r.a.createElement(ka,null,r.a.createElement("section",null,r.a.createElement("div",Object.assign({className:"container"},u()),r.a.createElement("input",s()),m&&r.a.createElement("img",{src:m,alt:""}),null===m&&r.a.createElement("div",{className:"hint"},o?r.a.createElement(E.Trans,{id:"Drop the image here ..."}):r.a.createElement(E.Trans,{id:"Click to select image or drop it here"})))),m&&r.a.createElement(Le.a,{type:"button",disabled:t,onDelete:Object(S.a)(L.a.mark(function e(){return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:d.setValue(null);case 1:case"end":return e.stop()}},e)}))}),c&&r.a.createElement(Ca,{image:c,onConfirm:function(e){i(null),d.setValue(e)},onCancel:function(){i(null)}}))}),Pa=function(e){var t=e.isCreate,a=Object(p.W)(),n=Object(I.a)(a,1)[0];return r.a.createElement(_e,{primaryColumnWidth:"minmax(24rem, 54rem)",secondaryColumnWidth:"minmax(12rem, 30rem)",contentPrimary:r.a.createElement(Pe.a,null,r.a.createElement(ia,{placeholder:g.b._("Recipe code")}),r.a.createElement(at,{placeholder:g.b._("Recipe name"),localized:!0}),r.a.createElement(ue,{isMain:!0},r.a.createElement(pa,null)),r.a.createElement(Xe,{placeholder:g.b._("Recipe internal note")}),!t&&r.a.createElement(la,null),r.a.createElement(ue,{isMain:!0},r.a.createElement(fa,null)),r.a.createElement(Te.a,{labelWidth:k.d.DefaultLabelWidth},r.a.createElement(oa,{label:g.b._("To show this recipe")}))),contentSecondary:r.a.createElement(xa,null),contentTopRight:r.a.createElement($e,null),contentBottomRight:r.a.createElement(Se,{mutationName:"destroyRecipe",confirmText:g.b._("Remove this recipe?"),onDelete:function(e){return n({recipeId:e})}})})},Ta=function(e){var t=e.ingredients,a=e.onRemove,n=e.isLoading,c=void 0!==n&&n;return r.a.createElement(N.f,{isLoading:c,items:t,disableHeader:!0,noRowsRenderer:function(){return r.a.createElement(N.g,{text:g.b._("Recipe has no ingredients")})}},r.a.createElement(N.a,{dataKey:"stockItem",width:k.d.ButtonColumnWidthPx,minWidth:k.d.ButtonColumnWidthPx,cellRenderer:N.c,columnData:{onRemove:a}}),r.a.createElement(N.a,{dataKey:"label",width:300,label:g.b._("Name")}),r.a.createElement(N.a,{dataKey:"quantity",width:60,label:g.b._("Quantity"),cellRenderer:function(e){var t=e.rowIndex;return r.a.createElement(jt.a,{width:2.5},r.a.createElement(He.a,{fieldName:["ingredients",String(t),"quantity"],fullWidth:!0}))}}),r.a.createElement(N.a,{dataKey:"unitLabel",width:100,label:g.b._("Ware unit")}))},Ra=fe.a.differenceWith(function(e,t){return e.id===t.stockItem}),La=Object(j.b)(function(e){var t=e.ingredients,a=e.onAdd,n=e.onRemove,c=lt(),i=Object(p.Rb)({branchId:c}),l=i.data,o=i.loading,u=Object(le.i)().isSubmitting;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ta,{ingredients:t,onRemove:n}),r.a.createElement(ut,{isLoading:o,isDisabled:u,addButtonText:g.b._("Add ingredient"),options:l?Ra(l.stockItems,t):Be.a,onAdd:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){a({stockItem:e.id,label:e.nameLabel,quantity:"1",unitLabel:e.wareUnit.code,allergens:e.allergens.map(fe.a.prop("enum"))})})}))}),Sa=function(){var e=Object(le.d)("ingredients");return Object(j.g)(function(){return r.a.createElement(La,{ingredients:e.value,onAdd:function(t){e.value.push(t)},onRemove:function(t){e.value.splice(e.value.findIndex(fe.a.propEq("stockItem",t)),1)}})})},Ia=function(e){var t=e.match.params.recipeId,a=Object(_.a)(t),n=a.isCreate,c=a.itemType,i=a.redirectToRecipeList;return null===c?(i(),null):r.a.createElement(At,{isCreate:n,recipeId:t,recipeType:c},r.a.createElement(Dt.a,{right:1.25,bottom:4},r.a.createElement(h.a,{pageTitle:Object(be.c)(c),hideLogoutWidget:!0,useBackButton:!0},r.a.createElement(d.a,null,r.a.createElement(Pa,{isCreate:n})),r.a.createElement(d.a,null,r.a.createElement(ca,null)),r.a.createElement(d.a,null,r.a.createElement(D.a,null,r.a.createElement(E.Trans,{id:"Recipe ingredients"})),r.a.createElement(f.a,null),r.a.createElement(Sa,null)),r.a.createElement(ue,{isMain:!0},r.a.createElement(d.a,null,r.a.createElement(D.a,null,r.a.createElement(E.Trans,{id:"Sidedish categories"})),r.a.createElement(ct.a,null,r.a.createElement(E.Trans,{id:"These sidedish are presented with recipe"})),r.a.createElement(Mt,{fieldName:"sideDishes",categoryType:Wt.a.SideDish,addButtonText:g.b._("Attach sidedish category"),noRowsText:g.b._("Recipe has no sidedish category attached")})),r.a.createElement(d.a,null,r.a.createElement(D.a,null,r.a.createElement(E.Trans,{id:"Category assignments"})),r.a.createElement(ct.a,null,r.a.createElement(E.Trans,{id:"Recipe is in these categories"})),r.a.createElement(Mt,{fieldName:"categories",categoryType:Wt.a.Main,addButtonText:g.b._("Add to category"),noRowsText:g.b._("Recipe is not in any category")})))),r.a.createElement(ie,null,r.a.createElement(me,{isCreate:n,createMutation:"createRecipe",updateMutation:"updateRecipe"}))))},Na=a(1363),Da=a(1653),Wa=a(1383);function _a(){var e=Object(u.a)(["\n  [aria-label='grid']:focus {\n    outline: none;\n  }\n\n  [role='columnheader'] {\n    display: flex;\n    align-items: center;\n    overflow: hidden;\n  }\n"]);return _a=function(){return e},e}var Ma=Object(s.c)(N.f)(_a()),Ba=Object(j.b)(function(e){var t=e.stockItems,a=e.isLoading;return r.a.createElement(Ma,{items:t,heightStretch:!0,noRowsRenderer:function(){return a?r.a.createElement(Wa.a,null):r.a.createElement("h3",null,r.a.createElement(E.Trans,{id:"Selected branch has no stock cards"}))}},r.a.createElement(N.a,{dataKey:"id",width:k.d.ButtonColumnWidthPx,minWidth:k.d.ButtonColumnWidthPx,cellRenderer:Object(N.h)({canQuery:"stockItem"},N.b)}),r.a.createElement(N.a,{dataKey:"code",width:100,label:g.b._("Card code")}),r.a.createElement(N.a,{dataKey:"nameLabel",width:300,minWidth:30,flexGrow:2,label:g.b._("Card name")}),r.a.createElement(N.a,{dataKey:"quantity",width:100,label:g.b._("Card stock"),cellRenderer:Va}),r.a.createElement(N.a,{dataKey:"allowNegativeValue",width:300,label:g.b._("Negative stock"),cellRenderer:Fa}),r.a.createElement(N.a,{dataKey:"note",width:300,label:g.b._("Card note")}))});function Va(e){var t=e.cellData,a=e.rowData;return"".concat(t," ").concat(a.wareUnit.code)}function Fa(e){return!0===e.cellData?r.a.createElement(E.Trans,{id:"Permitted"}):r.a.createElement(E.Trans,{id:"Forbidden"})}var Ua=Object(j.b)(function(){var e=Object(pe.a)(),t=Object(p.Rb)({branchId:e.branchId}),a=t.data,n=t.loading,c=e.filter.getPredicate({partialMatch:["code","nameLabel"],exactMatch:["plu"]}),i=a?a.stockItems.filter(c):Be.a;return r.a.createElement(Ba,{stockItems:i,isLoading:n})}),qa=function(){var e=Object(_.a)().getStockCreateRoute;return r.a.createElement(h.a,{pageTitle:g.b._("Stock overview"),useBackButton:!0},r.a.createElement(v.a,{forcePercentHeightInMobile:100},r.a.createElement(d.a,{stretchToParent:!0},r.a.createElement(Nt.b,null,r.a.createElement("div",{className:"filter"},r.a.createElement(b.a,{justify:"start",flexWrap:"wrap"},r.a.createElement(m.a,null,r.a.createElement(y.a,{width:20})),r.a.createElement(m.a,null,r.a.createElement(Da.a,null))),r.a.createElement(Na.a,{mutationName:"createStockItem"},r.a.createElement(W.a,{routeTo:e()}))),r.a.createElement("div",{className:"table"},r.a.createElement(Ua,null))))))},Aa=a(1414);function Ka(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function za(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ka(a,!0).forEach(function(t){Object(M.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ka(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var Ha=function(e){var t=e.stockId,a=e.isCreate,n=e.children,c=Object(pe.a)(),i=Object(_.a)().redirectToStockList,l=Object(le.c)(function(e){return{code:e.string().required(),nameLabel:e.string().required(),wareUnit:e.string().required(),ingredients:e.array().of(e.object({quantity:e.string().required()}))}}),u=Object(p.u)(),s=Object(I.a)(u,1)[0],d=r.a.useCallback(function(){var e=Object(S.a)(L.a.mark(function e(t){var a;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s({branchId:c.branchId});case 2:if(null!==(a=e.sent)){e.next=5;break}return e.abrupt("return",t);case 5:return e.abrupt("return",za({},t,{},{allowNegativeDefault:Ga(a.defaults.allowNegative)}));case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[c,s]),m=Object(p.v)(),b=Object(I.a)(m,1)[0],f=r.a.useCallback(function(){var e=Object(S.a)(L.a.mark(function e(a){var n;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b({stockId:t},{fetchPolicy:"no-cache"});case 2:if(null!==(n=e.sent)){e.next=6;break}return i(),e.abrupt("return",a);case 6:return e.abrupt("return",za({},{id:(r=n.stockItem).id,internalNote:"TBD",nameLabel:r.nameLabel,code:r.code,note:r.note,plu:r.plu||"",wareUnit:r.wareUnit.enum,quantity:r.quantity,allergens:r.allergens.map(fe.a.prop("enum")),allowNegative:r.allowNegative,allowNegativeDefault:Ga(r.companyBranch.allowNegative)}));case 7:case"end":return e.stop()}var r},e)}));return function(t){return e.apply(this,arguments)}}(),[b,i,t]),g=Object(p.Z)(),h=Object(I.a)(g,1)[0],v=r.a.useCallback(function(e){return h({stockItem:za({companyBranch:c.branchId},Qa(e))})},[h,c]),y=Object(p.cb)(),O=Object(I.a)(y,1)[0],E=r.a.useCallback(function(e){return O({stockId:t,stockItem:Qa(e)})},[t,O]);return r.a.createElement(Ee,{isCreate:a,onCreate:v,onUpdate:E,initialValues:{id:"NEW",internalNote:"",nameLabel:"",code:"",plu:"",note:"",wareUnit:null,quantity:0,allergens:[],allowNegative:p.c.Default,allowNegativeDefault:p.c.Default},loadCreateDefaults:d,loadUpdateValues:f,validationSchema:l,successRedirectPath:o.d},n)};function Ga(e){return e?p.c.Default:p.c.Disabled}function Qa(e){return{code:e.code,label:e.nameLabel,note:e.note,plu:e.plu,allergens:e.allergens,wareUnit:e.wareUnit,allowNegative:e.allowNegative}}var Ja=function(){var e=Object(le.d)("allergens"),t=r.a.useCallback(function(t){var a=e.value;a.includes(t)?e.setValue(fe.a.without([t],a)):e.setValue([].concat(Object(F.a)(a),[t]))},[e]);return Object(j.g)(function(){return r.a.createElement(Te.a,{icon:ua.a,labelWidth:7},r.a.createElement(ma,{selected:e.value,onToggle:t}))})},Xa=a(377),Ya=[{type:p.c.Enabled,label:Object(Xa.i18nMark)("Permit")},{type:p.c.Disabled,label:Object(Xa.i18nMark)("Forbid")}],Za=Object(j.b)(function(){var e=Object(le.i)().values.allowNegativeDefault;return r.a.createElement(Te.a,{label:g.b._("Negative stock"),labelWidth:7},r.a.createElement(ea,{items:Ya,fieldName:"allowNegative",getItemId:fe.a.prop("type"),formatItem:function(t){return t.type===e?r.a.createElement("span",null,g.b._(t.label),r.a.createElement("i",null," (".concat(g.b._("Is default setting").toLocaleLowerCase(),")"))):g.b._(t.label)}}))}),$a=a(2798),en=function(){return r.a.createElement(Te.a,{icon:$a.a,labelWidth:7},r.a.createElement(jt.a,{width:9},r.a.createElement(He.a,{fieldName:"plu",fullWidth:!0,placeholder:g.b._("PLU")})))},tn=a(2799),an=a(1572),nn=function(){var e=Object(p.Tb)(),t=e.data,a=e.loading;return r.a.createElement(Te.a,{icon:tn.a,labelWidth:7},r.a.createElement(an.a,{fieldName:"wareUnit",isLoading:a,options:t?t.wareUnits:Be.a,getOptionLabel:fe.a.prop("code"),getOptionValue:fe.a.prop("enum"),placeholder:g.b._("Choose unit"),width:12}))},rn=function(){var e=Object(p.ab)(),t=Object(I.a)(e,1)[0];return r.a.createElement(_e,{primaryColumnWidth:"minmax(10rem, 54rem)",contentPrimary:r.a.createElement(Pe.a,null,r.a.createElement(at,{placeholder:g.b._("Card name")}),r.a.createElement(ia,{placeholder:g.b._("Card code")}),r.a.createElement(nn,null),r.a.createElement(en,null),r.a.createElement(Xe,{fieldName:"note",placeholder:g.b._("Card note"),label:g.b._("Card note")}),r.a.createElement(Ja,null),r.a.createElement(Za,null)),contentBottomRight:r.a.createElement(Se,{mutationName:"destroyStockItem",confirmText:g.b._("Remove this card?"),onDelete:function(e){return t({stockId:e})}})})},cn=a(1513),ln=function(e){var t=e.stockId,a=Object(p.oc)({stockId:t}),n=a.getStash;if(a.loading)return r.a.createElement(cn.a,null);var c=n(function(e){return e.stockItem.ingredients});return c&&0!==c.length?r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a,null,r.a.createElement(E.Trans,{id:"Recipes using this card"})),r.a.createElement(N.f,{items:Object(F.a)(c),disableHeader:!0,fullHeight:!0},r.a.createElement(N.a,{dataKey:"",cellDataGetter:function(e){var t=e.rowData;return{pathname:"".concat(o.c,"/").concat(t.recipe.id),state:{recipeType:t.recipe.recipeType.enum}}},cellRenderer:N.b,width:100}),r.a.createElement(N.a,{dataKey:"recipe",width:300,label:g.b._("Name"),cellRenderer:function(e){var t=e.rowData;return r.a.createElement(r.a.Fragment,null,t.recipe.nameLabel,r.a.createElement(ct.a,null,t.recipe.descriptionLabel))}}))):r.a.createElement(D.a,null,r.a.createElement(E.Trans,{id:"No recipes are using stock card"}))},on=function(e){var t=e.match.params.stockId,a=Object(_.a)(t).isCreate;return r.a.createElement(h.a,{pageTitle:g.b._("Stock card"),hideLogoutWidget:!0,useBackButton:!0},r.a.createElement(Ha,{isCreate:a,stockId:t},r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,null,r.a.createElement(rn,null),!a&&r.a.createElement(Aa.a,{queryName:"recipes"},r.a.createElement(ln,{stockId:t}))),r.a.createElement(ie,null,r.a.createElement(me,{isCreate:a,createMutation:"createStockItem",updateMutation:"updateStockItem"})))))};a.d(t,"MenuRouting",function(){return un});var un=function(){return r.a.createElement(c.e,null,r.a.createElement(l.a,{path:"".concat(o.b,"/:categoryId"),component:It}),r.a.createElement(l.a,{path:o.b,component:re}),r.a.createElement(l.a,{path:"".concat(o.c,"/:recipeId"),component:Ia}),r.a.createElement(l.a,{path:o.c,component:Nt.a}),r.a.createElement(l.a,{path:"".concat(o.d,"/:stockId"),component:on}),r.a.createElement(l.a,{path:o.d,component:qa}),r.a.createElement(c.b,{to:o.b,from:o.a}),r.a.createElement(c.c,{component:i.a}))};t.default=un}}]);
//# sourceMappingURL=380.1df86222.chunk.js.map