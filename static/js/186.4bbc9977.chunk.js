(window.webpackJsonpspeedlo=window.webpackJsonpspeedlo||[]).push([[186],{1456:function(e,n,t){"use strict";t.d(n,"a",function(){return u});var r=t(64),a=t(0),o=t.n(a),c=t(1454),i=t(1462),u=Object(r.b)(function(e){var n=e.mutationName,t=e.children;return Object(c.b)(n)?o.a.createElement(o.a.Fragment,null,t):o.a.createElement(i.a,null,"No access to mutation ".concat(n))})},1465:function(e,n,t){"use strict";t.d(n,"a",function(){return b});var r=t(4),a=t(24),o=t(0),c=t.n(o),i=t(58),u=t(1503),l=t(140),d=t(20);function f(){var e=Object(r.a)(["\n    margin: 0;\n    grid-row: "," ;\n    grid-column: span 16;\n    height: "," ;\n    position: relative;\n  "]);return f=function(){return e},e}function s(){var e=Object(r.a)(["\n  position: fixed;\n  bottom: 0.5rem;\n  width: ",";\n  left: ",";\n  top: ",";"]);return s=function(){return e},e}var m=a.c.div.withConfig({displayName:"StyledPageLayoutFullHeightItem",componentId:"sc-1mean6j-0"})([""," ",""],Object(i.c)(s(),function(e){return void 0!==e.widthInColumns?"calc(("+e.widthInColumns+" * 6.22vw) - "+d.d.LayoutGridCellMargin+")":"calc(100vh - (2 * "+d.d.LayoutGridCellMargin+"))"},function(e){return void 0!==e.column?"calc(("+e.column+" * 6.22vw) + "+d.d.LayoutGridCellMargin+")":d.d.LayoutGridCellMargin},function(e){return void 0!==e.row?"calc(("+e.row+" * 3.9375rem) + "+d.d.LayoutGridCellMargin+")":"calc(3.9375rem + "+d.d.LayoutGridCellMargin+")"}),Object(i.d)(f(),function(e){return e.rowInMobile},function(e){var n=e.forcePercentHeightInMobile;return n?"calc(".concat(n,"vh - ").concat(d.d.PageHeaderHeight+.25+d.d.DefaultSizeUnit,")"):"unset"})),b=function(e){var n=e.children,t=e.row,r=void 0===t?1:t,a=e.rowInMobile,o=void 0===a?16:a,d=e.column,f=void 0===d?0:d,s=e.widthInColumns,b=void 0===s?16:s,v=e.withScrollArea,p=void 0!==v&&v,h=e.scrollAreaId,g=e.forcePercentHeightInMobile,E=Object(i.f)().isMobile;return c.a.createElement(m,{column:f,row:r,rowInMobile:o,widthInColumns:b,withScrollArea:p,forcePercentHeightInMobile:g},p&&!E?c.a.createElement(u.a,{id:h},n):c.a.createElement(l.a,{height:100,heightUnit:"%"},n))}},1467:function(e,n,t){"use strict";t.d(n,"a",function(){return o});var r=t(4);function a(){var e=Object(r.a)(["\n  display: flex;\n  flex-direction: row;\n  flex-wrap: ",";\n  justify-content: ",";\n"]);return a=function(){return e},e}var o=t(24).c.div(a(),function(e){var n=e.flexWrap;return void 0===n?"unset":n},function(e){var n=e.justify;return void 0===n?"space-between":n})},1468:function(e,n,t){"use strict";t.d(n,"a",function(){return o});var r=t(4);function a(){var e=Object(r.a)(["\n  flex: ",";\n  padding: ",";\n  margin: ",";\n"]);return a=function(){return e},e}var o=t(24).c.div(a(),function(e){var n=e.fixedWidth,t=void 0!==n&&n,r=e.width,a=e.widthGrowIndex,o=void 0===a?0:a;return t?r?"0 0 ".concat(r):"0 0":"".concat(o," 0")},function(e){var n=e.padding;return void 0===n?"0.25rem":n},function(e){var n=e.margin;return void 0===n?"":n})},1495:function(e,n,t){"use strict";t.d(n,"a",function(){return o});var r=t(4);function a(){var e=Object(r.a)(["\n  height: ",";\n"]);return a=function(){return e},e}var o=t(24).c.div(a(),function(e){var n=e.size,t=void 0===n?1:n,r=e.sizeUnit,a=void 0===r?"rem":r;return"".concat(t).concat(a)});o.displayName="VerticalGap"},1503:function(e,n,t){"use strict";t.d(n,"a",function(){return o});var r=t(4);function a(){var e=Object(r.a)(["\n  overflow-y: auto;\n  -webkit-overflow-scrolling: touch;\n  height: 100%;\n"]);return a=function(){return e},e}var o=t(24).c.div(a())},1523:function(e,n,t){"use strict";t.d(n,"a",function(){return d});var r=t(21),a=t(1826),o=t(0),c=t.n(o),i=t(332),u=t(20),l=t(139),d=function(e){var n=e.onDelete,t=e.confirmText,o=Object(r.a)(e,["onDelete","confirmText"]);return c.a.createElement(i.a,null,c.a.createElement(l.a,Object.assign({icon:a.a,color:u.a.greyMiddle,onClick:function(e){e.preventDefault(),t&&!window.confirm(t)||n()}},o)))}},1532:function(e,n,t){"use strict";t.d(n,"a",function(){return o}),t.d(n,"c",function(){return c}),t.d(n,"b",function(){return i});var r=t(1527),a=t(46);function o(e){return!e.errors||0===Object.keys(e.errors).length}function c(e){return function(n){return Object(r.isEmpty)(n+"")?a.b._("{fieldName} must be entered",{fieldName:e}):null}}function i(e){return"number"===typeof e?e:Number.parseFloat(e.replace(",","."))}},1563:function(e,n,t){"use strict";t.d(n,"a",function(){return m}),t.d(n,"b",function(){return b});var r=t(102),a=t(1525),o=t(77),c=t(64),i=t(0),u=t.n(i),l=t(70),d=t(20),f=t(60),s=(u.a.createContext(null),["places"]),m=function(e){var n=e.model,t=e.children,i={streetViewControl:!1,mapTypeControl:!1,fullscreenControl:!1},m=Object(f.b)().user,b=Object(a.e)({id:"script-loader",version:"weekly",googleMapsApiKey:l.a.googleMapsApi,libraries:s,language:m.language}),v=b.isLoaded,p=b.loadError,h=b.url,g=Reflect.has(window,"google");return p||v&&!g?(o.a.withScope(function(e){e.setExtras({googleMapUrl:h}),o.a.captureException(p)}),u.a.createElement("h2",null,u.a.createElement(r.Trans,{id:"Cannot load map right now. Please try again later."}))):v?u.a.createElement(c.a,null,function(){return u.a.createElement(a.a,{zoom:n.zoom,center:n.center,onCenterChanged:n.updatePosition,onZoomChanged:n.updateZoom,onLoad:n.setMapRef,options:i,mapContainerStyle:{borderRadius:d.c.Card,overflow:"hidden",height:"100%"}},t)}):null};function b(){var e=Object(a.d)();if(!e)throw new Error("Trying to useGoogleMap, but BaseMap is missing in the tree");return e}},1639:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t(4),a=t(24),o=t(20);function c(){var e=Object(r.a)(["\n  color: ",";\n  font-weight: lighter;\n  font-size: 1.2rem;\n  margin: 0.8rem 0 0.8rem 0.3rem;\n"]);return c=function(){return e},e}var i=a.c.h2(c(),o.a.greyLight)},1643:function(e,n,t){"use strict";t.d(n,"a",function(){return s});var r=t(4),a=t(2862),o=t(0),c=t.n(o),i=t(1567),u=t(24),l=t(177);function d(){var e=Object(r.a)(["\n  padding: 1rem 0.4rem;\n  cursor: grab;\n"]);return d=function(){return e},e}var f=u.c.div(d()),s=Object(i.c)(function(){return c.a.createElement(f,null,c.a.createElement(l.a,{icon:a.a}))})},1651:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(0),a=function(e){var n=e.isShow,t=e.confirmText,a=e.onCancel,o=e.onConfirm;return Object(r.useEffect)(function(){n&&(window.confirm(t)?o():a())},[t,n,a,o]),null}},1797:function(e,n,t){"use strict";t.d(n,"a",function(){return d});var r=t(21),a=t(47),o=t(0),c=t.n(o),i=t(60),u=t(1457),l=t(46),d=function(e){var n=e.brands,t=e.selectedBrand,o=e.onSelection,d=Object(r.a)(e,["brands","selectedBrand","onSelection"]),f=Object(i.b)().user;return c.a.createElement(u.a,Object.assign({placeholder:l.b._("Select brand"),options:n||f.brands,value:t,formatOptionLabel:a.RM.prop("name"),getOptionValue:a.RM.prop("id"),getOptionLabel:a.RM.prop("name"),isClearable:!0,isSearchable:!0,onChange:function(e){return o(e)},autoFocus:!0},d))}},2866:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),o=t(68),c=t(201),i=t(333),u=t(46),l=t(1465),d=t(338),f=t(36),s=t.n(f),m=t(81),b=t(88),v=t(4),p=t(57),h=t(1459),g=t(361),E=t(24),O=t(1456),j=t(198),y=t(1651),w=t(339),C=t(60),k=t(72),P=t(51),x=t(42),z=t(200),I=t(1523),B=t(20);function F(){return Object(p.m)().match.params.zoneId}function M(){var e=Object(C.b)(),n=e.user,t=e.zone,r=Object(p.m)().history,o=a.a.useCallback(function(e){return"".concat(i.f,"/").concat(e)},[]);return{getRouteToZone:o,routeToZoneEdit:a.a.useCallback(function(e){t.map.panToZone(e),n.canQuery("zone")&&r.push(o(e))},[o,r,n,t.map]),routeToZoneList:a.a.useCallback(function(){r.push(i.f)},[r])}}var S=t(102),D=t(2860),Z=t(2861),L=t(21),R=t(1620),T=function(e){var n=e.field,t=e.label,r=e.defaultValue,o=(e.children,Object(L.a)(e,["field","label","defaultValue","children"]));return a.a.createElement(R.a,null,a.a.createElement(h.Checkbox,Object.assign({field:n,checked:Boolean(r)},o)),t&&a.a.createElement("label",null,t))},A=t(1506),_=t(1464),N=t(1451),V=t(1532);function G(){var e=Object(v.a)(["\n  border-left: 3px solid #707070;\n  width: 3px;\n  position: relative;\n  left: -2rem;\n  height: 4rem;\n  float: left;\n  margin: -0.5rem 0 0 0;\n"]);return G=function(){return e},e}function H(){var e=Object(v.a)(["\n  position: relative;\n  left: 4rem;\n  top: -0.3rem;\n  width: 3rem;\n"]);return H=function(){return e},e}function U(){var e=Object(v.a)(["\n  position: relative;\n  left: 8rem;\n  top: 0rem;\n"]);return U=function(){return e},e}function q(){var e=Object(v.a)(["\n  color: ",";\n"]);return q=function(){return e},e}function W(){var e=Object(v.a)(["\n  width: 3rem;\n  position: relative;\n  z-index: 4;\n"]);return W=function(){return e},e}function J(){var e=Object(v.a)(["\n  min-width: 2rem;\n  display: inline-block;\n"]);return J=function(){return e},e}var K=E.c.div(J()),$=Object(E.c)(A.a)(W()),Q=Object(E.c)($)(q(),B.a.blue),Y=E.c.div(U()),X=E.c.div(H()),ee=E.c.div(G()),ne=function(e){if("number"===typeof e)return null;var n=e.trim();return n.length&&Number.isNaN(Number.parseFloat(n))?u.b._("Must be number"):null},te=a.a.forwardRef(function(e,n){var t=e.field,r=e.label,o=e.isDeliveryPrice,c=e.autoFocus,i=void 0!==c&&c;return o?a.a.createElement(Y,null,a.a.createElement(ee,null),a.a.createElement(K,null,r),a.a.createElement(Q,{field:t,validate:ne,ref:n})):a.a.createElement(X,null,a.a.createElement($,{field:t,validate:ne,autoFocus:i}))}),re=t(93),ae=t(31),oe=t(52),ce=t(44),ie=t(74),ue=t(75),le=t(76),de=t(1457);function fe(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}var se=function(e){function n(){var e,t;Object(oe.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(t=Object(ie.a)(this,(e=Object(ue.a)(n)).call.apply(e,[this].concat(a)))).validate=function(e){return t.props.isRequired&&!e?u.b._("{0} must be selected",{0:t.props.validatioName}):null},t}return Object(le.a)(n,e),Object(ce.a)(n,[{key:"getControlProps",value:function(e){var n=this.props,t=n.isMulti,r=n.options,a=n.getOptionValue,o=n.defaultValue,c=e.value||o;if(t){var i=Array.isArray(c)?function(e){return c.includes(a(e))}:x.a.F;return{value:Array.isArray(r)?r.filter(i):[],onChange:function(n){e.setValue(n.map(a))}}}return{value:c&&r.find(function(e){return a(e)===c}),onChange:function(n){e.setValue(a(n))}}}},{key:"render",value:function(){var e=this,n=this.props,t=n.field,r=n.fieldIsPure,o=void 0!==r&&r,c=(n.defaultValue,Object(L.a)(n,["field","fieldIsPure","defaultValue"]));return a.a.createElement(h.Field,{field:t,validate:this.validate,pure:o},function(n){return a.a.createElement(de.a,Object.assign({},e.getControlProps(n),{onFocus:function(){return n.setTouched(!0)},styles:{control:function(e){return Boolean(n.error)?function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?fe(t,!0).forEach(function(n){Object(ae.a)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):fe(t).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}({},e,{borderColor:"red"}):e}}},c))})}}]),n}(a.a.Component);se.defaultProps={validatioName:"Value",getItemId:x.a.prop("id")};var me=t(359),be=t(509);function ve(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function pe(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ve(t,!0).forEach(function(n){Object(ae.a)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ve(t).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function he(){var e=Object(v.a)(["\n  background-color: ",";\n  color: ",";\n  width: 6rem;\n  padding: 0.4rem 1rem;\n  margin: 0;\n  height: 100%;\n"]);return he=function(){return e},e}var ge=E.c.div(he(),function(e){return e.color},B.a.white),Ee=Object(me.a)(be.a),Oe=function(e){var n=e.field,t=void 0===n?"zoneColor.id":n;return a.a.createElement(Ee,{render:function(e){var n=e.zoneColors;return a.a.createElement(se,{field:t,fieldIsPure:!0,options:Object(re.a)(n),width:8,styles:{option:function(e){return pe({},e,{padding:0,margin:0})},menu:function(e){return pe({},e,{width:"8rem",maxWidth:"8rem"})}},defaultValue:x.a.head(n),getOptionValue:x.a.prop("id"),formatOptionLabel:function(e){return a.a.createElement(ge,{color:e.color},e.code)}})}})},je=t(1650),ye=t(139),we=t(1458);function Ce(){var e=Object(v.a)(["\n  margin: 0 0 0 1rem;\n"]);return Ce=function(){return e},e}function ke(){var e=Object(v.a)(["\n  width: 3rem;\n  position: relative;\n  z-index: 4;\n"]);return ke=function(){return e},e}function Pe(){var e=Object(v.a)(["\n  width: 3rem;\n  display: inline-block;\n"]);return Pe=function(){return e},e}var xe=E.c.div(Pe()),ze=Object(E.c)(we.a)(ke()),Ie=E.c.div(Ce()),Be=function(e){var n=e.label,t=e.display;return a.a.createElement(Ie,null,a.a.createElement(xe,null,n),a.a.createElement(ze,{disabled:!0,placeholder:t}))};function Fe(){var e=Object(v.a)(["\n  position: relative;\n  top: -7rem;\n  left: 16rem;\n  height: 0;\n"]);return Fe=function(){return e},e}function Me(){var e=Object(v.a)(["\n  position: relative;\n  top: -6rem;\n"]);return Me=function(){return e},e}var Se=E.c.div(Me()),De=E.c.div(Fe()),Ze=function(e){var n=e.fieldApi;return a.a.createElement(a.a.Fragment,null,n.values.map(function(e,t,o){return a.a.createElement(r.Fragment,{key:t},a.a.createElement(te,{label:"za",isDeliveryPrice:!0,field:[t,"price","value"]}),t===o.length-1?a.a.createElement(Be,{display:"\u221e",label:"do"}):a.a.createElement(te,{field:[t,"toPrice","value"],autoFocus:!0}),o.length>1&&a.a.createElement(De,null,a.a.createElement(I.a,{onDelete:function(){return n.removeValue("",t)}})))}),a.a.createElement(h.FormApi,{render:function(e){return a.a.createElement(Se,null,a.a.createElement(ye.a,{disabled:e.submitting,width:B.d.ButtonHeight+B.d.DefaultSizeUnit,icon:je.a,onClick:function(){return n.addValue("",{price:{value:0},toPrice:{value:0}})}}))}}))};function Le(){var e=Object(v.a)(["\n  color: ",";\n  padding-bottom: 0.2rem;\n"]);return Le=function(){return e},e}function Re(){var e=Object(v.a)(["\n  margin: ",";\n  color: ",";\n"]);return Re=function(){return e},e}var Te=E.c.div(Re(),B.d.Middle,B.a.black),Ae=E.c.div(Le(),B.a.greyDark),_e=function(e){return a.a.createElement(Te,null,a.a.createElement(N.a,{icon:D.a},a.a.createElement(A.a,{field:"name",validate:Object(V.c)(u.b._("Zone name"))})),a.a.createElement(N.a,{icon:Z.a},a.a.createElement(Oe,null)),a.a.createElement(T,{field:"enabled",name:"enabled",label:u.b._("Is active").toLocaleLowerCase()}),a.a.createElement(S.Trans,{id:"<0>Delivery cost</0><1>according order total cost</1>",components:[a.a.createElement(_.a,{margin:"0.5rem 0 0 0"}),a.a.createElement(Ae,null)]}),a.a.createElement(te,{field:"minimalOrderPrice.value"}),a.a.createElement(h.NestedField,{field:"priceRangeRules",component:Ze}))},Ne=t(1468),Ve=t(1467),Ge=function(e){var n=e.isSubmitting,t=e.isModified,r=e.onGoBack,o=e.onSave;return a.a.createElement(Ve.a,null,a.a.createElement(Ne.a,{widthGrowIndex:.4,padding:"0"},a.a.createElement(ye.a,{color:B.a.greyMiddle,onClick:r,text:u.b._("Back"),disabled:n})),a.a.createElement(Ne.a,{widthGrowIndex:.4,padding:"0"},a.a.createElement(O.a,{mutationName:"updateZone"},a.a.createElement(ye.a,{color:B.a.green,text:u.b._("Save zone"),onClick:o,disabled:n||!t}))))},He=t(64),Ue=t(7);function qe(){var e=Object(v.a)(["\n  query GZones($branchesId: [ID!]!) {\n    zones(companyBranches: $branchesId) {\n      ...FZone\n    }\n  }\n  ","\n"]);return qe=function(){return e},e}var We=t.n(Ue)()(qe(),k.d),Je=Object(me.a)(We),Ke=a.a.createContext(null),$e=Object(He.b)(function(e){var n=e.children,t=Object(C.b)().zone,r=t.branches.filter(t.branchFilterPredicate);return 0===r.length?a.a.createElement(Ke.Provider,{value:[]},n):a.a.createElement(Je,{fetchPolicy:"cache-and-network",variables:{branchesId:r.map(x.a.prop("id"))},renderLoading:!1,render:function(e,t){var r=e.zones,o=t.loading;return a.a.createElement(Ke.Provider,{value:o?null:r},n)}})}),Qe=function(){return Object(r.useContext)(Ke)};function Ye(){var e=Object(v.a)(["\n  width: ",";\n  margin-top: ",";\n"]);return Ye=function(){return e},e}var Xe=E.c.div(Ye(),B.d.ButtonHeight+B.d.DefaultSizeUnit,B.d.Middle),en=function(){var e=F(),n=Qe(),t=Object(C.b)().zone,o=M().routeToZoneList,c=Object(r.useState)(!1),i=Object(b.a)(c,2),l=i[0],d=i[1],f=Object(r.useRef)(null),v=Object(z.a)(),E=v.enqueueError,B=v.enqueueSuccess,S=Object(k.kb)(),D=Object(b.a)(S,1)[0],Z=Object(r.useCallback)(function(){var n=Object(m.a)(s.a.mark(function n(r){return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e){n.next=5;break}return n.next=3,D(t.getZoneVariables(e,r));case 3:n.sent&&(d(!1),o(),B(u.b._("Zone has been updated")));case 5:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}(),[B,o,e,t,D]),L=Object(r.useCallback)(Object(m.a)(s.a.mark(function n(){return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e){n.next=3;break}return n.next=3,t.destroyZone(e);case 3:o();case 4:case"end":return n.stop()}},n)})),[o,e,t]);Object(p.j)(function(){return null!==t.map.currentZonePoints},d),a.a.useEffect(function(){n&&0===n.length&&(E(u.b._("Requested zone wasn't found")),o())},[E,o,n]);var R=e&&n&&n.find(x.a.propEq("id",e))||null;return a.a.useEffect(function(){t.map.clearZonePoints()},[R,t.map]),R?a.a.createElement(h.Form,{defaultValues:R,onChange:function(e){Object(P.b)("zone form change",e.values),d(!0)},onSubmit:Z,render:function(e){return f.current=e,a.a.createElement(j.a,{padding:0},a.a.createElement(Ge,{isSubmitting:e.submitting,isModified:l,onSave:e.submitForm,onGoBack:o}),a.a.createElement(_e,null),a.a.createElement(O.a,{mutationName:"destroyZone"},a.a.createElement(Xe,null,a.a.createElement(I.a,{disabled:e.submitting,confirmText:u.b._("Remove zone {0}?",{0:R.name}),onDelete:L}))),a.a.createElement(g.b,{when:l},function(e){var n=e.isShow,t=e.handleOk,r=e.handleCancel;return a.a.createElement(y.a,{isShow:n,confirmText:u.b._("Do you want to cancel changes for the zone?"),onConfirm:t,onCancel:r})}))}}):a.a.createElement(w.a,{text:u.b._("Loading form...")})},nn=t(19),tn=t(1563),rn=t(1525),an=t(115);function on(){var e=Object(v.a)(["\n    background-color: ",";\n    color: ",";\n  "]);return on=function(){return e},e}function cn(){var e=Object(v.a)(["\n  "," font-size: 1.3rem;\n  white-space: nowrap;\n  padding: 0.2rem 0.5rem;\n"]);return cn=function(){return e},e}var un=E.c.div(cn(),function(e){var n=e.isActive;return Object(E.b)(on(),n?B.a.green:B.a.greyLight,n?B.a.white:B.a.greyDark)}),ln=function(e){var n=e.branch,t=e.isActive,r=void 0===t||t;return a.a.createElement(rn.b,{getPixelPositionOffset:function(e,n){return{x:-e/2,y:-n/2}},mapPaneName:rn.b.MARKER_LAYER,position:Object(an.b)(n.gps)},a.a.createElement(un,{isActive:r},n.name))};var dn=function(e){var n=e.points,t=e.color,r=e.priority,o=e.onFocus,c=a.a.useCallback(function(e){o&&(e.stop(),o())},[o]);return a.a.createElement(rn.c,{path:n.map(an.b),options:{fillColor:t,fillOpacity:.3,strokeWeight:0,zIndex:5e3-r},editable:!1,draggable:!1,onDblClick:c})},fn=function(e){var n=e.onChange,t=e.onClear,r=e.points,o=e.color,c=a.a.useRef(null),i=a.a.useRef([]),u=a.a.useCallback(function(){if(c.current){var e=c.current.getPath();n(e.getArray().map(an.d))}},[n]),l=a.a.useCallback(function(e){c.current=e;var n=e.getPath();i.current.push(n.addListener("set_at",u),n.addListener("insert_at",u),n.addListener("remove_at",u))},[u]),d=a.a.useCallback(function(){t(),i.current.forEach(function(e){return e.remove()}),c.current=null},[t]);return a.a.createElement(rn.c,{path:r.map(an.b),options:{fillColor:o,fillOpacity:.6,strokeWeight:2,zIndex:1e4},editable:!0,draggable:!0,onDragEnd:u,onLoad:l,onUnmount:d})};function sn(){return Object(C.b)().zone}var mn=function(){var e=sn(),n=F(),t=Qe(),o=M().routeToZoneEdit,c=e.branches.filter(e.branchFilterPredicate),i=a.a.useCallback(function(n){return!e.hasBranchFilter||n===e.branchFilterId},[e]);a.a.useEffect(function(){return Object(nn.autorun)(function(){e.branch&&e.map.isReady&&e.map.panToBranch(e.branch)})},[e]);var u=Object(r.useCallback)(function(e){return a.a.createElement(ln,{key:"branch".concat(e.id),branch:e,isActive:i(e.id)})},[i]);return a.a.createElement(tn.a,{model:e.map},t&&t.map(function(t){var r={key:"zone".concat(t.id),points:t.geoPolygon,priority:t.priority,color:i(t.companyBranch.id)&&t.enabled?t.zoneColor.color:B.a.greyMiddle};return t.id===n?a.a.createElement(fn,Object.assign({},r,{onChange:e.map.updateZonePoints,onClear:e.map.clearZonePoints})):a.a.createElement(dn,Object.assign({},r,{onFocus:function(){i(t.companyBranch.id)&&o(t.id)}}))}),c&&c.map(u))},bn=t(1503),vn=Object(He.b)(function(e){var n=e.children;return Object(C.b)().user.hasSingleBranch?null:n}),pn=t(1475),hn=Object(He.b)(function(){var e=sn(),n=M().routeToZoneEdit;return a.a.createElement(ye.a,{text:e.hasBranchFilter?u.b._("Create zone for branch"):u.b._("Select branch to create zone"),onClick:function(){return e.createZone(n)},disabled:!e.hasBranchFilter,color:B.a.turquoise,textNextToIcon:!0,height:B.d.ButtonHeight+B.d.DefaultSizeUnit,icon:je.a})}),gn=t(1796),En=t(1639),On=t(477),jn=t(470),yn=t(97),wn=t(471),Cn=t(168),kn=t(472),Pn=t(476),xn=t(473),zn=t(1567),In=t(1940),Bn=t(1643),Fn=t(332);function Mn(){var e=Object(v.a)(["\n  height: ",";\n"]);return Mn=function(){return e},e}function Sn(){var e=Object(v.a)(["\n  font-size: 0.875rem;\n"]);return Sn=function(){return e},e}function Dn(){var e=Object(v.a)(["\n  font-size: 1.125rem;\n  margin-top: 0.2rem;\n"]);return Dn=function(){return e},e}var Zn=E.c.div(Dn()),Ln=E.c.div(Sn()),Rn=Object(E.c)(Ve.a)(Mn(),B.d.ButtonHeight+B.d.DefaultSizeUnit),Tn=Object(zn.b)(function(e){var n=e.zone,t=e.branch,r=e.onEdit;return a.a.createElement(j.a,{key:n.id,padding:0,color:n.enabled?n.zoneColor.color:B.a.greyMiddle,onClick:r},a.a.createElement(Rn,null,a.a.createElement(Ne.a,{fixedWidth:!0,padding:"0 0.5rem 0 0"},a.a.createElement(Fn.a,null,a.a.createElement(ye.a,{icon:In.a}))),a.a.createElement(Ne.a,{widthGrowIndex:1},a.a.createElement(Zn,null,n.name," [P".concat(n.priority,"]")),a.a.createElement(Ln,null,t.name)),a.a.createElement(Ne.a,{padding:"0"},a.a.createElement(Bn.a,null))))});function An(){var e=Object(v.a)(["\n  margin-top: 0.5rem;\n  cursor: arrow;\n"]);return An=function(){return e},e}var _n=Object(zn.a)(E.c.div(An())),Nn=On.a([jn.a(yn.a(["companyBranch","name"])),wn.a(Cn.a("priority"))]),Vn=kn.a(function(e){return e.companyBranch.id}),Gn=function(e){var n,t,o=e.branches,c=e.zones,i=e.zoneModel,u=e.onZoneEdit,l=function(e,n){return a.a.createElement(Tn,{key:e.id,zone:e,branch:o.find(Pn.a("id",e.companyBranch.id)),index:n,collection:e.companyBranch.id,onEdit:function(){return u(e.id)}})};if(1===o.length){var d=Nn(c);n=d.map(l),t=function(e){var n=e.oldIndex,t=e.newIndex,r=d[n];i.changeZonePriority(r,n,t)}}else{var f=xn.a(Nn,Vn(c));n=o.map(function(e){var n=f[e.id];return n?function(e,n){return a.a.createElement(r.Fragment,{key:e.id},a.a.createElement(En.a,null,e.name),n.map(l))}(e,n):null}),t=function(e){var n=e.oldIndex,t=e.newIndex,r=e.collection,a=f[r][n];i.changeZonePriority(a,n,t)}}return a.a.createElement(_n,{useDragHandle:!0,lockAxis:"y",onSortEnd:t},n)},Hn=function(){var e=Qe(),n=sn(),t=M().routeToZoneEdit;return null===e?a.a.createElement(gn.a,{primaryOpacity:.2,secondaryOpacity:.2}):null===n.brand?a.a.createElement(En.a,null,a.a.createElement(S.Trans,{id:"Select brand to see its zones"})):a.a.createElement(Gn,{zoneModel:n,zones:e.filter(n.zoneFilterPredicate),branches:n.root.user.filterBranches(n.branchFilterPredicate),onZoneEdit:t})},Un=t(1495),qn=t(1505),Wn=t(1797),Jn=Object(He.b)(function(){var e=Object(C.b)(),n=e.user,t=e.zone,r=n.branches,o=a.a.useCallback(function(e){return null===e?[]:n.branches.filter(x.a.pathEq(["brand","id"],e.id))},[n.branches]);if(a.a.useEffect(function(){return Object(nn.autorun)(function(){1===r.length&&t.setBranchFilter(x.a.head(r))})},[r,t]),r.length<=1)return null;var c=1===n.brands.length?x.a.head(n.brands):null;return c&&t.setBrandFilter(c,o(t.brand)),a.a.createElement(a.a.Fragment,null,!c&&a.a.createElement(Wn.a,{selectedBrand:t.brand,onSelection:function(e){null===e?t.clearBrandFilter():t.setBrandFilter(e,o(e))}}),!c&&a.a.createElement(Un.a,null),a.a.createElement(qn.a,{branches:o(t.brand),selectedBranch:t.branch,autoFocus:Boolean(c),formatOptionLabel:x.a.prop("name"),isClearable:!0,onSingleSelection:function(e){e?t.setBranchFilter(e):t.clearBranchFilter()}}))});function Kn(){var e=Object(v.a)(["\n  flex: 1 1 0;\n  min-height: 0;\n"]);return Kn=function(){return e},e}function $n(){var e=Object(v.a)(["\n  flex: 0 0 auto;\n"]);return $n=function(){return e},e}function Qn(){var e=Object(v.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n"]);return Qn=function(){return e},e}var Yn=E.c.div(Qn()),Xn=E.c.div($n()),et=E.c.div(Kn()),nt=a.a.memo(function(){var e=Object(C.b)().zone;return Object(pn.a)(function(n){e.setBranchFilter(n)}),a.a.createElement(Yn,null,a.a.createElement(Xn,null,a.a.createElement(vn,null,a.a.createElement(j.a,null,a.a.createElement(Jn,null))),a.a.createElement(O.a,{mutationName:"createZone"},a.a.createElement(hn,null))),a.a.createElement(et,null,a.a.createElement(bn.a,null,a.a.createElement(Hn,null))))}),tt=function(e){var n=e.match,t=Boolean(n.params.zoneId);return a.a.createElement($e,null,a.a.createElement(d.a,{pageTitle:u.b._("Delivery zones"),backRoute:i.a,useBackButton:!0},a.a.createElement(l.a,{widthInColumns:6,column:10,rowInMobile:2,withScrollArea:t},t?a.a.createElement(en,null):a.a.createElement(nt,null)),a.a.createElement(l.a,{widthInColumns:10,rowInMobile:1,forcePercentHeightInMobile:60},a.a.createElement(mn,null))))};t.d(n,"ZonesRouting",function(){return rt});var rt=function(){return a.a.createElement(o.e,null,a.a.createElement(o.c,{path:"".concat(i.f,"/:zoneId?"),component:tt}),a.a.createElement(o.c,{component:c.a}))};n.default=rt}}]);
//# sourceMappingURL=186.4bbc9977.chunk.js.map