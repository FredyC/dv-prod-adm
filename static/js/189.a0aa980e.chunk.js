(window.webpackJsonpspeedlo=window.webpackJsonpspeedlo||[]).push([[189],{1543:function(e,t,a){"use strict";function n(e){return"/"===e.charAt(0)}function r(e,t){for(var a=t,n=a+1,r=e.length;n<r;a+=1,n+=1)e[a]=e[n];e.pop()}t.a=function(e,t){void 0===t&&(t="");var a,c=e&&e.split("/")||[],l=t&&t.split("/")||[],i=e&&n(e),o=t&&n(t),u=i||o;if(e&&n(e)?l=c:c.length&&(l.pop(),l=l.concat(c)),!l.length)return"/";if(l.length){var s=l[l.length-1];a="."===s||".."===s||""===s}else a=!1;for(var m=0,d=l.length;d>=0;d--){var f=l[d];"."===f?r(l,d):".."===f?(r(l,d),m++):m&&(r(l,d),m--)}if(!u)for(;m--;m)l.unshift("..");!u||""===l[0]||l[0]&&n(l[0])||l.unshift("");var h=l.join("/");return a&&"/"!==h.substr(-1)&&(h+="/"),h}},1554:function(e,t,a){"use strict";var n=a(0),r=a.n(n),c=a(38);t.a=Object(c.a)(r.a.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"}),"AddCircle")},1586:function(e,t,a){},1590:function(e,t,a){"use strict";a.d(t,"a",function(){return s});var n=a(0),r=function(){return(r=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};var c=function(){return Math.random().toString(36).substring(2)},l=function(e){var t=e.rtl,a=e.speed,l=e.interval,i=e.style,o=e.width,u=e.height,s=e.baseUrl,m=e.gradientRatio,d=e.animate,f=e.ariaLabel,h=e.children,b=e.className,p=e.uniquekey,E=e.primaryColor,v=e.primaryOpacity,g=e.secondaryColor,y=e.secondaryOpacity,O=e.preserveAspectRatio,j=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&(a[n[r]]=e[n[r]])}return a}(e,["rtl","speed","interval","style","width","height","baseUrl","gradientRatio","animate","ariaLabel","children","className","uniquekey","primaryColor","primaryOpacity","secondaryColor","secondaryOpacity","preserveAspectRatio"]),k=p?p+"-idClip":c(),w=p?p+"-idGradient":c(),I=t?{transform:"scaleX(-1)"}:{},C="0; "+l+"; 1",S=a+"s";return Object(n.createElement)("svg",r({role:"img",style:r({},i,I),className:b,"aria-label":f||null,viewBox:"0 0 "+o+" "+u,preserveAspectRatio:O},j),f?Object(n.createElement)("title",null,f):null,Object(n.createElement)("rect",{x:"0",y:"0",width:o,height:u,clipPath:"url("+s+"#"+k+")",style:{fill:"url("+s+"#"+w+")"}}),Object(n.createElement)("defs",null,Object(n.createElement)("clipPath",{id:k},h),Object(n.createElement)("linearGradient",{id:w},Object(n.createElement)("stop",{offset:"0%",stopColor:E,stopOpacity:v},d&&Object(n.createElement)("animate",{attributeName:"offset",values:-m+"; "+-m+"; 1",keyTimes:C,dur:S,repeatCount:"indefinite"})),Object(n.createElement)("stop",{offset:"50%",stopColor:g,stopOpacity:y},d&&Object(n.createElement)("animate",{attributeName:"offset",values:-m/2+"; "+-m/2+"; "+(1+m/2),keyTimes:C,dur:S,repeatCount:"indefinite"})),Object(n.createElement)("stop",{offset:"100%",stopColor:E,stopOpacity:v},d&&Object(n.createElement)("animate",{attributeName:"offset",values:"0; 0; "+(1+m),keyTimes:C,dur:S,repeatCount:"indefinite"})))))},i={animate:!0,ariaLabel:"Loading interface...",baseUrl:"",gradientRatio:2,height:130,interval:.25,preserveAspectRatio:"none",primaryColor:"#f0f0f0",primaryOpacity:1,rtl:!1,secondaryColor:"#e0e0e0",secondaryOpacity:1,speed:2,style:{},width:400},o=function(e){return Object(n.createElement)("rect",{x:"0",y:"0",rx:"5",ry:"5",width:e.width,height:e.height})},u=function(e){var t=r({},i,e),a=e.children?e.children:Object(n.createElement)(o,r({},t));return Object(n.createElement)(l,r({},t),a)},s=function(e){return Object(n.createElement)(u,r({},e),Object(n.createElement)("circle",{cx:"10",cy:"20",r:"8"}),Object(n.createElement)("rect",{x:"25",y:"15",rx:"5",ry:"5",width:"220",height:"10"}),Object(n.createElement)("circle",{cx:"10",cy:"50",r:"8"}),Object(n.createElement)("rect",{x:"25",y:"45",rx:"5",ry:"5",width:"220",height:"10"}),Object(n.createElement)("circle",{cx:"10",cy:"80",r:"8"}),Object(n.createElement)("rect",{x:"25",y:"75",rx:"5",ry:"5",width:"220",height:"10"}),Object(n.createElement)("circle",{cx:"10",cy:"110",r:"8"}),Object(n.createElement)("rect",{x:"25",y:"105",rx:"5",ry:"5",width:"220",height:"10"}))}},1591:function(e,t,a){"use strict";a.d(t,"a",function(){return d});var n=a(17),r=a(87),c=a(21),l=a(0),i=a.n(l),o=a(46),u=a(1415),s=a(35),m=function(e){var t=e.getStyles,a=e.innerProps,c=a.ref,l=Object(n.a)(a,["ref"]);return i.a.createElement("div",Object.assign({},l,{ref:c,style:t("clearIndicator",e)}),i.a.createElement("div",{style:{padding:"0px 5px"}},i.a.createElement(r.Trans,{id:"All"})))},d=function(e){var t=e.brands,a=e.selectedBrand,r=e.onSelection,l=Object(n.a)(e,["brands","selectedBrand","onSelection"]),d=Object(o.b)().user;return i.a.createElement(u.a,Object.assign({placeholder:s.b._("Select brand"),options:t||d.brands,value:a,formatOptionLabel:c.RM.prop("name"),getOptionValue:c.RM.prop("id"),getOptionLabel:c.RM.prop("name"),isClearable:!0,isSearchable:!0,onChange:function(e){return r(e)},autoFocus:!0,components:{ClearIndicator:m}},l))}},1779:function(e,t,a){"use strict";var n=a(0),r=a.n(n),c=a(38);t.a=Object(c.a)(r.a.createElement("path",{d:"M20 4H4v2h16V4zm1 10v-2l-1-5H4l-1 5v2h1v6h10v-6h4v6h2v-6h1zm-9 4H6v-4h6v4z"}),"Store")},2789:function(e,t,a){"use strict";var n=a(0),r=a.n(n),c=a(38);t.a=Object(c.a)(r.a.createElement(r.a.Fragment,null,r.a.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"}),r.a.createElement("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 6h-4c0 1.62-1.38 3-3 3s-3-1.38-3-3H5V5h14v4zm-4 7h6v3c0 1.1-.9 2-2 2H5c-1.1 0-2-.9-2-2v-3h6c0 1.66 1.34 3 3 3s3-1.34 3-3z"})),"AllInbox")},2790:function(e,t,a){"use strict";var n=a(0),r=a.n(n),c=a(38);t.a=Object(c.a)(r.a.createElement("path",{d:"M7 11v2h10v-2H7zm5-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"RemoveCircleOutline")},2791:function(e,t,a){"use strict";var n=a(0),r=a.n(n),c=a(38);t.a=Object(c.a)(r.a.createElement("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"}),"RemoveRedEye")},2792:function(e,t,a){"use strict";var n=a(0),r=a.n(n),c=a(38);t.a=Object(c.a)(r.a.createElement("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),"Search")},2837:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(53),l=a(171),i=a(96),o=a(1461),u=a(1771),s=a(38),m=Object(s.a)(r.a.createElement("path",{d:"M19 4H5c-1.11 0-2 .9-2 2v12c0 1.1.89 2 2 2h4v-2H5V8h14v10h-4v2h4c1.1 0 2-.9 2-2V6c0-1.1-.89-2-2-2zm-7 6l-4 4h3v6h2v-6h3l-4-4z"}),"OpenInBrowser"),d=Object(s.a)(r.a.createElement("path",{d:"M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z"}),"Redo"),f=a(2789),h=a(35),b=a(15),p=a(316),E=a(1456),v=a(1483),g=function(){return r.a.createElement(v.a,{pageTitle:h.b._("Stock")},r.a.createElement(E.a,{row:1,column:1,canQuery:"stockItems",text:h.b._("Stock overview"),icon:u.a,color:b.a.violet,route:p.c}),r.a.createElement(E.a,{row:1,column:2,canMutate:"changeAmountStockItem",text:h.b._("Stock deposit"),icon:m,color:b.a.violet,route:p.b}),r.a.createElement(E.a,{row:1,column:3,canMutate:"createStockItemTransfers",canAccessWithSingleBranch:!1,text:h.b._("Stock transfer"),icon:d,color:b.a.violet,route:p.e}),r.a.createElement(E.a,{row:2,column:1,canQuery:"stockItems",canAccessWithSingleBranch:!1,text:h.b._("Stock statistics"),icon:f.a,color:b.a.turquoise,route:p.d}))},y=a(168),O=a(170),j=a(1454),k=a(42),w=a(33),I=a(58),C=a(59),S=a(61),x=a(87),R=a(3),T=a(18);function M(){var e=Object(R.a)(["\n  flex: none;\n  margin-right: 1rem;\n"]);return M=function(){return e},e}function N(){var e=Object(R.a)(["\n  margin: 0.6rem;\n  display: flex;\n"]);return N=function(){return e},e}var L=T.c.div(N()),q=T.c.div(M()),B=a(1418),_=a(318),A=a(71),P=a(127),z=a.n(P),F=a(302),V=a(115),D=function(e){var t=e.wareUnit,a=e.quantity,n=e.onConfirm;return r.a.createElement(V.a,{disabled:null===t,onClick:n},t?r.a.createElement(x.Trans,{id:"Add {0} {1}",values:{0:z()(a).format(F.i),1:t.code}}):r.a.createElement(x.Trans,{id:"No stock card selected"}))},U=a(1413),H=a(1410),K=r.a.forwardRef(function(e,t){var a=e.value,n=e.onFilter,c=e.onConfirm;return r.a.createElement(H.a,{label:h.b._("Stock card"),labelWidth:7},r.a.createElement(U.a,{ref:t,autoFocus:!0,placeholder:"".concat(h.b._("Code").toLocaleLowerCase()," / ").concat(h.b._("PLU")," / ").concat(h.b._("Title").toLocaleLowerCase()),value:a,onChange:function(e){n(e.target.value)},onKeyPressCapture:function(e){"Enter"===e.key&&(e.preventDefault(),c())}}))}),Q=r.a.forwardRef(function(e,t){var a=e.enabled,n=e.onChange,c=e.onConfirm;return r.a.createElement(U.a,{ref:t,disabled:!a,onChange:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=z()(e.target.value).value();n(t)}),onKeyPressCapture:function(e){"Enter"===e.key&&(e.preventDefault(),c())}})}),W=Object(s.a)(r.a.createElement("path",{d:"M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"}),"Done"),G=a(1433),J=a(303);function X(){var e=Object(R.a)(["\n  background-color: ",";\n"]);return X=function(){return e},e}var Y=function(e){var t=e.stockItems,a=e.searchValue,n=e.onSelect;return r.a.createElement(G.f,{items:t,heightStretch:!1},r.a.createElement(G.a,{dataKey:"id",width:b.d.ButtonColumnWidthPx,minWidth:b.d.ButtonColumnWidthPx,cellRenderer:Z,columnData:{onSelect:n}}),r.a.createElement(G.a,{dataKey:"quantity",width:100,label:h.b._("Card stock"),cellRenderer:te}),r.a.createElement(G.a,{dataKey:"code",width:100,label:h.b._("Card code"),cellRenderer:ee(a)}),r.a.createElement(G.a,{dataKey:"nameLabel",width:300,label:h.b._("Card name"),cellRenderer:ee(a)}),r.a.createElement(G.a,{dataKey:"note",width:300,label:h.b._("Card note")}))};function Z(e){var t=e.rowData,a=e.columnData.onSelect;return r.a.createElement(J.a,null,r.a.createElement(V.a,{icon:W,onClick:function(){return a(t)}}))}var $=T.c.span(X(),b.a.yellow);function ee(e){return function(t){var a=t.cellData,n=a.toLocaleLowerCase().indexOf(e.toLocaleLowerCase());if(-1===n)return a;var c=a.substring(0,n),l=a.substring(n,n+e.length),i=a.substring(n+e.length);return r.a.createElement(r.a.Fragment,null,c,r.a.createElement($,null,l),i)}}function te(e){var t=e.cellData,a=e.rowData;return"".concat(t," ").concat(a.wareUnit.code)}var ae=function(e){function t(){var e,a;Object(k.a)(this,t);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(a=Object(I.a)(this,(e=Object(C.a)(t)).call.apply(e,[this].concat(c)))).state={targetStockItem:null,filteredStockItems:[],searchValue:"",inputQuantity:0},a.filterInputRef=r.a.createRef(),a.quantityInputRef=r.a.createRef(),a.onFilter=function(e){if(""!==e.trim()){var t=Object(_.a)(e),n=a.props.stockItems.filter(A.a.cond([[A.a.propEq("plu",e),A.a.T],[A.a.propSatisfies(t,"code"),A.a.T],[A.a.propSatisfies(t,"nameLabel"),A.a.T]])),r=null;1===n.length&&(r=A.a.head(n)),a.setState({filteredStockItems:n,searchValue:e,targetStockItem:r})}else a.setState({filteredStockItems:[],searchValue:"",targetStockItem:null})},a.onConfirmFilter=function(){1===a.state.filteredStockItems.length&&a.quantityInputRef.current.focus()},a.onQuantity=function(e){a.setState({inputQuantity:e})},a.onSelectStockItem=function(e){a.setState({targetStockItem:e,filteredStockItems:[e]},function(){a.quantityInputRef.current.focus()})},a.onConfirm=function(){var e=a.state,t=e.targetStockItem,n=e.inputQuantity;t&&0!==n&&a.props.onDeposit(t,n),a.setState({targetStockItem:null,searchValue:"",inputQuantity:0},function(){a.quantityInputRef.current.value="",a.filterInputRef.current.focus()})},a}return Object(S.a)(t,e),Object(w.a)(t,[{key:"componentDidUpdate",value:function(e){e.stockItems!==this.props.stockItems&&this.onFilter(this.state.searchValue)}},{key:"render",value:function(){var e=this.state,t=e.searchValue,a=e.filteredStockItems,n=e.targetStockItem,c=e.inputQuantity,l=""!==t.trim(),i=0===a.length,o=a.length>1;return r.a.createElement(r.a.Fragment,null,r.a.createElement(L,null,r.a.createElement(q,null,r.a.createElement(K,{onFilter:this.onFilter,onConfirm:this.onConfirmFilter,value:t,ref:this.filterInputRef})),r.a.createElement(q,null,r.a.createElement(Q,{enabled:null!==n,onChange:this.onQuantity,onConfirm:this.onConfirm,ref:this.quantityInputRef})),r.a.createElement(q,null,r.a.createElement(D,{cardName:n?n.nameLabel:"",quantity:c,wareUnit:n?n.wareUnit:null,onConfirm:this.onConfirm}))),r.a.createElement(B.a,null,l&&o&&r.a.createElement(x.Trans,{id:"Continue typing to find single stock card or select one from the list"}),l&&i&&r.a.createElement(x.Trans,{id:"No stock card found from entered search value"}),l&&n&&r.a.createElement(x.Trans,{id:"Stock card <0>{0}</0> is selected",values:{0:n.nameLabel},components:[r.a.createElement("b",null)]})),l&&r.a.createElement(Y,{searchValue:t,stockItems:a,onSelect:this.onSelectStockItem}))}}]),t}(r.a.Component),ne=a(70),re=a(49),ce=a(46),le=a(69),ie=Object(re.b)(function(e){var t=e.children,a=Object(ce.b)().settings,n=Object(le.Lb)({branchId:a.branchId}),r=n.data,c=n.loading,l=Object(le.db)(),i=Object(ne.a)(l,1)[0];return t(c?[]:r.stockItems,function(e,t){i({stockItem:e.id,quantityChange:t})})}),oe=function(e){return r.a.createElement(O.a,{pageTitle:h.b._("Stock deposit"),useBackButton:!0},r.a.createElement(y.a,null,r.a.createElement(j.a,null),r.a.createElement(ie,null,function(e,t){return r.a.createElement(ae,{stockItems:e,onDeposit:t})})))},ue=a(1419),se=a(1549),me=a(21),de=a(1427),fe=a(1678),he=20,be=20,pe=15,Ee=T.c.div.withConfig({displayName:"StyledStockStatisticsTable",componentId:"xtzl00-0"})(["margin:1rem;& .stock-item{display:grid;grid-gap:0 4px;grid-template-columns:5rem 1fr;grid-template-rows:","px auto;}& .code{grid-column:1;grid-row:1;}& .header{grid-column:2;grid-row:1;white-space:nowrap;border-bottom:1px solid ",";& .quantity{font-weight:bold;}}& .branches{grid-column:2;grid-row:2;margin-top:0.2rem;}& .header,& .branchItem{display:flex;flex-direction:row;}& .header .name,& .branches .branchName{flex:1 1 auto;max-width:20rem;}& .header .quantity,& .branches .quantity{flex:0 0 5rem;margin-right:1rem;text-align:right;}& .branchItem,& .header .quantity{font-size:0.9rem;}& .branchItem{height:","px;overflow:hidden;}& .branchName{color:",";}& .nameAtBranch{flex:2 1 auto;color:",";}"],he,b.a.greyMiddle,be,b.a.greyMiddle,b.a.greyMiddle),ve=function(e){var t=e.items;return r.a.createElement(fe.a,{items:t,rowHeight:function(e){var a=e.index;return he+pe+t[a].branches.length*be},heightStretch:!0,renderItem:function(e){return r.a.createElement(Ee,null,r.a.createElement("div",{className:"stock-item"},r.a.createElement("div",{className:"code"},e.code),r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"name"},e.nameLabel),r.a.createElement("div",{className:"quantity"},e.quantity," ",e.wareUnit.code),r.a.createElement("div",{className:"nameAtBranch"},"\xa0")),r.a.createElement("div",{className:"branches"},e.branches.map(function(t){return r.a.createElement("div",{className:"branchItem",key:t.branchName},r.a.createElement("div",{className:"branchName"},t.branchName),r.a.createElement("div",{className:"quantity"},t.quantity," ",e.wareUnit.code),e.showNamePerBranch&&r.a.createElement("div",{className:"nameAtBranch"},t.itemNameAtBranch))}))))}})},ge=Object(re.b)(function(){var e=Object(ce.b)().statistics,t=Object(le.mc)({brandId:e.stockBrandId},{skip:!e.stockBrandId}),a=t.data,n=t.loading;if(!e.stockBrandId)return null;if(n)return r.a.createElement(de.a,null);var c=e.stockSearchInput,l=Object(_.a)(c),i=me.RM.cond([[me.RM.propEq("plu",c),me.RM.T],[me.RM.propSatisfies(l,"code"),me.RM.T],[me.RM.propSatisfies(l,"nameLabel"),me.RM.T]]),o=me.RM.sortWith([me.RM.ascend(me.RM.prop("code"))])(a.stockItems.filter(i)).reduce(function(e,t){var a=e.find(function(e){var a=e.code,n=e.wareUnit;return a===t.code&&n.id===t.wareUnit.id}),n={stockItemId:t.id,quantity:t.quantity,branchName:t.companyBranch.name,itemNameAtBranch:t.nameLabel};return a?(a.branches.push(n),a.nameLabel!==t.nameLabel&&(a.showNamePerBranch=!0)):e.push({code:t.code,wareUnit:t.wareUnit,nameLabel:t.nameLabel,showNamePerBranch:!1,branches:[n],quantity:t.quantity}),e},[]);return r.a.createElement(ve,{items:o})}),ye=a(217),Oe=a(1779),je=a(2792),ke=a(1422),we=a(1421),Ie=a(305),Ce=a(116),Se=a(1591),xe=Object(T.c)(we.a).withConfig({displayName:"StyledFlexRowSingle",componentId:"sc-1cl7fri-0"})(["flex-wrap:wrap;"]),Re=function(){var e=Object(ce.b)(),t=e.user,a=e.statistics;return Object(re.g)(function(){return r.a.createElement(xe,{justify:"flex-start"},r.a.createElement(ke.a,null,r.a.createElement(Ie.a,{margin:"0 1rem 0 0"},r.a.createElement(H.a,{icon:Oe.a},r.a.createElement(Ce.a,{width:16},r.a.createElement(Se.a,{selectedBrand:t.brands.find(Object(me.idPropEq)(a.stockBrandId))||null,onSelection:function(e){a.setStockBrand(e?e.id:null)}}))))),r.a.createElement(ke.a,null,r.a.createElement(H.a,{icon:je.a},r.a.createElement(Ce.a,{width:14},r.a.createElement(U.a,{defaultValue:a.stockSearchInput,inputFullWidth:!0,onChange:function(e){return a.setStockFilter(e.target.value)},placeholder:ye.i18n._("Filter by name or code")})))))})},Te=function(){return r.a.createElement(O.a,{pageTitle:h.b._("Stock statistics"),useBackButton:!0},r.a.createElement(ue.a,{forcePercentHeightInMobile:100},r.a.createElement(y.a,{stretchToParent:!0},r.a.createElement(se.b,null,r.a.createElement("div",{className:"filter"},r.a.createElement(Re,null)),r.a.createElement("div",{className:"table"},r.a.createElement(ge,null))))))},Me=a(1676),Ne=a(1411);function Le(){return Object(ce.b)().stock.transfer}var qe=a(51),Be=a.n(qe),_e=a(80),Ae=a(44),Pe=a(169),ze=a(164);function Fe(){var e=Object(R.a)(["\n    margin-left: ",";\n  "]);return Fe=function(){return e},e}function Ve(){var e=Object(R.a)(["\n    margin-left: 3rem;\n    width: 16rem;\n  "]);return Ve=function(){return e},e}function De(){var e=Object(R.a)(["\n  flex: 0 0 auto;\n  ",";\n  @media (max-width: 760px) {\n    width: unset;\n    margin-left: ",";\n  }\n  ",";\n"]);return De=function(){return e},e}var Ue=T.c.div(De(),Object(Ae.c)(Ve()),b.d.Middle,Object(Ae.d)(Fe(),b.d.Middle)),He=Object(re.b)(function(){var e=Le(),t=Object(Pe.a)().enqueueSuccess,a=Object(le.L)(),n=Object(ne.a)(a,1)[0],c=Object(Ne.b)("createStockItemTransfers"),l=r.a.useCallback(Object(_e.a)(Be.a.mark(function a(){var r,c,l;return Be.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(r=e.targetId,!((c=e.itemsForTransfer.map(function(e){return{stockItemId:e.id,quantity:e.quantity||ze.d}})).length>0&&r)){a.next=8;break}return l={targetBranch:r,transfers:c},a.next=6,n(l);case 6:a.sent&&(t(h.b._("Transfer was successfully completed!")),e.clearTransferState());case 8:case"end":return a.stop()}},a)})),[n,t,e]);if(!c)return null;var i=function(e){if(!e.hasTarget)return!1;var t=e.itemsForTransfer;if(0===t.length)return!1;if(t.some(function(e){return!1===e.isQuantityValid}))return!1;return!0}(e);return r.a.createElement(Ue,null,r.a.createElement(V.a,{color:b.a.green,onClick:l,disabled:!i},e.isImportMode?r.a.createElement(x.Trans,{id:"Confirm import"}):r.a.createElement(x.Trans,{id:"Confirm transfer"})))});var Ke=a(17),Qe=a(1583),We=function(e){var t=e.sideText,a=Object(Ke.a)(e,["sideText"]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ie.a,{margin:"0 10px 0 0"},r.a.createElement(Qe.a,null,r.a.createElement("input",Object.assign({type:"checkbox"},a)))),t)},Ge=Object(re.b)(function(){var e=Le();return r.a.createElement(r.a.Fragment,null,r.a.createElement(We,{checked:e.isImportMode,onChange:e.toggleImportMode}),r.a.createElement(Ce.a,{width:10},r.a.createElement(x.Trans,{id:"Enable import mode"})))}),Je=a(1412),Xe=a(457),Ye=Object(re.b)(function(e){var t=e.stockItemId,a=Le(),n=r.a.useRef(null),c=r.a.useCallback(function(e){var n=e.target.value;a.setQuantity(t,n)},[t,a]),l=r.a.useCallback(function(){n.current&&n.current.select()},[]);return r.a.createElement(U.a,{type:"text",inputFullWidth:!0,value:a.getItemRawQuantity(t),disabled:!a.hasTarget,onChange:c,onFocus:l,placeholder:h.b._("to transfer"),pattern:Xe.b.source,invalid:!a.isItemQuantityValid(t)})});function Ze(){var e=Object(R.a)(["\n  display: flex;\n  align-items: center;\n"]);return Ze=function(){return e},e}function $e(){var e=Object(R.a)(["\n  [aria-label='grid']:focus {\n    outline: none;\n  }\n\n  [role='columnheader'] {\n    display: flex;\n    align-items: center;\n    overflow: hidden;\n  }\n\n  .flex-animation,\n  [role='columnheader'] {\n    transition: flex ",";\n  }\n"]);return $e=function(){return e},e}var et=Object(T.c)(G.f)($e(),"0.3s"),tt=T.c.div(Ze()),at=Object(re.b)(function(){var e=Le(),t=r.a.useCallback(function(t){var a=t.cellData;return r.a.createElement(re.a,null,function(){return r.a.createElement(We,{checked:e.isImportingItem(a),disabled:!e.hasTarget,onChange:function(){return e.toggleImportItem(a)},"data-testid":"import-checkbox"})})},[e]),a=r.a.useCallback(function(){return r.a.createElement(re.a,null,function(){return r.a.createElement(We,{checked:e.isImportingAll,disabled:!e.hasTarget,onChange:e.toggleImportAll,sideText:r.a.createElement(x.Trans,{id:"Import"}),"data-testid":"import-all-checkbox"})})},[e]),n=r.a.useCallback(function(e){var t=e.cellData;return r.a.createElement(re.a,null,function(){return r.a.createElement(tt,null,r.a.createElement(Ce.a,{width:6,margin:"0 0.5rem 0 0"},r.a.createElement(Ye,{stockItemId:t})))})},[]),c=function(){var e=Le(),t=Object(le.kc)({branchId:e.sourceId}),a=t.data,n=t.loading;r.a.useEffect(function(){if(!n){var t=a.stockItems.map(function(e){var t=!0===e.allowNegativeValue?Number.MAX_SAFE_INTEGER:Math.max(e.quantity,0);return{id:e.id,max:t}});e.initItems(t)}},[a.stockItems,n,e]);var c=e.filter.getPredicate({exactMatch:["plu"],partialMatch:["code","nameLabel"]});return{isLoading:n,filteredItems:n?[]:a.stockItems.filter(c)}}(),l=c.filteredItems,i=c.isLoading;return r.a.createElement(et,{items:l,heightStretch:!0,noRowsRenderer:function(){return i?r.a.createElement(de.a,null):r.a.createElement("h3",null,r.a.createElement(x.Trans,{id:"Selected branch has no stock cards"}))}},r.a.createElement(G.a,{dataKey:"id",width:e.isTransferMode?140:0,label:h.b._("Amount"),cellRenderer:n,className:"flex-animation",headerClassName:Object(Je.b)({"data-testid-amount":e.isTransferMode})}),r.a.createElement(G.a,{dataKey:"id",width:e.isImportMode?140:0,label:h.b._("Import"),headerRenderer:a,cellRenderer:t,className:"flex-animation",headerClassName:Object(Je.b)({"data-testid-import":e.isImportMode})}),r.a.createElement(G.a,{dataKey:"quantity",width:100,label:h.b._("Card stock"),cellRenderer:nt}),r.a.createElement(G.a,{dataKey:"code",width:100,label:h.b._("Card code")}),r.a.createElement(G.a,{dataKey:"nameLabel",width:300,minWidth:30,flexGrow:2,label:h.b._("Card name")}),r.a.createElement(G.a,{dataKey:"allowNegativeValue",width:300,label:h.b._("Negative stock"),cellRenderer:rt}))});function nt(e){var t=e.cellData,a=e.rowData;return"".concat(t," ").concat(a.wareUnit.code)}function rt(e){return!0===e.cellData?r.a.createElement(x.Trans,{id:"Permitted"}):r.a.createElement(x.Trans,{id:"Forbidden"})}var ct=function(){return r.a.createElement(j.a,{width:20})},lt=Object(s.a)(r.a.createElement("path",{d:"M16.01 11H4v2h12.01v3L20 12l-3.99-4z"}),"ArrowRightAlt"),it=a(1434),ot=Object(re.b)(function(){var e=Object(ce.b)().user,t=Le(),a=me.RM.reject(Object(me.idPropEq)(t.sourceId),e.branches);return r.a.createElement(H.a,{icon:lt},r.a.createElement(it.a,{selectedBranches:t.targetId?[t.targetId]:[],onSelectionChange:function(e){var a=Object(ne.a)(e,1)[0];return t.setTargetId(a)},onSelectionClear:function(){return t.setTargetId(null)},isMulti:!1,isClearable:!1,getDropdownProps:function(){return{width:20}},hideWhenSingleBranch:!0,branches:a}))});function ut(){var e=Object(R.a)(["\n  &,\n  & > * {\n    display: flex;\n    align-items: center;\n  }\n"]);return ut=function(){return e},e}function st(){var e=Object(R.a)(["\n  display: flex;\n"]);return st=function(){return e},e}var mt=T.c.div(st()),dt=Object(T.c)(we.a)(ut()),ft=function(e){var t=Object(ce.b)().user,a=Object(Ne.b)("createStockItemTransfers")&&!t.hasSingleBranch,n=Le().filter;return r.a.createElement(O.a,{pageTitle:h.b._("Stock transfer"),useBackButton:!0,topContent:r.a.createElement(mt,null,r.a.createElement(He,null))},r.a.createElement(ue.a,{forcePercentHeightInMobile:100},r.a.createElement(y.a,{stretchToParent:!0},a?r.a.createElement(se.b,null,r.a.createElement("div",{className:"filter"},r.a.createElement(dt,{justify:"start",flexWrap:"wrap"},r.a.createElement(ke.a,null,r.a.createElement(ct,null)),r.a.createElement(ke.a,null,r.a.createElement(ot,null)),r.a.createElement(ke.a,null,r.a.createElement(Me.a,{model:n,placeholder:"".concat(h.b._("Code").toLocaleLowerCase()," / ").concat(h.b._("PLU")," / ").concat(h.b._("Title").toLocaleLowerCase()),debounceIntervalMs:200})),r.a.createElement(ke.a,null,r.a.createElement(Ge,null)))),r.a.createElement("div",{className:"table"},r.a.createElement(at,null))):r.a.createElement(B.a,null,r.a.createElement(x.Trans,{id:"Can't access page"})))))};a.d(t,"StockRouting",function(){return ht});var ht=function(){return r.a.createElement(c.e,null,r.a.createElement(i.a,{path:p.a,exact:!0,component:g}),r.a.createElement(i.a,{path:p.d,component:Te}),r.a.createElement(i.a,{path:p.e,component:ft}),r.a.createElement(i.a,{path:p.b,component:oe}),r.a.createElement(c.b,{to:o.d,from:p.c}),r.a.createElement(c.c,{component:l.a}))};t.default=ht}}]);
//# sourceMappingURL=189.a0aa980e.chunk.js.map