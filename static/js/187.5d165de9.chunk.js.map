{"version":3,"sources":["atoms/VerticalGap.tsx","components/forms/FormInput.tsx","molecules/TouchButtonDelete.tsx","helpers/form.ts","components/forms/FormSubmitButton.tsx","atoms/FlexDiv.tsx","atoms/DragHandle.tsx","atoms/PictogramDisplay.tsx","../node_modules/@material-ui/icons/esm/ErrorOutline.js","segments/menu/molecules/MenuGuideDownload.tsx","molecules/SortableDataTable.tsx","segments/menu/molecules/CategoryListTable.tsx","segments/menu/organisms/CategoryList.tsx","segments/menu/pages/MenuCategoryListPage.tsx","molecules/TopRightButtonContainer.tsx","segments/menu/hooks/useMenuItemType.ts","segments/menu/atoms/IsMenuItemType.tsx","segments/menu/atoms/MenuSubmitButton.tsx","components/forms/useFormLoader.ts","segments/menu/molecules/MenuFormLoader.tsx","segments/menu/hooks/useMenuItemId.ts","segments/menu/hooks/useMenuTranslations.ts","segments/menu/molecules/MenuTranslationLoader.tsx","segments/menu/organisms/CategoryFormLoader.tsx","components/forms/FormDeleteButton.tsx","segments/menu/atoms/FormLayoutGrid.tsx","components/forms/FormDropdown.tsx","segments/menu/molecules/CategoryOriginsField.tsx","segments/menu/molecules/CategoryPictogramSelect.tsx","segments/menu/atoms/MenuTranslationInput.tsx","segments/menu/molecules/MenuInternalNoteField.tsx","segments/menu/molecules/MenuLanguageSwitch.tsx","segments/menu/molecules/MenuNameInput.tsx","segments/menu/organisms/CategoryFormPrimary.tsx","hooks/useSettingsBranch.ts","segments/menu/atoms/MenuSuggestionPanel.tsx","segments/menu/hooks/usePriceType.ts","segments/menu/organisms/CategoryRecipesView.tsx","segments/menu/molecules/CategoryRequirementControl.tsx","segments/menu/organisms/CategoryRequirementsForm.tsx","segments/menu/pages/MenuCategoryPage.tsx","segments/menu/organisms/CategorySuggestionPanel.tsx","segments/menu/organisms/RecipeCategoryView.tsx","segments/menu/organisms/RecipeFormLoader.tsx","components/forms/FormDisplayValue.tsx","../node_modules/@material-ui/icons/esm/Toll.js","segments/menu/molecules/MenuPriceInput.tsx","components/forms/FormFlatSingleSelect.tsx","segments/menu/molecules/RecipeVatSelectField.tsx","segments/menu/molecules/RecipeAssocListTable.tsx","segments/menu/organisms/RecipeAssociatedView.tsx","segments/menu/organisms/RecipeFormPricing.tsx","segments/menu/molecules/MenuCodeInput.tsx","segments/menu/molecules/MenuIdExternalSystem.tsx","segments/menu/molecules/MenuVisibilityField.tsx","segments/menu/atoms/MenuAllergenIndicator.tsx","segments/menu/molecules/RecipeAllergenDisplay.tsx","segments/menu/molecules/RecipeDescriptionInput.tsx","segments/menu/organisms/RecipeFormPrimary.tsx","segments/menu/molecules/RecipeIngredientsTable.tsx","segments/menu/organisms/RecipeIngredientsView.tsx","segments/menu/pages/MenuRecipePage.tsx","segments/menu/organisms/StockListTable.tsx","segments/menu/organisms/StockListLoader.tsx","segments/menu/pages/MenuStockListPage.tsx","segments/menu/organisms/StockFormLoader.tsx","segments/menu/molecules/StockAllergenField.tsx","segments/menu/molecules/StockAllowNegativeField.tsx","../node_modules/@material-ui/icons/esm/Fingerprint.js","segments/menu/molecules/StockPluField.tsx","../node_modules/@material-ui/icons/esm/SelectAll.js","segments/menu/molecules/StockWareUnitField.tsx","segments/menu/organisms/StockFormPrimary.tsx","segments/menu/organisms/StockRecipesVIew.tsx","segments/menu/pages/MenuStockPage.tsx","segments/menu/routes/MenuRouting.tsx"],"names":["VerticalGap","styled","div","size","sizeUnit","displayName","FormInput","React","forwardRef","inputRef","fieldName","fullWidth","addHiddenLabelWithPlaceholderText","withLabel","props","useXFieldForInput","field","getInputProps","useObserver","invalid","touched","Boolean","error","inputFullWidth","ref","placeholder","hidden","htmlFor","name","TouchButtonDelete","onDelete","confirmText","icon","Delete","color","Colors","greyMiddle","onClick","ev","preventDefault","window","confirm","isFormValid","formState","errors","Object","keys","length","validateIsRequired","value","isEmpty","parseNumber","Number","parseFloat","replace","FormSubmitButton","children","id","state","useXFormState","type","green","disabled","isSubmitting","isDirty","isValid","undefined","ErrorOutline","iconSize","iconColor","red","FlexDiv","StyledDragHandle","DragHandle","SortableHandle","Reorder","getFontSize","fontSize","fontSizeUnit","Spacing","DefaultSizeUnit","PictogramDisplay","attrs","className","getPictogramClassName","pictogramId","createElement","Fragment","fill","d","MenuGuideDownloadButton","TouchButton","black","MenuGuideDownload","observer","settings","useRoot","useQMenuGuideDownload","branchId","fetchPolicy","loading","data","companyBranch","foodMenuUrl","href","target","rel","SortableTableRowRenderer","SortableElement","columns","style","SortableDataTableContainer","SortableContainer","DataTable","SortableDataTable","sortedItems","items","rowRenderer","rowProps","onHandleSorting","a","newIndex","oldIndex","currentItems","arrayMove","setState","onSort","sortSuccess","item","offset","this","lockAxis","useDragHandle","onSortEnd","PureComponent","getDerivedStateFromProps","nextProps","CategoryListTable","categories","onToggle","onRemove","showEditColumn","showRemoveColumn","showVisibilityColumn","showHeader","isSortable","isLoading","heightStretch","fullHeight","noRowsDisplay","text","i18n","disableHeader","noRowsRenderer","getCategoryEditRoute","useMenuRouting","dataKey","width","ButtonColumnWidthPx","minWidth","cellRenderer","checkColumnAccess","canQuery","ColumnRendererEdit","cellDataGetter","rowData","categoryType","enum","ColumnRendererRemove","columnData","canMutate","ColumnRendererVisibility","label","ColumnRendererWithNote","noteKey","cellData","toLocaleLowerCase","StyledCategoryList","greyLight","headline","subHeadline","useQMenuCategoryList","updateQuery","refetch","dataOrigins","useQMenuCategoryOrigins","originsMap","useMemo","origins","reduce","acc","origin","code","renderOrigins","useCallback","sort","map","originEnum","key","useMMenuCategoryVisibility","changeVisibility","onVisibilityToogle","categoryId","visible","optimisticResponse","updateWareCategory","__typename","useMMenuCategorySort","sortCategory","result","success","useLoadingCache","getCategories","getCategoryCreateRoute","FlexRowSingle","FlexColumn","widthGrowIndex","Headline","fixedWidth","MenuCreateButton","routeTo","PartialDataTableContainer","MenuCategoryListPage","FullPageLayout","pageTitle","useBackButton","backRoute","ROUTE_SETTINGS","PageLayoutFullHeightItem","forcePercentHeightInMobile","Card","stretchToParent","justify","SettingsCompanyBranchPicker","WareCategoryTypeEnum","Main","SideDish","Cover","TopRightButtonContainer","Radiuses","Button","useMenuItemType","useXFieldState","IsMenuItemType","isMain","isSideDish","isCover","itemType","MenuSubmitButton","isCreate","createMutation","updateMutation","useCanMutate","logger","MenuFormLoader","initialValues","loadCreateDefaults","loadUpdateValues","onCreate","onUpdate","createSuccessMessage","updateSuccessMessage","successRedirectPath","validationSchema","xform","onSubmit","loadValues","submitMessage","submitRedirectPath","history","useRouterContext","useSnackBar","enqueueSuccess","enqueueWarning","onSubmitSuccess","values","push","onSubmitFailed","msg","hasLoaded","useRef","onReset","current","useXForm","initialValidationEnabled","ignoreUnknownFieldsInValidation","onFormChanges","useEffect","Promise","resolve","then","api","mergeValues","pristineValues","enableValidation","useFormLoader","useMenuItemId","byLanguage","RM","propEq","useMenuTranslations","translations","findTranslation","language","find","getTranslation","hasTranslation","getTranslationOrCreate","create","translation","MenuTranslationLoader","loadTranslations","menuModel","useMenuModel","branch","supportedLanguages","includes","currentLanguage","setLanguage","defaultLanguage","isDefaultLanguage","translated","assign","CategoryFormLoader","redirectToCategoryList","useObjectValidation","yup","nameLabel","string","required","useExecutableQMenuCategoryForm","queryCategory","category","useMMenuCategoryUpdate","updateCategory","executeUpdate","getWriteVariables","useMMenuCategoryCreate","createCategory","wareCategoryType","useExecutableQMenuCategoryFormTrans","queryTranslations","internalNoteLabel","getDefaults","ROUTE_MENU_CATEGORY","pictogram","minCount","maxCount","recipes","formValues","enabled","idProp","orderOriginCategories","FormDeleteButton","mutationName","useXField","canDelete","useAccessGuard","goBack","StyledFormLayoutGrid","Middle","primaryColumnWidth","secondaryColumnWidth","mediaMobile","FormLayoutGrid","contentPrimary","contentSecondary","contentTopRight","contentBottomRight","FormDropdown","isMulti","options","getOptionValue","SelectControl","selection","isSelected","Array","isArray","option","F","filter","onChange","selectedOptions","setValue","getPropsForMulti","getPropsForSingle","onFocus","setTouched","hasError","CategoryOriginsField","IconLine","labelWidth","isSearchable","getOptionLabel","prop","CategoryPictogramSelect","availablePictograms","formatOptionLabel","components","SingleValue","styles","container","base","menuList","maxHeight","isClearable","StyledMenuTranslationInput","MenuTranslationInput","getFieldProps","isTranslating","fieldProps","src","getFlag","alt","MenuInternalNoteInput","localized","StyledLanguagePicker","LanguagePicker","MenuLanguageSwitch","availableLanguages","selectedLanguage","formatLanguage","identity","arrowColor","MenuNameInput","Label","DefaultLabelWidth","CategoryFormPrimary","useMMenuCategoryDelete","deleteCategory","FormGrid","useSettingsBranch","MenuSuggestionPanel","onAdd","addLabel","addButtonText","selectProps","useStateRef","getSelected","setSelected","onConfirm","selected","onKeyDown","onSelect","margin","propOr","priceTypes","WarePriceTypeEnum","Delivery","Inhouse","usePriceType","priceTypeLabels","getPriceTypesLabels","StyledCategoryRecipesView","mediaDesktop","StyledFormStretchedRow","SortableRecipes","StyledRecipeRow","SortableRecipe","recipe","prices","priceType","foundPrice","pathEq","NoteText","Price","currencyCode","price","currency","TouchButtonRemove","internalNote","CategoryRecipesView","useQMenuRecipeList","unselectedRecipesOnly","differenceWith","eqProps","isDesktop","useResponsive","addedRecipe","lockToContainerEdges","DataList","rowHeight","renderItem","index","reject","idPropEq","StyledCategoryRequirementControl","CategoryRequirementControl","count","countRef","Sizer","FormInputStyled","validity","valid","parseInt","select","pattern","StyledCheckbox","checked","getRulesMap","noLimit","min","max","optional","onlyOne","custom","CategoryRequirementsForm","ruleMap","useLocalStore","currentRule","setRule","rule","useAutorun","found","_","findKey","SelectControlFlat","formatItem","req","onSingleSelection","selectedRule","selectedItem","FormContainer","FormFixedRow","FormStretchedRow","MenuCategoryPage","match","params","getCategoryTypeLabel","hideLogoutWidget","withScrollArea","minHeight","CategorySuggestionPanel","currentCategories","without","RecipeCategoryView","noRowsText","from","remove","addedCategory","RecipeFormLoader","recipeId","recipeType","redirectToRecipeList","object","mapPriceTypes","useExecutableQMenuRecipeDefaults","queryDefaults","normalizeLoadedDefaults","defaults","useExecutableQMenuRecipeForm","queryRecipe","normalizeUpdateValues","useMMenuRecipeUpdate","updateRecipe","useMMenuRecipeCreate","createRecipe","useExecutableQMenuRecipeFormTrans","descriptionLabel","ROUTE_MENU_RECIPE","warePriceType","numeral","vat","vatId","sideDishCategories","sideDishes","wareCategories","associatedRecipes","pick","ingredients","stockItem","quantity","internalCode","image","vats","recipeSource","sourceAssociatedRecipes","associatedRecipe","formattedPrice","sourceIngredients","allergens","unitLabel","wareUnit","sourcePrice","sourcePrices","FormDisplayValue","createSvgIcon","MenuPriceField","Toll","FormFlatSingleSelect","getItemId","isInvalid","RecipeVatSelectField","useQMenuVats","RecipeAssocListTable","RecipeAssociatedView","useQMenuRecipeFormAssoc","isPriceType","isAssocRecipe","priceTypeRecipes","rejectSuggestions","some","onAddRecipe","onRemoveRecipe","both","FormPricingCurrencyCode","RecipeFormPricing","baseName","MarginBox","left","MenuCodeInput","MenuIdExternalSystem","MenuVisibilityField","AllergenBox","MarginAroundFormComponents","white","yellow","MenuAllergenIndicator","useQMenuAllergens","allergen","title","cn","active","StyledAllergenLabel","RecipeAllergenDisplay","uniq","flatten","RecipeDescriptionInput","RecipeFormPrimary","useMMenuRecipeDelete","deleteRecipe","RecipeIngredientsTable","rowIndex","String","unselectedStockOnly","RecipeIngredientsControl","useQMenuStockList","stockItems","addedStockItem","RecipeIngredientsView","ingredient","stockItemId","splice","findIndex","MenuRecipePage","right","bottom","getRecipeTypeLabel","TCategoryType","StyledDataTable","StockListTable","Loading","flexGrow","stockWithUnit","stockAllowNegative","StockListLoader","filterItem","getPredicate","partialMatch","exactMatch","MenuStockListPage","getStockCreateRoute","flexWrap","MenuFilterInput","CanMutate","StockFormLoader","stockId","redirectToStockList","array","of","useExecutableQMenuStockDefaults","allowNegativeDefault","getAllowNegativeDefault","allowNegative","useExecutableQMenuStockForm","queryStock","note","plu","useMMenuStockCreate","createStock","useMMenuStockUpdate","updateStock","FieldStateEnum","Default","ROUTE_MENU_STOCK","isEnabled","Disabled","StockAllergenField","Enabled","i18nMark","StockAllowNegativeField","StockPluField","Fingerprint","StockWareUnitField","useQMenuWareUnits","SelectAll","wareUnits","StockFormPrimary","useMMenuStockDelete","deleteStockItem","StockRecipesView","useQStockRecipes","BlockLoader","pathname","MenuStockPage","CanQuery","queryName","MenuRouting","SecureRoute","path","component","MenuRecipeListPage","to","ROUTE_MENU","NotFoundPage"],"mappings":"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","file":"static/js/187.5d165de9.chunk.js","sourcesContent":["import styled from 'styled-components'\n\ninterface IVerticalGapProps {\n  size?: number\n  sizeUnit?: string\n}\n\nexport const VerticalGap = styled.div`\n  height: ${({ size = 1, sizeUnit = 'rem' }: IVerticalGapProps) =>\n    `${size}${sizeUnit}`};\n`\n\nVerticalGap.displayName = 'VerticalGap'\n","import { useXFieldForInput, XFieldValidator } from '@speedlo/xform'\nimport { useObserver } from 'mobx-react-lite'\nimport React from 'react'\n\nimport { StyledFormInput } from '../../atoms/FormInputStyled'\n\ninterface IProps extends LegacyOmit<React.InputHTMLAttributes<never>, 'name'> {\n  fieldName: FieldName\n  validate?: XFieldValidator<string>\n  fullWidth?: boolean\n  children?: never\n  addHiddenLabelWithPlaceholderText?: boolean\n}\n\nexport type FormInputProps = IProps\n\nexport const FormInput = React.forwardRef<HTMLInputElement, IProps>(\n  (\n    {\n      fieldName,\n      fullWidth,\n      addHiddenLabelWithPlaceholderText: withLabel = true,\n      ...props\n    },\n    inputRef,\n  ) => {\n    const [field, getInputProps] = useXFieldForInput<string>(fieldName)\n    return useObserver(() => (\n      <>\n        <StyledFormInput\n          {...getInputProps()}\n          invalid={field.touched && Boolean(field.error)}\n          inputFullWidth={fullWidth}\n          ref={inputRef}\n          {...props}\n        />\n        {withLabel && props.placeholder && (\n          <label hidden={true} htmlFor={field.name}>\n            {props.placeholder}\n          </label>\n        )}\n      </>\n    ))\n  },\n)\n","import { Delete } from '@material-ui/icons'\nimport React from 'react'\n\nimport { SizerButton } from '../atoms/SizerButton'\nimport { Colors } from '../styling'\nimport { ITouchButtonProps, TouchButton } from './TouchButton'\n\ninterface ITouchButtonDeleteProps\n  extends LegacyOmit<ITouchButtonProps, 'onClick'> {\n  confirmText?: string\n  onDelete(): void\n}\n\nexport const TouchButtonDelete: React.FC<ITouchButtonDeleteProps> = ({\n  onDelete,\n  confirmText,\n  ...props\n}) => {\n  return (\n    <SizerButton>\n      <TouchButton\n        icon={Delete}\n        color={Colors.greyMiddle}\n        onClick={ev => {\n          ev.preventDefault()\n          if (!confirmText || window.confirm(confirmText)) {\n            onDelete()\n          }\n        }}\n        {...props}\n      />\n    </SizerButton>\n  )\n}\n","import { IFormState } from 'react-form'\nimport { isEmpty } from 'validator'\n\nimport { i18n } from '../i18n'\n\nexport function isFormValid(formState: IFormState) {\n  return !formState.errors || Object.keys(formState.errors).length === 0\n}\n\nexport function validateIsRequired(fieldName: string) {\n  return (value: string) =>\n    isEmpty(value + '') ? i18n.t`${fieldName} must be entered` : null\n}\n\nexport function parseNumber(value: string | number) {\n  return typeof value === 'number'\n    ? value\n    : Number.parseFloat(value.replace(',', '.'))\n}\n","import { ErrorOutline } from '@material-ui/icons'\nimport { useXFormState } from '@speedlo/xform'\nimport { useObserver } from 'mobx-react-lite'\nimport React from 'react'\n\nimport { ITouchButtonProps, TouchButton } from '../../molecules/TouchButton'\nimport { Colors } from '../../styling'\n\ninterface IProps extends ITouchButtonProps {\n  children: ReactNode | ReactNode[] | string\n}\n\nexport const FormSubmitButton: React.FC<IProps> = ({\n  children,\n  id = 'form-submit',\n  ...props\n}) => {\n  const state = useXFormState()\n  return useObserver(() => (\n    <TouchButton\n      type=\"submit\"\n      color={Colors.green}\n      disabled={state.isSubmitting && state.isDirty}\n      id={id}\n      icon={!state.isValid ? ErrorOutline : undefined}\n      iconSize={1.1}\n      iconColor={Colors.red}\n      {...props}\n    >\n      <>{children}</>\n    </TouchButton>\n  ))\n}\n","import styled from 'styled-components/macro'\n\nexport const FlexDiv = styled.div`\n  display: flex;\n`\n","import { Reorder } from '@material-ui/icons'\nimport React from 'react'\nimport { SortableHandle } from 'react-sortable-hoc'\nimport styled from 'styled-components'\n\nimport { Icon } from './Icon'\n\ninterface IProps {}\n\nconst StyledDragHandle = styled.div`\n  padding: 1rem 0.4rem;\n  cursor: grab;\n`\nexport const DragHandle = SortableHandle<IProps>(() => (\n  <StyledDragHandle>\n    <Icon icon={Reorder} />\n  </StyledDragHandle>\n))\n","import '@speedlo/assets/Flaticon.css'\n\nimport styled from 'styled-components/macro'\n\nimport { Spacing } from '../styling'\n\ninterface IProps {\n  pictogramId: string\n  fontSize?: number\n  fontSizeUnit?: string\n}\n\nconst getFontSize = ({\n  fontSize = 2,\n  fontSizeUnit = Spacing.DefaultSizeUnit,\n}: IProps) => `${fontSize}${fontSizeUnit}`\n\nexport const PictogramDisplay = styled.div.attrs<IProps>(({ pictogramId }) => ({\n  className: getPictogramClassName(pictogramId),\n}))<IProps>`\n  &:before {\n    font-size: ${getFontSize} !important;\n    margin-left: 0.5rem !important;\n  }\n`\n\nexport function getPictogramClassName(pictogramId: string) {\n  return `flaticon-${pictogramId}`\n}\n","import React from 'react';\nimport createSvgIcon from './utils/createSvgIcon';\nexport default createSvgIcon(React.createElement(React.Fragment, null, React.createElement(\"path\", {\n  fill: \"none\",\n  d: \"M0 0h24v24H0V0z\"\n}), React.createElement(\"path\", {\n  d: \"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z\"\n})), 'ErrorOutline');","import { Trans } from '@lingui/macro'\nimport { observer } from 'mobx-react-lite'\nimport React from 'react'\nimport styled from 'styled-components'\n\nimport { useRoot } from '../../../atoms/RootProvider'\nimport { useQMenuGuideDownload } from '../../../graph/generated'\nimport { TouchButton } from '../../../molecules/TouchButton'\nimport { Colors } from '../../../styling'\n\nconst MenuGuideDownloadButton = styled(TouchButton)`\n  white-space: nowrap;\n  margin-left: 2rem;\n  & a {\n    text-decoration: none;\n    color: ${Colors.black};\n    padding: 1rem;\n  }\n`\n\nexport const MenuGuideDownload = observer(() => {\n  const { settings } = useRoot()\n  const { loading, data } = useQMenuGuideDownload(\n    {\n      branchId: settings.branchId,\n    },\n    { fetchPolicy: 'cache-first' },\n  )\n  if (loading || !data.companyBranch.foodMenuUrl) {\n    return null\n  }\n  return (\n    <MenuGuideDownloadButton color={Colors.greyMiddle}>\n      <a\n        href={data.companyBranch.foodMenuUrl}\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n      >\n        <Trans>Menu codes manual</Trans>\n      </a>\n    </MenuGuideDownloadButton>\n  )\n})\n","import React from 'react'\nimport {\n  arrayMove,\n  SortableContainer,\n  SortableElement,\n  SortEndHandler,\n} from 'react-sortable-hoc'\nimport { TableRowProps } from 'react-virtualized'\n\nimport { DataTable, IDataTableProps } from '../atoms/DataTable'\n\ninterface ISortResult<T> {\n  item: T\n  items: RoA<T>\n  offset: number\n  oldIndex: number\n  newIndex: number\n}\n\nexport type TSortHandler<T> = (\n  result: ISortResult<T>,\n) => Promise<boolean> | void\n\ninterface IProps<T> extends IDataTableProps<T> {\n  items: RoA<T>\n  onSort?: TSortHandler<T>\n}\n\ninterface IState<T> {\n  sortedItems: RoA<T>\n}\n\nconst SortableTableRowRenderer = SortableElement(\n  ({ columns, style, className }: TableRowProps) => (\n    <div style={style} className={className}>\n      {columns}\n    </div>\n  ),\n)\n\nconst SortableDataTableContainer = SortableContainer(DataTable)\n\nexport class SortableDataTable<T> extends React.PureComponent<\n  IProps<T>,\n  IState<T>\n> {\n  state = { sortedItems: this.props.items }\n  static getDerivedStateFromProps = (nextProps: IProps<{}>) => {\n    return {\n      sortedItems: nextProps.items,\n    }\n  }\n  rowRenderer = rowProps => {\n    return <SortableTableRowRenderer {...rowProps} />\n  }\n  onHandleSorting: SortEndHandler = async ({ newIndex, oldIndex }) => {\n    if (newIndex === oldIndex) {\n      return\n    }\n    const currentItems = [...this.state.sortedItems]\n    const sortedItems = arrayMove(\n      this.state.sortedItems as T[],\n      oldIndex,\n      newIndex,\n    )\n\n    this.setState({ sortedItems })\n\n    if (this.props.onSort) {\n      const sortSuccess = this.props.onSort({\n        item: currentItems[oldIndex],\n        items: sortedItems,\n        offset: newIndex - oldIndex,\n        newIndex,\n        oldIndex,\n      })\n      if (sortSuccess && !(await sortSuccess)) {\n        this.setState({\n          sortedItems: currentItems,\n        })\n      }\n    }\n  }\n  render() {\n    const { items, ...props } = this.props\n    return (\n      <SortableDataTableContainer\n        lockAxis=\"y\"\n        useDragHandle={true}\n        onSortEnd={this.onHandleSorting}\n        rowRenderer={this.rowRenderer}\n        {...props}\n        items={this.state.sortedItems}\n      />\n    )\n  }\n}\n","import React from 'react'\n\nimport {\n  checkColumnAccess,\n  Column,\n  ColumnRendererEdit,\n  ColumnRendererRemove,\n  ColumnRendererVisibility,\n  ColumnRendererWithNote,\n  DataTable,\n  DataTableEmptyText,\n  IDataTableProps,\n} from '../../../atoms/DataTable'\nimport { DragHandle } from '../../../atoms/DragHandle'\nimport { FMenuCategoryInListFragment } from '../../../graph/generated'\nimport { i18n } from '../../../i18n'\nimport {\n  SortableDataTable,\n  TSortHandler,\n} from '../../../molecules/SortableDataTable'\nimport { Spacing } from '../../../styling'\nimport { useMenuRouting } from '../hooks/useMenuRouting'\n\ntype TCategory = FMenuCategoryInListFragment\n\ninterface IProps {\n  categories: RoA<TCategory>\n  isSortable?: boolean\n  isLoading?: boolean\n  showEditColumn?: boolean\n  showRemoveColumn?: boolean\n  showVisibilityColumn?: boolean\n  showHeader?: boolean\n  onToggle?(categoryId: ID, visible: boolean): void\n  onRemove?(categoryId: ID): void\n  onSort?: TSortHandler<TCategory>\n  heightStretch?: boolean\n  fullHeight?: boolean\n  noRowsDisplay?: ReactNode\n}\n\nexport const CategoryListTable: React.FC<IProps> = ({\n  categories,\n  children,\n  onToggle,\n  onRemove,\n  onSort,\n  showEditColumn = true,\n  showRemoveColumn = false,\n  showVisibilityColumn = false,\n  showHeader = true,\n  isSortable = false,\n  isLoading = false,\n  heightStretch = false,\n  fullHeight = false,\n  noRowsDisplay = <DataTableEmptyText text={i18n.t`No recipes in category`} />,\n}) => {\n  const props: IDataTableProps<TCategory> = {\n    isLoading,\n    items: categories,\n    disableHeader: !showHeader,\n    heightStretch,\n    fullHeight,\n    noRowsRenderer: () => noRowsDisplay,\n  }\n  const { getCategoryEditRoute } = useMenuRouting()\n  const columns = [\n    showEditColumn && (\n      <Column\n        dataKey=\"id\"\n        width={Spacing.ButtonColumnWidthPx}\n        minWidth={Spacing.ButtonColumnWidthPx}\n        cellRenderer={checkColumnAccess(\n          { canQuery: 'wareCategory' },\n          ColumnRendererEdit,\n        )}\n        cellDataGetter={({ rowData }) =>\n          getCategoryEditRoute(rowData.id, rowData.categoryType.enum)\n        }\n      />\n    ),\n    showRemoveColumn && (\n      <Column\n        dataKey=\"id\"\n        width={Spacing.ButtonColumnWidthPx}\n        minWidth={Spacing.ButtonColumnWidthPx}\n        cellRenderer={ColumnRendererRemove}\n        columnData={{ onRemove }}\n      />\n    ),\n    showVisibilityColumn && (\n      <Column\n        dataKey=\"visible\"\n        width={Spacing.ButtonColumnWidthPx}\n        minWidth={Spacing.ButtonColumnWidthPx}\n        cellRenderer={checkColumnAccess(\n          { canMutate: 'updateWareCategory' },\n          ColumnRendererVisibility,\n        )}\n        columnData={{ onToggle }}\n      />\n    ),\n    <Column\n      dataKey=\"nameLabel\"\n      width={300}\n      label={i18n.t`Name`}\n      cellRenderer={ColumnRendererWithNote}\n      columnData={{ noteKey: 'internalNote' }}\n    />,\n    <Column\n      dataKey=\"countRecipes\"\n      label={i18n.t`Recipe count`}\n      width={100}\n      cellRenderer={({ cellData }) =>\n        `${cellData} ${i18n.t`Recipes`.toLocaleLowerCase()}`\n      }\n    />,\n    children,\n    isSortable && (\n      <Column dataKey=\"id\" width={50} cellRenderer={() => <DragHandle />} />\n    ),\n  ]\n\n  if (isSortable) {\n    return React.createElement(\n      SortableDataTable,\n      {\n        onSort: onSort as any,\n        ...props,\n      },\n      ...columns,\n    )\n  }\n\n  return React.createElement(DataTable, props, ...columns)\n}\n","import { observer } from 'mobx-react-lite'\nimport React from 'react'\nimport styled from 'styled-components'\n\nimport { Column } from '../../../atoms/DataTable'\nimport { FlexColumn } from '../../../atoms/FlexColumn'\nimport { FlexRowSingle } from '../../../atoms/FlexRowSingle'\nimport { Headline } from '../../../atoms/Headline'\nimport { useRoot } from '../../../atoms/RootProvider'\nimport {\n  FMenuCategoryInListFragment,\n  OrderOriginCategoryEnum,\n  useMMenuCategorySort,\n  useMMenuCategoryVisibility,\n  useQMenuCategoryList,\n  useQMenuCategoryOrigins,\n  WareCategoryTypeEnum,\n} from '../../../graph/generated'\nimport { useLoadingCache } from '../../../hooks/useLoadingCache'\nimport { Colors } from '../../../styling'\nimport { MenuCreateButton } from '../atoms/MenuCreateButton'\nimport { useMenuRouting } from '../hooks/useMenuRouting'\nimport { CategoryListTable } from '../molecules/CategoryListTable'\n\ninterface IProps {\n  headline: string\n  subHeadline?: string\n  categoryType: WareCategoryTypeEnum\n  heightStretch?: boolean\n}\n\nconst StyledCategoryList = styled.div`\n  .origins span {\n    display: inline-block;\n    margin: 0.2rem;\n    padding: 0.2rem;\n    background-color: ${Colors.greyLight};\n  }\n`\n\nconst CategoryList: React.FC<IProps> = ({\n  headline,\n  subHeadline = false,\n  categoryType,\n}) => {\n  const { settings } = useRoot()\n  const { data, loading, updateQuery, refetch } = useQMenuCategoryList({\n    branchId: settings.branchId,\n    categoryType,\n  })\n\n  const { data: dataOrigins } = useQMenuCategoryOrigins(\n    {},\n    { fetchPolicy: 'cache-first' },\n  )\n\n  const originsMap = React.useMemo(() => {\n    if (dataOrigins && dataOrigins.origins) {\n      return dataOrigins.origins.reduce((acc, origin) => {\n        acc[origin.enum] = origin.code\n        return acc\n      }, {}) as Record<OrderOriginCategoryEnum, string>\n    }\n    return {} as Record<OrderOriginCategoryEnum, string>\n  }, [dataOrigins])\n\n  const renderOrigins = React.useCallback(\n    ({ cellData }) => {\n      cellData.sort()\n      return cellData.map(originEnum => (\n        <span key={originEnum}>{originsMap[originEnum]}</span>\n      ))\n    },\n    [originsMap],\n  )\n\n  const [changeVisibility] = useMMenuCategoryVisibility()\n  const onVisibilityToogle = React.useCallback(\n    (categoryId: ID, visible: boolean) => {\n      changeVisibility(\n        { categoryId, visible },\n        {\n          optimisticResponse: {\n            updateWareCategory: {\n              __typename: 'WareCategory',\n              id: categoryId,\n              visible,\n            },\n          },\n        },\n      )\n    },\n    [changeVisibility],\n  )\n\n  const [sortCategory] = useMMenuCategorySort()\n  const onSort = React.useCallback(\n    async ({ item, items, offset }) => {\n      updateQuery(() => ({\n        categories: items,\n      }))\n      const result = await sortCategory({\n        categoryId: item.id,\n        offset,\n      })\n      if (result) {\n        await refetch()\n        return result.success\n      }\n      return false\n    },\n    [refetch, sortCategory, updateQuery],\n  )\n\n  const getCategories = useLoadingCache<RoA<FMenuCategoryInListFragment>>()\n  const categories = getCategories(loading, () => data.categories)\n\n  const { getCategoryCreateRoute } = useMenuRouting()\n\n  return (\n    <StyledCategoryList>\n      <FlexRowSingle>\n        <FlexColumn widthGrowIndex={1}>\n          <Headline>{headline}</Headline>\n          {subHeadline && <Headline size=\"smaller\">{subHeadline}</Headline>}\n        </FlexColumn>\n        <FlexColumn fixedWidth={true}>\n          <MenuCreateButton routeTo={getCategoryCreateRoute(categoryType)} />\n        </FlexColumn>\n      </FlexRowSingle>\n      <CategoryListTable\n        isLoading={loading}\n        categories={categories || []}\n        onToggle={onVisibilityToogle}\n        isSortable={true}\n        showHeader={false}\n        fullHeight={true}\n        showVisibilityColumn={true}\n        onSort={onSort}\n      >\n        <Column\n          dataKey=\"origins\"\n          width={300}\n          className=\"origins\"\n          cellRenderer={renderOrigins}\n          style={{ fontSize: '0.8rem' }}\n        />\n      </CategoryListTable>\n    </StyledCategoryList>\n  )\n}\n\nexport default observer(CategoryList)\n","import React from 'react'\nimport styled from 'styled-components'\n\nimport { Card } from '../../../atoms/Card'\nimport { FlexColumn } from '../../../atoms/FlexColumn'\nimport { FlexRowSingle } from '../../../atoms/FlexRowSingle'\nimport { VerticalGap } from '../../../atoms/VerticalGap'\nimport { WareCategoryTypeEnum } from '../../../graph/generated'\nimport { i18n } from '../../../i18n'\nimport { FullPageLayout } from '../../../molecules/FullPageLayout'\nimport { PageLayoutFullHeightItem } from '../../../molecules/PageLayoutFullHeightItem'\nimport { SettingsCompanyBranchPicker } from '../../settings/organisms/SettingsCompanyBranchPicker'\nimport { ROUTE_SETTINGS } from '../../settings/settings.routes'\nimport { MenuGuideDownload } from '../molecules/MenuGuideDownload'\nimport CategoryList from '../organisms/CategoryList'\n\nexport const PartialDataTableContainer = styled.div`\n  height: calc(100% - 3.5rem);\n  padding-top: 1rem;\n  overflow-y: scroll;\n  overflow-x: hidden;\n  -webkit-overflow-scrolling: touch;\n`\n\nexport const MenuCategoryListPage: React.FC = () => (\n  <FullPageLayout\n    pageTitle={i18n.t`Category overview`}\n    useBackButton\n    backRoute={ROUTE_SETTINGS}\n  >\n    <PageLayoutFullHeightItem forcePercentHeightInMobile={100}>\n      <Card stretchToParent={true}>\n        <FlexRowSingle justify=\"start\">\n          <FlexColumn>\n            <SettingsCompanyBranchPicker width={20} />\n          </FlexColumn>\n          <FlexColumn>\n            <MenuGuideDownload />\n          </FlexColumn>\n        </FlexRowSingle>\n\n        <PartialDataTableContainer>\n          <CategoryList\n            categoryType={WareCategoryTypeEnum.Main}\n            headline={i18n.t`Category of recipes`}\n          />\n\n          <VerticalGap size={1.5} />\n\n          <CategoryList\n            categoryType={WareCategoryTypeEnum.SideDish}\n            headline={i18n.t`Category of sidedish`}\n          />\n\n          <VerticalGap size={1.5} />\n\n          <CategoryList\n            categoryType={WareCategoryTypeEnum.Cover}\n            headline={i18n.t`Category of covers`}\n          />\n        </PartialDataTableContainer>\n        {/* <VerticalGap size={1.5} />\n      <Trans>\n        <Headline>Recipes without category</Headline>\n        <Headline size=\"smaller\">are not visible anywhere</Headline>\n      </Trans> */}\n      </Card>\n    </PageLayoutFullHeightItem>\n  </FullPageLayout>\n)\n","import styled from 'styled-components'\n\nimport { Colors, Radiuses } from '../styling'\n\nexport const TopRightButtonContainer = styled.div`\n  position: fixed;\n  z-index: 500;\n  right: 0.5rem;\n  top: 0.5rem;\n  width: 10rem;\n  opacity: 0.96;\n  background: ${Colors.black};\n  border-radius: ${Radiuses.Button};\n`\n","import { useXFieldState } from '@speedlo/xform'\n\nimport { TMenuItemType } from '../menu.types'\n\nexport function useMenuItemType() {\n  const field = useXFieldState<TMenuItemType>('itemType')\n  return field.value\n}\n","import React from 'react'\n\nimport { WareCategoryTypeEnum } from '../../../graph/generated'\nimport { useMenuItemType } from '../hooks/useMenuItemType'\n\ninterface IProps {\n  isMain?: boolean\n  isSideDish?: boolean\n  isCover?: boolean\n  children: ReactNode | ReactNode[]\n}\n\nexport const IsMenuItemType: React.FC<IProps> = ({\n  isMain,\n  isSideDish,\n  isCover,\n  children,\n}) => {\n  const itemType = useMenuItemType()\n  if (\n    (isMain === true && itemType === WareCategoryTypeEnum.Main) ||\n    (isSideDish === true && itemType === WareCategoryTypeEnum.SideDish) ||\n    (isCover === true && itemType === WareCategoryTypeEnum.Cover)\n  ) {\n    return <>{children}</>\n  }\n  return null\n}\n","import { Trans } from '@lingui/macro'\nimport React from 'react'\n\nimport { FormSubmitButton } from '../../../components/forms/FormSubmitButton'\nimport { useCanMutate } from '../../../hooks/useAccessGuard'\n\ninterface IProps {\n  isCreate: boolean\n  createMutation: string\n  updateMutation: string\n}\n\nexport const MenuSubmitButton: React.FC<IProps> = ({\n  isCreate,\n  createMutation,\n  updateMutation,\n}) => {\n  const canSubmit = useCanMutate(isCreate ? createMutation : updateMutation)\n  if (!canSubmit) {\n    return null\n  }\n\n  return (\n    <FormSubmitButton>\n      {isCreate ? <Trans>Create</Trans> : <Trans>Save</Trans>}\n    </FormSubmitButton>\n  )\n}\n","import { useRouterContext } from '@speedlo/hooks'\nimport { TValidationSchema, useXForm, XFormErrors } from '@speedlo/xform'\nimport React from 'react'\n\nimport { logForm } from '../../helpers/logger'\nimport { useSnackBar } from '../../hooks/useSnackBar'\n\ninterface IOptions<TValues> {\n  initialValues: TValues\n  loadValues?(initialValues: TValues): Promise<Partial<TValues> | undefined>\n  onSubmit(values: TValues): Promise<any>\n  submitMessage?: string\n  submitRedirectPath?: string\n  validationSchema?: TValidationSchema\n}\n\nexport type TFormLoaderOptions<TValues = any> = IOptions<TValues>\n\nconst logger =\n  process.env.REACT_APP_STAGE !== 'prod' ? obj => logForm('%o', obj) : undefined\n\nexport function useFormLoader<TValues>({\n  onSubmit,\n  initialValues,\n  loadValues,\n  validationSchema,\n  submitMessage,\n  submitRedirectPath,\n}: IOptions<TValues>) {\n  const { history } = useRouterContext()\n  const { enqueueSuccess, enqueueWarning } = useSnackBar()\n\n  const onSubmitSuccess = React.useCallback(\n    async (values: TValues) => {\n      await onSubmit(values)\n      if (submitMessage) {\n        enqueueSuccess(submitMessage)\n      }\n      if (submitRedirectPath) {\n        history.push(submitRedirectPath)\n      }\n    },\n    [enqueueSuccess, history, onSubmit, submitMessage, submitRedirectPath],\n  )\n\n  const onSubmitFailed = React.useCallback(\n    (values: TValues, errors: XFormErrors) => {\n      for (const msg of errors.values()) {\n        if (msg) {\n          enqueueWarning(msg)\n        }\n      }\n    },\n    [enqueueWarning],\n  )\n\n  const hasLoaded = React.useRef(false)\n\n  const onReset = React.useCallback(() => {\n    hasLoaded.current = false\n  }, [])\n\n  const xform = useXForm<TValues>({\n    onSubmit: onSubmitSuccess,\n    onSubmitFailed,\n    onReset,\n    validationSchema,\n    initialValues,\n    initialValidationEnabled: loadValues === undefined,\n    ignoreUnknownFieldsInValidation: true,\n    onFormChanges: logger,\n  })\n\n  React.useEffect(() => {\n    if (!hasLoaded.current) {\n      if (loadValues) {\n        Promise.resolve(loadValues(xform.state.initialValues)).then(values => {\n          if (values) {\n            xform.api.mergeValues(values)\n            xform.state.pristineValues = xform.state.values\n          }\n          xform.api.enableValidation()\n        })\n      }\n      hasLoaded.current = true\n    }\n  }, [loadValues, xform])\n\n  return xform\n}\n","import { TValidationSchema, XFormRender } from '@speedlo/xform'\nimport React from 'react'\n\nimport { useFormLoader } from '../../../components/forms/useFormLoader'\n\ninterface IProps<TValues> {\n  isCreate: boolean\n  initialValues: TValues\n  loadUpdateValues(values: TValues): Promise<Partial<TValues> | undefined>\n  loadCreateDefaults?(values: TValues): Promise<Partial<TValues> | undefined>\n  onCreate(values: TValues): Promise<any>\n  onUpdate(values: TValues): Promise<any>\n  createSuccessMessage?: string\n  updateSuccessMessage?: string\n  successRedirectPath?: string\n  validationSchema: TValidationSchema\n  children: ReactNode | ReactNode[]\n}\n\nexport function MenuFormLoader<TValues>({\n  isCreate,\n  initialValues,\n  loadCreateDefaults,\n  loadUpdateValues,\n  onCreate,\n  onUpdate,\n  createSuccessMessage,\n  updateSuccessMessage,\n  successRedirectPath,\n  validationSchema,\n  children,\n}: IProps<TValues>) {\n  const xform = useFormLoader({\n    initialValues,\n    validationSchema,\n    onSubmit: isCreate ? onCreate : onUpdate,\n    loadValues: isCreate ? loadCreateDefaults : loadUpdateValues,\n    submitMessage: isCreate ? createSuccessMessage : updateSuccessMessage,\n    submitRedirectPath: successRedirectPath,\n  })\n  return <XFormRender xform={xform}>{children}</XFormRender>\n}\n","import { useXFieldState } from '@speedlo/xform'\n\nexport const isCreateId = (id: ID) => id === 'NEW'\n\nexport function useMenuItemId() {\n  const field = useXFieldState<ID>('id')\n  return field.value\n}\n","import { RM } from '@speedlo/tools'\nimport { useXFieldState } from '@speedlo/xform'\n\nimport { LanguageEnum } from '../../../graph/generated'\n\nconst byLanguage = RM.propEq('language')\n\nexport interface WithLanguage {\n  language: LanguageEnum\n}\n\nexport interface WithTranslations<T extends WithLanguage> {\n  translations: T[]\n}\n\nexport function useMenuTranslations() {\n  const field = useXFieldState<WithLanguage[]>('translations')\n  const translations = field.value\n\n  const findTranslation = <T extends WithLanguage>(language: LanguageEnum) => {\n    return (\n      translations && (translations.find(byLanguage(language)) as T | undefined)\n    )\n  }\n\n  const getTranslation = <T extends WithLanguage>(\n    language: LanguageEnum,\n  ): T | undefined => {\n    return findTranslation(language)\n  }\n\n  const getTranslationOrCreate = <T extends WithLanguage>(\n    language: LanguageEnum,\n    create: () => LegacyOmit<T, 'language'>,\n  ): T => {\n    const translation = findTranslation<T>(language)\n    if (!translation) {\n      translations.push({ language, ...create() })\n      return getTranslation<T>(language)!\n    }\n    return translation\n  }\n\n  const hasTranslation = (language: LanguageEnum) => {\n    return !!findTranslation(language)\n  }\n\n  return { hasTranslation, getTranslation, getTranslationOrCreate }\n}\n","import { observer } from 'mobx-react-lite'\nimport React from 'react'\n\nimport { LanguageEnum } from '../../../graph/generated'\nimport { useMenuModel } from '../hooks/useMenu'\nimport { isCreateId, useMenuItemId } from '../hooks/useMenuItemId'\nimport { useMenuTranslations } from '../hooks/useMenuTranslations'\n\ninterface IProps {\n  loadTranslations(language: LanguageEnum): Promise<object | undefined>\n  children?: never\n}\n\nexport const MenuTranslationLoader = observer<IProps>(\n  ({ loadTranslations }) => {\n    const menuModel = useMenuModel()\n    const isCreate = isCreateId(useMenuItemId())\n    const { hasTranslation, getTranslationOrCreate } = useMenuTranslations()\n\n    React.useEffect(() => {\n      if (\n        menuModel.branch &&\n        !menuModel.branch.supportedLanguages.includes(menuModel.currentLanguage)\n      ) {\n        menuModel.setLanguage(menuModel.defaultLanguage)\n      }\n    }, [menuModel])\n\n    if (menuModel.isDefaultLanguage || isCreate) {\n      return null\n    }\n\n    // do not override existing translation\n    if (hasTranslation(menuModel.currentLanguage)) {\n      return null\n    }\n\n    loadTranslations(menuModel.currentLanguage).then((translated = {}) => {\n      Object.assign(\n        getTranslationOrCreate(menuModel.currentLanguage, () => translated),\n        translated,\n      )\n    })\n\n    return null\n  },\n)\n","import { idProp } from '@speedlo/tools'\nimport { useObjectValidation } from '@speedlo/xform'\nimport React from 'react'\n\nimport {\n  useExecutableQMenuCategoryForm,\n  useExecutableQMenuCategoryFormTrans,\n  useMMenuCategoryCreate,\n  useMMenuCategoryUpdate,\n  WareCategoryTypeEnum,\n} from '../../../graph/generated'\nimport { LanguageEnum } from '../../../graph/types'\nimport { i18n } from '../../../i18n'\nimport { useMenuModel } from '../hooks/useMenu'\nimport { useMenuRouting } from '../hooks/useMenuRouting'\nimport { ROUTE_MENU_CATEGORY } from '../menu.routes'\nimport { TCategoryFormValues } from '../menu.types'\nimport { MenuFormLoader } from '../molecules/MenuFormLoader'\nimport { MenuTranslationLoader } from '../molecules/MenuTranslationLoader'\n\ninterface IProps {\n  isCreate: boolean\n  categoryId: ID\n  categoryType: WareCategoryTypeEnum\n  children: ReactNode\n}\n\nexport const CategoryFormLoader: React.FC<IProps> = ({\n  isCreate,\n  categoryId,\n  categoryType,\n  children,\n}) => {\n  const menuModel = useMenuModel()\n  const { redirectToCategoryList } = useMenuRouting()\n\n  const validationSchema = useObjectValidation(yup => ({\n    nameLabel: yup\n      .string()\n      .required(i18n.t`Category name in default language must be entered.`),\n  }))\n\n  const [queryCategory] = useExecutableQMenuCategoryForm()\n  const loadUpdateValues = React.useCallback(\n    async (values: TCategoryFormValues) => {\n      const result = await queryCategory(\n        { categoryId: categoryId! },\n        { fetchPolicy: 'no-cache' },\n      )\n      if (result === null) {\n        redirectToCategoryList()\n        return values\n      }\n      return {\n        ...result.category,\n        itemType: categoryType,\n        origins: [...result.category.origins],\n      }\n    },\n    [categoryId, categoryType, queryCategory, redirectToCategoryList],\n  )\n\n  const [updateCategory] = useMMenuCategoryUpdate()\n  const executeUpdate = React.useCallback(\n    (categoryId: ID, values: TCategoryFormValues) =>\n      updateCategory({\n        categoryId,\n        category: {\n          ...getWriteVariables(values),\n          translations: values.translations,\n        },\n      }),\n    [updateCategory],\n  )\n\n  const onUpdate = React.useCallback(\n    (values: TCategoryFormValues) => executeUpdate(categoryId, values),\n    [categoryId, executeUpdate],\n  )\n\n  const [createCategory] = useMMenuCategoryCreate()\n  const onCreate = React.useCallback(\n    async (values: TCategoryFormValues) => {\n      const result = await createCategory({\n        category: {\n          companyBranch: menuModel.branchId,\n          wareCategoryType: categoryType,\n          ...getWriteVariables(values),\n        },\n      })\n      if (result && values.translations && values.translations.length > 0) {\n        const categoryId = result.createCategory.id\n        executeUpdate(categoryId, values)\n      }\n    },\n    [categoryType, createCategory, executeUpdate, menuModel],\n  )\n\n  const [queryTranslations] = useExecutableQMenuCategoryFormTrans()\n  const loadTranslations = React.useCallback(\n    async (language: LanguageEnum) => {\n      const result = await queryTranslations(\n        { categoryId, language },\n        { fetchPolicy: 'no-cache' },\n      )\n      if (result === null) {\n        return\n      }\n      const { nameLabel, internalNoteLabel } = result.category\n      return { nameLabel, internalNoteLabel }\n    },\n    [categoryId, queryTranslations],\n  )\n\n  return (\n    <MenuFormLoader<TCategoryFormValues>\n      isCreate={isCreate}\n      onCreate={onCreate}\n      onUpdate={onUpdate}\n      initialValues={getDefaults(categoryType)}\n      loadUpdateValues={loadUpdateValues}\n      validationSchema={validationSchema}\n      successRedirectPath={ROUTE_MENU_CATEGORY}\n    >\n      <>\n        <MenuTranslationLoader loadTranslations={loadTranslations} />\n        {children}\n      </>\n    </MenuFormLoader>\n  )\n}\n\nfunction getDefaults(categoryType: WareCategoryTypeEnum): TCategoryFormValues {\n  return {\n    id: 'NEW',\n    itemType: categoryType,\n    visible: true,\n    internalNoteLabel: '',\n    pictogram: '',\n    nameLabel: '',\n    minCount: 0,\n    maxCount: 0,\n    recipes: [],\n    origins: [],\n    translations: [],\n  }\n}\n\nfunction getWriteVariables(formValues: TCategoryFormValues) {\n  return {\n    nameLabel: formValues.nameLabel!,\n    internalNoteLabel: formValues.internalNoteLabel,\n    enabled: formValues.visible,\n    pictogram: formValues.pictogram,\n    recipes: formValues.recipes.map(idProp),\n    minCount: formValues.minCount,\n    maxCount: formValues.maxCount,\n    orderOriginCategories: formValues.origins,\n  }\n}\n","import { useRouterContext } from '@speedlo/hooks'\nimport { useXField } from '@speedlo/xform'\nimport { observer } from 'mobx-react-lite'\nimport React from 'react'\n\nimport { useAccessGuard } from '../../hooks/useAccessGuard'\nimport { TouchButtonDelete } from '../../molecules/TouchButtonDelete'\n\ninterface IProps {\n  fieldName?: FieldName\n  mutationName?: string\n  confirmText: string\n  onDelete(id: ID): Promise<any>\n  children?: never\n}\n\nexport const FormDeleteButton = observer<IProps>(\n  ({ fieldName = 'id', mutationName, confirmText, onDelete }) => {\n    const field = useXField<ID>(fieldName)\n    const canDelete = useAccessGuard([], mutationName ? [mutationName] : [])\n\n    const { history } = useRouterContext()\n\n    if (!canDelete || field.value === 'NEW') {\n      return null\n    }\n\n    return (\n      <TouchButtonDelete\n        type=\"button\"\n        confirmText={confirmText}\n        onDelete={async () => {\n          await onDelete(field.value)\n          history.goBack()\n        }}\n      />\n    )\n  },\n)\n","import React from 'react'\nimport styled from 'styled-components/macro'\n\nimport { mediaMobile } from '../../../app/Responsive'\nimport { Spacing } from '../../../styling'\n\ninterface IStyledProps {\n  primaryColumnWidth?: string\n  secondaryColumnWidth?: string\n}\n\ninterface IProps extends IStyledProps {\n  contentPrimary: React.ReactNode\n  contentSecondary?: React.ReactNode\n  contentTopRight?: React.ReactNode\n  contentBottomRight?: React.ReactNode\n}\n\nconst StyledFormLayoutGrid = styled.div<IStyledProps>`\n  display: grid;\n  margin: -${Spacing.Middle};\n  grid-column-gap: ${Spacing.Middle};\n  grid-template-columns: ${Spacing.Middle} ${({ primaryColumnWidth }) =>\n      primaryColumnWidth} ${({ secondaryColumnWidth }) => secondaryColumnWidth} auto;\n  grid-template-rows: ${Spacing.Middle} auto 1fr auto ${Spacing.Middle};\n  grid-template-areas:\n    '. .              .                contentTopRight'\n    '. contentPrimary contentSecondary contentTopRight'\n    '. contentPrimary contentSecondary .'\n    '. contentPrimary contentSecondary contentBottomRight'\n    '. .              .                contentBottomRight';\n\n  .contentPrimary {\n    grid-area: contentPrimary;\n  }\n  .contentSecondary {\n    grid-area: contentSecondary;\n  }\n  .contentTopRight {\n    grid-area: contentTopRight;\n    justify-self: end;\n    align-self: start;\n  }\n  .contentBottomRight {\n    grid-area: contentBottomRight;\n    justify-self: end;\n    align-self: end;\n  }\n\n  ${mediaMobile`\n    grid-template-columns: ${Spacing.Middle} 1fr ${Spacing.Middle};\n    grid-template-rows: auto auto auto auto;\n    grid-row-gap: ${Spacing.Middle};\n    grid-template-areas:\n      '. contentTopRight    contentTopRight'\n      '. contentPrimary     .'\n      '. contentSecondary   .'\n      '. contentBottomRight contentBottomRight'\n  `};\n`\n\nexport const FormLayoutGrid: React.FC<IProps> = ({\n  contentPrimary,\n  contentSecondary,\n  contentTopRight,\n  contentBottomRight,\n  primaryColumnWidth = '1fr',\n  secondaryColumnWidth = '0',\n}) => {\n  return (\n    <StyledFormLayoutGrid\n      primaryColumnWidth={primaryColumnWidth}\n      secondaryColumnWidth={secondaryColumnWidth}\n    >\n      <div className=\"contentPrimary\">{contentPrimary}</div>\n      <div className=\"contentSecondary\">{contentSecondary}</div>\n      <div className=\"contentTopRight\">{contentTopRight}</div>\n      <div className=\"contentBottomRight\">{contentBottomRight}</div>\n    </StyledFormLayoutGrid>\n  )\n}\n","import { RM } from '@speedlo/tools'\nimport { useXField } from '@speedlo/xform'\nimport { useObserver } from 'mobx-react-lite'\nimport React from 'react'\n\nimport { ISelectControlProps, SelectControl } from '../../atoms/SelectControl'\n\ntype DefaultOptionType = object\n\nexport interface FormDropdownProps<\n  OptionType extends DefaultOptionType = DefaultOptionType\n> extends ISelectControlProps<OptionType> {\n  fieldName: FieldName\n}\n\nexport const FormDropdown = <OptionType extends DefaultOptionType>({\n  fieldName,\n  ...props\n}: FormDropdownProps<OptionType>) => {\n  const field = useXField(fieldName)\n  const { isMulti, options, getOptionValue } = props\n\n  const getPropsForMulti = () => {\n    const selection = field.value\n    const isSelected = Array.isArray(selection)\n      ? (option: OptionType) => selection.includes(getOptionValue!(option))\n      : RM.F\n\n    return {\n      value: Array.isArray(options)\n        ? (options as OptionType[]).filter(isSelected)\n        : [],\n      onChange: selectedOptions => {\n        field.setValue(selectedOptions.map(getOptionValue))\n      },\n    }\n  }\n\n  const getPropsForSingle = () => {\n    const selection = field.value\n    return {\n      value:\n        selection &&\n        (options as OptionType[]).find(\n          item => getOptionValue!(item) === selection,\n        ),\n      onChange: option => {\n        field.setValue(getOptionValue!(option))\n      },\n    }\n  }\n\n  return useObserver(() => (\n    <SelectControl\n      {...(isMulti ? getPropsForMulti() : getPropsForSingle())}\n      onFocus={() => field.setTouched()}\n      invalid={field.touched && field.hasError}\n      {...props}\n    />\n  ))\n}\n","import { RM } from '@speedlo/tools'\nimport React from 'react'\n\nimport { IconLine } from '../../../atoms/IconLine'\nimport { FormDropdown } from '../../../components/forms/FormDropdown'\nimport {\n  QMenuCategoryOriginsOrigins,\n  useQMenuCategoryOrigins,\n} from '../../../graph/generated'\nimport { i18n } from '../../../i18n'\n\nexport const CategoryOriginsField: React.FC = () => {\n  const { data, loading } = useQMenuCategoryOrigins()\n  return (\n    <IconLine label={i18n.t`cat. origins`} labelWidth={7}>\n      <FormDropdown<QMenuCategoryOriginsOrigins>\n        fieldName=\"origins\"\n        isMulti={true}\n        isLoading={loading}\n        isSearchable={true}\n        options={loading ? [] : (data.origins as any)}\n        getOptionLabel={RM.prop('code')}\n        getOptionValue={RM.prop('enum')}\n      />\n    </IconLine>\n  )\n}\n","import { pictograms as availablePictograms } from '@speedlo/assets'\nimport { useXField } from '@speedlo/xform'\nimport { useObserver } from 'mobx-react-lite'\nimport React from 'react'\n\nimport { PictogramDisplay } from '../../../atoms/PictogramDisplay'\nimport { SelectControl } from '../../../atoms/SelectControl'\nimport { RM } from '../../../helpers/ramda'\nimport { TCategoryFormValues } from '../menu.types'\n\ninterface IProps {}\n\ninterface IFormValue {\n  pictogram: string\n}\n\nexport const CategoryPictogramSelect: React.FC<IProps> = () => {\n  const field = useXField<TCategoryFormValues['pictogram']>('pictogram')\n\n  return useObserver(() => (\n    <SelectControl<IFormValue>\n      value={field.value ? { pictogram: field.value } : null}\n      onChange={value => {\n        if (value) {\n          field.setValue((value as IFormValue).pictogram)\n        }\n      }}\n      options={availablePictograms.map(pictogram => ({ pictogram }))}\n      getOptionValue={RM.prop('pictogram')}\n      formatOptionLabel={({ pictogram }) => (\n        <PictogramDisplay pictogramId={pictogram} fontSize={2} />\n      )}\n      components={{\n        SingleValue: ({ data }) => (\n          <PictogramDisplay pictogramId={data.pictogram} fontSize={4} />\n        ),\n      }}\n      styles={{\n        container: base => ({ ...base, width: '8rem' }),\n        menuList: base => ({ ...base, maxHeight: '35rem' }),\n      }}\n      isClearable={false}\n      isSearchable={false}\n      minWidth={8}\n    />\n  ))\n}\n","import { getFlag } from '@speedlo/assets'\nimport { useXFieldForInput } from '@speedlo/xform'\nimport { observer } from 'mobx-react-lite'\nimport React from 'react'\nimport styled from 'styled-components/macro'\n\nimport { StyledFormInput } from '../../../atoms/FormInputStyled'\nimport { i18n } from '../../../i18n'\nimport { useMenuModel } from '../hooks/useMenu'\nimport { useMenuTranslations } from '../hooks/useMenuTranslations'\n\ninterface IProps {\n  fieldName: FieldName\n  placeholder?: string\n}\nconst StyledMenuTranslationInput = styled.div`\n  position: relative;\n\n  .original {\n    font-size: 0.9rem;\n    padding: 0.3rem 0;\n    opacity: 0.7;\n  }\n\n  .original img {\n    width: 1.5rem;\n    margin: 0 0.6rem;\n  }\n\n  .current-language {\n    width: 1.5rem;\n    position: absolute;\n    right: 0.5rem;\n    top: 0.8rem;\n    border: 1px #aaa solid;\n    box-sizing: content-box;\n  }\n`\n\nexport const MenuTranslationInput = observer<IProps>(\n  ({ fieldName, placeholder }) => {\n    const [field, getFieldProps] = useXFieldForInput(fieldName)\n    const menuModel = useMenuModel()\n\n    const { getTranslation, getTranslationOrCreate } = useMenuTranslations()\n\n    const onChange = (ev: React.ChangeEvent<HTMLInputElement>) => {\n      const value = ev.target.value\n      const translation = getTranslationOrCreate(\n        menuModel.currentLanguage,\n        () => ({}),\n      )\n      translation[field.name] = value\n    }\n\n    const isTranslating = !menuModel.isDefaultLanguage\n\n    const translation = getTranslation(menuModel.currentLanguage)\n    const value = isTranslating\n      ? translation && translation[field.name]\n      : field.value\n\n    const fieldProps = getFieldProps()\n\n    return (\n      <StyledMenuTranslationInput>\n        <StyledFormInput\n          {...fieldProps}\n          value={value || ''}\n          onChange={isTranslating ? onChange : fieldProps.onChange}\n          inputFullWidth={true}\n          invalid={!isTranslating && field.touched && field.hasError}\n          placeholder={placeholder}\n        />\n        <img\n          className=\"current-language\"\n          src={getFlag(menuModel.currentLanguage)}\n          alt=\"translation\"\n        />\n        {isTranslating && (\n          <div\n            className=\"original\"\n            onClick={() => menuModel.setLanguage(menuModel.defaultLanguage)}\n          >\n            <img src={getFlag(menuModel.defaultLanguage)} alt=\"original text\" />\n            {field.value || <i>{i18n.t`No text is filled`}</i>}\n          </div>\n        )}\n      </StyledMenuTranslationInput>\n    )\n  },\n)\n","import { Trans } from '@lingui/macro'\nimport React from 'react'\n\nimport { IconLine } from '../../../atoms/IconLine'\nimport { FormInput } from '../../../components/forms/FormInput'\nimport { MenuTranslationInput } from '../atoms/MenuTranslationInput'\n\ninterface IProps {\n  fieldName?: FieldName\n  label?: string\n  placeholder?: string\n  localized?: boolean\n}\n\nexport const MenuInternalNoteInput: React.FC<IProps> = ({\n  fieldName = 'internalNote',\n  label = <Trans>Internal note</Trans>,\n  placeholder,\n  localized = false,\n}) => {\n  const props = {\n    fieldName,\n    placeholder,\n    fullWidth: true,\n  }\n  return (\n    <IconLine label={label} labelWidth={7}>\n      {localized ? (\n        <MenuTranslationInput {...props} />\n      ) : (\n        <FormInput {...props} />\n      )}\n    </IconLine>\n  )\n}\n","import { RM } from '@speedlo/tools'\nimport { LanguagePicker } from '@speedlo/ui'\nimport { observer } from 'mobx-react-lite'\nimport React from 'react'\nimport styled from 'styled-components/macro'\n\nimport { Colors } from '../../../styling'\nimport { useMenuModel } from '../hooks/useMenu'\n\ninterface IProps {}\n\nconst StyledLanguagePicker = styled(LanguagePicker)`\n  transform: scale(2) translateY(0.5rem);\n  transform-origin: right;\n  height: 2.5rem;\n`\n\nexport const MenuLanguageSwitch = observer<IProps>(() => {\n  const menuModel = useMenuModel()\n  return (\n    <div>\n      <StyledLanguagePicker\n        availableLanguages={menuModel.supportedLanguages}\n        selectedLanguage={menuModel.currentLanguage}\n        onChange={menuModel.setLanguage}\n        formatLanguage={RM.identity}\n        arrowColor={Colors.greyMiddle}\n      />\n    </div>\n  )\n})\n","import { Label } from '@material-ui/icons'\nimport React from 'react'\n\nimport { IconLine } from '../../../atoms/IconLine'\nimport { FormInput, FormInputProps } from '../../../components/forms/FormInput'\nimport { Spacing } from '../../../styling'\nimport { MenuTranslationInput } from '../atoms/MenuTranslationInput'\n\ninterface IProps extends Partial<FormInputProps> {\n  localized?: boolean\n}\n\nexport const MenuNameInput: React.FC<IProps> = ({\n  fieldName = 'nameLabel',\n  localized = false,\n  ...rest\n}) => {\n  const props = {\n    fieldName,\n    ...rest,\n  }\n  return (\n    <IconLine icon={Label} labelWidth={Spacing.DefaultLabelWidth}>\n      {localized ? (\n        <MenuTranslationInput {...props} />\n      ) : (\n        <FormInput {...props} />\n      )}\n    </IconLine>\n  )\n}\n","import React from 'react'\n\nimport { FormGrid } from '../../../atoms/FormGrid'\nimport { IconLine } from '../../../atoms/IconLine'\nimport { FormDeleteButton } from '../../../components/forms/FormDeleteButton'\nimport { FormCheckbox } from '../../../components/forms/FormInputCheckbox'\nimport { useMMenuCategoryDelete } from '../../../graph/generated'\nimport { i18n } from '../../../i18n'\nimport { FormLayoutGrid } from '../atoms/FormLayoutGrid'\nimport { IsMenuItemType } from '../atoms/IsMenuItemType'\nimport { CategoryOriginsField } from '../molecules/CategoryOriginsField'\nimport { CategoryPictogramSelect } from '../molecules/CategoryPictogramSelect'\nimport { MenuInternalNoteInput } from '../molecules/MenuInternalNoteField'\nimport { MenuLanguageSwitch } from '../molecules/MenuLanguageSwitch'\nimport { MenuNameInput } from '../molecules/MenuNameInput'\n\ninterface IProps {}\n\nexport const CategoryFormPrimary: React.FC<IProps> = () => {\n  const [deleteCategory] = useMMenuCategoryDelete()\n  return (\n    <FormLayoutGrid\n      primaryColumnWidth=\"minmax(10rem, 45rem)\"\n      secondaryColumnWidth=\"14rem\"\n      contentPrimary={\n        <FormGrid>\n          <MenuNameInput placeholder={i18n.t`Category name`} localized />\n          <MenuInternalNoteInput\n            placeholder={i18n.t`Category internal note`}\n            fieldName=\"internalNoteLabel\"\n            localized\n          />\n          <CategoryOriginsField />\n          <IconLine>\n            <FormCheckbox\n              fieldName=\"visible\"\n              label={i18n.t`To show this category`}\n            />\n          </IconLine>\n        </FormGrid>\n      }\n      contentSecondary={\n        <IsMenuItemType isMain>\n          <CategoryPictogramSelect />\n        </IsMenuItemType>\n      }\n      contentTopRight={<MenuLanguageSwitch />}\n      contentBottomRight={\n        <FormDeleteButton\n          mutationName=\"destroyWareCategory\"\n          confirmText={i18n.t`Remove this category?`}\n          onDelete={categoryId => deleteCategory({ categoryId })}\n        />\n      }\n    />\n  )\n}\n","import { useObserver } from 'mobx-react-lite'\n\nimport { useRoot } from '../atoms/RootProvider'\n\nexport function useSettingsBranch() {\n  const { settings } = useRoot()\n  return useObserver(() => settings.branchId)\n}\n","import { useStateRef } from '@speedlo/hooks'\nimport React, { useCallback } from 'react'\n\nimport { FlexColumn } from '../../../atoms/FlexColumn'\nimport { FlexRowSingle } from '../../../atoms/FlexRowSingle'\nimport {\n  ISelectControlProps,\n  SelectControl,\n} from '../../../atoms/SelectControl'\nimport { RM } from '../../../helpers/ramda'\nimport { i18n } from '../../../i18n'\nimport { TouchButton } from '../../../molecules/TouchButton'\n\ninterface IProps<OptionType> extends ISelectControlProps<OptionType> {\n  onAdd(option: OptionType): void\n  addLabel?: string\n  addButtonText?: string\n  isLoading?: boolean\n}\n\nexport function MenuSuggestionPanel<\n  OptionType extends { id: ID; nameLabel: Maybe<string> }\n>(props: IProps<OptionType>) {\n  const {\n    onAdd,\n    addLabel = i18n.t`Add`,\n    addButtonText = i18n.t`Add`,\n    isLoading = false,\n    ...selectProps\n  } = props\n\n  const [getSelected, setSelected] = useStateRef<Maybe<OptionType>>(null)\n\n  const onConfirm = useCallback(() => {\n    const selected = getSelected()\n    if (selected !== null) {\n      onAdd(selected)\n      setSelected(null)\n    }\n  }, [getSelected, onAdd, setSelected])\n\n  const onKeyDown = useCallback(\n    (ev: React.KeyboardEvent<HTMLElement>) => {\n      if (ev.key === 'Enter') {\n        onConfirm()\n      }\n    },\n    [onConfirm],\n  )\n\n  const onSelect = useCallback(\n    option => {\n      setSelected(option || null)\n    },\n    [setSelected],\n  )\n\n  return (\n    <FlexRowSingle justify=\"flex-start\">\n      <FlexColumn fixedWidth={true} width=\"4rem\" margin=\"auto 0\">\n        {addLabel}\n      </FlexColumn>\n      <FlexColumn fixedWidth={true} width=\"20rem\" margin=\"auto 0\">\n        <SelectControl<OptionType>\n          value={getSelected()}\n          onChange={onSelect}\n          onKeyDown={onKeyDown}\n          isLoading={isLoading}\n          isMulti={false}\n          isClearable={false}\n          getOptionValue={RM.prop('id')}\n          getOptionLabel={RM.propOr('', 'nameLabel')}\n          {...selectProps}\n        />\n      </FlexColumn>\n      <FlexColumn fixedWidth={true} width=\"10rem\" margin=\"auto 0\">\n        <TouchButton\n          text={addButtonText}\n          disabled={getSelected() === null}\n          onClick={onConfirm}\n        />\n      </FlexColumn>\n    </FlexRowSingle>\n  )\n}\n","import React from 'react'\n\nimport { WarePriceTypeEnum } from '../../../graph/generated'\nimport { getPriceTypesLabels } from '../menu.labels'\n\nexport const priceTypes = [\n  WarePriceTypeEnum.Delivery,\n  WarePriceTypeEnum.Inhouse,\n]\n\nexport function usePriceType() {\n  const priceTypeLabels = React.useMemo(getPriceTypesLabels, [])\n  return {\n    priceTypes,\n    priceTypeLabels,\n  }\n}\n","import { idPropEq } from '@speedlo/tools'\nimport { useXField } from '@speedlo/xform'\nimport { useObserver } from 'mobx-react-lite'\nimport React from 'react'\nimport {\n  arrayMove,\n  SortableContainer,\n  SortableElement,\n  SortEndHandler,\n} from 'react-sortable-hoc'\nimport styled from 'styled-components/macro'\n\nimport { mediaDesktop, useResponsive } from '../../../app/Responsive'\nimport { DataList } from '../../../atoms/DataList'\nimport { DragHandle } from '../../../atoms/DragHandle'\nimport { NoteText } from '../../../atoms/NoteText'\nimport { Price } from '../../../atoms/Price'\nimport {\n  FMenuCategoryInFormRecipes,\n  FMenuRecipeInListFragment,\n  useQMenuRecipeList,\n} from '../../../graph/generated'\nimport { RM } from '../../../helpers/ramda'\nimport { useSettingsBranch } from '../../../hooks/useSettingsBranch'\nimport { i18n } from '../../../i18n'\nimport { TouchButtonRemove } from '../../../molecules/TouchButtonRemove'\nimport { Spacing } from '../../../styling'\nimport { MenuSuggestionPanel } from '../atoms/MenuSuggestionPanel'\nimport { useMenuItemType } from '../hooks/useMenuItemType'\nimport { usePriceType } from '../hooks/usePriceType'\n\ninterface IProps {}\n\nconst StyledCategoryRecipesView = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: calc(100% - 2rem);\n  width: 100%;\n\n  & .fixed-row {\n    flex: 0 0 auto;\n  }\n  & .move-cell {\n    ${mediaDesktop`\n      cursor: move;\n    `}\n  }\n`\n\nconst StyledFormStretchedRow = styled.div`\n  flex: 1 1 0;\n  margin: 1rem 0 0 1rem;\n`\n\nconst SortableRecipes = SortableContainer(StyledFormStretchedRow)\n\nconst StyledRecipeRow = styled.div`\n  display: grid;\n  grid-gap: 1rem;\n  grid-template-columns: ${Spacing.ButtonColumnWidthPx}px 100px 3fr 1fr 1fr 50px;\n`\n\ntype TCategoryRecipe = FMenuCategoryInFormRecipes\n\ninterface IRecipeRow {\n  recipe: TCategoryRecipe\n  onRemove(): void\n}\n\nconst SortableRecipe = SortableElement(({ recipe, onRemove }: IRecipeRow) => {\n  const { priceTypes, priceTypeLabels } = usePriceType()\n  const prices = priceTypes.map(priceType => {\n    const foundPrice = recipe.prices.find(\n      RM.pathEq(['priceType', 'enum'], priceType),\n    )\n    return (\n      <div className=\"move-cell\" key={priceType}>\n        <NoteText>{priceTypeLabels[priceType]}</NoteText>\n        {foundPrice ? (\n          <Price currencyCode={foundPrice.price.currency.code}>\n            {foundPrice.price.value}\n          </Price>\n        ) : (\n          <i>{i18n.t`Not set`.toLocaleLowerCase()}</i>\n        )}\n      </div>\n    )\n  })\n\n  return (\n    <StyledRecipeRow>\n      <div>\n        <TouchButtonRemove onClick={onRemove} />\n      </div>\n      <div className=\"move-cell\">{recipe.code}</div>\n      <div className=\"move-cell\">\n        {recipe.nameLabel}\n        <NoteText>{recipe.internalNote || ''}</NoteText>\n      </div>\n      {prices}\n      <DragHandle />\n    </StyledRecipeRow>\n  )\n})\n\nexport const CategoryRecipesView: React.FC<IProps> = () => {\n  const branchId = useSettingsBranch()\n  const categoryType = useMenuItemType()\n\n  const { data, loading } = useQMenuRecipeList({\n    branchId,\n    categoryType,\n  })\n\n  const field = useXField<TCategoryRecipe[]>('recipes')\n\n  const onHandleSorting: SortEndHandler = React.useCallback(\n    async ({ newIndex, oldIndex }) => {\n      if (newIndex === oldIndex) {\n        return\n      }\n      field.setValue(arrayMove(field.value, oldIndex, newIndex))\n    },\n    [field],\n  )\n\n  const unselectedRecipesOnly = RM.differenceWith<\n    FMenuRecipeInListFragment,\n    TCategoryRecipe\n  >(RM.eqProps('id'))\n\n  const { isDesktop } = useResponsive()\n\n  return useObserver(() => (\n    <StyledCategoryRecipesView>\n      <div className=\"fixed-row\">\n        <MenuSuggestionPanel<TCategoryRecipe>\n          isLoading={loading}\n          options={\n            loading ? [] : unselectedRecipesOnly(data.recipes, field.value)\n          }\n          onAdd={addedRecipe => field.value.push(addedRecipe)}\n          getOptionLabel={({ nameLabel, code }) => `${code} - ${nameLabel}`}\n        />\n      </div>\n      <SortableRecipes\n        lockAxis=\"y\"\n        lockToContainerEdges={true}\n        onSortEnd={onHandleSorting}\n        useDragHandle={!isDesktop}\n      >\n        <DataList\n          items={field.value}\n          heightStretch={true}\n          rowHeight={60}\n          renderItem={(recipe, index) => (\n            <SortableRecipe\n              recipe={recipe}\n              onRemove={() => {\n                field.setValue(RM.reject(idPropEq(recipe.id), field.value))\n              }}\n              index={index}\n            />\n          )}\n        />\n      </SortableRecipes>\n    </StyledCategoryRecipesView>\n  ))\n}\n","import { Trans } from '@lingui/macro'\nimport React from 'react'\nimport styled from 'styled-components'\n\nimport { FormInputStyled } from '../../../atoms/FormInputStyled'\nimport { Sizer } from '../../../atoms/Sizer'\nimport { StyledCheckbox } from '../../../atoms/StyledCheckbox'\nimport { TouchButton } from '../../../molecules/TouchButton'\n\ninterface IProps {\n  id: string\n  count: number\n  label: ReactNode | string\n  enabled: boolean\n  onChange(count: number): void\n}\n\nconst StyledCategoryRequirementControl = styled.div`\n  display: flex;\n  align-items: center;\n  & > label {\n    min-width: 5rem;\n  }\n  & > * {\n    margin: 0.2rem 0.5rem;\n  }\n  input.count {\n    font-size: 1.5rem;\n    line-height: 1.5rem;\n    text-align: center;\n  }\n`\n\nexport const CategoryRequirementControl: React.FC<IProps> = ({\n  count,\n  label,\n  enabled,\n  onChange,\n  id,\n}) => {\n  const countRef = React.useRef(count)\n  return (\n    <StyledCategoryRequirementControl>\n      <label htmlFor={id}>{label}</label>\n      <Sizer width={3}>\n        <FormInputStyled\n          id={id}\n          value={count === 0 ? '' : count}\n          onChange={ev => {\n            if (ev.target.validity.valid) {\n              onChange(Number.parseInt(ev.target.value, 10))\n            }\n          }}\n          onFocus={ev => {\n            ev.target.select()\n          }}\n          disabled={count === 0 || !enabled}\n          inputFullWidth={true}\n          type=\"tel\"\n          pattern=\"^[1-9]\\d*$\"\n          className=\"count\"\n        />\n      </Sizer>\n      <Sizer width={4}>\n        <TouchButton\n          disabled={!enabled || count <= 0}\n          onClick={() => onChange(count - 1)}\n        >\n          ➖\n        </TouchButton>\n      </Sizer>\n      <Sizer width={4}>\n        <TouchButton disabled={!enabled} onClick={() => onChange(count + 1)}>\n          ➕\n        </TouchButton>\n      </Sizer>\n      <div>\n        <StyledCheckbox>\n          <input\n            type=\"checkbox\"\n            id={`${id}-nolimit`}\n            checked={count === 0}\n            disabled={!enabled}\n            onChange={ev => {\n              if (count === 0) {\n                onChange(countRef.current || 1)\n              } else {\n                countRef.current = count\n                onChange(0)\n              }\n            }}\n          />\n          <label htmlFor={`${id}-nolimit`}>\n            <Trans>Unlimited</Trans>\n          </label>\n        </StyledCheckbox>\n      </div>\n    </StyledCategoryRequirementControl>\n  )\n}\n","import { Trans } from '@lingui/macro'\nimport { useAutorun } from '@speedlo/hooks'\nimport { useXField } from '@speedlo/xform'\nimport _ from 'lodash'\nimport { observer, useLocalStore } from 'mobx-react-lite'\nimport React from 'react'\n\nimport { SelectControlFlat } from '../../../atoms/SelectControlFlat'\nimport { i18n } from '../../../i18n'\nimport { CategoryRequirementControl } from '../molecules/CategoryRequirementControl'\n\ninterface IRequirement {\n  label: string\n  min?: number\n  max?: number\n}\n\nexport const getRulesMap = (): Record<string, IRequirement> => ({\n  noLimit: {\n    label: i18n.t`No limitation`,\n    min: 0,\n    max: 0,\n  },\n  optional: {\n    label: i18n.t`One at most`,\n    min: 0,\n    max: 1,\n  },\n  required: {\n    label: i18n.t`One at least`,\n    min: 1,\n    max: 0,\n  },\n  onlyOne: {\n    label: i18n.t`Exactly one`,\n    min: 1,\n    max: 1,\n  },\n  custom: {\n    label: i18n.t`Custom range`,\n  },\n})\n\ntype TRule = keyof ReturnType<typeof getRulesMap>\n\nexport const CategoryRequirementsForm = observer(() => {\n  const ruleMap = React.useMemo(getRulesMap, [])\n\n  const state = useLocalStore(() => ({\n    currentRule: 'noLimit' as TRule,\n  }))\n\n  const setRule = (rule: TRule) => {\n    state.currentRule = rule\n  }\n\n  const minCount = useXField<number>('minCount')\n  const maxCount = useXField<number>('maxCount')\n\n  useAutorun(() => {\n    if (state.currentRule !== 'custom') {\n      const found = _.findKey(\n        ruleMap,\n        ({ min, max }) => min === minCount.value && max === maxCount.value,\n      )\n      if (found) {\n        setRule(found)\n      }\n    }\n  })\n\n  return (\n    <>\n      <SelectControlFlat<TRule>\n        items={Object.keys(ruleMap) as RoA<TRule>}\n        formatItem={req => ruleMap[req].label}\n        onSingleSelection={selectedRule => {\n          if (selectedRule) {\n            setRule(selectedRule)\n            const rule = ruleMap[selectedRule]\n            minCount.value = rule.min || 0\n            maxCount.value = rule.max || 0\n          }\n        }}\n        selectedItem={state.currentRule}\n      />\n      <CategoryRequirementControl\n        id=\"minCount\"\n        count={minCount.value}\n        label={<Trans>Minimum</Trans>}\n        enabled={state.currentRule === 'custom'}\n        onChange={minCount.setValue}\n      />\n      <CategoryRequirementControl\n        id=\"maxCount\"\n        count={maxCount.value}\n        label={<Trans>Maximum</Trans>}\n        enabled={state.currentRule === 'custom'}\n        onChange={maxCount.setValue}\n      />\n    </>\n  )\n})\n","import { Trans } from '@lingui/macro'\nimport React from 'react'\nimport { RouteComponentProps } from 'react-router'\nimport styled from 'styled-components/macro'\n\nimport { Card } from '../../../atoms/Card'\nimport { Headline } from '../../../atoms/Headline'\nimport { FullPageLayout } from '../../../molecules/FullPageLayout'\nimport { PageLayoutFullHeightItem } from '../../../molecules/PageLayoutFullHeightItem'\nimport { TopRightButtonContainer } from '../../../molecules/TopRightButtonContainer'\nimport { IsMenuItemType } from '../atoms/IsMenuItemType'\nimport { MenuSubmitButton } from '../atoms/MenuSubmitButton'\nimport { useMenuRouting } from '../hooks/useMenuRouting'\nimport { getCategoryTypeLabel } from '../menu.labels'\nimport { CategoryFormLoader } from '../organisms/CategoryFormLoader'\nimport { CategoryFormPrimary } from '../organisms/CategoryFormPrimary'\nimport { CategoryRecipesView } from '../organisms/CategoryRecipesView'\nimport { CategoryRequirementsForm } from '../organisms/CategoryRequirementsForm'\n\ninterface IProps extends RouteComponentProps<{ categoryId: ID }> {}\n\nexport const FormContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  width: 100%;\n`\nexport const FormFixedRow = styled.div`\n  flex: 0 0 8rem;\n`\nexport const FormStretchedRow = styled.div`\n  flex: 1 1 0;\n  min-height: 0;\n  position: relative;\n`\n\nexport const MenuCategoryPage: React.FC<IProps> = ({ match }) => {\n  const { categoryId } = match.params\n  const {\n    isCreate,\n    itemType: categoryType,\n    redirectToCategoryList,\n  } = useMenuRouting(categoryId)\n\n  if (categoryType === null) {\n    redirectToCategoryList()\n    return null\n  }\n\n  return (\n    <CategoryFormLoader\n      isCreate={isCreate}\n      categoryId={categoryId}\n      categoryType={categoryType}\n    >\n      <FullPageLayout\n        pageTitle={getCategoryTypeLabel(categoryType)}\n        hideLogoutWidget={true}\n        useBackButton={true}\n      >\n        <PageLayoutFullHeightItem withScrollArea={true}>\n          <FormContainer>\n            <FormFixedRow>\n              <Card>\n                <CategoryFormPrimary />\n              </Card>\n            </FormFixedRow>\n            <IsMenuItemType isSideDish>\n              <FormFixedRow>\n                <Card>\n                  <Headline>\n                    <Trans>Required amounts of recipes to be picked</Trans>\n                  </Headline>\n                  <CategoryRequirementsForm />\n                </Card>\n              </FormFixedRow>\n            </IsMenuItemType>\n            <FormStretchedRow>\n              <Card stretchToParent={true} minHeight={25}>\n                <Headline>\n                  <Trans>Recipes assigned to this category</Trans>\n                </Headline>\n                <CategoryRecipesView />\n              </Card>\n            </FormStretchedRow>\n          </FormContainer>\n        </PageLayoutFullHeightItem>\n        <TopRightButtonContainer>\n          <MenuSubmitButton\n            isCreate={isCreate}\n            createMutation=\"createWareCategory\"\n            updateMutation=\"updateWareCategory\"\n          />\n        </TopRightButtonContainer>\n      </FullPageLayout>\n    </CategoryFormLoader>\n  )\n}\n","import { observer } from 'mobx-react-lite'\nimport React from 'react'\n\nimport { useRoot } from '../../../atoms/RootProvider'\nimport {\n  FMenuCategoryInListFragment,\n  useQMenuCategoryList,\n  WareCategoryTypeEnum,\n} from '../../../graph/generated'\nimport { RM } from '../../../helpers/ramda'\nimport { MenuSuggestionPanel } from '../atoms/MenuSuggestionPanel'\n\ninterface IProps {\n  categoryType: WareCategoryTypeEnum\n  onAdd(recipe: TCategory): void\n  addButtonText: string\n  currentCategories: RoA<TCategory>\n}\n\ntype TCategory = FMenuCategoryInListFragment\n\nexport const CategorySuggestionPanel = observer<IProps>(\n  ({ categoryType, currentCategories, addButtonText, onAdd }) => {\n    const { settings } = useRoot()\n    const { data, loading } = useQMenuCategoryList({\n      branchId: settings.branchId,\n      categoryType,\n    })\n\n    const categories = (data && data.categories) || []\n\n    return (\n      <MenuSuggestionPanel<TCategory>\n        isLoading={loading}\n        options={RM.without(currentCategories, categories)}\n        addButtonText={addButtonText}\n        onAdd={onAdd}\n      />\n    )\n  },\n)\n","import { idPropEq } from '@speedlo/tools'\nimport { useXField } from '@speedlo/xform'\nimport { IObservableArray } from 'mobx'\nimport { useObserver } from 'mobx-react-lite'\nimport React from 'react'\n\nimport { DataTableEmptyText } from '../../../atoms/DataTable'\nimport {\n  FMenuCategoryInListFragment,\n  WareCategoryTypeEnum,\n} from '../../../graph/generated'\nimport { CategoryListTable } from '../molecules/CategoryListTable'\nimport { CategorySuggestionPanel } from './CategorySuggestionPanel'\n\ninterface IProps {\n  categoryType: WareCategoryTypeEnum\n  addButtonText: string\n  noRowsText: string\n  name: FieldName\n}\n\ntype TCategory = FMenuCategoryInListFragment\n\nexport const RecipeCategoryView: React.FC<IProps> = ({\n  categoryType,\n  addButtonText,\n  noRowsText,\n  name,\n}) => {\n  const field = useXField<IObservableArray<TCategory>>(name)\n  return useObserver(() => (\n    <>\n      <CategoryListTable\n        categories={Array.from(field.value)}\n        showRemoveColumn={true}\n        showEditColumn={false}\n        showHeader={false}\n        noRowsDisplay={<DataTableEmptyText text={noRowsText} />}\n        onRemove={categoryId =>\n          field.value.remove(field.value.find(idPropEq(categoryId))!)\n        }\n      />\n      <CategorySuggestionPanel\n        addButtonText={addButtonText}\n        categoryType={categoryType}\n        currentCategories={Array.from(field.value)}\n        onAdd={addedCategory => field.value.push(addedCategory)}\n      />\n    </>\n  ))\n}\n","import { useObjectValidation } from '@speedlo/xform'\nimport numeral from 'numeral'\nimport React from 'react'\n\nimport {\n  LanguageEnum,\n  QMenuRecipeDefaultsDefaults,\n  QMenuRecipeFormRecipe,\n  useExecutableQMenuRecipeDefaults,\n  useExecutableQMenuRecipeForm,\n  useExecutableQMenuRecipeFormTrans,\n  useMMenuRecipeCreate,\n  useMMenuRecipeUpdate,\n  WarePriceTypeEnum,\n} from '../../../graph/generated'\nimport { parseNumber } from '../../../helpers/form'\nimport { RM } from '../../../helpers/ramda'\nimport { i18n } from '../../../i18n'\nimport { useMenuModel } from '../hooks/useMenu'\nimport { useMenuRouting } from '../hooks/useMenuRouting'\nimport { priceTypes, usePriceType } from '../hooks/usePriceType'\nimport { ROUTE_MENU_RECIPE } from '../menu.routes'\nimport { TRecipeFormValues, TRecipeType } from '../menu.types'\nimport { MenuFormLoader } from '../molecules/MenuFormLoader'\nimport { MenuTranslationLoader } from '../molecules/MenuTranslationLoader'\n\ninterface IProps {\n  isCreate: boolean\n  recipeId: ID\n  recipeType: TRecipeType\n  children: ReactNode\n}\n\ntype FormValues = TRecipeFormValues\n\nexport const RecipeFormLoader: React.FC<IProps> = ({\n  isCreate,\n  recipeId,\n  recipeType,\n  children,\n}) => {\n  const menuModel = useMenuModel()\n  const { redirectToRecipeList } = useMenuRouting()\n  const { priceTypeLabels } = usePriceType()\n\n  const validationSchema = useObjectValidation(yup => ({\n    nameLabel: yup\n      .string()\n      .required(i18n.t`Recipe name in default language must be entered.`),\n    code: yup.string().required(i18n.t`Recipe code must be entered.`),\n    prices: yup.object(\n      mapPriceTypes(type => {\n        const priceType = priceTypeLabels[type].toLocaleLowerCase()\n        return yup.object({\n          value: yup\n            .string()\n            .required(i18n.t`Recipe price for ${priceType} must be entered.`),\n        })\n      }),\n    ),\n  }))\n\n  const [queryDefaults] = useExecutableQMenuRecipeDefaults()\n  const loadCreateDefaults = React.useCallback(async () => {\n    const result = await queryDefaults(\n      {\n        branchId: menuModel.branchId,\n      },\n      { fetchPolicy: 'cache-first' },\n    )\n    if (result !== null) {\n      return normalizeLoadedDefaults(result.defaults)\n    }\n    return\n  }, [menuModel, queryDefaults])\n\n  const [queryRecipe] = useExecutableQMenuRecipeForm()\n  const loadUpdateValues = React.useCallback(async () => {\n    const result = await queryRecipe(\n      { recipeId: recipeId! },\n      { fetchPolicy: 'no-cache' },\n    )\n    if (result === null) {\n      redirectToRecipeList()\n      return\n    }\n    return normalizeUpdateValues(result.recipe)\n  }, [queryRecipe, recipeId, redirectToRecipeList])\n\n  const [updateRecipe] = useMMenuRecipeUpdate()\n  const executeUpdate = React.useCallback(\n    (recipeId: ID, values: FormValues) =>\n      updateRecipe({\n        recipeId,\n        recipe: {\n          ...getWriteVariables(values),\n          translations: values.translations,\n        },\n      }),\n    [updateRecipe],\n  )\n\n  const onUpdate = React.useCallback(\n    (values: FormValues) => executeUpdate(recipeId, values),\n    [executeUpdate, recipeId],\n  )\n\n  const [createRecipe] = useMMenuRecipeCreate()\n  const onCreate = React.useCallback(\n    async (values: FormValues) => {\n      const result = await createRecipe({\n        recipe: {\n          companyBranch: menuModel.branchId,\n          wareCategoryType: recipeType,\n          ...getWriteVariables(values),\n        },\n      })\n      if (result && values.translations && values.translations.length > 0) {\n        const recipeId = result.recipe.id\n        executeUpdate(recipeId, values)\n      }\n    },\n    [createRecipe, executeUpdate, menuModel, recipeType],\n  )\n\n  const [queryTranslations] = useExecutableQMenuRecipeFormTrans()\n  const loadTranslations = React.useCallback(\n    async (language: LanguageEnum) => {\n      const result = await queryTranslations(\n        { recipeId, language },\n        { fetchPolicy: 'no-cache' },\n      )\n      if (result === null) {\n        return\n      }\n      const { nameLabel, descriptionLabel } = result.recipe\n      return { nameLabel, descriptionLabel }\n    },\n    [queryTranslations, recipeId],\n  )\n\n  return (\n    <MenuFormLoader<TRecipeFormValues>\n      isCreate={isCreate}\n      onCreate={onCreate}\n      onUpdate={onUpdate}\n      initialValues={getDefaults(recipeType)}\n      loadCreateDefaults={loadCreateDefaults}\n      loadUpdateValues={loadUpdateValues}\n      validationSchema={validationSchema}\n      successRedirectPath={ROUTE_MENU_RECIPE}\n    >\n      <>\n        {children}\n        <MenuTranslationLoader loadTranslations={loadTranslations} />\n      </>\n    </MenuFormLoader>\n  )\n}\n\nfunction getWriteVariables(formValues: FormValues) {\n  return {\n    code: formValues.code,\n    nameLabel: formValues.nameLabel || '',\n    internalNote: formValues.internalNote,\n    descriptionLabel: formValues.descriptionLabel,\n    enabled: formValues.visible,\n    prices: Object.keys(formValues.prices).map(priceType => ({\n      warePriceType: (priceType as unknown) as WarePriceTypeEnum,\n      price: { value: numeral(formValues.prices[priceType].value).value() },\n      vat: formValues.prices[priceType].vatId,\n    })),\n    sideDishCategories: formValues.sideDishes.map(RM.prop('id')),\n    wareCategories: formValues.categories.map(RM.prop('id')),\n    associatedRecipes: formValues.associatedRecipes.map(\n      RM.pick(['associatedRecipe', 'warePriceType']),\n    ),\n    ingredients: formValues.ingredients.map(({ stockItem, quantity }) => {\n      return { stockItem, quantity: parseNumber(quantity) }\n    }),\n  }\n}\n\nfunction mapPriceTypes<T>(acc: (priceType: WarePriceTypeEnum) => T) {\n  return priceTypes.reduce((result, priceType) => {\n    result[priceType] = acc(priceType)\n    return result\n  }, {}) as { [priceType in WarePriceTypeEnum]: T }\n}\n\nfunction getDefaults(recipeType: TRecipeType): FormValues {\n  return {\n    id: 'NEW',\n    itemType: recipeType,\n    visible: true,\n    code: '',\n    nameLabel: '',\n    internalNote: '',\n    internalCode: '',\n    descriptionLabel: '',\n    image: '',\n    prices: mapPriceTypes(() => ({\n      value: 0,\n      vatId: null,\n      currencyCode: '',\n    })),\n    associatedRecipes: [],\n    ingredients: [],\n    sideDishes: [],\n    categories: [],\n    translations: [],\n  }\n}\n\nfunction normalizeLoadedDefaults(\n  defaults: QMenuRecipeDefaultsDefaults,\n): Partial<FormValues> {\n  const vats = defaults.vats.reduce((acc, { vatId, priceType }) => {\n    acc[priceType.enum] = vatId\n    return acc\n  }, {})\n  return {\n    prices: mapPriceTypes(priceType => ({\n      value: 0,\n      vatId: vats[priceType],\n      currencyCode: defaults.currency.code,\n    })),\n  }\n}\n\nfunction normalizeUpdateValues(\n  recipeSource: QMenuRecipeFormRecipe,\n): Partial<FormValues> {\n  return {\n    ...recipeSource,\n    itemType: recipeSource.recipeType.enum,\n    internalNote: recipeSource.internalNote || '',\n    descriptionLabel: recipeSource.descriptionLabel || '',\n    associatedRecipes: recipeSource.sourceAssociatedRecipes.map(\n      ({ priceType, recipe }) => ({\n        warePriceType: priceType.enum,\n        nameLabel: recipe.nameLabel!,\n        associatedRecipe: recipe.id,\n        formattedPrice: '?',\n      }),\n    ),\n    ingredients: recipeSource.sourceIngredients.map(\n      ({ quantity, stockItem: { id, label, allergens, wareUnit } }) => ({\n        stockItem: id,\n        label,\n        quantity,\n        unitLabel: wareUnit.code,\n        allergens: allergens.map(RM.prop('enum')),\n      }),\n    ),\n    prices: mapPriceTypes(priceType => {\n      const sourcePrice = recipeSource.sourcePrices.find(\n        RM.pathEq(['priceType', 'enum'], priceType),\n      )\n      if (!sourcePrice) {\n        return {\n          value: 0,\n          vatId: null,\n          currencyCode: '',\n        }\n      }\n      return {\n        value: sourcePrice.price.value,\n        vatId: sourcePrice.vat.id,\n        currencyCode: sourcePrice.price.currency.code,\n      }\n    }),\n  }\n}\n","import { useXFieldState } from '@speedlo/xform'\nimport { useObserver } from 'mobx-react-lite'\nimport React from 'react'\n\ninterface IProps {\n  fieldName: string | string[]\n  className?: string\n  children?: never\n}\n\nexport const FormDisplayValue: React.FC<IProps> = ({\n  fieldName,\n  className,\n}) => {\n  const field = useXFieldState<string>(fieldName)\n  return useObserver(() => <span className={className}>{field.value}</span>)\n}\n","import React from 'react';\nimport createSvgIcon from './utils/createSvgIcon';\nexport default createSvgIcon(React.createElement(React.Fragment, null, React.createElement(\"path\", {\n  d: \"M15 4c-4.42 0-8 3.58-8 8s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6z\"\n}), React.createElement(\"path\", {\n  fill: \"none\",\n  d: \"M0 0h24v24H0V0z\"\n}), React.createElement(\"path\", {\n  d: \"M3 12c0-2.61 1.67-4.83 4-5.65V4.26C3.55 5.15 1 8.27 1 12s2.55 6.85 6 7.74v-2.09c-2.33-.82-4-3.04-4-5.65z\"\n})), 'Toll');","import { Toll } from '@material-ui/icons'\nimport React from 'react'\n\nimport { IconLine } from '../../../atoms/IconLine'\nimport { Sizer } from '../../../atoms/Sizer'\nimport { FormInput, FormInputProps } from '../../../components/forms/FormInput'\n\ninterface IProps extends FormInputProps {}\n\nexport const MenuPriceField: React.FC<IProps> = ({ fieldName, ...props }) => (\n  <IconLine icon={Toll}>\n    <Sizer width={5}>\n      <FormInput fieldName={fieldName} fullWidth={true} {...props} />\n    </Sizer>\n  </IconLine>\n)\n","import { idProp } from '@speedlo/tools'\nimport { useXField } from '@speedlo/xform'\nimport { useObserver } from 'mobx-react-lite'\nimport React from 'react'\n\nimport {\n  ISelectControlFlatProps,\n  SelectControlFlat,\n} from '../../atoms/SelectControlFlat'\n\ninterface IProps<ItemType>\n  extends LegacyOmit<\n    ISelectControlFlatProps<ItemType>,\n    | 'selectedItems'\n    | 'onMultiSelection'\n    | 'selectedItem'\n    | 'onSingleSelection'\n    | 'isMulti'\n  > {\n  fieldName: FieldName\n  getItemId?: (item: ItemType) => ID\n}\n\nexport const FormFlatSingleSelect = <ItemType extends Record<string, unknown>>(\n  props: IProps<ItemType>,\n) => {\n  const {\n    items,\n    fieldName,\n    isClearable = false,\n    getItemId = idProp as AnyFunction,\n  } = props\n\n  const field = useXField(fieldName)\n\n  return useObserver(() => (\n    <SelectControlFlat<ItemType>\n      selectedItem={\n        field.value && items.find(item => getItemId(item) === field.value)\n      }\n      onSingleSelection={item => {\n        field.setValue(item ? getItemId(item) : null)\n        field.setTouched()\n      }}\n      isInvalid={field.hasError}\n      isClearable={isClearable}\n      isMulti={false}\n      {...props}\n    />\n  ))\n}\n","import React from 'react'\n\nimport { IconLine } from '../../../atoms/IconLine'\nimport { FormFlatSingleSelect } from '../../../components/forms/FormFlatSingleSelect'\nimport { useQMenuVats } from '../../../graph/generated'\nimport { useSettingsBranch } from '../../../hooks/useSettingsBranch'\nimport { i18n } from '../../../i18n'\n\ninterface IProps {\n  fieldName: FieldName\n}\n\nexport const RecipeVatSelectField: React.FC<IProps> = ({ fieldName }) => {\n  const branchId = useSettingsBranch()\n  const { data, loading } = useQMenuVats(\n    { branchId },\n    { fetchPolicy: 'cache-first' },\n  )\n\n  if (loading) {\n    return null\n  }\n\n  return (\n    <IconLine label={`${i18n.t`VAT`}:`}>\n      <FormFlatSingleSelect\n        fieldName={fieldName}\n        items={data.vats}\n        formatItem={({ vat }) => `${vat}%`}\n      />\n    </IconLine>\n  )\n}\n","import React from 'react'\n\nimport {\n  Column,\n  ColumnRendererWithNote,\n  DataTable,\n} from '../../../atoms/DataTable'\nimport { i18n } from '../../../i18n'\nimport { TouchButtonRemove } from '../../../molecules/TouchButtonRemove'\nimport { Spacing } from '../../../styling'\nimport { TAssocRecipe } from '../menu.types'\n\ninterface IProps {\n  recipes: TAssocRecipe[]\n  onRemove(recipeId: ID): void\n}\n\nexport const RecipeAssocListTable: React.FC<IProps> = ({\n  recipes,\n  onRemove,\n}) => (\n  <DataTable items={recipes} disableHeader={true}>\n    <Column\n      dataKey=\"associatedRecipe\"\n      width={Spacing.ButtonColumnWidthPx}\n      minWidth={Spacing.ButtonColumnWidthPx}\n      cellRenderer={({ cellData }) => (\n        <TouchButtonRemove onClick={() => onRemove(cellData)} />\n      )}\n    />\n    <Column\n      dataKey=\"nameLabel\"\n      width={300}\n      label={i18n.t`Name`}\n      cellRenderer={ColumnRendererWithNote}\n      columnData={{ noteKey: 'internalNote' }}\n    />\n    <Column dataKey=\"formattedPrice\" width={100} label={i18n.t`Price`} />\n  </DataTable>\n)\n","import { useXFieldState } from '@speedlo/xform'\nimport { IObservableArray } from 'mobx'\nimport { observer } from 'mobx-react-lite'\nimport React from 'react'\n\nimport {\n  FMenuAssocRecipeFragment,\n  useQMenuRecipeFormAssoc,\n} from '../../../graph/generated'\nimport { RM } from '../../../helpers/ramda'\nimport { useSettingsBranch } from '../../../hooks/useSettingsBranch'\nimport { MenuSuggestionPanel } from '../atoms/MenuSuggestionPanel'\nimport { useMenuItemId } from '../hooks/useMenuItemId'\nimport { TAssocRecipe, TPriceType } from '../menu.types'\nimport { RecipeAssocListTable } from '../molecules/RecipeAssocListTable'\n\ninterface IProps {\n  priceType: TPriceType\n}\n\nexport const RecipeAssociatedView = observer<IProps>(({ priceType }) => {\n  const name = 'associatedRecipes'\n\n  const recipes = useXFieldState<IObservableArray<TAssocRecipe>>(name)\n\n  const recipeId = useMenuItemId()\n  const branchId = useSettingsBranch()\n\n  const { data, loading } = useQMenuRecipeFormAssoc({ branchId })\n\n  const isPriceType = RM.propEq('warePriceType', priceType)\n  const isAssocRecipe = RM.propEq('associatedRecipe')\n\n  const priceTypeRecipes = RM.filter(isPriceType, recipes.value)\n\n  const isAssociated = (id: ID) => priceTypeRecipes.some(isAssocRecipe(id))\n\n  const rejectSuggestions = RM.reject(\n    (recipe: FMenuAssocRecipeFragment) =>\n      recipe.id === recipeId || isAssociated(recipe.id),\n  )\n\n  const onAddRecipe = React.useCallback(\n    (addedRecipe: FMenuAssocRecipeFragment) => {\n      recipes.value.push({\n        warePriceType: priceType,\n        associatedRecipe: addedRecipe.id,\n        nameLabel: addedRecipe.nameLabel!,\n        formattedPrice: '?',\n      })\n    },\n    [priceType, recipes],\n  )\n\n  const onRemoveRecipe = React.useCallback(\n    (id: ID) => {\n      recipes.value.remove(\n        recipes.value.find(RM.both(isAssocRecipe(id), isPriceType))!,\n      )\n    },\n    [isAssocRecipe, isPriceType, recipes.value],\n  )\n\n  return (\n    <>\n      <RecipeAssocListTable\n        recipes={priceTypeRecipes}\n        onRemove={onRemoveRecipe}\n      />\n      <MenuSuggestionPanel\n        options={loading ? [] : rejectSuggestions(data.recipes)}\n        onAdd={onAddRecipe}\n        isLoading={loading}\n      />\n    </>\n  )\n})\n","import React, { Fragment } from 'react'\nimport styled from 'styled-components/macro'\n\nimport { FlexDiv } from '../../../atoms/FlexDiv'\nimport { Headline } from '../../../atoms/Headline'\nimport { MarginBox } from '../../../atoms/MarginBox'\nimport { VerticalGap } from '../../../atoms/VerticalGap'\nimport { FormDisplayValue } from '../../../components/forms/FormDisplayValue'\nimport { IsMenuItemType } from '../atoms/IsMenuItemType'\nimport { usePriceType } from '../hooks/usePriceType'\nimport { MenuPriceField } from '../molecules/MenuPriceInput'\nimport { RecipeVatSelectField } from '../molecules/RecipeVatSelectField'\nimport { RecipeAssociatedView } from './RecipeAssociatedView'\n\ninterface IProps {}\n\nconst FormPricingCurrencyCode = styled(FormDisplayValue)`\n  padding: 0.5rem;\n`\n\nexport const RecipeFormPricing: React.FC<IProps> = () => {\n  const { priceTypes, priceTypeLabels } = usePriceType()\n  return (\n    <>\n      {priceTypes.map(priceType => {\n        const baseName = ['prices', priceType]\n        return (\n          <Fragment key={priceType}>\n            <Headline>{priceTypeLabels[priceType]}</Headline>\n            <FlexDiv>\n              <MenuPriceField fieldName={[...baseName, 'value']} />\n              <FormPricingCurrencyCode\n                fieldName={[...baseName, 'currencyCode']}\n              />\n              <MarginBox left={5}>\n                <RecipeVatSelectField fieldName={[...baseName, 'vatId']} />\n              </MarginBox>\n            </FlexDiv>\n            <VerticalGap />\n            <IsMenuItemType isMain>\n              <RecipeAssociatedView priceType={priceType} />\n              <VerticalGap />\n            </IsMenuItemType>\n          </Fragment>\n        )\n      })}\n    </>\n  )\n}\n","import { Trans } from '@lingui/macro'\nimport React from 'react'\n\nimport { IconLine } from '../../../atoms/IconLine'\nimport { Sizer } from '../../../atoms/Sizer'\nimport { FormInput } from '../../../components/forms/FormInput'\nimport { Spacing } from '../../../styling'\n\ninterface IProps {\n  placeholder?: string\n}\n\nexport const MenuCodeInput: React.FC<IProps> = ({ placeholder }) => (\n  <IconLine label={<Trans>Code</Trans>} labelWidth={Spacing.DefaultLabelWidth}>\n    <Sizer width={9}>\n      <FormInput fieldName=\"code\" fullWidth={true} placeholder={placeholder} />\n    </Sizer>\n  </IconLine>\n)\n","import React from 'react'\n\nimport { IconLine } from '../../../atoms/IconLine'\nimport { FormInput } from '../../../components/forms/FormInput'\nimport { i18n } from '../../../i18n'\n\ninterface IProps {}\n\nexport const MenuIdExternalSystem: React.FC<IProps> = props => {\n  return (\n    <IconLine label={i18n.t`External ID`} labelWidth={7}>\n      <FormInput fieldName=\"internalCode\" disabled={true} />\n    </IconLine>\n  )\n}\n","import React from 'react'\n\nimport { FormCheckbox } from '../../../components/forms/FormInputCheckbox'\n\ninterface IProps {\n  label: string\n}\n\nexport const MenuVisibilityField: React.FC<IProps> = ({ label }) => {\n  return <FormCheckbox fieldName=\"visible\" label={label} />\n}\n","import { cn } from '@speedlo/ui'\nimport React from 'react'\nimport styled from 'styled-components'\n\nimport { AllergenEnum, useQMenuAllergens } from '../../../graph/generated'\nimport { Colors, Spacing } from '../../../styling'\n\ninterface IProps {\n  selected: RoA<AllergenEnum>\n  onToggle?(allergen: AllergenEnum): void\n}\n\nconst AllergenBox = styled.div`\n  float: left;\n  width: 2.3rem;\n  height: 2.3rem;\n  border: 1px solid ${Colors.greyMiddle};\n  margin: 0.3rem 0.6rem 0.3rem ${Spacing.MarginAroundFormComponents};\n  font-size: 1.5rem;\n  text-align: center;\n  vertical-align: middle;\n  cursor: default;\n  color: ${Colors.greyMiddle};\n  background-color: ${Colors.white};\n  &.active {\n    color: ${Colors.black};\n    background-color: ${Colors.yellow};\n  }\n`\n\nexport const MenuAllergenIndicator: React.FC<IProps> = ({\n  selected,\n  onToggle,\n}) => {\n  const { data, loading } = useQMenuAllergens(\n    {},\n    { fetchPolicy: 'cache-first' },\n  )\n  if (loading) {\n    return null\n  }\n  return (\n    <>\n      {data.allergens.map(allergen => {\n        return (\n          <AllergenBox\n            key={allergen.enum}\n            title={allergen.code}\n            className={cn({ active: selected.includes(allergen.enum) })}\n            onClick={onToggle && (() => onToggle(allergen.enum))}\n          >\n            {allergen.category}\n          </AllergenBox>\n        )\n      })}\n    </>\n  )\n}\n","import { Trans } from '@lingui/macro'\nimport { ErrorOutline } from '@material-ui/icons'\nimport { useXFieldState } from '@speedlo/xform'\nimport _ from 'lodash'\nimport { observer } from 'mobx-react-lite'\nimport React from 'react'\nimport styled from 'styled-components/macro'\n\nimport { IconLine } from '../../../atoms/IconLine'\nimport { RM } from '../../../helpers/ramda'\nimport { Spacing } from '../../../styling'\nimport { MenuAllergenIndicator } from '../atoms/MenuAllergenIndicator'\nimport { TRecipeFormValues } from '../menu.types'\n\nconst StyledAllergenLabel = styled.div`\n  margin: 0.7rem 0 0 0.2rem;\n`\n\nexport const RecipeAllergenDisplay = observer(() => {\n  const field = useXFieldState<TRecipeFormValues['ingredients']>('ingredients')\n  const allergens = _.uniq(_.flatten(field.value.map(RM.prop('allergens'))))\n  return (\n    <IconLine labelWidth={Spacing.DefaultLabelWidth} icon={ErrorOutline}>\n      <StyledAllergenLabel>\n        <Trans>Allergens based on stock cards</Trans>\n      </StyledAllergenLabel>\n      <MenuAllergenIndicator selected={allergens} />\n    </IconLine>\n  )\n})\n","import { Trans } from '@lingui/macro'\nimport React from 'react'\n\nimport { IconLine } from '../../../atoms/IconLine'\nimport { i18n } from '../../../i18n'\nimport { Spacing } from '../../../styling'\nimport { MenuTranslationInput } from '../atoms/MenuTranslationInput'\n\ninterface IProps {}\n\nexport const RecipeDescriptionInput: React.FC<IProps> = () => (\n  <IconLine\n    label={<Trans>Public note</Trans>}\n    labelWidth={Spacing.DefaultLabelWidth}\n  >\n    <MenuTranslationInput\n      fieldName=\"descriptionLabel\"\n      placeholder={i18n.t`Public note for customers, allergens`}\n    />\n  </IconLine>\n)\n","import React from 'react'\n\nimport { FormGrid } from '../../../atoms/FormGrid'\nimport { IconLine } from '../../../atoms/IconLine'\nimport { FormDeleteButton } from '../../../components/forms/FormDeleteButton'\nimport { useMMenuRecipeDelete } from '../../../graph/generated'\nimport { i18n } from '../../../i18n'\nimport { Spacing } from '../../../styling'\nimport { FormLayoutGrid } from '../atoms/FormLayoutGrid'\nimport { IsMenuItemType } from '../atoms/IsMenuItemType'\nimport { MenuCodeInput } from '../molecules/MenuCodeInput'\nimport { MenuIdExternalSystem } from '../molecules/MenuIdExternalSystem'\nimport { MenuInternalNoteInput } from '../molecules/MenuInternalNoteField'\nimport { MenuLanguageSwitch } from '../molecules/MenuLanguageSwitch'\nimport { MenuNameInput } from '../molecules/MenuNameInput'\nimport { MenuVisibilityField } from '../molecules/MenuVisibilityField'\nimport { RecipeAllergenDisplay } from '../molecules/RecipeAllergenDisplay'\nimport { RecipeDescriptionInput } from '../molecules/RecipeDescriptionInput'\n\ninterface IProps {\n  isCreate: boolean\n}\n\nexport const RecipeFormPrimary: React.FC<IProps> = ({ isCreate }) => {\n  const [deleteRecipe] = useMMenuRecipeDelete()\n\n  return (\n    <FormLayoutGrid\n      primaryColumnWidth=\"minmax(10rem, 54rem)\"\n      secondaryColumnWidth=\"3rem\"\n      contentPrimary={\n        <FormGrid>\n          <MenuCodeInput placeholder={i18n.t`Recipe code`} />\n          <MenuNameInput placeholder={i18n.t`Recipe name`} localized />\n          <IsMenuItemType isMain>\n            <RecipeDescriptionInput />\n          </IsMenuItemType>\n          <MenuInternalNoteInput placeholder={i18n.t`Recipe internal note`} />\n          {!isCreate && <MenuIdExternalSystem />}\n          <IsMenuItemType isMain>\n            <RecipeAllergenDisplay />\n          </IsMenuItemType>\n          <IconLine labelWidth={Spacing.DefaultLabelWidth}>\n            <MenuVisibilityField label={i18n.t`To show this recipe`} />\n          </IconLine>\n        </FormGrid>\n      }\n      contentTopRight={<MenuLanguageSwitch />}\n      contentBottomRight={\n        <FormDeleteButton\n          mutationName=\"destroyRecipe\"\n          confirmText={i18n.t`Remove this recipe?`}\n          onDelete={recipeId => deleteRecipe({ recipeId })}\n        />\n      }\n    />\n  )\n}\n","import React from 'react'\n\nimport {\n  Column,\n  ColumnRendererRemove,\n  DataTable,\n  DataTableEmptyText,\n} from '../../../atoms/DataTable'\nimport { Sizer } from '../../../atoms/Sizer'\nimport { FormInput } from '../../../components/forms/FormInput'\nimport { i18n } from '../../../i18n'\nimport { Spacing } from '../../../styling'\nimport { TIngredient } from '../menu.types'\n\ninterface IProps {\n  ingredients: TIngredient[]\n  onRemove?(stockItemId: ID): void\n  isLoading?: boolean\n}\n\nexport const RecipeIngredientsTable: React.FC<IProps> = ({\n  ingredients,\n  onRemove,\n  isLoading = false,\n}) => (\n  <DataTable\n    isLoading={isLoading}\n    items={ingredients}\n    disableHeader={true}\n    noRowsRenderer={() => (\n      <DataTableEmptyText text={i18n.t`Recipe has no ingredients`} />\n    )}\n  >\n    <Column\n      dataKey=\"stockItem\"\n      width={Spacing.ButtonColumnWidthPx}\n      minWidth={Spacing.ButtonColumnWidthPx}\n      cellRenderer={ColumnRendererRemove}\n      columnData={{ onRemove }}\n    />\n    <Column dataKey=\"label\" width={300} label={i18n.t`Name`} />\n    <Column\n      dataKey=\"quantity\"\n      width={60}\n      label={i18n.t`Quantity`}\n      cellRenderer={({ rowIndex }) => (\n        <Sizer width={2.5}>\n          <FormInput\n            fieldName={['ingredients', String(rowIndex), 'quantity']}\n            fullWidth={true}\n          />\n        </Sizer>\n      )}\n    />\n    <Column dataKey=\"unitLabel\" width={100} label={i18n.t`Ware unit`} />\n  </DataTable>\n)\n\n// function validateQuantity(value: string) {\n//   const fieldName = i18n.t`Quantity`\n//   if (validator.isEmpty(value + '')) {\n//     return i18n.t`${fieldName} must be entered`\n//   }\n//   if (!validator.isFloat(value + '', { min: 0 })) {\n//     return i18n.t`${fieldName} must be a positive number`\n//   }\n//   return\n// }\n","import { useXField } from '@speedlo/xform'\nimport { observer, useObserver } from 'mobx-react-lite'\nimport React from 'react'\n\nimport {\n  FMenuStockItemFragment,\n  useQMenuStockList,\n} from '../../../graph/generated'\nimport { RM } from '../../../helpers/ramda'\nimport { useSettingsBranch } from '../../../hooks/useSettingsBranch'\nimport { i18n } from '../../../i18n'\nimport { MenuSuggestionPanel } from '../atoms/MenuSuggestionPanel'\nimport { TIngredient, TRecipeFormValues } from '../menu.types'\nimport { RecipeIngredientsTable } from '../molecules/RecipeIngredientsTable'\n\ninterface IProps {\n  ingredients: TIngredient[]\n  onAdd(ingredient: TIngredient): void\n  onRemove(stockItemId: ID): void\n}\n\nconst unselectedStockOnly = RM.differenceWith(\n  ({ id }: FMenuStockItemFragment, { stockItem }: TIngredient) =>\n    id === stockItem,\n)\n\nexport const RecipeIngredientsControl = observer<IProps>(\n  ({ ingredients, onAdd, onRemove }) => {\n    const branchId = useSettingsBranch()\n    const { data, loading } = useQMenuStockList({\n      branchId,\n    })\n\n    return (\n      <>\n        <RecipeIngredientsTable ingredients={ingredients} onRemove={onRemove} />\n        <MenuSuggestionPanel<FMenuStockItemFragment>\n          isLoading={loading}\n          addButtonText={i18n.t`Add ingredient`}\n          options={\n            loading ? [] : unselectedStockOnly(data.stockItems, ingredients)\n          }\n          onAdd={(addedStockItem: FMenuStockItemFragment) => {\n            onAdd({\n              stockItem: addedStockItem.id,\n              label: addedStockItem.nameLabel,\n              quantity: 1,\n              unitLabel: addedStockItem.wareUnit.code,\n              allergens: addedStockItem.allergens.map(RM.prop('enum')),\n            })\n          }}\n        />\n      </>\n    )\n  },\n)\n\nexport const RecipeIngredientsView = () => {\n  const field = useXField<TRecipeFormValues['ingredients']>('ingredients')\n  return useObserver(() => (\n    <RecipeIngredientsControl\n      ingredients={field.value}\n      onAdd={ingredient => {\n        field.value.push(ingredient)\n      }}\n      onRemove={stockItemId => {\n        field.value.splice(\n          field.value.findIndex(RM.propEq('stockItem', stockItemId)),\n          1,\n        )\n      }}\n    />\n  ))\n}\n","import { Trans } from '@lingui/macro'\nimport React from 'react'\nimport { RouteComponentProps } from 'react-router-dom'\n\nimport { Card } from '../../../atoms/Card'\nimport { Headline } from '../../../atoms/Headline'\nimport { MarginBox } from '../../../atoms/MarginBox'\nimport { NoteText } from '../../../atoms/NoteText'\nimport { VerticalGap } from '../../../atoms/VerticalGap'\nimport { i18n } from '../../../i18n'\nimport { FullPageLayout } from '../../../molecules/FullPageLayout'\nimport { TopRightButtonContainer } from '../../../molecules/TopRightButtonContainer'\nimport { IsMenuItemType } from '../atoms/IsMenuItemType'\nimport { MenuSubmitButton } from '../atoms/MenuSubmitButton'\nimport { useMenuRouting } from '../hooks/useMenuRouting'\nimport { getRecipeTypeLabel } from '../menu.labels'\nimport { TCategoryType } from '../menu.types'\nimport { RecipeCategoryView } from '../organisms/RecipeCategoryView'\nimport { RecipeFormLoader } from '../organisms/RecipeFormLoader'\nimport { RecipeFormPricing } from '../organisms/RecipeFormPricing'\nimport { RecipeFormPrimary } from '../organisms/RecipeFormPrimary'\nimport { RecipeIngredientsView } from '../organisms/RecipeIngredientsView'\n\ninterface IProps extends RouteComponentProps<{ recipeId: ID }> {}\n\nexport const MenuRecipePage: React.FC<IProps> = ({ match }) => {\n  const { recipeId } = match.params\n  const { isCreate, itemType, redirectToRecipeList } = useMenuRouting(recipeId)\n\n  if (itemType === null) {\n    redirectToRecipeList()\n    return null\n  }\n\n  return (\n    <RecipeFormLoader\n      isCreate={isCreate}\n      recipeId={recipeId}\n      recipeType={itemType}\n    >\n      <MarginBox right={1.25} bottom={4}>\n        <FullPageLayout\n          pageTitle={getRecipeTypeLabel(itemType)}\n          hideLogoutWidget={true}\n          useBackButton={true}\n        >\n          <Card>\n            <RecipeFormPrimary isCreate={isCreate} />\n          </Card>\n          <Card>\n            <RecipeFormPricing />\n          </Card>\n          <Card>\n            <Headline>\n              <Trans>Recipe ingredients</Trans>\n            </Headline>\n            <VerticalGap />\n            <RecipeIngredientsView />\n          </Card>\n          <IsMenuItemType isMain>\n            <Card>\n              <Headline>\n                <Trans>Sidedish categories</Trans>\n              </Headline>\n              <NoteText>\n                <Trans>These sidedish are presented with recipe</Trans>\n              </NoteText>\n              <RecipeCategoryView\n                name=\"sideDishes\"\n                categoryType={TCategoryType.SideDish}\n                addButtonText={i18n.t`Attach sidedish category`}\n                noRowsText={i18n.t`Recipe has no sidedish category attached`}\n              />\n            </Card>\n            <Card>\n              <Headline>\n                <Trans>Category assignments</Trans>\n              </Headline>\n              <NoteText>\n                <Trans>Recipe is in these categories</Trans>\n              </NoteText>\n              <RecipeCategoryView\n                name=\"categories\"\n                categoryType={TCategoryType.Main}\n                addButtonText={i18n.t`Add to category`}\n                noRowsText={i18n.t`Recipe is not in any category`}\n              />\n            </Card>\n          </IsMenuItemType>\n        </FullPageLayout>\n\n        <TopRightButtonContainer>\n          <MenuSubmitButton\n            isCreate={isCreate}\n            createMutation=\"createRecipe\"\n            updateMutation=\"updateRecipe\"\n          />\n        </TopRightButtonContainer>\n      </MarginBox>\n    </RecipeFormLoader>\n  )\n}\n","import { Trans } from '@lingui/macro'\nimport { observer } from 'mobx-react-lite'\nimport React from 'react'\nimport { TableCellProps } from 'react-virtualized'\nimport styled from 'styled-components'\n\nimport {\n  checkColumnAccess,\n  Column,\n  ColumnRendererEdit,\n  DataTable,\n} from '../../../atoms/DataTable'\nimport { Loading } from '../../../atoms/Loading'\nimport { QMenuStockListStockItems } from '../../../graph/generated'\nimport { i18n } from '../../../i18n'\nimport { Spacing } from '../../../styling'\n\ntype TStockItem = QMenuStockListStockItems\n\ninterface IProps {\n  stockItems: RoA<TStockItem>\n  isLoading: boolean\n}\n\nconst StyledDataTable = styled(DataTable)`\n  [aria-label='grid']:focus {\n    outline: none;\n  }\n\n  [role='columnheader'] {\n    display: flex;\n    align-items: center;\n    overflow: hidden;\n  }\n`\n\nexport const StockListTable: React.FC<IProps> = observer(\n  ({ stockItems, isLoading }) => {\n    return (\n      <StyledDataTable\n        items={stockItems}\n        heightStretch={true}\n        noRowsRenderer={() =>\n          isLoading ? (\n            <Loading />\n          ) : (\n            <h3>\n              <Trans>Selected branch has no stock cards</Trans>\n            </h3>\n          )\n        }\n      >\n        <Column\n          dataKey=\"id\"\n          width={Spacing.ButtonColumnWidthPx}\n          minWidth={Spacing.ButtonColumnWidthPx}\n          cellRenderer={checkColumnAccess(\n            { canQuery: 'stockItem' },\n            ColumnRendererEdit,\n          )}\n        />\n        <Column dataKey=\"code\" width={100} label={i18n.t`Card code`} />\n        <Column\n          dataKey=\"nameLabel\"\n          width={300}\n          minWidth={30}\n          flexGrow={2}\n          label={i18n.t`Card name`}\n        />\n        <Column\n          dataKey=\"quantity\"\n          width={100}\n          label={i18n.t`Card stock`}\n          cellRenderer={stockWithUnit}\n        />\n        <Column\n          dataKey=\"allowNegativeValue\"\n          width={300}\n          label={i18n.t`Negative stock`}\n          cellRenderer={stockAllowNegative}\n        />\n        <Column dataKey=\"note\" width={300} label={i18n.t`Card note`} />\n      </StyledDataTable>\n    )\n  },\n)\n\nfunction stockWithUnit({ cellData, rowData }: TableCellProps) {\n  return `${cellData} ${rowData.wareUnit.code}`\n}\n\nfunction stockAllowNegative({ cellData }: TableCellProps) {\n  return cellData === true ? <Trans>Permitted</Trans> : <Trans>Forbidden</Trans>\n}\n","import { observer } from 'mobx-react-lite'\nimport React from 'react'\n\nimport { useQMenuStockList } from '../../../graph/generated'\nimport { useMenuModel } from '../hooks/useMenu'\nimport { StockListTable } from './StockListTable'\n\ninterface IProps {}\n\nexport const StockListLoader = observer<IProps>(() => {\n  const menuModel = useMenuModel()\n  const { data, loading } = useQMenuStockList({\n    branchId: menuModel.branchId,\n  })\n\n  const filterItem = menuModel.filter.getPredicate({\n    partialMatch: ['code', 'nameLabel'],\n    exactMatch: ['plu'],\n  })\n\n  const stockItems = loading ? [] : data.stockItems.filter(filterItem)\n\n  return <StockListTable stockItems={stockItems} isLoading={loading} />\n})\n","import React from 'react'\n\nimport { CanMutate } from '../../../atoms/CanMutate'\nimport { Card } from '../../../atoms/Card'\nimport { FlexColumn } from '../../../atoms/FlexColumn'\nimport { FlexRowSingle } from '../../../atoms/FlexRowSingle'\nimport { i18n } from '../../../i18n'\nimport { FullPageLayout } from '../../../molecules/FullPageLayout'\nimport { PageLayoutFullHeightItem } from '../../../molecules/PageLayoutFullHeightItem'\nimport { SettingsCompanyBranchPicker } from '../../settings/organisms/SettingsCompanyBranchPicker'\nimport { useMenuRouting } from '../hooks/useMenuRouting'\nimport { MenuCreateButton } from '../atoms/MenuCreateButton'\nimport { MenuFilterInput } from '../molecules/MenuFilterInput'\nimport { StockListLoader } from '../organisms/StockListLoader'\nimport { StyledFilterWithTableContainer } from './MenuRecipeListPage'\n\nexport const MenuStockListPage: React.FC = () => {\n  const { getStockCreateRoute } = useMenuRouting()\n  return (\n    <FullPageLayout pageTitle={i18n.t`Stock overview`} useBackButton={true}>\n      <PageLayoutFullHeightItem forcePercentHeightInMobile={100}>\n        <Card stretchToParent={true}>\n          <StyledFilterWithTableContainer>\n            <div className=\"filter\">\n              <FlexRowSingle justify=\"start\" flexWrap=\"wrap\">\n                <FlexColumn>\n                  <SettingsCompanyBranchPicker width={20} />\n                </FlexColumn>\n                <FlexColumn>\n                  <MenuFilterInput />\n                </FlexColumn>\n              </FlexRowSingle>\n              <CanMutate mutationName=\"createStockItem\">\n                <MenuCreateButton routeTo={getStockCreateRoute()} />\n              </CanMutate>\n            </div>\n            <div className=\"table\">\n              <StockListLoader />\n            </div>\n          </StyledFilterWithTableContainer>\n        </Card>\n      </PageLayoutFullHeightItem>\n    </FullPageLayout>\n  )\n}\n","import { useObjectValidation } from '@speedlo/xform'\nimport React from 'react'\n\nimport {\n  FieldStateEnum,\n  QMenuStockDefaultsDefaults,\n  QMenuStockFormStockItem,\n  useExecutableQMenuStockDefaults,\n  useExecutableQMenuStockForm,\n  useMMenuStockCreate,\n  useMMenuStockUpdate,\n} from '../../../graph/generated'\nimport { RM } from '../../../helpers/ramda'\nimport { useMenuModel } from '../hooks/useMenu'\nimport { useMenuRouting } from '../hooks/useMenuRouting'\nimport { ROUTE_MENU_STOCK } from '../menu.routes'\nimport { TStockFormValues } from '../menu.types'\nimport { MenuFormLoader } from '../molecules/MenuFormLoader'\n\ninterface IProps {\n  stockId: ID\n  isCreate: boolean\n  children: ReactNode\n}\n\nexport const StockFormLoader: React.FC<IProps> = ({\n  stockId,\n  isCreate,\n  children,\n}) => {\n  const menuModel = useMenuModel()\n  const { redirectToStockList } = useMenuRouting()\n\n  const validationSchema = useObjectValidation(yup => ({\n    code: yup.string().required(),\n    nameLabel: yup.string().required(),\n    wareUnit: yup.string().required(),\n    ingredients: yup.array().of(\n      yup.object({\n        quantity: yup.string().required(),\n      }),\n    ),\n  }))\n\n  const [queryDefaults] = useExecutableQMenuStockDefaults()\n  const loadCreateDefaults = React.useCallback(\n    async (values: TStockFormValues) => {\n      const result = await queryDefaults({ branchId: menuModel.branchId })\n      if (result === null) {\n        return values\n      }\n      return {\n        ...values,\n        ...normalizeLoadedDefaults(result.defaults),\n      }\n    },\n    [menuModel, queryDefaults],\n  )\n\n  const [queryStock] = useExecutableQMenuStockForm()\n  const loadUpdateValues = React.useCallback(\n    async (values: TStockFormValues) => {\n      const result = await queryStock({ stockId }, { fetchPolicy: 'no-cache' })\n      if (result === null) {\n        redirectToStockList()\n        return values\n      }\n      return {\n        ...normalizeUpdateValues(result.stockItem),\n      }\n    },\n    [queryStock, redirectToStockList, stockId],\n  )\n\n  const [createStock] = useMMenuStockCreate()\n  const onCreate = React.useCallback(\n    (values: TStockFormValues) =>\n      createStock({\n        stockItem: {\n          companyBranch: menuModel.branchId,\n          ...getWriteVariables(values),\n        },\n      }),\n    [createStock, menuModel],\n  )\n\n  const [updateStock] = useMMenuStockUpdate()\n  const onUpdate = React.useCallback(\n    (values: TStockFormValues) =>\n      updateStock({\n        stockId,\n        stockItem: getWriteVariables(values),\n      }),\n    [stockId, updateStock],\n  )\n\n  return (\n    <MenuFormLoader<TStockFormValues>\n      isCreate={isCreate}\n      onCreate={onCreate}\n      onUpdate={onUpdate}\n      initialValues={getDefaults()}\n      loadCreateDefaults={loadCreateDefaults}\n      loadUpdateValues={loadUpdateValues}\n      validationSchema={validationSchema}\n      successRedirectPath={ROUTE_MENU_STOCK}\n    >\n      {children}\n    </MenuFormLoader>\n  )\n}\n\nfunction getDefaults(): TStockFormValues {\n  return {\n    id: 'NEW',\n    internalNote: '',\n    nameLabel: '',\n    code: '',\n    plu: '',\n    note: '',\n    wareUnit: null,\n    quantity: 0,\n    allergens: [],\n    allowNegative: FieldStateEnum.Default,\n    allowNegativeDefault: FieldStateEnum.Default,\n  }\n}\n\nfunction normalizeLoadedDefaults(\n  defaults: QMenuStockDefaultsDefaults,\n): Partial<TStockFormValues> {\n  return {\n    allowNegativeDefault: getAllowNegativeDefault(defaults.allowNegative),\n  }\n}\n\nfunction normalizeUpdateValues(\n  stockItem: QMenuStockFormStockItem,\n): TStockFormValues {\n  return {\n    id: stockItem.id,\n    internalNote: 'TBD',\n    nameLabel: stockItem.nameLabel,\n    code: stockItem.code,\n    note: stockItem.note,\n    plu: stockItem.plu || '',\n    wareUnit: stockItem.wareUnit.enum,\n    quantity: stockItem.quantity,\n    allergens: stockItem.allergens.map(RM.prop('enum')),\n    allowNegative: stockItem.allowNegative,\n    allowNegativeDefault: getAllowNegativeDefault(\n      stockItem.companyBranch.allowNegative,\n    ),\n  }\n}\n\nfunction getAllowNegativeDefault(isEnabled: boolean) {\n  return isEnabled ? FieldStateEnum.Default : FieldStateEnum.Disabled\n}\n\nfunction getWriteVariables(formValues: TStockFormValues) {\n  return {\n    code: formValues.code,\n    label: formValues.nameLabel,\n    note: formValues.note,\n    plu: formValues.plu,\n    allergens: formValues.allergens,\n    wareUnit: formValues.wareUnit!,\n    allowNegative: formValues.allowNegative,\n  }\n}\n","import { ErrorOutline } from '@material-ui/icons'\nimport { useXField } from '@speedlo/xform'\nimport { useObserver } from 'mobx-react-lite'\nimport React from 'react'\n\nimport { IconLine } from '../../../atoms/IconLine'\nimport { AllergenEnum } from '../../../graph/generated'\nimport { RM } from '../../../helpers/ramda'\nimport { MenuAllergenIndicator } from '../atoms/MenuAllergenIndicator'\n\ninterface IProps {}\n\nexport const StockAllergenField: React.FC<IProps> = () => {\n  const field = useXField<RoA<AllergenEnum>>('allergens')\n\n  const onToggle = React.useCallback(\n    (allergen: AllergenEnum) => {\n      const current = field.value\n      if (current.includes(allergen)) {\n        field.setValue(RM.without([allergen], current))\n      } else {\n        field.setValue([...current, allergen])\n      }\n    },\n    [field],\n  )\n\n  return useObserver(() => (\n    <IconLine icon={ErrorOutline} labelWidth={7}>\n      <MenuAllergenIndicator selected={field.value} onToggle={onToggle} />\n    </IconLine>\n  ))\n}\n","import { i18nMark } from '@lingui/core'\nimport { RM } from '@speedlo/tools'\nimport { useXFormState } from '@speedlo/xform'\nimport { observer } from 'mobx-react-lite'\nimport React from 'react'\n\nimport { IconLine } from '../../../atoms/IconLine'\nimport { FormFlatSingleSelect } from '../../../components/forms/FormFlatSingleSelect'\nimport { FieldStateEnum } from '../../../graph/generated'\nimport { i18n } from '../../../i18n'\nimport { TStockFormValues } from '../menu.types'\n\nconst items = [\n  {\n    type: FieldStateEnum.Enabled,\n    label: i18nMark('Permit'),\n  },\n  {\n    type: FieldStateEnum.Disabled,\n    label: i18nMark('Forbid'),\n  },\n]\n\nexport const StockAllowNegativeField = observer(() => {\n  const { allowNegativeDefault } = useXFormState<TStockFormValues>().values\n  return (\n    <IconLine label={i18n.t`Negative stock`} labelWidth={7}>\n      <FormFlatSingleSelect\n        items={items}\n        fieldName=\"allowNegative\"\n        getItemId={RM.prop('type')}\n        formatItem={item => {\n          if (item.type === allowNegativeDefault) {\n            return (\n              <span>\n                {i18n._(item.label)}\n                <i>{` (${i18n.t`Is default setting`.toLocaleLowerCase()})`}</i>\n              </span>\n            )\n          }\n          return i18n._(item.label)\n        }}\n      />\n    </IconLine>\n  )\n})\n","import React from 'react';\nimport createSvgIcon from './utils/createSvgIcon';\nexport default createSvgIcon(React.createElement(\"path\", {\n  d: \"M17.81 4.47c-.08 0-.16-.02-.23-.06C15.66 3.42 14 3 12.01 3c-1.98 0-3.86.47-5.57 1.41-.24.13-.54.04-.68-.2-.13-.24-.04-.55.2-.68C7.82 2.52 9.86 2 12.01 2c2.13 0 3.99.47 6.03 1.52.25.13.34.43.21.67-.09.18-.26.28-.44.28zM3.5 9.72c-.1 0-.2-.03-.29-.09-.23-.16-.28-.47-.12-.7.99-1.4 2.25-2.5 3.75-3.27C9.98 4.04 14 4.03 17.15 5.65c1.5.77 2.76 1.86 3.75 3.25.16.22.11.54-.12.7-.23.16-.54.11-.7-.12-.9-1.26-2.04-2.25-3.39-2.94-2.87-1.47-6.54-1.47-9.4.01-1.36.7-2.5 1.7-3.4 2.96-.08.14-.23.21-.39.21zm6.25 12.07c-.13 0-.26-.05-.35-.15-.87-.87-1.34-1.43-2.01-2.64-.69-1.23-1.05-2.73-1.05-4.34 0-2.97 2.54-5.39 5.66-5.39s5.66 2.42 5.66 5.39c0 .28-.22.5-.5.5s-.5-.22-.5-.5c0-2.42-2.09-4.39-4.66-4.39-2.57 0-4.66 1.97-4.66 4.39 0 1.44.32 2.77.93 3.85.64 1.15 1.08 1.64 1.85 2.42.19.2.19.51 0 .71-.11.1-.24.15-.37.15zm7.17-1.85c-1.19 0-2.24-.3-3.1-.89-1.49-1.01-2.38-2.65-2.38-4.39 0-.28.22-.5.5-.5s.5.22.5.5c0 1.41.72 2.74 1.94 3.56.71.48 1.54.71 2.54.71.24 0 .64-.03 1.04-.1.27-.05.53.13.58.41.05.27-.13.53-.41.58-.57.11-1.07.12-1.21.12zM14.91 22c-.04 0-.09-.01-.13-.02-1.59-.44-2.63-1.03-3.72-2.1-1.4-1.39-2.17-3.24-2.17-5.22 0-1.62 1.38-2.94 3.08-2.94 1.7 0 3.08 1.32 3.08 2.94 0 1.07.93 1.94 2.08 1.94s2.08-.87 2.08-1.94c0-3.77-3.25-6.83-7.25-6.83-2.84 0-5.44 1.58-6.61 4.03-.39.81-.59 1.76-.59 2.8 0 .78.07 2.01.67 3.61.1.26-.03.55-.29.64-.26.1-.55-.04-.64-.29-.49-1.31-.73-2.61-.73-3.96 0-1.2.23-2.29.68-3.24 1.33-2.79 4.28-4.6 7.51-4.6 4.55 0 8.25 3.51 8.25 7.83 0 1.62-1.38 2.94-3.08 2.94s-3.08-1.32-3.08-2.94c0-1.07-.93-1.94-2.08-1.94s-2.08.87-2.08 1.94c0 1.71.66 3.31 1.87 4.51.95.94 1.86 1.46 3.27 1.85.27.07.42.35.35.61-.05.23-.26.38-.47.38z\"\n}), 'Fingerprint');","import { Fingerprint } from '@material-ui/icons'\nimport React from 'react'\n\nimport { IconLine } from '../../../atoms/IconLine'\nimport { Sizer } from '../../../atoms/Sizer'\nimport { FormInput } from '../../../components/forms/FormInput'\nimport { i18n } from '../../../i18n'\n\ninterface IProps {}\n\nexport const StockPluField: React.FC<IProps> = () => (\n  <IconLine icon={Fingerprint} labelWidth={7}>\n    <Sizer width={9}>\n      <FormInput fieldName=\"plu\" fullWidth={true} placeholder={i18n.t`PLU`} />\n    </Sizer>\n  </IconLine>\n)\n","import React from 'react';\nimport createSvgIcon from './utils/createSvgIcon';\nexport default createSvgIcon(React.createElement(\"path\", {\n  d: \"M3 5h2V3c-1.1 0-2 .9-2 2zm0 8h2v-2H3v2zm4 8h2v-2H7v2zM3 9h2V7H3v2zm10-6h-2v2h2V3zm6 0v2h2c0-1.1-.9-2-2-2zM5 21v-2H3c0 1.1.9 2 2 2zm-2-4h2v-2H3v2zM9 3H7v2h2V3zm2 18h2v-2h-2v2zm8-8h2v-2h-2v2zm0 8c1.1 0 2-.9 2-2h-2v2zm0-12h2V7h-2v2zm0 8h2v-2h-2v2zm-4 4h2v-2h-2v2zm0-16h2V3h-2v2zM7 17h10V7H7v10zm2-8h6v6H9V9z\"\n}), 'SelectAll');","import { SelectAll } from '@material-ui/icons'\nimport React from 'react'\n\nimport { IconLine } from '../../../atoms/IconLine'\nimport { FormDropdown } from '../../../components/forms/FormDropdown'\nimport {\n  QMenuWareUnitsWareUnits,\n  useQMenuWareUnits,\n} from '../../../graph/generated'\nimport { RM } from '../../../helpers/ramda'\nimport { i18n } from '../../../i18n'\n\ninterface IProps {}\n\ntype TWareUnits = QMenuWareUnitsWareUnits\n\nexport const StockWareUnitField: React.FC<IProps> = selectProps => {\n  const { data, loading } = useQMenuWareUnits()\n\n  return (\n    <IconLine icon={SelectAll} labelWidth={7}>\n      <FormDropdown<TWareUnits>\n        options={data.wareUnits}\n        isLoading={loading}\n        getOptionLabel={RM.prop('code')}\n        getOptionValue={RM.prop('enum')}\n        placeholder={i18n.t`Choose unit`}\n        fieldName=\"wareUnit\"\n        width={12}\n      />\n    </IconLine>\n  )\n}\n","import React from 'react'\n\nimport { FormGrid } from '../../../atoms/FormGrid'\nimport { FormDeleteButton } from '../../../components/forms/FormDeleteButton'\nimport { useMMenuStockDelete } from '../../../graph/generated'\nimport { i18n } from '../../../i18n'\nimport { FormLayoutGrid } from '../atoms/FormLayoutGrid'\nimport { MenuCodeInput } from '../molecules/MenuCodeInput'\nimport { MenuInternalNoteInput } from '../molecules/MenuInternalNoteField'\nimport { MenuNameInput } from '../molecules/MenuNameInput'\nimport { StockAllergenField } from '../molecules/StockAllergenField'\nimport { StockAllowNegativeField } from '../molecules/StockAllowNegativeField'\nimport { StockPluField } from '../molecules/StockPluField'\nimport { StockWareUnitField } from '../molecules/StockWareUnitField'\n\nexport const StockFormPrimary: React.FC = () => {\n  const [deleteStockItem] = useMMenuStockDelete()\n  return (\n    <FormLayoutGrid\n      primaryColumnWidth=\"minmax(10rem, 54rem)\"\n      contentPrimary={\n        <FormGrid>\n          <MenuNameInput placeholder={i18n.t`Card name`} />\n          <MenuCodeInput placeholder={i18n.t`Card code`} />\n          <StockWareUnitField />\n          <StockPluField />\n          <MenuInternalNoteInput\n            fieldName=\"note\"\n            placeholder={i18n.t`Card note`}\n            label={i18n.t`Card note`}\n          />\n          <StockAllergenField />\n          <StockAllowNegativeField />\n        </FormGrid>\n      }\n      contentBottomRight={\n        <FormDeleteButton\n          mutationName=\"destroyStockItem\"\n          confirmText={i18n.t`Remove this card?`}\n          onDelete={stockId => deleteStockItem({ stockId })}\n        />\n      }\n    />\n  )\n}\n","import { Trans } from '@lingui/macro'\nimport React from 'react'\n\nimport { BlockLoader } from '../../../atoms/BlockLoader'\nimport { Column, ColumnRendererEdit, DataTable } from '../../../atoms/DataTable'\nimport { Headline } from '../../../atoms/Headline'\nimport { NoteText } from '../../../atoms/NoteText'\nimport { useQStockRecipes } from '../../../graph/generated'\nimport { i18n } from '../../../i18n'\nimport { ROUTE_MENU_RECIPE } from '../menu.routes'\n\ninterface IProps {\n  stockId: ID\n}\n\nexport const StockRecipesView: React.FC<IProps> = ({ stockId }) => {\n  const { data, loading } = useQStockRecipes({\n    stockId,\n  })\n\n  if (loading) {\n    return <BlockLoader />\n  }\n\n  const {\n    stockItem: { ingredients },\n  } = data\n  if (ingredients.length === 0) {\n    return (\n      <Headline>\n        <Trans>No recipes are using stock card</Trans>\n      </Headline>\n    )\n  }\n  return (\n    <>\n      <Headline>\n        <Trans>Recipes using this card</Trans>\n      </Headline>\n\n      <DataTable\n        items={[...ingredients]}\n        disableHeader={true}\n        fullHeight={true}\n      >\n        <Column\n          dataKey=\"\"\n          cellDataGetter={({ rowData }) => ({\n            pathname: `${ROUTE_MENU_RECIPE}/${rowData.recipe.id}`,\n            state: { recipeType: rowData.recipe.recipeType.enum },\n          })}\n          cellRenderer={ColumnRendererEdit}\n          width={100}\n        />\n        <Column\n          dataKey=\"recipe\"\n          width={300}\n          label={i18n.t`Name`}\n          cellRenderer={({ rowData }) => (\n            <>\n              {rowData.recipe.nameLabel}\n              <NoteText>{rowData.recipe.descriptionLabel}</NoteText>\n            </>\n          )}\n        />\n      </DataTable>\n    </>\n  )\n}\n","import React from 'react'\nimport { RouteComponentProps } from 'react-router'\n\nimport { CanQuery } from '../../../atoms/CanQuery'\nimport { Card } from '../../../atoms/Card'\nimport { i18n } from '../../../i18n'\nimport { FullPageLayout } from '../../../molecules/FullPageLayout'\nimport { TopRightButtonContainer } from '../../../molecules/TopRightButtonContainer'\nimport { MenuSubmitButton } from '../atoms/MenuSubmitButton'\nimport { useMenuRouting } from '../hooks/useMenuRouting'\nimport { StockFormLoader } from '../organisms/StockFormLoader'\nimport { StockFormPrimary } from '../organisms/StockFormPrimary'\nimport { StockRecipesView } from '../organisms/StockRecipesVIew'\n\ninterface IProps extends RouteComponentProps<{ stockId: ID }> {}\n\nexport const MenuStockPage: React.FC<IProps> = ({ match }) => {\n  const { stockId } = match.params\n  const { isCreate } = useMenuRouting(stockId)\n\n  return (\n    <FullPageLayout\n      pageTitle={i18n.t`Stock card`}\n      hideLogoutWidget={true}\n      useBackButton={true}\n    >\n      <StockFormLoader isCreate={isCreate} stockId={stockId}>\n        <>\n          <Card>\n            <StockFormPrimary />\n            {!isCreate && (\n              <CanQuery queryName=\"recipes\">\n                <StockRecipesView stockId={stockId} />\n              </CanQuery>\n            )}\n          </Card>\n          <TopRightButtonContainer>\n            <MenuSubmitButton\n              isCreate={isCreate}\n              createMutation=\"createStockItem\"\n              updateMutation=\"updateStockItem\"\n            />\n          </TopRightButtonContainer>\n        </>\n      </StockFormLoader>\n    </FullPageLayout>\n  )\n}\n","import React from 'react'\nimport { Redirect, Route, Switch } from 'react-router-dom'\n\nimport { NotFoundPage } from '../../../pages/NotFoundPage'\nimport { SecureRoute } from '../../../routes/SecureRoute'\nimport {\n  ROUTE_MENU,\n  ROUTE_MENU_CATEGORY,\n  ROUTE_MENU_RECIPE,\n  ROUTE_MENU_STOCK,\n} from '../menu.routes'\nimport { MenuCategoryListPage } from '../pages/MenuCategoryListPage'\nimport { MenuCategoryPage } from '../pages/MenuCategoryPage'\nimport { MenuRecipeListPage } from '../pages/MenuRecipeListPage'\nimport { MenuRecipePage } from '../pages/MenuRecipePage'\nimport { MenuStockListPage } from '../pages/MenuStockListPage'\nimport { MenuStockPage } from '../pages/MenuStockPage'\n\ninterface IProps {}\n\nexport const MenuRouting: React.FC<IProps> = () => (\n  <Switch>\n    <SecureRoute\n      path={`${ROUTE_MENU_CATEGORY}/:categoryId`}\n      component={MenuCategoryPage}\n    />\n    <SecureRoute path={ROUTE_MENU_CATEGORY} component={MenuCategoryListPage} />\n    <SecureRoute\n      path={`${ROUTE_MENU_RECIPE}/:recipeId`}\n      component={MenuRecipePage}\n    />\n    <SecureRoute path={ROUTE_MENU_RECIPE} component={MenuRecipeListPage} />\n    <SecureRoute\n      path={`${ROUTE_MENU_STOCK}/:stockId`}\n      component={MenuStockPage}\n    />\n    <SecureRoute path={ROUTE_MENU_STOCK} component={MenuStockListPage} />\n    <Redirect to={ROUTE_MENU_CATEGORY} from={ROUTE_MENU} />\n    <Route component={NotFoundPage} />\n  </Switch>\n)\n\nexport default MenuRouting\n"],"sourceRoot":""}