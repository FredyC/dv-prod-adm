(window.webpackJsonp=window.webpackJsonp||[]).push([[177],{7852:function(e,t,n){"use strict";t.__esModule=!0;var r,o=n(5813),l=(r=o)&&r.__esModule?r:{default:r};t.default=function(e,t,n){return t in e?(0,l.default)(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},7860:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.FlexRowSingle=void 0;const o=((r=n(51))&&r.__esModule?r:{default:r}).default.div.withConfig({displayName:"FlexRowSingle"})`
  display: flex;
  flex-direction: row;
  justify-content: ${({justify:e="space-between"})=>e};
`;t.FlexRowSingle=o},7861:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageLayoutFullHeightItem=void 0;var r=i(n(0)),o=i(n(51)),l=n(7873),a=n(52);function i(e){return e&&e.__esModule?e:{default:e}}const u=o.default.div.withConfig({displayName:"FullHeightDiv"})`
  position: fixed;
  bottom: 0.5rem;
  width: ${(()=>e=>void 0!==e.widthInColumns?"calc(("+e.widthInColumns+" * 6.22vw) - "+a.Spacing.LayoutGridCellMargin+")":"calc(100vh - (2 * "+a.Spacing.LayoutGridCellMargin+"))")()};
  left: ${(()=>e=>void 0!==e.column?"calc(("+e.column+" * 6.22vw) + "+a.Spacing.LayoutGridCellMargin+")":a.Spacing.LayoutGridCellMargin)()};
  top: ${(()=>e=>void 0!==e.row?"calc(("+e.row+" * 3.9375rem) + "+a.Spacing.LayoutGridCellMargin+")":"calc(3.9375rem + "+a.Spacing.LayoutGridCellMargin+")")()};
`,d=o.default.div.withConfig({displayName:"FullHeightDivStyled"})`
  height: 100%;
`;t.PageLayoutFullHeightItem=(({children:e,row:t=1,column:n=0,widthInColumns:o=16,withScrollArea:a=!1,scrollAreaId:i})=>r.default.createElement(u,{column:n,row:t,widthInColumns:o,withScrollArea:a},a?r.default.createElement(l.ScrollArea,{id:i},e):r.default.createElement(d,null,e)))},7866:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.VerticalGap=void 0;const o=((r=n(51))&&r.__esModule?r:{default:r}).default.div.withConfig({displayName:"VerticalGap"})`
  height: ${({size:e=1,sizeUnit:t="rem"})=>`${e}${t}`};
`;t.VerticalGap=o,o.displayName="VerticalGap"},7870:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useSnackBar=function(){const e=(0,l.useContext)(o.SnackbarContextNext),t=(0,l.useCallback)(t=>e(t,a),[]),n=(0,l.useCallback)(t=>e(t,i),[]),r=(0,l.useCallback)(t=>e(t,u),[]),c=(0,l.useCallback)(t=>e(t,d),[]);return{enqueueSnackbar:e,enqueueSuccess:t,enqueueError:n,enqueueWarning:r,enqueueInfo:c}};var r,o=n(286),l=n(0);!function(e){e.default="default",e.error="error",e.success="success",e.warning="warning",e.info="info"}(r||(r={}));const a={variant:r.success},i={variant:r.error},u={variant:r.warning},d={variant:r.info}},7872:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return(0,r.useContext)(o.__RouterContext)};var r=n(0),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(25))},7873:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ScrollArea=void 0;const o=((r=n(51))&&r.__esModule?r:{default:r}).default.div.withConfig({displayName:"ScrollArea"})`
  overflow-y: scroll;
  -webkit-overflow-scrolling: touch;
  height: 100%;
`;t.ScrollArea=o},7890:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CardListTitle=void 0;var r,o=(r=n(51))&&r.__esModule?r:{default:r},l=n(52);const a=o.default.h2.withConfig({displayName:"CardListTitle"})`
  color: ${l.Colors.greyLight};
  font-weight: lighter;
  font-size: 1.2rem;
  margin: 0.8rem 0 0.8rem 0.3rem;
`;t.CardListTitle=a},7901:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useMapModel=function(){const e=(0,a.useContext)(p);if(!e)throw new Error("Trying to useMapModel, but BaseMap is missing in the tree");return e},t.useGoogleMap=function(){const e=(0,a.useContext)(m);if(!e)throw new Error("Trying to useGoogleMap, but BaseMap is missing in the tree");return e},t.BaseMap=void 0;var r,o=n(5808),l=n(5),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(0)),i=n(7881),u=n(7853),d=(r=n(51))&&r.__esModule?r:{default:r},c=n(52);const s=d.default.div.withConfig({displayName:"MapContainerStyled"})`
  border-radius: ${c.Radiuses.Card};
  overflow: hidden;
  height: 100%;
`,f=(0,i.withGoogleMap)(({children:e})=>a.default.createElement(a.default.Fragment,null,e)),p=a.default.createContext(null),m=a.default.createContext(null);t.BaseMap=(({model:e,children:t})=>{const n={streetViewControl:!1,mapTypeControl:!1,fullscreenControl:!1};return a.default.createElement(p.Provider,{value:e},a.default.createElement(f,{containerElement:a.default.createElement(s,null),mapElement:a.default.createElement("div",{style:{height:"100%"}})},a.default.createElement(g,null,a.default.createElement(o.Observer,null,()=>a.default.createElement(i.GoogleMap,{ref:e.setMapRef,zoom:e.zoom,center:e.center,onCenterChanged:e.updatePosition,onZoomChanged:e.updateZoom,options:n},t)))))});class g extends a.default.PureComponent{constructor(e,t){super(e),this.map=t[u.MAP]}render(){return a.default.createElement(m.Provider,{value:this.map},this.props.children)}}g.contextTypes={[u.MAP]:l.object}},7908:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useZoneRouteControl=function(){const{user:e,zone:t}=(0,o.useRoot)(),{history:n}=(0,l.default)(),r=e=>`/settings/zones/${e}`;return{getRouteToZone:r,routeToZoneEdit(o){t.map.panToZone(o),e.canQuery("zone")&&n.push(r(o))},routeToZoneList(){n.push("/settings/zones")}}};var r,o=n(99),l=(r=n(7872))&&r.__esModule?r:{default:r}},7931:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useZoneList=t.ZoneListLoader=void 0;var r=n(100),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(0)),l=n(99),a=n(53),i=n(8475);const u=o.default.createContext(null),d=(0,r.observer)(({children:e})=>{const{zone:t}=(0,l.useRoot)(),n=t.branches.filter(t.branchFilterPredicate);return 0===n.length?o.default.createElement(u.Provider,{value:[]},e):o.default.createElement(i.QueryZones,{variables:{branchesId:n.map(a.RM.prop("id"))},renderLoading:!1,render:({zones:t},{loading:n})=>o.default.createElement(u.Provider,{value:n?null:t},e)})});t.ZoneListLoader=d;t.useZoneList=(()=>(0,o.useContext)(u))},7933:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DragHandle=void 0;var r=i(n(0)),o=n(7909),l=i(n(51)),a=n(173);function i(e){return e&&e.__esModule?e:{default:e}}const u=l.default.div.withConfig({displayName:"DragHandleContainerStyled"})`
  padding: 1rem 0.4rem;
  cursor: grab;
`,d=(0,o.SortableHandle)(()=>r.default.createElement(u,null,r.default.createElement(a.Icon,{iconName:"reorder"})));t.DragHandle=d},7993:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormInputSelect=void 0;var r,o=(r=n(0))&&r.__esModule?r:{default:r},l=n(7849),a=n(53),i=n(78),u=n(7855);function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var c=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]])}return n};class s extends o.default.Component{constructor(){super(...arguments),this.validate=(e=>this.props.isRequired&&!e?i.i18n._("{0} must be selected",{0:this.props.validatioName}):null)}getControlProps(e){const{isMulti:t,options:n,getOptionValue:r,defaultValue:o}=this.props,l=e.value||o;if(t){const t=Array.isArray(l)?e=>l.includes(r(e)):a.RM.F;return{value:Array.isArray(n)?n.filter(t):[],onChange:t=>{e.setValue(t.map(r))}}}return{value:l&&n.find(e=>r(e)===l),onChange:t=>{e.setValue(r(t))}}}render(){const e=this.props,{field:t,fieldIsPure:n=!1,defaultValue:r,isRequired:a=!1}=e,i=c(e,["field","fieldIsPure","defaultValue","isRequired"]);return o.default.createElement(l.Field,{field:t,validate:this.validate,pure:n},e=>o.default.createElement(u.SelectControl,d({},this.getControlProps(e),{onFocus:()=>e.setTouched(!0),styles:{control:t=>Boolean(e.error)?Object.assign({},t,{borderColor:"red"}):t}},i)))}}t.FormInputSelect=s,s.defaultProps={validatioName:"Value",getItemId:a.RM.prop("id")}},7994:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useZoneModel=function(){const{zone:e}=(0,r.useRoot)();return e};var r=n(99)},8085:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useZoneId=function(){const{match:e}=(0,o.default)(),{zoneId:t}=e.params;return t};var r,o=(r=n(7872))&&r.__esModule?r:{default:r}},8086:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZonePriceInput=void 0;var r=u(n(0)),o=u(n(51)),l=n(7854),a=n(78),i=n(52);function u(e){return e&&e.__esModule?e:{default:e}}const d=o.default.div.withConfig({displayName:"LabelStyled"})`
  min-width: 2rem;
  display: inline-block;
`,c=(0,o.default)(l.FormInputTextBox).withConfig({displayName:"FormInputTextBoxStyled"})`
  width: 3rem;
  position: relative;
  z-index: 4;
`,s=(0,o.default)(c).withConfig({displayName:"FormInputTextBoxDeliveryStyled"})`
  color: ${i.Colors.blue};
`,f=o.default.div.withConfig({displayName:"DeliveryContainer"})`
  position: relative;
  left: 8rem;
  top: 0rem;
`,p=o.default.div.withConfig({displayName:"PriceRangeContainer"})`
  position: relative;
  left: 4rem;
  top: -0.3rem;
  width: 3rem;
`,m=o.default.div.withConfig({displayName:"VerticalLine"})`
  border-left: 3px solid #707070;
  width: 3px;
  position: relative;
  left: -2rem;
  height: 4rem;
  float: left;
  margin: -0.5rem 0 0 0;
`,g=e=>{if("number"===typeof e)return null;const t=e.trim();return t.length&&Number.isNaN(Number.parseFloat(t))?a.i18n._("Must be number"):null},h=r.default.forwardRef(({field:e,label:t,isDeliveryPrice:n,autoFocus:o=!1},l)=>n?r.default.createElement(f,null,r.default.createElement(m,null),r.default.createElement(d,null,t),r.default.createElement(s,{field:e,validate:g,ref:l})):r.default.createElement(p,null,r.default.createElement(c,{field:e,validate:g,autoFocus:o})));t.ZonePriceInput=h},8466:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ZoneMenuRoutes=void 0;var r,o=(r=n(0))&&r.__esModule?r:{default:r},l=n(25),a=n(282),i=n(8467),u=n(7908);const d=()=>{const{getRouteToZone:e}=(0,u.useZoneRouteControl)();return o.default.createElement(l.Switch,null,o.default.createElement(l.Route,{path:e(":zoneId?"),component:i.ZonePageLayout}),o.default.createElement(l.Route,{component:a.NotFoundPage}))};t.ZoneMenuRoutes=d;var c=d;t.default=c},8467:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZonePageLayout=void 0;var r,o=(r=n(0))&&r.__esModule?r:{default:r},l=n(78),a=n(5803),i=n(7861),u=n(8468),d=n(7931),c=n(8476),s=n(8480);t.ZonePageLayout=(({match:e})=>{const t=Boolean(e.params.zoneId);return o.default.createElement(d.ZoneListLoader,null,o.default.createElement(a.PageLayout,{pageTitle:l.i18n._("Delivery zones"),useBackButton:!0,backRoute:"/settings"}),o.default.createElement(i.PageLayoutFullHeightItem,{widthInColumns:6,column:10,withScrollArea:t},t?o.default.createElement(u.ZoneFormPanel,null):o.default.createElement(s.ZoneMenuPanel,null)),o.default.createElement(i.PageLayoutFullHeightItem,{widthInColumns:10},o.default.createElement(c.ZoneMapControl,null)))})},8468:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZoneFormPanel=void 0;var r=n(11),o=n(100),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(0)),a=n(7849),i=E(n(5852)),u=E(n(51)),d=n(7851),c=n(5798),s=n(8469),f=n(5807),p=n(99),m=n(55),g=n(53),h=n(5810),y=n(7870),v=n(78),b=n(7887),C=n(52),_=n(8085),P=n(7908),O=n(8470),w=n(8474),M=n(7931);function E(e){return e&&e.__esModule?e:{default:e}}var Z=function(e,t,n,r){return new(n||(n=Promise))(function(o,l){function a(e){try{u(r.next(e))}catch(t){l(t)}}function i(e){try{u(r.throw(e))}catch(t){l(t)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,i)}u((r=r.apply(e,t||[])).next())})};const j=u.default.div.withConfig({displayName:"DeleteButtonContainer"})`
  width: ${C.Spacing.ButtonHeight};
  margin-top: ${C.Spacing.Middle};
`;t.ZoneFormPanel=(()=>{const e=(0,_.useZoneId)(),t=(0,M.useZoneList)(),{zone:n}=(0,p.useRoot)(),{routeToZoneList:u}=(0,P.useZoneRouteControl)(),[C,E]=(0,l.useState)(!1),F=(0,l.useRef)(null),{enqueueError:S}=(0,y.useSnackBar)(),x=(0,l.useCallback)(()=>Z(void 0,void 0,void 0,function*(){F.current&&(yield F.current.submitForm(),E(!1),u())}),[]),B=(0,l.useCallback)(()=>Z(void 0,void 0,void 0,function*(){e&&(yield n.destroyZone(e)),u()}),[e]);(0,o.useDisposable)(()=>(0,r.reaction)(()=>null!==n.map.currentZonePoints,E)),(0,h.useEffectOnce)(()=>{t&&0===t.length&&(S(v.i18n._("Requested zone wasn't found")),u())});const L=e&&t&&t.find(g.RM.propEq("id",e))||null;return L?l.default.createElement(a.Form,{defaultValues:L,onChange:e=>{(0,m.logDebug)("zone form change",e.values),E(!0)},onSubmit:t=>n.saveZone(e,t),render:e=>(F.current=e,l.default.createElement(c.Card,{padding:0},l.default.createElement(w.ZoneFormControls,{isSubmitting:e.submitting,isModified:C,onSave:x,onGoBack:u}),l.default.createElement(O.ZoneFormContent,null),l.default.createElement(d.CanMutate,{mutationName:"destroyZone"},l.default.createElement(j,null,l.default.createElement(b.TouchButtonDelete,{disabled:e.submitting,confirmText:v.i18n._("Remove zone {0}?",{0:L.name}),onDelete:B}))),l.default.createElement(i.default,{when:C},({isShow:e,handleOk:t,handleCancel:n})=>l.default.createElement(s.ConfirmDialog,{isShow:e,confirmText:v.i18n._("Do you want to cancel changes for the zone?"),onConfirm:t,onCancel:n}))))}):l.default.createElement(f.Loading,{text:v.i18n._("Loading form...")})})},8469:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfirmDialog=void 0;var r=n(0);t.ConfirmDialog=(e=>((0,r.useEffect)(()=>{e.isShow&&(window.confirm(e.confirmText)?e.onConfirm():e.onCancel())},[e.isShow]),null))},8470:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZoneFormContent=void 0;var r=n(130),o=y(n(0)),l=n(7849),a=y(n(51)),i=n(7930),u=n(7854),d=n(7857),c=n(7850),s=n(7879),f=n(78),p=n(52),m=n(8086),g=n(8471),h=n(8472);function y(e){return e&&e.__esModule?e:{default:e}}const v=a.default.div.withConfig({displayName:"ZoneFormContentStyled"})`
  margin: ${p.Spacing.Middle};
  color: ${p.Colors.black};
`,b=a.default.div.withConfig({displayName:"DescriptionUnderHeadline"})`
  color: ${p.Colors.greyDark};
  padding-bottom: 0.2rem;
`;t.ZoneFormContent=(e=>o.default.createElement(v,null,o.default.createElement(c.IconLine,{icon:"label"},o.default.createElement(u.FormInputTextBox,{field:"name",validate:(0,s.validateIsRequired)(f.i18n._("Zone name"))})),o.default.createElement(c.IconLine,{icon:"color_lens"},o.default.createElement(g.ZoneColorSelector,null)),o.default.createElement(i.FormInputCheckbox,{field:"enabled",name:"enabled",label:f.i18n._("Is active").toLocaleLowerCase()}),o.default.createElement(r.Trans,{id:"<0>Delivery cost</0><1>according order total cost</1>",components:[o.default.createElement(d.Headline,{margin:"0.5rem 0 0 0"}),o.default.createElement(b,null)]}),o.default.createElement(m.ZonePriceInput,{field:"minimalOrderPrice.value"}),o.default.createElement(l.NestedField,{field:"priceRangeRules",component:h.ZoneFormPriceRange})))},8471:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZoneColorSelector=void 0;var r=c(n(0)),o=c(n(51)),l=n(7993),a=n(79),i=n(53),u=n(52),d=n(294);function c(e){return e&&e.__esModule?e:{default:e}}const s=o.default.div.withConfig({displayName:"ColorOption"})`
  background-color: ${({color:e})=>e};
  color: ${u.Colors.white};
  width: 6rem;
  padding: 0.4rem 1rem;
  margin: 0;
  height: 100%;
`,f=(0,a.buildQuery)(d.ZoneColorsQuery);t.ZoneColorSelector=(({field:e="zoneColor.id"})=>r.default.createElement(f,{render:({zoneColors:t})=>r.default.createElement(l.FormInputSelect,{field:e,fieldIsPure:!0,options:[...t],width:8,styles:(()=>({option:e=>Object.assign({},e,{padding:0,margin:0}),menu:e=>Object.assign({},e,{width:"8rem",maxWidth:"8rem"})}))(),defaultValue:i.RM.head(t),getOptionValue:i.RM.prop("id"),formatOptionLabel:e=>r.default.createElement(s,{color:e.color},e.code)})}))},8472:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZoneFormPriceRange=void 0;var r,o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(0)),l=n(7849),a=(r=n(51))&&r.__esModule?r:{default:r},i=n(5794),u=n(7887),d=n(52),c=n(8473),s=n(8086);const f=a.default.div.withConfig({displayName:"AddButtonContainer"})`
  position: relative;
  top: -6rem;
`,p=a.default.div.withConfig({displayName:"RemoveButtonContainer"})`
  position: relative;
  top: -7rem;
  left: 16rem;
`;t.ZoneFormPriceRange=(({fieldApi:e})=>o.default.createElement(o.default.Fragment,null,e.values.map((t,n,r)=>o.default.createElement(o.Fragment,{key:n},o.default.createElement(s.ZonePriceInput,{label:"za",isDeliveryPrice:!0,field:[n,"price","value"]}),n===r.length-1?o.default.createElement(c.ZonePlaceholderInput,{display:"\u221e",label:"do"}):o.default.createElement(s.ZonePriceInput,{field:[n,"toPrice","value"],autoFocus:!0}),r.length>1&&o.default.createElement(p,null,o.default.createElement(u.TouchButtonDelete,{onDelete:()=>e.removeValue("",n)})))),o.default.createElement(l.FormApi,{render:t=>o.default.createElement(f,null,o.default.createElement(i.TouchButton,{disabled:t.submitting,width:d.Spacing.ButtonHeight,iconName:"add_circle",onClick:()=>e.addValue("",{price:{value:0},toPrice:{value:0}})}))})))},8473:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZonePlaceholderInput=void 0;var r=a(n(0)),o=a(n(51)),l=n(7859);function a(e){return e&&e.__esModule?e:{default:e}}const i=o.default.div.withConfig({displayName:"LabelStyled"})`
  width: 3rem;
  display: inline-block;
`,u=(0,o.default)(l.FormInputStyled).withConfig({displayName:"FormInputForPlaceholderStyled"})`
  width: 3rem;
  position: relative;
  z-index: 4;
`,d=o.default.div.withConfig({displayName:"Container"})`
  margin: 0 0 0 1rem;
`;t.ZonePlaceholderInput=(({label:e,display:t})=>r.default.createElement(d,null,r.default.createElement(i,null,e),r.default.createElement(u,{disabled:!0,placeholder:t})))},8474:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZoneFormControls=void 0;var r,o=(r=n(0))&&r.__esModule?r:{default:r},l=n(7851),a=n(7865),i=n(7860),u=n(78),d=n(5794),c=n(52);t.ZoneFormControls=(({isSubmitting:e,isModified:t,onGoBack:n,onSave:r})=>o.default.createElement(i.FlexRowSingle,null,o.default.createElement(a.FlexColumn,{widthGrowIndex:.4,padding:"0"},o.default.createElement(d.TouchButton,{color:c.Colors.greyMiddle,onClick:n,text:u.i18n._("Back"),disabled:e})),o.default.createElement(a.FlexColumn,{widthGrowIndex:.4,padding:"0"},o.default.createElement(l.CanMutate,{mutationName:"updateZone"},o.default.createElement(d.TouchButton,{color:c.Colors.green,text:u.i18n._("Save zone"),onClick:r,disabled:e||!t})))))},8475:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueryZones=t.ZonesQuery=void 0;var r,o=(r=n(23))&&r.__esModule?r:{default:r},l=n(79),a=n(294);const i=o.default`
  query GZones($branchesId: [ID!]!) {
    zones(companyBranches: $branchesId) {
      ...GZone
    }
  }
  ${a.ZoneFragment}
`;t.ZonesQuery=i;const u=(0,l.buildQuery)(i);t.QueryZones=u},8476:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZoneMapControl=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(0)),o=n(7901),l=n(8477),a=n(52),i=n(8478),u=n(8479),d=n(8085),c=n(7994),s=n(7908),f=n(7931);function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}t.ZoneMapControl=(()=>{const e=(0,c.useZoneModel)(),t=(0,d.useZoneId)(),n=(0,f.useZoneList)(),{routeToZoneEdit:m}=(0,s.useZoneRouteControl)(),g=e.branches.filter(e.branchFilterPredicate),h=t=>!e.hasBranchFilter||t===e.branchFilterId,y=(0,r.useCallback)(e=>r.default.createElement(l.MapCompanyBranchMarker,{key:`branch${e.id}`,branch:e,isActive:h(e.id)}),[]);return r.default.createElement(o.BaseMap,{model:e.map},n&&n.map(n=>{const o={key:`zone${n.id}`,points:n.geoPolygon,priority:n.priority,color:h(n.companyBranch.id)&&n.enabled?n.zoneColor.color:a.Colors.greyMiddle};return n.id===t?r.default.createElement(u.ZoneMapEditableArea,p({},o,{onChange:e.map.updateZonePoints,onClear:e.map.clearZonePoints})):r.default.createElement(i.ZoneMapArea,p({},o,{onFocus:()=>{h(n.companyBranch.id)&&m(n.id)}}))}),g&&g.map(y))})},8477:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapCompanyBranchMarker=void 0;var r,o=(r=n(0))&&r.__esModule?r:{default:r},l=n(7881),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(51)),i=n(132),u=n(52);const d=a.default.div.withConfig({displayName:"BranchNameStyled"})`
  ${function({isActive:e}){return a.css`
    background-color: ${e?u.Colors.green:u.Colors.greyLight};
    color: ${e?u.Colors.white:u.Colors.greyDark};
  `}} font-size: 1.3rem;
  white-space: nowrap;
  padding: 0.2rem 0.5rem;
`;t.MapCompanyBranchMarker=(({branch:e,isActive:t=!0})=>o.default.createElement(l.OverlayView,{getPixelPositionOffset:(e,t)=>({x:-e/2,y:-t/2}),mapPaneName:l.OverlayView.MARKER_LAYER,position:(0,i.gpsToLatLng)(e.gps)},o.default.createElement(d,{isActive:t},e.name)))},8478:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZoneMapArea=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(0)),o=n(7881),l=n(132);t.ZoneMapArea=(e=>{const t=(0,r.useCallback)(t=>{e.onFocus&&(t.stop(),e.onFocus())},[e.onFocus]),{points:n,color:a,priority:i}=e;return r.default.createElement(o.Polygon,{defaultPath:n.map(l.gpsToLatLng),options:{fillColor:a,fillOpacity:.3,strokeWeight:0,zIndex:5e3-i},editable:!1,draggable:!1,onDblClick:t})})},8479:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZoneMapEditableArea=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(0)),o=n(7881),l=n(132);t.ZoneMapEditableArea=(e=>{const t=(0,r.useRef)(null),n=(0,r.useCallback)(()=>{if(t.current){const n=t.current.getPath();e.onChange(n.getArray().map(l.latLngToGps))}},[e.onChange]);(0,r.useEffect)(()=>{let r;if(t.current&&e.onChange){const e=t.current.getPath();r=[e.addListener("set_at",n),e.addListener("insert_at",n),e.addListener("remove_at",n)]}return()=>{e.onClear(),r&&r.forEach(e=>e.remove())}},[]);const{points:a,color:i}=e;return r.default.createElement(o.Polygon,{defaultPath:a.map(l.gpsToLatLng),options:{fillColor:i,fillOpacity:.6,strokeWeight:2,zIndex:1e4},editable:!0,draggable:!0,ref:t,onDragEnd:n})})},8480:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZoneMenuPanel=void 0;var r=s(n(0)),o=s(n(51)),l=n(7851),a=n(5798),i=n(7873),u=n(8481),d=n(8482),c=n(8489);function s(e){return e&&e.__esModule?e:{default:e}}const f=o.default.div.withConfig({displayName:"ZoneMenuContainer"})`
  display: flex;
  flex-direction: column;
  height: 100%;
`,p=o.default.div.withConfig({displayName:"FixedHeaderContainer"})`
  flex: 0 0 auto;
`,m=o.default.div.withConfig({displayName:"ScrollAreaContainer"})`
  flex: 1 1 0;
  min-height: 0;
`;t.ZoneMenuPanel=(()=>r.default.createElement(f,null,r.default.createElement(p,null,r.default.createElement(a.Card,null,r.default.createElement(c.ZoneFilter,null)),r.default.createElement(l.CanMutate,{mutationName:"createZone"},r.default.createElement(u.CreateZoneButton,null))),r.default.createElement(m,null,r.default.createElement(i.ScrollArea,null,r.default.createElement(d.ZoneListControl,null)))))},8481:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreateZoneButton=void 0;var r,o=n(100),l=(r=n(0))&&r.__esModule?r:{default:r},a=n(78),i=n(5794),u=n(52),d=n(7994),c=n(7908);const s=(0,o.observer)(()=>{const e=(0,d.useZoneModel)(),{routeToZoneEdit:t}=(0,c.useZoneRouteControl)();return l.default.createElement(i.TouchButton,{text:e.hasBranchFilter?a.i18n._("Create zone for branch"):a.i18n._("Select branch to create zone"),onClick:()=>e.createZone(t),disabled:!e.hasBranchFilter,color:u.Colors.turquoise,textNextToIcon:!0,height:u.Spacing.ButtonHeight,iconName:"add_circle"})});t.CreateZoneButton=s},8482:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZoneListControl=void 0;var r,o=n(130),l=(r=n(0))&&r.__esModule?r:{default:r},a=n(8087),i=n(7890),u=n(7994),d=n(7908),c=n(8483),s=n(7931);t.ZoneListControl=(()=>{const e=(0,s.useZoneList)();if(null===e)return l.default.createElement(a.BulletList,{primaryOpacity:.2,secondaryOpacity:.2});const t=(0,u.useZoneModel)(),{routeToZoneEdit:n}=(0,d.useZoneRouteControl)();return null===t.brand?l.default.createElement(i.CardListTitle,null,l.default.createElement(o.Trans,{id:"Select brand to see its zones"})):l.default.createElement(c.ZoneList,{zoneModel:t,zones:e.filter(t.zoneFilterPredicate),branches:t.root.user.filterBranches(t.branchFilterPredicate),onZoneEdit:n})})},8483:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZoneList=void 0;var r,o=c(n(182)),l=c(n(0)),a=n(7909),i=(r=n(51))&&r.__esModule?r:{default:r},u=n(7890),d=n(8488);function c(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}const s=(0,a.SortableContainer)(i.default.div`
  margin-top: 0.5rem;
  cursor: arrow;
`),f=o.sortWith([o.ascend(o.path(["companyBranch","name"])),o.descend(o.prop("priority"))]),p=o.groupBy(e=>e.companyBranch.id);t.ZoneList=(({branches:e,zones:t,zoneModel:n,onZoneEdit:r})=>{const a=(t,n)=>l.default.createElement(d.ZoneListCard,{key:t.id,zone:t,branch:e.find(o.propEq("id",t.companyBranch.id)),index:n,collection:t.companyBranch.id,onEdit:()=>r(t.id)});let i,c;if(1===e.length){const e=f(t);i=e.map(a),c=(({oldIndex:t,newIndex:r})=>{const o=e[t];n.changeZonePriority(o,t,r)})}else{const r=o.mapObjIndexed(f,p(t));i=e.map(e=>{const t=r[e.id];return t?((e,t)=>l.default.createElement(l.Fragment,{key:e.id},l.default.createElement(u.CardListTitle,null,e.name),t.map(a)))(e,t):null}),c=(({oldIndex:e,newIndex:t,collection:o})=>{const l=r[o][e];n.changeZonePriority(l,e,t)})}return l.default.createElement(s,{useDragHandle:!0,lockAxis:"y",onSortEnd:c},i)})},8488:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZoneListCard=void 0;var r=f(n(0)),o=n(7909),l=f(n(51)),a=n(5798),i=n(7933),u=n(7865),d=n(7860),c=n(5794),s=n(52);function f(e){return e&&e.__esModule?e:{default:e}}const p=l.default.div.withConfig({displayName:"ZoneNameStyled"})`
  font-size: 1.125rem;
  margin-top: 0.2rem;
`,m=l.default.div.withConfig({displayName:"ZoneDescriptionStyled"})`
  font-size: 0.875rem;
`,g=(0,l.default)(d.FlexRowSingle).withConfig({displayName:"ZoneFlexRowStyled"})`
  height: ${s.Spacing.ButtonHeight};
`,h=(0,o.SortableElement)(({zone:e,branch:t,onEdit:n})=>r.default.createElement(a.Card,{key:e.id,padding:0,color:e.enabled?e.zoneColor.color:s.Colors.greyMiddle,onClick:n},r.default.createElement(g,null,r.default.createElement(u.FlexColumn,{fixedWidth:!0,padding:"0 0.5rem 0 0"},r.default.createElement(c.TouchButton,{width:s.Spacing.ButtonHeight,height:s.Spacing.ButtonHeight,iconName:"mode_edit"})),r.default.createElement(u.FlexColumn,{widthGrowIndex:1},r.default.createElement(p,null,e.name,` [P${e.priority}]`),r.default.createElement(m,null,t.name)),r.default.createElement(u.FlexColumn,{padding:"0"},r.default.createElement(i.DragHandle,null)))));t.ZoneListCard=h},8489:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZoneFilter=void 0;var r=n(11),o=n(100),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(0)),a=n(99),i=n(7866),u=n(53),d=n(8490),c=n(8491);const s=(0,o.observer)(()=>{const{user:e,zone:t}=(0,a.useRoot)(),n=e.branches,s=(0,l.useCallback)(t=>null===t?[]:e.branches.filter(u.RM.pathEq(["brand","id"],t.id)),[]);if((0,o.useDisposable)(()=>(0,r.autorun)(()=>{1===n.length&&t.setBranchFilter(u.RM.head(n))})),n.length<=1)return null;const f=1===e.brands.length?u.RM.head(e.brands):null;return f&&t.setBrandFilter(f,s(t.brand)),l.default.createElement(l.default.Fragment,null,!f&&l.default.createElement(c.ZoneFilterBrand,{brands:e.brands,selectedBrand:t.brand,onSelection:e=>{null===e?t.clearBrandFilter():t.setBrandFilter(e,s(e))}}),!f&&l.default.createElement(i.VerticalGap,null),l.default.createElement(d.ZoneFilterBranch,{branches:s(t.brand),selectedBranch:t.branch,autoFocus:Boolean(f),onSelection:e=>{e?t.setBranchFilter(e):t.clearBranchFilter()}}))});t.ZoneFilter=s},8490:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZoneFilterBranch=void 0;var r,o=(r=n(0))&&r.__esModule?r:{default:r},l=n(53),a=n(78),i=n(7888);t.ZoneFilterBranch=(({branches:e,selectedBranch:t,onSelection:n,autoFocus:r})=>o.default.createElement(i.CompanyBranchDropdown,{placeholder:a.i18n._("Select branch"),branches:e,selectedBranch:t,onSingleSelection:n,formatOptionLabel:l.RM.prop("name"),isClearable:!0,autoFocus:r}))},8491:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZoneFilterBrand=void 0;var r,o=(r=n(0))&&r.__esModule?r:{default:r},l=n(7855),a=n(53),i=n(78);t.ZoneFilterBrand=(({brands:e,selectedBrand:t,onSelection:n})=>o.default.createElement(l.SelectControl,{placeholder:i.i18n._("Select brand"),options:e,value:t,formatOptionLabel:a.RM.prop("name"),getOptionValue:a.RM.prop("id"),getOptionLabel:a.RM.prop("name"),isClearable:!0,isSearchable:!0,onChange:e=>n(e),autoFocus:!0}))}}]);
//# sourceMappingURL=177.843c82d4.chunk.js.map