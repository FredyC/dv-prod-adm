(this.webpackJsonpspeedlo=this.webpackJsonpspeedlo||[]).push([[389],{1382:function(e,n,t){"use strict";t.d(n,"a",(function(){return l}));var a=t(61),r=t(0),c=t.n(r),i=t(1373),u=t(1389),l=Object(a.b)((function(e){var n=e.mutationName,t=e.children;return Object(i.b)(n)?c.a.createElement(c.a.Fragment,null,t):c.a.createElement(u.a,null,"No access to mutation ".concat(n))}))},1393:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var a=t(4);function r(){var e=Object(a.a)(["\n  flex: ",";\n  padding: ",";\n  margin: ",";\n"]);return r=function(){return e},e}var c=t(18).c.div(r(),(function(e){var n=e.fixedWidth,t=void 0!==n&&n,a=e.width,r=e.widthGrowIndex,c=void 0===r?0:r;return t?a?"0 0 ".concat(a):"0 0":"".concat(c," 0")}),(function(e){var n=e.padding;return void 0===n?"0.25rem":n}),(function(e){var n=e.margin;return void 0===n?"":n}))},1408:function(e,n,t){"use strict";t.d(n,"a",(function(){return d})),t.d(n,"b",(function(){return m}));var a=t(89),r=t(46),c=t(65),i=t(1370),u=t(61),l=t(0),o=t.n(l),s=t(1377),d=o.a.forwardRef((function(e,n){var t=e.fieldName,a=e.fullWidth,r=e.validate,i=e.addHiddenLabelWithPlaceholderText,l=void 0===i||i,d=Object(c.a)(e,["fieldName","fullWidth","validate","addHiddenLabelWithPlaceholderText"]),f=m({fieldName:t,validate:r});return Object(u.g)((function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(s.b,Object.assign({},f(),{inputFullWidth:a,ref:n},d)),l&&d.placeholder&&o.a.createElement("label",{hidden:!0,htmlFor:f().id},d.placeholder))}))}));function m(e){var n=e.fieldName,t=e.validate,c=Object(i.i)(),u=Object(i.e)(n,{validate:t}),l=Object(r.a)(u,2),o=l[0],s=l[1];return function(){return Object(a.a)({},s(),{disabled:c.isSubmitting,invalid:o.touched&&Boolean(o.error)})}}},1411:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var a=t(0),r=t.n(a),c=function(e){var n=e.text,t=void 0===n?"...":n;return r.a.createElement("h1",null,t)}},1442:function(e,n,t){"use strict";t.d(n,"a",(function(){return m}));var a=t(65),r=t(1587),c=t(1375),i=t(1370),u=t(61),l=t(0),o=t.n(l),s=t(131),d=t(14),m=function(e){var n=e.children,t=e.id,l=void 0===t?"form-submit":t,m=Object(a.a)(e,["children","id"]),f=Object(i.i)();return Object(u.g)((function(){return o.a.createElement(s.a,Object.assign({id:l,type:"submit",color:d.a.green,disabled:f.isSubmitting,icon:f.isValid?void 0:r.a,iconSize:1.1,iconColor:d.a.red},m,{className:Object(c.b)(m.className,"animated","infinite",{heartBeat:f.isSubmitting})}),o.a.createElement(o.a.Fragment,null,n))}))}},1447:function(e,n,t){"use strict";t.d(n,"a",(function(){return s}));var a=t(65),r=t(1673),c=t(0),i=t.n(c),u=t(439),l=t(14),o=t(131),s=function(e){var n=e.onDelete,t=e.confirmText,c=Object(a.a)(e,["onDelete","confirmText"]);return i.a.createElement(u.a,null,i.a.createElement(o.a,Object.assign({className:"delete-button",icon:r.a,color:l.a.greyMiddle,onClick:function(e){e.preventDefault(),t&&!window.confirm(t)||n()}},c)))}},1449:function(e,n,t){"use strict";t.d(n,"a",(function(){return l}));var a=t(61),r=t(0),c=t.n(r),i=t(1373),u=t(1389),l=Object(a.b)((function(e){var n=e.queryName,t=e.children;return Object(i.c)(n)?c.a.createElement(c.a.Fragment,null,t):c.a.createElement(u.a,null,"No access to query ".concat(n))}))},1480:function(e,n,t){"use strict";t.d(n,"a",(function(){return l}));var a=t(1516),r=t(1384),c=t(0),i=t.n(c),u=t(125),l=function(e){var n=e.children;return i.a.createElement(r.a,{utils:a.a,locale:u.b},n)}},1523:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var a=t(18).c.div.withConfig({displayName:"FlexDiv",componentId:"dwel3j-0"})(["display:flex;"])},1588:function(e,n,t){"use strict";t.d(n,"a",(function(){return l}));var a=t(4),r=t(18),c=t(14),i=t(1523);function u(){var e=Object(a.a)(["\n  flex-direction: row;\n  justify-content: space-between;\n  border-bottom: 1px solid ",";\n  padding: 0.1rem 0 0.1rem 0;\n"]);return u=function(){return e},e}var l=Object(r.c)(i.a)(u(),c.a.greyMiddle)},1592:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var a=t(40);function r(){return Object(a.b)().settings}},1602:function(e,n,t){"use strict";var a=t(65),r=t(1370),c=t(61),i=t(0),u=t.n(i),l=t(380),o=t(2799),s=t(1480),d=function(e){return u.a.createElement(s.a,null,u.a.createElement(o.a,Object.assign({variant:"inline",format:"PPP",maxDateMessage:l.i18n._("Date is too much in the future"),minDateMessage:l.i18n._("Date is too much in the past")},e)))};t.d(n,"a",(function(){return m}));var m=u.a.memo((function(e){var n=e.fieldName,t=Object(a.a)(e,["fieldName"]),i=Object(r.d)(n),l=Object(r.i)();return Object(c.g)((function(){return u.a.createElement(d,Object.assign({value:i.value,onChange:i.setValue,onOpen:i.setTouched,disabled:l.isSubmitting},t))}))}))},2829:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),c=t(59),i=t(260),u=t(114),l=t(443),o=t(79),s=t(1382),d=t(1449),m=t(254),f=t(1391),b=t(442),h=t(36),p=t(257),v=t(1463),E=t(54),O=t.n(E),j=t(160),g=t(46),w=t(15),y=t(61),A=t(1411),D=t(40),x=t(158),N=t(78),T=t(1371),k=t(177),I=t(255),H=t(131),S=t(14),C=t(125),W=t(20),M=t(4),F=t(1673),B=t(1575),_=t(18),R=t(439),L=t(2815),P=t(1480),q=function(e){return r.a.createElement(P.a,null,r.a.createElement(L.a,Object.assign({format:"p",variant:"inline",ampm:!1},e)))};function V(){var e=Object(M.a)(["\n  & input {\n    width: 5rem;\n  }\n"]);return V=function(){return e},e}var z=_.c.div(V()),G=r.a.memo((function(e){var n=e.hour;return Object(y.g)((function(){return r.a.createElement(z,null,r.a.createElement(q,{value:n.openAt,onChange:function(e){return n.openAt=e},label:r.a.createElement(o.Trans,{id:"input.timespan.from"}),fullWidth:!1}),r.a.createElement(q,{value:n.closeAt,onChange:function(e){return n.closeAt=e},label:r.a.createElement(o.Trans,{id:"input.timespan.to"}),fullWidth:!1}))}))}));function J(){var e=Object(M.a)(["\n  display: flex;\n  align-items: baseline;\n  margin: 0 0 0.3rem 0;\n  h5 {\n    width: 5rem;\n  }\n  & .range {\n    display: flex;\n    margin: 0 2rem 0 0;\n    padding-right: 1rem;\n    background: ",";\n    border-radius: ",";\n  }\n  .remove-btn {\n    margin-right: 1rem;\n  }\n"]);return J=function(){return e},e}var Q=_.c.article(J(),S.a.white,S.c.Button),U=function(e){var n=e.weekday,t=e.hours,a=e.onAdd,c=e.onRemove,i=function(e){return r.a.createElement("div",{key:e.id,"data-testid":"bh-range",className:"range"},r.a.createElement(R.a,{className:"remove-btn"},r.a.createElement(H.a,{title:h.b._("Remove business hour"),role:"button",onClick:function(){return c(e.id)}},r.a.createElement(F.a,null))),r.a.createElement(G,{hour:e}))};return Object(y.g)((function(){return r.a.createElement(Q,null,r.a.createElement("h5",null,n.code),0===t.length?r.a.createElement("em",null,r.a.createElement(o.Trans,{id:"Closed"})):t.map(i),r.a.createElement(R.a,null,r.a.createElement(H.a,{title:h.b._("Add business hour"),role:"button",onClick:a},r.a.createElement(B.a,null))))}))},Y=C.c.parse(new Date,"H:mm"),K=Object(y.b)((function(){var e=Object(D.b)().settings,n=Object(N.lc)({branchId:e.branchId}),t=n.data,a=n.loading,c=r.a.useState((function(){return Object(w.observable)(new Map)})),i=Object(g.a)(c,1)[0],u=Object(N.A)(),l=Object(g.a)(u,1)[0];r.a.useEffect((function(){if(void 0!==t)return 0===i.size&&t.weekDays.forEach((function(e){i.set(e.enum,w.observable.array([]))})),t.businessHours.forEach((function(e){var n=e.id,t=e.openAt,a=e.closeAt,r=e.weekDay;r&&i.get(r.enum).push({id:n,openAt:Y(t),closeAt:Y(a),weekDay:r.enum})})),function(){i.forEach((function(e){e.clear()}))}}),[i,t,e.branchId]);var o=r.a.useRef(0),s=function(e){return function(n){var t=i.get(e),a=t.findIndex(W.a.propEq("id",n));a>=0&&t.splice(a,1)}},d=Object(I.a)().enqueueSuccess,m=r.a.useCallback((function(){var n;return O.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],i.forEach((function(e,t){n.push.apply(n,Object(j.a)(e.map((function(e){return{openAt:Object(k.h)(e.openAt),closeAt:Object(k.h)(e.closeAt),weekDay:t}}))))})),t.next=4,O.a.awrap(l({branchId:e.branchId,hours:n}));case 4:t.sent&&d(h.b._("Regular business hours has been updated"));case 6:case"end":return t.stop()}}))}),[i,d,e.branchId,l]);return a?r.a.createElement(A.a,null):r.a.createElement("div",null,t&&t.weekDays.map((function(e){return r.a.createElement(U,{key:e.enum,weekday:e,hours:i.get(e.enum)||T.a,onAdd:(n=e.enum,function(){i.get(n).push({weekDay:n,id:"L".concat(o.current++),openAt:C.c.startOfDay(new Date),closeAt:C.c.endOfDay(new Date)})}),onRemove:s(e.enum)});var n})),r.a.createElement(x.a,{width:20},r.a.createElement(b.a,{margin:"1rem"},r.a.createElement(H.a,{text:h.b._("Save regular hours"),color:S.a.green,onClick:m}))))})),X=t(47),Z=t(1370),$=t(90),ee=t(140),ne=t(269),te=t(270),ae=t(1408),re=t(1602),ce=t(65),ie=r.a.memo((function(e){var n=e.fieldName,t=Object(ce.a)(e,["fieldName"]),a=Object(Z.d)(n),c=Object(Z.i)();return Object(y.g)((function(){return r.a.createElement(q,Object.assign({value:a.value,onChange:a.setValue,onOpen:a.setTouched,disabled:c.isSubmitting},t))}))}));function ue(){var e=Object(M.a)(["\n  width: 5rem;\n  display: inline-block;\n"]);return ue=function(){return e},e}var le,oe=_.c.div(ue()),se=function(e){var n=e.fieldFrom,t=e.fieldTo;return r.a.createElement(r.a.Fragment,null,r.a.createElement(oe,null,r.a.createElement(ie,{fieldName:n,label:r.a.createElement(o.Trans,{id:"input.timespan.from"}),fullWidth:!1})),r.a.createElement(oe,null,r.a.createElement(ie,{fieldName:t,label:r.a.createElement(o.Trans,{id:"input.timespan.to"}),fullWidth:!1})))},de=t(1442),me=t(256),fe=t(380),be=t(1430),he=t(1592),pe=t(430),ve=(le={},Object(me.a)(le,pe.a.TIMESPAN,Object(fe.i18nMark)("Open between")),Object(me.a)(le,pe.a.FULLDAY,Object(fe.i18nMark)("Closed")),le),Ee=r.a.memo((function(){var e=Object(he.a)().businessHours;return Object(y.g)((function(){return r.a.createElement(be.a,{items:[pe.a.TIMESPAN,pe.a.FULLDAY],selectedItem:e.specificMode,formatItem:function(e){return h.b._(ve[e])},onSingleSelection:function(n){return e.changeSpecificMode(n)}})}))}));function Oe(){var e=Object(M.a)(["\n  display: inline-block;\n  width: 16rem;\n  min-height: 6rem;\n  margin: 0rem 0 0 1rem;\n  vertical-align: top;\n"]);return Oe=function(){return e},e}function je(){var e=Object(M.a)(["\n  display: inline-block;\n  width: 13rem;\n  margin-left: 1rem;\n  margin-top: 2rem;\n"]);return je=function(){return e},e}var ge=_.c.div(je()),we=_.c.div(Oe()),ye=function(){var e,n=Object(X.h)(),t=Object(D.b)().settings,a=Object(N.lb)(),c=Object(g.a)(a,1)[0],i=r.a.useCallback((function(e){var n=t.businessHours.isTimespanMode&&e.openAt?e.openAt:Object($.a)(e.date),a=t.businessHours.isTimespanMode&&e.closeAt?e.closeAt:Object(ee.a)(e.date);c({input:{companyBranch:t.branchId,specificDate:e.date,closed:!t.businessHours.isTimespanMode,closedNote:e.note,openAt:Object(k.h)(n),closeAt:Object(k.h)(a)}},{refetchQueries:[{query:N.l,variables:{branchId:t.branchId}}]})}),[c,t]);return r.a.createElement(Z.a,{onSubmit:i,initialValues:(e=n(),{date:e,openAt:Object(ne.a)(Object(te.a)(e,0),9),closeAt:Object(ne.a)(Object(te.a)(e,0),20),note:""})},r.a.createElement(ge,null,r.a.createElement(re.a,{fieldName:"date",format:k.j,minDate:new Date,fullWidth:!0,label:r.a.createElement(o.Trans,{id:"Date"})})),r.a.createElement(we,null,r.a.createElement(Ee,null),r.a.createElement(y.a,null,(function(){return t.businessHours.isTimespanMode?r.a.createElement(se,{fieldFrom:"openAt",fieldTo:"closeAt"}):r.a.createElement(x.a,{width:13},r.a.createElement(ae.a,{fieldName:"note",fullWidth:!0,placeholder:h.b._("Closing reason")}))}))),r.a.createElement(de.a,{width:"9rem"},r.a.createElement(o.Trans,{id:"Add"})))};var Ae=t(267),De=t(2803),xe=t(1373),Ne=t(1393),Te=t(1588),ke=t(1447),Ie=function(e){var n=e.bsHour,t=e.canDelete,a=e.onDelete;return r.a.createElement(Te.a,null,r.a.createElement(Ne.a,{fixedWidth:!0},t&&r.a.createElement(ke.a,{onDelete:a,confirmText:"".concat(h.b._("Really remove specific business hour {0}?",{0:Object(k.c)(n.specificDate)}))})),r.a.createElement(Ne.a,{fixedWidth:!0,width:"14rem"},Object(k.c)(n.specificDate)),r.a.createElement(Ne.a,{fixedWidth:!0,width:"10rem"},"".concat(n.openAt," - ").concat(n.closeAt)),r.a.createElement(Ne.a,{fixedWidth:!0,width:"10rem"},n.closed?r.a.createElement(o.Trans,{id:"Closed"}):r.a.createElement(o.Trans,{id:"Open"})),r.a.createElement(Ne.a,{widthGrowIndex:1},n.closedNote))},He=W.a.sort(W.a.ascend(W.a.or(W.a.prop("specificDate"),W.a.not))),Se=function(e){var n=e.specificDate;return null===n||Object(Ae.a)(n,Object($.a)(new Date))},Ce=Object(y.b)((function(){var e=Object(D.b)().settings,n=Object(N.mc)({branchId:e.branchId}),t=n.getStash,a=n.updateQuery,c=Object(xe.b)("destroyBusinessHour"),i=Object(N.mb)(),u=Object(g.a)(i,1)[0],l=t((function(e){return He(W.a.reject(Se,e.businessHours))}));return null===l?null:0===l.length?r.a.createElement(b.a,{margin:1},r.a.createElement(o.Trans,{id:"No specific business hours defined"})):r.a.createElement(r.a.Fragment,null,l.map((function(e){return r.a.createElement(Ie,{key:e.id,bsHour:e,canDelete:c,onDelete:function(){return O.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,O.a.awrap(u({id:e.id}));case 2:a(We(e.id));case 3:case"end":return n.stop()}}))}})})))}));function We(e){return Object(De.a)((function(n){n.businessHours.splice(n.businessHours.findIndex(Object(W.c)(e)),1)}))}var Me=function(){return r.a.createElement(p.a,{pageTitle:h.b._("Business hours"),useBackButton:!0},r.a.createElement(m.a,null,r.a.createElement(v.a,null),r.a.createElement(d.a,{queryName:"businessHours"},r.a.createElement(f.a,null,r.a.createElement(b.a,{margin:"1rem 0"},r.a.createElement(o.Trans,{id:"Regular business hours"}))),r.a.createElement(K,null)),r.a.createElement(f.a,null,r.a.createElement(b.a,{margin:"1rem 0"},r.a.createElement(o.Trans,{id:"Specific business hours"}))),r.a.createElement(Ce,null),r.a.createElement(s.a,{mutationName:"addSpecialBusinessHour"},r.a.createElement(f.a,null,r.a.createElement(b.a,{margin:"1rem 0"},r.a.createElement(o.Trans,{id:"Add specific business hour"}))),r.a.createElement(ye,null))))};t.d(n,"BusinessHoursRouting",(function(){return Fe}));var Fe=function(){return r.a.createElement(c.e,null,r.a.createElement(u.a,{exact:!0,path:l.b,component:Me}),r.a.createElement(c.c,{component:i.a}))};n.default=Fe}}]);
//# sourceMappingURL=389.2d755481.chunk.js.map