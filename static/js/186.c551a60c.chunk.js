(window.webpackJsonpspeedlo=window.webpackJsonpspeedlo||[]).push([[186],{1402:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(45),r=n(0),c=n.n(r),i=n(1400),u=n(1407),o=Object(a.b)(function(e){var t=e.mutationName,n=e.children;return Object(i.b)(t)?c.a.createElement(c.a.Fragment,null,n):c.a.createElement(u.a,null,"No access to mutation ".concat(t))})},1414:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n(3);function r(){var e=Object(a.a)(["\n  flex: ",";\n  padding: ",";\n  margin: ",";\n"]);return r=function(){return e},e}var c=n(17).c.div(r(),function(e){var t=e.fixedWidth,n=void 0!==t&&t,a=e.width,r=e.widthGrowIndex,c=void 0===r?0:r;return n?a?"0 0 ".concat(a):"0 0":"".concat(c," 0")},function(e){var t=e.padding;return void 0===t?"0.25rem":t},function(e){var t=e.margin;return void 0===t?"":t})},1428:function(e,t,n){"use strict";n.d(t,"a",function(){return m}),n.d(t,"b",function(){return f});var a=n(22),r=n(66),c=n(16),i=n(1397),u=n(45),o=n(0),l=n.n(o),s=n(1403);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var m=l.a.forwardRef(function(e,t){var n=e.fieldName,a=e.fullWidth,r=e.validate,i=e.addHiddenLabelWithPlaceholderText,o=void 0===i||i,d=Object(c.a)(e,["fieldName","fullWidth","validate","addHiddenLabelWithPlaceholderText"]),m=f({fieldName:n,validate:r});return Object(u.g)(function(){return l.a.createElement(l.a.Fragment,null,l.a.createElement(s.b,Object.assign({},m(),{inputFullWidth:a,ref:t},d)),o&&d.placeholder&&l.a.createElement("label",{hidden:!0,htmlFor:m().id},d.placeholder))})});function f(e){var t=e.fieldName,n=e.validate,c=Object(i.e)(t,{validate:n}),u=Object(r.a)(c,2),o=u[0],l=u[1];return function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(n,!0).forEach(function(t){Object(a.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},l(),{invalid:o.touched&&Boolean(o.error)})}}},1430:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n(0),r=n.n(a),c=function(e){var t=e.text,n=void 0===t?"...":t;return r.a.createElement("h1",null,n)}},1455:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(45),r=n(0),c=n.n(r),i=n(1400),u=n(1407),o=Object(a.b)(function(e){var t=e.queryName,n=e.children;return Object(i.c)(t)?c.a.createElement(c.a.Fragment,null,n):c.a.createElement(u.a,null,"No access to query ".concat(t))})},1469:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var a=n(16),r=n(1777),c=n(0),i=n.n(c),u=n(291),o=n(14),l=n(107),s=function(e){var t=e.onDelete,n=e.confirmText,c=Object(a.a)(e,["onDelete","confirmText"]);return i.a.createElement(u.a,null,i.a.createElement(l.a,Object.assign({icon:r.a,color:o.a.greyMiddle,onClick:function(e){e.preventDefault(),n&&!window.confirm(n)||t()}},c)))}},1481:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var a=n(1601),r=n(2748),c=n(0),i=n.n(c),u=function(e){var t=e.children;return i.a.createElement(r.b,{utils:a.a},t)}},1503:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var a=n(16),r=n(1793),c=n(1397),i=n(45),u=n(0),o=n.n(u),l=n(107),s=n(14),d=function(e){var t=e.children,n=e.id,u=void 0===n?"form-submit":n,d=Object(a.a)(e,["children","id"]),m=Object(c.h)();return Object(i.g)(function(){return o.a.createElement(l.a,Object.assign({type:"submit",color:s.a.green,disabled:m.isSubmitting&&m.isDirty,id:u,icon:m.isValid?void 0:r.a,iconSize:1.1,iconColor:s.a.red},d),o.a.createElement(o.a.Fragment,null,t))})}},1567:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a=n(17).c.div.withConfig({displayName:"FlexDiv",componentId:"dwel3j-0"})(["display:flex;"])},1742:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(3),r=n(17),c=n(14),i=n(1567);function u(){var e=Object(a.a)(["\n  flex-direction: row;\n  justify-content: space-between;\n  border-bottom: 1px solid ",";\n  padding: 0.1rem 0 0.1rem 0;\n"]);return u=function(){return e},e}var o=Object(r.c)(i.a)(u(),c.a.greyMiddle)},1746:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(41);function r(){return Object(a.b)().settings}},1754:function(e,t,n){"use strict";var a=n(66),r=n(16),c=n(1397),i=n(45),u=n(0),o=n.n(u),l=n(205),s=n(2785),d=n(1481),m=function(e){return o.a.createElement(d.a,null,o.a.createElement(s.a,Object.assign({variant:"inline",format:"ll",maxDateMessage:l.i18n._("Date is too much in the future"),minDateMessage:l.i18n._("Date is too much in the past")},e)))};n.d(t,"a",function(){return f});var f=function(e){var t=e.fieldName,n=Object(r.a)(e,["fieldName"]),u=Object(c.e)(t),l=Object(a.a)(u,2),s=l[0],d=l[1];return Object(i.g)(function(){return o.a.createElement(m,Object.assign({},d(),{onChange:s.setValue,onOpen:s.setTouched},n))})}},2831:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(50),i=n(161),u=n(90),o=n(292),l=n(82),s=n(1402),d=n(1455),m=n(158),f=n(1409),b=n(293),p=n(30),h=n(160),E=n(1470),O=n(48),v=n.n(O),j=n(73),g=n(75),w=n(66),y=n(18),D=n(13),A=n(45),k=n(1430),T=n(41),x=n(108),N=n(65),H=n(290),I=n(159),M=n(107),W=n(14),C=n(3),F=n(1777),P=n(1599),S=n(17),B=n(291),L=n(2817),R=n(1481),_=function(e){return r.a.createElement(R.a,null,r.a.createElement(L.a,Object.assign({format:"LT",variant:"inline"},e)))};function q(){var e=Object(C.a)(["\n  & input {\n    width: 5rem;\n  }\n"]);return q=function(){return e},e}var z=S.c.div(q()),V=r.a.memo(function(e){var t=e.hour;return Object(A.g)(function(){return r.a.createElement(z,null,r.a.createElement(_,{value:t.openAt,onChange:function(e){return t.openAt=e},label:r.a.createElement(l.Trans,{id:"input.timespan.from"}),fullWidth:!1}),r.a.createElement(_,{value:t.closeAt,onChange:function(e){return t.closeAt=e},label:r.a.createElement(l.Trans,{id:"input.timespan.to"}),fullWidth:!1}))})});function G(){var e=Object(C.a)(["\n  display: flex;\n  align-items: baseline;\n  margin: 0 0 0.3rem 0;\n  h5 {\n    width: 5rem;\n  }\n  & .range {\n    display: flex;\n    margin: 0 2rem 0 0;\n    padding-right: 1rem;\n    background: ",";\n    border-radius: ",";\n  }\n  .remove-btn {\n    margin-right: 1rem;\n  }\n"]);return G=function(){return e},e}var J=S.c.article(G(),W.a.white,W.c.Button),Q=r.a.memo(function(e){var t=e.weekday,n=e.hours,a=e.onAdd,c=e.onRemove,i=function(e){return r.a.createElement("div",{key:e.id,"data-testid":"bh-range",className:"range"},r.a.createElement(B.a,{className:"remove-btn"},r.a.createElement(M.a,{title:p.b._("Remove business hour"),role:"button",onClick:function(){return c(e.id)}},r.a.createElement(F.a,null))),r.a.createElement(V,{hour:e}))};return Object(A.g)(function(){return r.a.createElement(J,null,r.a.createElement("h5",null,t.code),0===n.length?r.a.createElement("em",null,r.a.createElement(l.Trans,{id:"Closed"})):n.map(i),r.a.createElement(B.a,null,r.a.createElement(M.a,{title:p.b._("Add business hour"),role:"button",onClick:a},r.a.createElement(P.a,null))))})}),U=y.DFP.parse(new Date,"H:mm"),Y=Object(A.b)(function(){var e=Object(T.b)().settings,t=Object(N.Vb)({branchId:e.branchId}),n=t.data,a=t.loading,c=r.a.useState(function(){return Object(D.observable)(new Map)}),i=Object(w.a)(c,1)[0],u=Object(N.B)(),o=Object(w.a)(u,1)[0];r.a.useEffect(function(){if(!a)return 0===i.size&&n.weekDays.forEach(function(e){i.set(e.enum,D.observable.array([]))}),n.businessHours.forEach(function(e){var t=e.id,n=e.openAt,a=e.closeAt,r=e.weekDay;r&&i.get(r.enum).push({id:t,openAt:U(n),closeAt:U(a),weekDay:r.enum})}),function(){i.forEach(function(e){e.clear()})}},[n.businessHours,n.weekDays,a,e.branchId]);var l=r.a.useRef(0),s=function(e){return function(t){var n=i.get(e),a=n.findIndex(y.RM.propEq("id",t));a>=0&&n.splice(a,1)}},d=Object(I.a)().enqueueSuccess,m=r.a.useCallback(Object(g.a)(v.a.mark(function t(){var n;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],i.forEach(function(e,t){n.push.apply(n,Object(j.a)(e.map(function(e){return{openAt:Object(H.f)(e.openAt),closeAt:Object(H.f)(e.closeAt),weekDay:t}})))}),t.next=4,o({branchId:e.branchId,hours:n});case 4:t.sent&&d(p.b._("Regular business hours has been updated"));case 6:case"end":return t.stop()}},t)})),[i,d,e.branchId,o]);return a||0===i.size?r.a.createElement(k.a,null):r.a.createElement("div",null,n.weekDays.map(function(e){return r.a.createElement(Q,{key:e.enum,weekday:e,hours:i.get(e.enum),onAdd:(t=e.enum,function(){i.get(t).push({weekDay:t,id:"L".concat(l.current++),openAt:y.DFP.startOfDay(new Date),closeAt:y.DFP.endOfDay(new Date)})}),onRemove:s(e.enum)});var t}),r.a.createElement(x.a,{width:20},r.a.createElement(b.a,{margin:"1rem"},r.a.createElement(M.a,{text:p.b._("Save regular hours"),color:W.a.green,onClick:m}))))}),K=n(5),X=n(34),Z=n(1397),$=n(67),ee=n(1428),te=n(1754),ne=n(16),ae=r.a.memo(function(e){var t=e.fieldName,n=Object(ne.a)(e,["fieldName"]),a=Object(Z.e)(t),c=Object(w.a)(a,2),i=c[0],u=c[1];return Object(A.g)(function(){return r.a.createElement(_,Object.assign({},u(),{onChange:i.setValue,onOpen:i.setTouched},n))})});function re(){var e=Object(C.a)(["\n  width: 5rem;\n  display: inline-block;\n"]);return re=function(){return e},e}var ce,ie=S.c.div(re()),ue=function(e){var t=e.fieldFrom,n=e.fieldTo;return r.a.createElement(r.a.Fragment,null,r.a.createElement(ie,null,r.a.createElement(ae,{fieldName:t,label:r.a.createElement(l.Trans,{id:"input.timespan.from"}),fullWidth:!1})),r.a.createElement(ie,null,r.a.createElement(ae,{fieldName:n,label:r.a.createElement(l.Trans,{id:"input.timespan.to"}),fullWidth:!1})))},oe=n(1503),le=n(22),se=n(205),de=n(1415),me=n(1746),fe=n(282),be=(ce={},Object(le.a)(ce,fe.a.TIMESPAN,Object(se.i18nMark)("Open between")),Object(le.a)(ce,fe.a.FULLDAY,Object(se.i18nMark)("Closed")),ce),pe=r.a.memo(function(){var e=Object(me.a)().businessHours;return Object(A.g)(function(){return r.a.createElement(de.a,{items:[fe.a.TIMESPAN,fe.a.FULLDAY],selectedItem:e.specificMode,formatItem:function(e){return p.b._(be[e])},onSingleSelection:function(t){return e.changeSpecificMode(t)}})})});function he(){var e=Object(C.a)(["\n  display: inline-block;\n  width: 16rem;\n  min-height: 6rem;\n  margin: 0rem 0 0 1rem;\n  vertical-align: top;\n"]);return he=function(){return e},e}function Ee(){var e=Object(C.a)(["\n  display: inline-block;\n  width: 13rem;\n  margin-left: 1rem;\n  margin-top: 2rem;\n"]);return Ee=function(){return e},e}var Oe=S.c.div(Ee()),ve=S.c.div(he()),je=function(){var e,t=Object(X.i)(),n=Object(T.b)().settings,a=Object(N.jb)(),c=Object(w.a)(a,1)[0],i=r.a.useCallback(function(e){var t=n.businessHours.isTimespanMode&&e.openAt?e.openAt:Object($.startOfDay)(e.date),a=n.businessHours.isTimespanMode&&e.closeAt?e.closeAt:Object($.endOfDay)(e.date);c({input:{companyBranch:n.branchId,specificDate:Object(K.isoDate)(e.date),closed:!n.businessHours.isTimespanMode,closedNote:e.note,openAt:Object(H.f)(t),closeAt:Object(H.f)(a)}},{refetchQueries:[{query:N.m,variables:{branchId:n.branchId}}]})},[c,n]);return r.a.createElement(Z.a,{onSubmit:i,initialValues:(e=t(),{date:e,openAt:Object($.setHours)(Object($.setMinutes)(e,0),9),closeAt:Object($.setHours)(Object($.setMinutes)(e,0),20),note:""})},r.a.createElement(Oe,null,r.a.createElement(te.a,{fieldName:"date",format:H.h,minDate:new Date,fullWidth:!0,label:r.a.createElement(l.Trans,{id:"Date"})})),r.a.createElement(ve,null,r.a.createElement(pe,null),r.a.createElement(A.a,null,function(){return n.businessHours.isTimespanMode?r.a.createElement(ue,{fieldFrom:"openAt",fieldTo:"closeAt"}):r.a.createElement(x.a,{width:13},r.a.createElement(ee.a,{fieldName:"note",fullWidth:!0,placeholder:p.b._("Closing reason")}))})),r.a.createElement(oe.a,{width:"9rem"},r.a.createElement(l.Trans,{id:"Add"})))};var ge=n(2781),we=n(47),ye=n(1400),De=n(296),Ae=n(1414),ke=n(1742),Te=n(1469),xe=function(e){var t=e.bsHour,n=e.canDelete,a=e.onDelete;return r.a.createElement(ke.a,null,r.a.createElement(Ae.a,{fixedWidth:!0},n&&r.a.createElement(Te.a,{onDelete:a,confirmText:"".concat(p.b._("Really remove specific business hour {0}?",{0:t.specificDateLocalized}))})),r.a.createElement(Ae.a,{fixedWidth:!0,width:"14rem"},t.specificDateLocalized),r.a.createElement(Ae.a,{fixedWidth:!0,width:"10rem"},"".concat(t.openAt," - ").concat(t.closeAt)),r.a.createElement(Ae.a,{fixedWidth:!0,width:"10rem"},t.closed?r.a.createElement(l.Trans,{id:"Closed"}):r.a.createElement(l.Trans,{id:"Open"})),r.a.createElement(Ae.a,{widthGrowIndex:1},t.closedNote))},Ne=we.a.sort(we.a.ascend(we.a.or(we.a.prop("specificDate"),we.a.not))),He=we.a.reject(function(e){var t=e.specificDate;return Boolean(t)&&Object($.isBefore)(t,Object($.startOfDay)(new Date))}),Ie=Object(A.b)(function(){var e=Object(T.b)().settings,t=Object(De.a)(),n=Object(N.Wb)({branchId:e.branchId}),a=n.data,c=n.loading,i=n.updateQuery,u=t(c,function(){return Ne(He(a.businessHours))}),o=Object(ye.b)("destroyBusinessHour"),s=Object(N.kb)(),d=Object(w.a)(s,1)[0];return null===u?null:0===u.length?r.a.createElement(b.a,{margin:1},r.a.createElement(l.Trans,{id:"No specific business hours defined"})):r.a.createElement(r.a.Fragment,null,u.map(function(e){return r.a.createElement(xe,{key:e.id,bsHour:e,canDelete:o,onDelete:Object(g.a)(v.a.mark(function t(){return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d({id:e.id});case 2:i(Me(e.id));case 3:case"end":return t.stop()}},t)}))})}))});function Me(e){return Object(ge.a)(function(t){t.businessHours.splice(t.businessHours.findIndex(Object(y.idPropEq)(e)),1)})}var We=function(){return r.a.createElement(h.a,{pageTitle:p.b._("Business hours"),useBackButton:!0},r.a.createElement(m.a,null,r.a.createElement(E.a,null),r.a.createElement(d.a,{queryName:"businessHours"},r.a.createElement(f.a,null,r.a.createElement(b.a,{margin:"1rem 0"},r.a.createElement(l.Trans,{id:"Regular business hours"}))),r.a.createElement(Y,null)),r.a.createElement(f.a,null,r.a.createElement(b.a,{margin:"1rem 0"},r.a.createElement(l.Trans,{id:"Specific business hours"}))),r.a.createElement(Ie,null),r.a.createElement(s.a,{mutationName:"addSpecialBusinessHour"},r.a.createElement(f.a,null,r.a.createElement(b.a,{margin:"1rem 0"},r.a.createElement(l.Trans,{id:"Add specific business hour"}))),r.a.createElement(je,null))))};n.d(t,"BusinessHoursRouting",function(){return Ce});var Ce=function(){return r.a.createElement(c.e,null,r.a.createElement(u.a,{exact:!0,path:o.b,component:We}),r.a.createElement(c.c,{component:i.a}))};t.default=Ce}}]);
//# sourceMappingURL=186.c551a60c.chunk.js.map