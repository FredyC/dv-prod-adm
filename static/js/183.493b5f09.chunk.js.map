{"version":3,"sources":["atoms/ShowFeedbackButton.tsx","hooks/useMutationGuard.ts","atoms/VerticalGap.tsx","segments/settings/organisms/UserMenuLanguage.tsx","segments/settings/pages/UserMenuPage.tsx"],"names":["ShowFeedbackButton","react_default","a","createElement","TouchButton","onClick","Raven","showReportDialog","_lingui_react","id","useMutationGuard","mutate","options","arguments","length","undefined","defaultMessage","i18n","_","_useSnackBar","useSnackBar","enqueueSnackbar","enqueueError","enqueueWarning","handleUserErrors","userErrors","forEach","handleGraphQLErrors","errors","filter","RM","pathEq","map","prop","handleError","err","isApolloError","networkError","graphQLErrors","reportError","action","React","key","_ref","Object","asyncToGenerator","regenerator_default","mark","_callee","variables","mutateOptions","result","_data","_args","wrap","_context","prev","next","sent","abrupt","data","getUserErrors","t0","stop","this","_x","apply","__webpack_require__","d","__webpack_exports__","VerticalGap","styled","div","withConfig","displayName","componentId","_ref$size","size","_ref$sizeUnit","sizeUnit","concat","UserMenuLanguage","_useRoot","useRoot","auth","user","_useQUserMenuLanguage","useQUserMenuLanguages","loading","updateUserLanguage","useMUserMenuLanguage","_React$useState","useState","_React$useState2","slicedToArray","language","setLanguage","useEffect","languages","find","propEq","useObserver","node_modules_react_default","Sizer","width","margin","SelectControl","isLoading","toConsumableArray","getOptionLabel","getOptionValue","value","onChange","lang","_callee2","_context2","userId","enum","rawCode","color","Colors","green","react","UserMenuPage","FullPageLayout","pageTitle","Card","Headline","UserMenuLanguage_UserMenuLanguage"],"mappings":"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","file":"static/js/183.493b5f09.chunk.js","sourcesContent":["import { Trans } from '@lingui/macro'\nimport Raven from 'raven-js'\nimport React from 'react'\n\nimport { TouchButton } from '../molecules/TouchButton'\n\nexport function ShowFeedbackButton() {\n  return (\n    <TouchButton onClick={() => Raven.showReportDialog()}>\n      <Trans> Submit feedback </Trans>\n    </TouchButton>\n  )\n}\n","import { MutationFn, MutationHookOptions } from '@speedlo/graphql'\nimport { isApolloError } from 'apollo-client/errors/ApolloError'\nimport { GraphQLError } from 'graphql'\nimport React from 'react'\n\nimport { ShowFeedbackButton } from '../atoms/ShowFeedbackButton'\nimport { RM } from '../helpers/ramda'\nimport { reportError } from '../helpers/sentry'\nimport { i18n } from '../i18n'\nimport { useSnackBar } from './useSnackBar'\n\ninterface IMutationGuardOptions<TData> {\n  getUserErrors?(data: TData): ReadonlyArray<string> | null\n}\n\nexport function useMutationGuard<TData, TVariables>(\n  mutate: MutationFn<TData, TVariables>,\n  options: IMutationGuardOptions<TData> = {},\n) {\n  const defaultMessage = i18n.t`Unexpected error occured while sending a request. Our team was notified about the issue.`\n\n  const { enqueueSnackbar, enqueueError, enqueueWarning } = useSnackBar()\n\n  const handleUserErrors = (userErrors: ReadonlyArray<string>) => {\n    userErrors.forEach(enqueueWarning)\n  }\n\n  const handleGraphQLErrors = (errors: ReadonlyArray<GraphQLError>) => {\n    const userErrors = errors.filter(\n      RM.pathEq(['extensions', 'showToUser'], true),\n    )\n    if (userErrors.length === 0) {\n      enqueueError(defaultMessage)\n    } else {\n      handleUserErrors(userErrors.map(RM.prop('message')))\n    }\n  }\n\n  const handleError = (err: Error) => {\n    if (isApolloError(err)) {\n      if (err.networkError) {\n        enqueueError(\n          i18n.t`Communication with server has failed. Please retry the operation in a moment again.`,\n        )\n        return\n      } else if (err.graphQLErrors) {\n        handleGraphQLErrors(err.graphQLErrors)\n        return\n      }\n    }\n    reportError(err)\n    enqueueSnackbar(defaultMessage, {\n      action: [React.createElement(ShowFeedbackButton, { key: 'feedback' })],\n    })\n  }\n\n  return async (\n    variables: TVariables,\n    mutateOptions: MutationHookOptions<TData, TVariables> = {},\n  ) => {\n    try {\n      const result = await mutate(variables, mutateOptions)\n      if (result.errors) {\n        handleGraphQLErrors(result.errors)\n        return null\n      }\n      if (!result.data) {\n        return null\n      }\n      const data = result.data as TData\n      if (options.getUserErrors) {\n        const userErrors = options.getUserErrors(data)\n        if (userErrors !== null) {\n          handleUserErrors(userErrors)\n        }\n      }\n      return data\n    } catch (err) {\n      handleError(err)\n      return null\n    }\n  }\n}\n","import styled from 'styled-components'\n\ninterface IVerticalGapProps {\n  size?: number\n  sizeUnit?: string\n}\n\nexport const VerticalGap = styled.div`\n  height: ${({ size = 1, sizeUnit = 'rem' }: IVerticalGapProps) =>\n    `${size}${sizeUnit}`};\n`\n\nVerticalGap.displayName = 'VerticalGap'\n","import { Trans } from '@lingui/macro'\nimport { useObserver } from 'mobx-react-lite'\nimport React from 'react'\n\nimport { useRoot } from '../../../atoms/RootProvider'\nimport { SelectControl } from '../../../atoms/SelectControl'\nimport { Sizer } from '../../../atoms/Sizer'\nimport { VerticalGap } from '../../../atoms/VerticalGap'\nimport {\n  useMUserMenuLanguage,\n  useQUserMenuLanguages,\n} from '../../../graph/generated'\nimport { QUserMenuLanguages } from '../../../graph/types'\nimport { RM } from '../../../helpers/ramda'\nimport { useMutationGuard } from '../../../hooks/useMutationGuard'\nimport { TouchButton } from '../../../molecules/TouchButton'\nimport { Colors } from '../../../styling'\n\ninterface IProps {}\n\ntype TLang = QUserMenuLanguages.Languages\n\nexport const UserMenuLanguage: React.FC<IProps> = () => {\n  const { auth, user } = useRoot()\n  const { data, loading } = useQUserMenuLanguages()\n  const updateUserLanguage = useMutationGuard(useMUserMenuLanguage())\n\n  const [language, setLanguage] = React.useState<Maybe<TLang>>(null)\n\n  React.useEffect(\n    () => {\n      if (language === null && !loading) {\n        setLanguage(\n          data.languages.find(RM.propEq('rawCode', user.language)) || null,\n        )\n      }\n    },\n    [data, loading],\n  )\n\n  return useObserver(() => (\n    <Sizer width={20} margin=\"1rem\">\n      <SelectControl<TLang>\n        isLoading={loading}\n        options={loading ? [] : [...data.languages]}\n        getOptionLabel={RM.prop('code')}\n        getOptionValue={RM.prop('enum')}\n        value={language}\n        onChange={async lang => {\n          if (lang) {\n            setLanguage(lang as TLang)\n          }\n        }}\n      />\n      <VerticalGap />\n      <TouchButton\n        onClick={async () => {\n          if (language) {\n            await updateUserLanguage({\n              userId: auth.userId,\n              lang: language.enum,\n            })\n            user.setLanguage(language.rawCode)\n          }\n        }}\n        color={Colors.green}\n      >\n        <Trans>Change language</Trans>\n      </TouchButton>\n    </Sizer>\n  ))\n}\n","import { Trans } from '@lingui/macro'\nimport React from 'react'\n\nimport { Card } from '../../../atoms/Card'\nimport { Headline } from '../../../atoms/Headline'\nimport { i18n } from '../../../i18n'\nimport { FullPageLayout } from '../../../molecules/FullPageLayout'\nimport { UserMenuLanguage } from '../organisms/UserMenuLanguage'\n\nconst UserMenuPage: React.FC = () => {\n  return (\n    <FullPageLayout width={16} pageTitle={i18n.t`User`}>\n      <Card>\n        <Headline>\n          <Trans>Application language</Trans>\n        </Headline>\n        <UserMenuLanguage />\n      </Card>\n    </FullPageLayout>\n  )\n}\n\nexport default UserMenuPage\n"],"sourceRoot":""}