(window.webpackJsonpspeedlo=window.webpackJsonpspeedlo||[]).push([[184],{1414:function(e,n,t){"use strict";t.d(n,"a",function(){return l});var r=t(49),a=t(0),i=t.n(a),c=t(1411),o=t(1420),l=Object(r.b)(function(e){var n=e.mutationName,t=e.children;return Object(c.b)(n)?i.a.createElement(i.a.Fragment,null,t):i.a.createElement(o.a,null,"No access to mutation ".concat(n))})},1419:function(e,n,t){"use strict";var r=t(3),a=t(18),i=t(0),c=t.n(i),o=t(44);function l(){var e=Object(r.a)(["\n  overflow-y: auto;\n  -webkit-overflow-scrolling: touch;\n  height: 100%;\n"]);return l=function(){return e},e}var u=a.c.div(l()),d=t(116),s=t(15);function f(){var e=Object(r.a)(["\n    margin: 0;\n    grid-row: "," ;\n    grid-column: span 16;\n    height: "," ;\n    position: relative;\n  "]);return f=function(){return e},e}function m(){var e=Object(r.a)(["\n  position: fixed;\n  bottom: 0.5rem;\n  width: ",";\n  left: ",";\n  top: ",";"]);return m=function(){return e},e}t.d(n,"a",function(){return p});var b=a.c.div.withConfig({displayName:"StyledPageLayoutFullHeightItem",componentId:"sc-1mean6j-0"})([""," ",""],Object(o.c)(m(),function(e){return void 0!==e.widthInColumns?"calc(("+e.widthInColumns+" * 6.22vw) - "+s.d.LayoutGridCellMargin+")":"calc(100vh - (2 * "+s.d.LayoutGridCellMargin+"))"},function(e){return void 0!==e.column?"calc(("+e.column+" * 6.22vw) + "+s.d.LayoutGridCellMargin+")":s.d.LayoutGridCellMargin},function(e){return void 0!==e.row?"calc(("+e.row+" * 3.9375rem) + "+s.d.LayoutGridCellMargin+")":"calc(3.9375rem + "+s.d.LayoutGridCellMargin+")"}),Object(o.d)(f(),function(e){return e.rowInMobile},function(e){var n=e.forcePercentHeightInMobile;return n?"calc(".concat(n,"vh - ").concat(s.d.PageHeaderHeight+.25+s.d.DefaultSizeUnit,")"):"unset"})),p=function(e){var n=e.children,t=e.row,r=void 0===t?1:t,a=e.rowInMobile,i=void 0===a?16:a,l=e.column,s=void 0===l?0:l,f=e.widthInColumns,m=void 0===f?16:f,p=e.withScrollArea,g=void 0!==p&&p,h=e.scrollAreaId,v=e.forcePercentHeightInMobile,O=Object(o.f)().isMobile;return c.a.createElement(b,{column:s,row:r,rowInMobile:i,widthInColumns:m,withScrollArea:g,forcePercentHeightInMobile:v},g&&!O?c.a.createElement(u,{id:h},n):c.a.createElement(d.a,{height:100,heightUnit:"%"},n))}},1421:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t(3);function a(){var e=Object(r.a)(["\n  display: flex;\n  flex-direction: row;\n  flex-wrap: ",";\n  justify-content: ",";\n"]);return a=function(){return e},e}var i=t(18).c.div(a(),function(e){var n=e.flexWrap;return void 0===n?"unset":n},function(e){var n=e.justify;return void 0===n?"space-between":n})},1422:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t(3);function a(){var e=Object(r.a)(["\n  flex: ",";\n  padding: ",";\n  margin: ",";\n"]);return a=function(){return e},e}var i=t(18).c.div(a(),function(e){var n=e.fixedWidth,t=void 0!==n&&n,r=e.width,a=e.widthGrowIndex,i=void 0===a?0:a;return t?r?"0 0 ".concat(r):"0 0":"".concat(i," 0")},function(e){var n=e.padding;return void 0===n?"0.25rem":n},function(e){var n=e.margin;return void 0===n?"":n})},1426:function(e,n,t){"use strict";t.d(n,"a",function(){return f}),t.d(n,"b",function(){return m});var r=t(25),a=t(70),i=t(17),c=t(1409),o=t(49),l=t(0),u=t.n(l),d=t(1413);function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}var f=u.a.forwardRef(function(e,n){var t=e.fieldName,r=e.fullWidth,a=e.validate,c=e.addHiddenLabelWithPlaceholderText,l=void 0===c||c,s=Object(i.a)(e,["fieldName","fullWidth","validate","addHiddenLabelWithPlaceholderText"]),f=m({fieldName:t,validate:a});return Object(o.g)(function(){return u.a.createElement(u.a.Fragment,null,u.a.createElement(d.b,Object.assign({},f(),{inputFullWidth:r,ref:n},s)),l&&s.placeholder&&u.a.createElement("label",{hidden:!0,htmlFor:f().id},s.placeholder))})});function m(e){var n=e.fieldName,t=e.validate,i=Object(c.h)(),o=Object(c.e)(n,{validate:t}),l=Object(a.a)(o,2),u=l[0],d=l[1];return function(){return function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(t,!0).forEach(function(n){Object(r.a)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(t).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}({},d(),{disabled:i.isSubmitting,invalid:u.touched&&Boolean(u.error)})}}},1430:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t(3);function a(){var e=Object(r.a)(["\n  height: ",";\n"]);return a=function(){return e},e}var i=t(18).c.div(a(),function(e){var n=e.size,t=void 0===n?1:n,r=e.sizeUnit,a=void 0===r?"rem":r;return"".concat(t).concat(a)});i.displayName="VerticalGap"},1457:function(e,n,t){"use strict";t.d(n,"a",function(){return d});var r=t(17),a=t(1617),i=t(0),c=t.n(i),o=t(303),l=t(15),u=t(115),d=function(e){var n=e.onDelete,t=e.confirmText,i=Object(r.a)(e,["onDelete","confirmText"]);return c.a.createElement(o.a,null,c.a.createElement(u.a,Object.assign({icon:a.a,color:l.a.greyMiddle,onClick:function(e){e.preventDefault(),t&&!window.confirm(t)||n()}},i)))}},1462:function(e,n,t){"use strict";t.d(n,"a",function(){return f});var r=t(17),a=t(1674),i=t(1412),c=t(1409),o=t(49),l=t(0),u=t.n(l),d=t(115),s=t(15),f=function(e){var n=e.children,t=e.id,l=void 0===t?"form-submit":t,f=Object(r.a)(e,["children","id"]),m=Object(c.h)();return Object(o.g)(function(){return u.a.createElement(d.a,Object.assign({id:l,type:"submit",color:s.a.green,disabled:m.isSubmitting,icon:m.isValid?void 0:a.a,iconSize:1.1,iconColor:s.a.red},f,{className:Object(i.b)(f.className,"animated","infinite",{heartBeat:m.isSubmitting})}),u.a.createElement(u.a.Fragment,null,n))})}},1486:function(e,n,t){"use strict";t.d(n,"a",function(){return m}),t.d(n,"b",function(){return b});var r=t(87),a=t(1453),i=t(60),c=t(49),o=t(0),l=t.n(o),u=t(55),d=t(15),s=t(46),f=(l.a.createContext(null),["places"]),m=function(e){var n=e.model,t=e.children,o={streetViewControl:!1,mapTypeControl:!1,fullscreenControl:!1},m=Object(s.b)().user,b=Object(a.e)({id:"script-loader",version:"weekly",googleMapsApiKey:u.a.googleMapsApi,libraries:f,language:m.language}),p=b.isLoaded,g=b.loadError,h=b.url,v=Reflect.has(window,"google");return g||p&&!v?(i.a.withScope(function(e){e.setExtras({googleMapUrl:h}),i.a.captureException(g)}),l.a.createElement("h2",null,l.a.createElement(r.Trans,{id:"Cannot load map right now. Please try again later."}))):p?l.a.createElement(c.a,null,function(){return l.a.createElement(a.a,{zoom:n.zoom,center:n.center,onCenterChanged:n.updatePosition,onZoomChanged:n.updateZoom,onLoad:n.setMapRef,options:o,mapContainerStyle:{borderRadius:d.c.Card,overflow:"hidden",height:"100%"}},t)}):null};function b(){var e=Object(a.d)();if(!e)throw new Error("Trying to useGoogleMap, but BaseMap is missing in the tree");return e}},1488:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t(18),a=t(15),i=r.c.h2.withConfig({displayName:"CardListTitle",componentId:"dr5aqq-0"})(["color:",";font-weight:lighter;font-size:1.2rem;margin:0.8rem 0 0.8rem 0.3rem;"],a.a.greyLight)},1504:function(e,n,t){"use strict";t.d(n,"a",function(){return r}),t.d(n,"b",function(){return a});t(1482),t(35);function r(e){return!e.errors||0===Object.keys(e.errors).length}function a(e){return"number"===typeof e?e:Number.parseFloat(e.replace(",","."))}},1546:function(e,n,t){"use strict";t.d(n,"a",function(){return d});var r=t(17),a=t(21),i=t(1409),c=t(49),o=t(0),l=t.n(o),u=t(1415),d=function(e){var n=e.fieldName,t=Object(r.a)(e,["fieldName"]),o=Object(i.d)(n),d=t.isMulti,s=t.options,f=t.getOptionValue,m=Object(i.h)();return Object(c.g)(function(){return l.a.createElement(u.a,Object.assign({},d?function(){var e=o.value,n=Array.isArray(e)?function(n){return e.includes(f(n))}:a.RM.F;return{value:Array.isArray(s)?s.filter(n):[],onChange:function(e){o.setValue(e.map(f))}}}():function(){var e=o.value;return{value:e&&s.find(function(n){return f(n)===e}),onChange:function(e){o.setValue(f(e))}}}(),{onFocus:function(){return o.setTouched()},invalid:o.touched&&o.hasError,isDisabled:m.isSubmitting},t))})}},1547:function(e,n,t){"use strict";t.d(n,"a",function(){return o});var r=t(1409),a=t(49),i=t(0),c=t.n(i),o=function(e){var n=e.fieldName,t=e.className,i=Object(r.f)(n);return Object(a.g)(function(){return c.a.createElement("span",{className:t},i.value)})}},1548:function(e,n,t){"use strict";t.d(n,"a",function(){return f});var r=t(3),a=t(2829),i=t(0),c=t.n(i),o=t(1498),l=t(18),u=t(148);function d(){var e=Object(r.a)(["\n  padding: 1rem 0.4rem;\n  cursor: grab;\n"]);return d=function(){return e},e}var s=l.c.div(d()),f=Object(o.c)(function(){return c.a.createElement(s,null,c.a.createElement(u.a,{icon:a.a}))})},1555:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(0),a=function(e){var n=e.isShow,t=e.confirmText,a=e.onCancel,i=e.onConfirm;return Object(r.useEffect)(function(){n&&(window.confirm(t)?i():a())},[t,n,a,i]),null}},1591:function(e,n,t){"use strict";t.d(n,"a",function(){return f});var r=t(17),a=t(87),i=t(21),c=t(0),o=t.n(c),l=t(46),u=t(1415),d=t(35),s=function(e){var n=e.getStyles,t=e.innerProps,i=t.ref,c=Object(r.a)(t,["ref"]);return o.a.createElement("div",Object.assign({},c,{ref:i,style:n("clearIndicator",e)}),o.a.createElement("div",{style:{padding:"0px 5px"}},o.a.createElement(a.Trans,{id:"All"})))},f=function(e){var n=e.brands,t=e.selectedBrand,a=e.onSelection,c=Object(r.a)(e,["brands","selectedBrand","onSelection"]),f=Object(l.b)().user;return o.a.createElement(u.a,Object.assign({placeholder:d.b._("Select brand"),options:n||f.brands,value:t,formatOptionLabel:i.RM.prop("name"),getOptionValue:i.RM.prop("id"),getOptionLabel:i.RM.prop("name"),isClearable:!0,isSearchable:!0,onChange:function(e){return a(e)},autoFocus:!0,components:{ClearIndicator:s}},c))}},1592:function(e,n,t){"use strict";t.d(n,"a",function(){return f});var r=t(51),a=t.n(r),i=t(80),c=t(40),o=t(1409),l=t(0),u=t.n(l),d=(t(36),t(169)),s=void 0;function f(e){var n=e.onSubmit,t=e.initialValues,r=e.loadValues,l=e.validationSchema,f=e.submitMessage,m=e.submitRedirectPath,b=Object(c.m)().history,p=Object(d.a)(),g=p.enqueueSuccess,h=p.enqueueWarning,v=u.a.useCallback(function(){var e=Object(i.a)(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(t);case 2:f&&g(f),m&&b.push(m);case 4:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}(),[g,b,n,f,m]),O=u.a.useCallback(function(e,n){var t=!0,r=!1,a=void 0;try{for(var i,c=n.values()[Symbol.iterator]();!(t=(i=c.next()).done);t=!0){var o=i.value;o&&h(o)}}catch(l){r=!0,a=l}finally{try{t||null==c.return||c.return()}finally{if(r)throw a}}},[h]),y=u.a.useRef(!1),j=u.a.useCallback(function(){y.current=!1},[]),E=Object(o.g)({onSubmit:v,onSubmitFailed:O,onReset:j,validationSchema:l,initialValues:t,initialValidationEnabled:void 0===r,ignoreUnknownFieldsInValidation:!0,onFormChanges:s});return u.a.useEffect(function(){y.current||(r&&Promise.resolve(r(E.state.initialValues)).then(function(e){e&&(E.api.mergeValues(e),E.state.pristineValues=E.state.values),E.api.enableValidation()}),y.current=!0)},[r,E]),E}},2836:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),i=t(53),c=t(171),o=t(306),l=t(35),u=t(1419),d=t(309),s=t(25),f=t(51),m=t.n(f),b=t(80),p=t(70),g=t(21),h=t(1409),v=t(1592),O=t(69),y=t(1504),j=t(304),E=t(169),w=t(40),P=t(46);function C(){var e=Object(P.b)().user,n=Object(w.m)().history,t=a.a.useCallback(function(e){return"".concat(o.f,"/").concat(e)},[]);return{getRouteToZone:t,routeToZoneEdit:a.a.useCallback(function(r){e.canQuery("zone")&&n.push(t(r))},[t,n,e]),routeToZoneList:a.a.useCallback(function(){n.push(o.f)},[n])}}function z(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}var R=function(e){var n=e.children,t=e.zoneId,r=C().routeToZoneList,i=Object(E.a)().enqueueSuccess,c=Object(O.tb)(),o=Object(p.a)(c,1)[0],u=Object(h.c)(function(e){return{name:e.string().required(),minimalOrderPrice:e.number().required().min(0)}}),d=function(){var e=Object(b.a)(m.a.mark(function e(n){return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o({zoneId:n.id,update:S(n)});case 2:e.sent&&(r(),i(l.b._("Zone has been updated")));case 4:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}(),f=Object(v.a)({initialValues:{id:"",type:O.r.Area,name:"",enabled:!0,branchId:"",zoneColor:"",geoPolygon:[],minimalPrice:0,priceRules:{},priceRulesOrder:[],currencyCode:""},onSubmit:d,validationSchema:u}),y=!t,w=Object(O.qc)({zoneId:t},{skip:y}),P=w.data,R=w.loading,k=Object(j.a)(y)(R,function(){return y?null:function(e){return function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?z(t,!0).forEach(function(n){Object(s.a)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):z(t).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}({id:e.id,type:e.zoneType.enum,name:e.name,enabled:e.enabled,zoneColor:e.zoneColor.id,branchId:e.branchWithCurrency.id,geoPolygon:e.geoPolygon.map(x),currencyCode:e.branchWithCurrency.currency.code,minimalPrice:e.minimalOrderPrice.value},function(e){var n=e.priceRangeRules.map(function(e,n){return{clientId:String(n+1),toPrice:e.toPrice.value,price:e.price.value}});return{priceRulesOrder:n.map(g.RM.prop("clientId")),priceRules:n.reduce(function(e,n){return e[n.clientId]=n,e},{})}}(e))}(P.zone)});return a.a.useEffect(function(){return k&&(f.api.mergeValues(k),f.state.pristineValues=k),function(){f.api.resetForm()}},[k,f.api,f.state]),a.a.createElement(h.b,{xform:f},n)};var x=g.RM.omit(["__typename"]);function S(e){return{name:e.name,enabled:e.enabled,companyBranch:e.branchId,zoneColor:e.zoneColor,geoPolygon:e.geoPolygon,minimalOrderPrice:{value:Number(e.minimalPrice)},priceRangeRules:e.priceRulesOrder.map(function(n,t){return r=e.priceRules[n],a=t===e.priceRulesOrder.length-1,{price:{value:Object(y.b)(r.price)},toPrice:{value:a?-1:Object(y.b)(r.toPrice)}};var r,a})}}var k=t(49),I=t(1486),M=t(3),F=t(1453),N=t(18),B=t(149),L=t(15);function D(){var e=Object(M.a)(["\n    background-color: ",";\n    color: ",";\n  "]);return D=function(){return e},e}function T(){var e=Object(M.a)(["\n  "," font-size: 1.3rem;\n  white-space: nowrap;\n  padding: 0.2rem 0.5rem;\n"]);return T=function(){return e},e}var A=N.c.div(T(),function(e){var n=e.isActive;return Object(N.b)(D(),n?L.a.green:L.a.greyLight,n?L.a.white:L.a.greyDark)}),_=function(e){var n=e.branch,t=e.isActive,r=void 0===t||t;return a.a.createElement(F.b,{getPixelPositionOffset:function(e,n){return{x:-e/2,y:-n/2}},mapPaneName:F.b.MARKER_LAYER,position:Object(B.b)(n.gps)},a.a.createElement(A,{isActive:r},n.name))};var Z=function(e){var n=e.points,t=e.type,r=e.color,i=e.priority,c=e.onFocus,o=a.a.useCallback(function(e){c&&(e.stop(),c())},[c]);return a.a.createElement(F.c,{path:n.map(B.b),options:t===O.r.Return?{fillColor:"transparent",strokeWeight:3,strokeColor:r,zIndex:1e4-i}:{fillColor:r,fillOpacity:.3,strokeWeight:0,zIndex:5e3-i},editable:!1,draggable:!1,onDblClick:o})},V=function(e){var n=e.type,t=e.color,r=e.onChange,i=e.initialPoints,c=a.a.useRef(null),o=a.a.useRef([]),l=a.a.useCallback(function(){if(c.current){var e=c.current.getPath();r(e.getArray().map(B.d))}},[r]),u=a.a.useCallback(function(e){c.current=e;var n=e.getPath();o.current.push(n.addListener("set_at",l),n.addListener("insert_at",l),n.addListener("remove_at",l))},[l]),d=a.a.useCallback(function(){o.current.forEach(function(e){return e.remove()}),o.current.length=0,c.current=null},[]),s=a.a.useRef(i),f=a.a.useMemo(function(){return s.current.map(B.b)},[]);return a.a.createElement(F.c,{path:f,options:n===O.r.Return?{fillColor:"transparent",strokeWeight:5,strokeColor:t,zIndex:2e4}:{fillColor:t,fillOpacity:.1,strokeWeight:2,zIndex:2e4},editable:!0,draggable:!0,onDragEnd:l,onLoad:u,onUnmount:d})},q=[];function W(){var e=Object(O.pc)({},{fetchPolicy:"cache-first"}),n=e.data,t=e.loading;return Object(j.a)()(t,function(){return n.zoneColors})||q}var H=t(293);function G(){return Object(P.b)().zone}function U(){var e=Object(P.b)().zone,n=e.branches.filter(e.branchFilterPredicate).map(g.idProp),t=0===n.length,r=Object(O.rc)({branches:n},{skip:t}),a=r.data,i=r.loading;return{zones:Object(j.a)(t)(i,function(){return t?null:a.zones}),loading:i}}var J=Object(k.b)(function(e){var n=e.zoneId,t=G(),i=function(e){var n=G(),t=U().zones,r=n.branches.filter(n.branchFilterPredicate),i=a.a.useCallback(function(e){return!n.hasBranchFilter||e===n.branchFilterId},[n]),c=Object(k.c)({zoneId:e,zones:t});return Object(w.e)(function(){if(n.map.isReady&&c.zoneId&&c.zones){var e=c.zones.find(Object(g.idPropEq)(c.zoneId));if(e){var t=Object(H.getCenter)(e.geoPolygon);n.map.panTo(t)}}}),Object(w.e)(function(){n.map.isReady&&n.branch&&!c.zoneId&&n.map.panTo(n.branch.gps)}),{isActive:i,branches:r,zones:t}}(n),c=i.isActive,o=i.branches,l=i.zones,u=C().routeToZoneEdit,d=Object(h.d)("geoPolygon"),s=Object(h.f)("type"),f=Object(h.f)("zoneColor"),m=W(),b=Object(r.useCallback)(function(e){return a.a.createElement(_,{key:"branch".concat(e.id),branch:e,isActive:c(e.id)})},[c]);return a.a.createElement(I.a,{model:t.map},l&&l.map(function(e){return e.id===n?null:a.a.createElement(Z,{key:"zone".concat(e.id),type:e.zoneType.enum,points:e.geoPolygon,priority:e.priority,color:c(e.companyBranch.id)&&e.enabled&&null===n?e.zoneColor.color:L.a.greyMiddle,onFocus:function(){c(e.companyBranch.id)&&u(e.id)}})}),n&&function(){if(0===d.value.length)return null;var e=m.find(Object(g.idPropEq)(f.value));return a.a.createElement(V,{key:"zone".concat(n),type:s.value,color:e?e.color:"",initialPoints:d.value,onChange:d.setValue})}(),o&&o.map(b))}),K=t(329),Q=t(1414),Y=t(168),X=t(1555),$=t(1457),ee=t(87),ne=t(2827),te=t(2828),re=t(1418),ae=t(1410),ie=t(1426),ce=t(1532),oe=t(1546);function le(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function ue(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?le(t,!0).forEach(function(n){Object(s.a)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):le(t).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function de(){var e=Object(M.a)(["\n  background-color: ",";\n  color: ",";\n  width: 6rem;\n  padding: 0.4rem 1rem;\n  margin: 0;\n  height: 100%;\n"]);return de=function(){return e},e}var se=N.c.div(de(),function(e){return e.color},L.a.white),fe=function(e){var n=e.fieldName,t=W();return a.a.createElement(oe.a,{fieldName:n,options:t,isLoading:0===t.length,width:8,styles:{option:function(e){return ue({},e,{padding:0,margin:0})},menu:function(e){return ue({},e,{width:"8rem",maxWidth:"8rem"})}},defaultValue:g.RM.head(t),getOptionValue:g.RM.prop("id"),formatOptionLabel:function(e){return a.a.createElement(se,{color:e.color},e.code)}})},me=t(1554),be=t(115),pe=t(78),ge=t(1413),he=t(1547),ve=Object(k.b)(function(e,n){var t=e.fieldName,r=Object(ie.b)({fieldName:t})();return a.a.createElement(a.a.Fragment,null,a.a.createElement("label",{className:"forPriceLabel",htmlFor:r.id},l.b._({id:"for"})),a.a.createElement(ge.b,Object.assign({},r,{className:"forPrice",ref:n,inputFullWidth:!0})),a.a.createElement(he.a,{fieldName:"currencyCode"}))},{forwardRef:!0});function Oe(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}var ye=Object(k.b)(function(e,n){var t=e.fieldName,r=e.asInfinity,i=void 0!==r&&r,c=Object(ie.b)({fieldName:t})(),o=function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Oe(t,!0).forEach(function(n){Object(s.a)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Oe(t).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}({},c,{className:"toPrice",ref:n}),u=a.a.createElement("label",{className:"toPriceLabel",htmlFor:c.id},l.b._({id:"to"}));return i?a.a.createElement(a.a.Fragment,null,u,a.a.createElement(ge.b,Object.assign({},o,{value:"",disabled:!0,placeholder:"\u221e"}))):a.a.createElement(a.a.Fragment,null,u,a.a.createElement(ge.b,o),a.a.createElement(he.a,{fieldName:"currencyCode"}))},{forwardRef:!0}),je=Object(k.b)(function(e){var n=e.fieldPath,t=e.shouldFocus,r=e.isLastRule,i=a.a.useRef(null),c=a.a.useRef(null);return a.a.useEffect(function(){t&&(i.current&&!r?i.current.focus():c.current&&c.current.focus())},[t,r]),a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"toPriceField"},a.a.createElement("div",{className:"verticalLine"}),a.a.createElement(ye,{fieldName:[].concat(Object(pe.a)(n),["toPrice"]),ref:i,asInfinity:r})),a.a.createElement("div",{className:"forPriceField"},a.a.createElement(ve,{fieldName:[].concat(Object(pe.a)(n),["price"]),ref:c})))});function Ee(){var e=Object(M.a)(["\n  display: grid;\n\n  grid-template-columns: 4.5rem 7rem 8rem 4.5rem;\n\n  & input {\n    width: 4rem;\n    z-index: 1;\n  }\n  & label {\n    margin: ",";\n  }\n\n  & .minimalPriceField {\n    grid-column: 2;\n    display: flex;\n    align-items: center;\n  }\n  & .minimalPriceField span {\n    margin: ",";\n  }\n  & .addRule {\n    grid-column: 1;\n    justify-self: start;\n    align-self: center;\n    margin-bottom: 3rem;\n  }\n  & .toPriceField {\n    grid-column: 2;\n    display: flex;\n    align-items: center;\n    align-self: end;\n    position: relative;\n  }\n  & .toPriceField span {\n    margin: ",";\n  }\n  & .forPriceField {\n    grid-column: 3;\n    display: flex;\n    align-items: center;\n    align-self: center;\n    margin-bottom: 3rem;\n  }\n  & .forPriceField input {\n    color: ",";\n    width: 4rem;\n  }\n  & .forPriceField span {\n    margin: ",";\n  }\n  & .removeRule {\n    height: 5rem;\n    margin-bottom: 3rem;\n    grid-column: 4;\n    display: flex;\n    align-items: center;\n    justify-self: end;\n    align-self: center;\n  }\n  & .verticalLine {\n    width: 3px;\n    height: 8rem;\n    background: ",";\n    position: absolute;\n    top: -112px;\n    left: 62px;\n  }\n"]);return Ee=function(){return e},e}var we=N.c.div(Ee(),L.d.Middle,L.d.Middle,L.d.Middle,L.a.blue,L.d.Middle,L.a.greyMiddle),Pe=function(){var e=Object(h.d)("priceRulesOrder"),n=Object(h.f)("priceRules"),t=Object(h.h)(),i=a.a.useState(null),c=Object(p.a)(i,2),o=c[0],u=c[1],d=a.a.useRef(e.value.length);a.a.useEffect(function(){d.current<e.value.length&&(d.current=e.value.length)},[e.value]);return Object(k.g)(function(){return a.a.createElement(we,null,a.a.createElement("div",{className:"minimalPriceField"},a.a.createElement(ye,{fieldName:["minimalPrice"]})),e.value.map(function(i,c,s){return a.a.createElement(r.Fragment,{key:i},a.a.createElement(be.a,{className:"addRule",disabled:t.isSubmitting,width:L.d.ButtonHeight+L.d.DefaultSizeUnit,height:L.d.ButtonHeight+L.d.DefaultSizeUnit,onClick:function(){return function(t){var r=e.value.findIndex(g.RM.equals(t)),a=String(++d.current);e.value.splice(r,0,a),n.value[a]={clientId:String(a),toPrice:null,price:null},u(a)}(i)},icon:me.a,title:l.b._("Add another range")}),a.a.createElement(je,{fieldPath:["priceRules",i],shouldFocus:i===o,isLastRule:c===s.length-1}),a.a.createElement("div",{className:"removeRule"},a.a.createElement($.a,{onDelete:function(){return function(t){var r=e.value.findIndex(g.RM.equals(t));e.value.splice(r,1),delete n.value[t]}(i)},title:l.b._("Remove price range"),disabled:s.length<=1})))}))})};function Ce(){var e=Object(M.a)(["\n  margin: ",";\n  color: ",";\n\n  .description {\n    color: ",";\n    padding-bottom: 0.2rem;\n  }\n"]);return Ce=function(){return e},e}var ze=N.c.div(Ce(),L.d.Middle,L.a.black,L.a.greyDark),Re=function(e){var n=e.type;return a.a.createElement(ze,null,a.a.createElement(ae.a,{icon:ne.a},a.a.createElement(ie.a,{fieldName:"name"})),a.a.createElement(ae.a,{icon:te.a},a.a.createElement(fe,{fieldName:"zoneColor"})),a.a.createElement(ce.a,{fieldName:"enabled",label:l.b._("Is active").toLocaleLowerCase()}),n===O.r.Area&&a.a.createElement(a.a.Fragment,null,a.a.createElement(ee.Trans,{id:"<0>Delivery cost</0><1>according order total cost</1>",components:[a.a.createElement(re.a,{margin:"0.5rem 0 0 0"}),a.a.createElement("div",{className:"description"})]}),a.a.createElement(Pe,null)))},xe=t(1422),Se=t(1421),ke=t(1462),Ie=function(){var e=Object(h.h)(),n=C().routeToZoneList;return Object(k.g)(function(){return a.a.createElement(Se.a,null,a.a.createElement(xe.a,{widthGrowIndex:.4,padding:"0"},a.a.createElement(be.a,{color:L.a.greyMiddle,text:l.b._("Back"),onClick:n,disabled:e.isSubmitting})),a.a.createElement(xe.a,{widthGrowIndex:.4,padding:"0"},a.a.createElement(Q.a,{mutationName:"updateZone"},a.a.createElement(ke.a,null,a.a.createElement(ee.Trans,{id:"Save zone"})))))})};function Me(){var e=Object(M.a)(["\n  width: ",";\n  margin-top: ",";\n"]);return Me=function(){return e},e}var Fe=N.c.div(Me(),L.d.ButtonHeight+L.d.DefaultSizeUnit,L.d.Middle),Ne=Object(k.b)(function(e){var n=e.zoneId,t=C().routeToZoneList,r=Object(O.sb)(),i=Object(p.a)(r,1)[0],c=a.a.useCallback(Object(b.a)(m.a.mark(function e(){return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=3;break}return e.next=3,i({zoneId:n});case 3:t();case 4:case"end":return e.stop()}},e)})),[i,t,n]),o=Object(h.h)(),u=Object(h.f)("type").value;return a.a.createElement(Y.a,{padding:0},a.a.createElement(Ie,null),a.a.createElement(Re,{type:u}),a.a.createElement(Q.a,{mutationName:"destroyZone"},a.a.createElement(Fe,null,a.a.createElement($.a,{disabled:o.isSubmitting,confirmText:l.b._("Remove zone {0}?",{0:o.values.name}),onDelete:c}))),a.a.createElement(K.b,{when:o.isDirty},function(e){var n=e.isShow,t=e.handleOk,r=e.handleCancel;return a.a.createElement(X.a,{isShow:n,confirmText:l.b._("Do you want to cancel changes for the zone?"),onConfirm:t,onCancel:r})}))}),Be=Object(k.b)(function(e){var n=e.children;return Object(P.b)().user.hasSingleBranch?null:n}),Le=t(1428),De=N.c.p.withConfig({displayName:"StyledZoneListSection",componentId:"sc-1tw7uij-0"})(["color:",";"],L.a.greyMiddle),Te=function(e){return e.type===O.r.Return?a.a.createElement(De,null,a.a.createElement(ee.Trans,{id:"Notification will be shown when driver enters one of these zones."})):null},Ae=Object(k.b)(function(e){var n,t,r=e.type,i=G(),c=C().routeToZoneEdit,o=Object(O.rb)(),u=Object(p.a)(o,1)[0],d=Object(E.a)().enqueueSuccess,f=a.a.useState(!1),g=Object(p.a)(f,2),h=g[0],v=g[1],y=function(){var e=Object(b.a)(m.a.mark(function e(){var n;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i.branch){e.next=2;break}return e.abrupt("return");case 2:return v(!0),e.next=5,u({type:r,branchId:i.branch.id,points:Object(B.a)({center:i.branch.gps,metersRadius:1e3,pointsCount:5})});case 5:(n=e.sent)&&(d(l.b._("Zone has been created")),c(n.createZone.id));case 7:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),j=(n={},Object(s.a)(n,O.r.Area,l.b._("Create delivery zone for branch")),Object(s.a)(n,O.r.Return,l.b._("Create return zone for branch")),n),w=(t={},Object(s.a)(t,O.r.Area,L.a.turquoise),Object(s.a)(t,O.r.Return,L.a.greyMiddle),t),P=i.hasBranchFilter?j[r]:l.b._("Select branch to create zone");return a.a.createElement(be.a,{text:P,onClick:y,disabled:h||!i.hasBranchFilter,color:w[r],height:L.d.ButtonHeight+L.d.DefaultSizeUnit,textNextToIcon:!0,icon:me.a})}),_e=t(1590),Ze=t(1488),Ve=t(1772),qe=t(129),We=t.n(qe),He=t(1498),Ge=t(1548),Ue=t(303);function Je(){var e=Object(M.a)(["\n  height: ",";\n"]);return Je=function(){return e},e}function Ke(){var e=Object(M.a)(["\n  font-size: 0.875rem;\n"]);return Ke=function(){return e},e}function Qe(){var e=Object(M.a)(["\n  font-size: 1.125rem;\n  margin-top: 0.2rem;\n"]);return Qe=function(){return e},e}function Ye(){var e=Object(M.a)(["\n  background: ",";\n"]);return Ye=function(){return e},e}var Xe=Object(N.c)(Y.a)(Ye(),function(e){var n=e.color;if(e.type===O.r.Area)return"";var t=We()(n).alpha(.8).darken(.2),r=t.lighten(.4);return"repeating-linear-gradient(135deg, ".concat(t,", ").concat(t," 10px, ").concat(r," 10px, ").concat(r," 20px)")});var $e=N.c.div(Qe()),en=N.c.div(Ke()),nn=Object(N.c)(Se.a)(Je(),L.d.ButtonHeight+L.d.DefaultSizeUnit),tn=Object(He.b)(function(e){var n=e.zone,t=e.branch,r=e.type,i=e.onEdit;return a.a.createElement(Xe,{key:n.id,type:r,padding:0,color:n.enabled?n.zoneColor.color:L.a.greyMiddle,onClick:i},a.a.createElement(nn,null,a.a.createElement(xe.a,{fixedWidth:!0,padding:"0 0.5rem 0 0"},a.a.createElement(Ue.a,null,a.a.createElement(be.a,{icon:Ve.a}))),a.a.createElement(xe.a,{widthGrowIndex:1},a.a.createElement($e,null,n.name," [P".concat(n.priority,"]")),a.a.createElement(en,null,t.name)),a.a.createElement(xe.a,{padding:"0"},a.a.createElement(Ge.a,null))))}),rn=N.c.div.withConfig({displayName:"ZoneListContainerStyled",componentId:"sc-1j9qfbo-0"})(["margin-top:0.5rem;cursor:arrow;"]),an=Object(He.a)(rn),cn=function(e){e.type;var n=e.onSort,t=e.children;return a.a.createElement(an,{onSortEnd:n,useDragHandle:!0,lockAxis:"y",lockToContainerEdges:!0},t)},on=g.RM.sortWith([g.RM.ascend(g.RM.path(["companyBranch","name"])),g.RM.descend(g.RM.prop("priority"))]),ln=g.RM.groupBy(function(e){return e.companyBranch.id}),un=g.RM.pathEq(["zoneType","enum"]);var dn=Object(k.b)(function(e){var n=e.type,t=G(),i=C().routeToZoneEdit,c=function(e){var n=U(),t=n.zones,r=n.loading,i=a.a.useMemo(function(){return t?g.RM.mapObjIndexed(on,ln(t.filter(un(e)))):null},[e,t]),c=Object(O.ub)(),o=Object(p.a)(c,1)[0],l=a.a.useCallback(function(e){var n=e.oldIndex,t=e.newIndex,r=e.collection;if(i){var a=i[r][n],c=n-t;o({zoneId:a.id,offset:c},{optimisticResponse:{__typename:"Mutation",updateZonePriority:[{__typename:"Zone",id:a.id,priority:a.priority+c}]}})}},[i,o]);return{isLoading:r,zonesByBranch:i,onZoneSort:l}}(n),o=c.isLoading,l=c.zonesByBranch,u=c.onZoneSort;if(null===o)return a.a.createElement(_e.a,{primaryOpacity:.2,secondaryOpacity:.2});if(null===l)return a.a.createElement(Ze.a,null,a.a.createElement(ee.Trans,{id:"Select brand to see its zones"}));var d=t.root.user.filterBranches(t.branchFilterPredicate),s=function(e,t){return a.a.createElement(tn,{key:e.id,type:n,zone:e,branch:d.find(Object(g.idPropEq)(e.companyBranch.id)),onEdit:function(){return i(e.id)},index:t,collection:e.companyBranch.id})};return a.a.createElement(cn,{type:n,onSort:u},d.map(function(e){var n=l[e.id];return n?function(e,n){return a.a.createElement(r.Fragment,{key:e.id},a.a.createElement(Ze.a,null,e.name),n.map(s))}(e,n):null}))}),sn=t(14),fn=t(1430),mn=t(71),bn=t(1450),pn=t(1591),gn=Object(k.b)(function(){var e=Object(P.b)(),n=e.user,t=e.zone,r=n.branches,i=a.a.useCallback(function(e){return null===e?[]:n.branches.filter(mn.a.pathEq(["brand","id"],e.id))},[n.branches]);if(a.a.useEffect(function(){return Object(sn.autorun)(function(){1===r.length&&t.setBranchFilter(mn.a.head(r))})},[r,t]),r.length<=1)return null;var c=1===n.brands.length?mn.a.head(n.brands):null;return c&&t.setBrandFilter(c,i(t.brand)),a.a.createElement(a.a.Fragment,null,!c&&a.a.createElement(pn.a,{selectedBrand:t.brand,onSelection:function(e){null===e?t.clearBrandFilter():t.setBrandFilter(e,i(e))}}),!c&&a.a.createElement(fn.a,null),a.a.createElement(bn.a,{branches:i(t.brand),selectedBranch:t.branch,autoFocus:Boolean(c),formatOptionLabel:mn.a.prop("name"),isClearable:!0,onSingleSelection:function(e){e?t.setBranchFilter(e):t.clearBranchFilter()}}))});function hn(){var e=Object(M.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n\n  & div.header {\n    flex: 0 0 auto;\n  }\n\n  & div.zone-list {\n    flex: 1 1 0;\n  }\n\n  & h3 {\n    margin-top: 6rem;\n  }\n"]);return hn=function(){return e},e}var vn=N.c.div(hn()),On=a.a.memo(function(){var e=G();return Object(Le.a)(function(n){e.setBranchFilter(n)}),Object(k.g)(function(){return a.a.createElement(vn,null,a.a.createElement("div",{className:"header"},a.a.createElement(Be,null,a.a.createElement(Y.a,null,a.a.createElement(gn,null)))),a.a.createElement("div",{className:"zone-list"},e.zoneTypes.map(function(e,n){return a.a.createElement("div",{className:"list".concat(n)},e===O.r.Return&&a.a.createElement("h3",null,a.a.createElement(ee.Trans,{id:"Service zones"})),a.a.createElement(Q.a,{mutationName:"createZone"},a.a.createElement(Ae,{type:e})),a.a.createElement(Te,{type:e}),a.a.createElement(dn,{type:e}))})))})}),yn=function(e){var n=e.match.params.zoneId||null,t=Boolean(n);return a.a.createElement(d.a,{pageTitle:l.b._("Delivery zones"),backRoute:o.a,useBackButton:!0},a.a.createElement(R,{zoneId:n},a.a.createElement(u.a,{widthInColumns:6,column:10,rowInMobile:2,withScrollArea:!0},t?a.a.createElement(Ne,{zoneId:n}):a.a.createElement(On,null)),a.a.createElement(u.a,{widthInColumns:10,rowInMobile:1,forcePercentHeightInMobile:60},a.a.createElement(J,{zoneId:n}))))};t.d(n,"ZonesRouting",function(){return jn});var jn=function(){return a.a.createElement(i.e,null,a.a.createElement(i.c,{path:"".concat(o.f,"/:zoneId?"),component:yn}),a.a.createElement(i.c,{component:c.a}))};n.default=jn}}]);
//# sourceMappingURL=184.4871f2d3.chunk.js.map