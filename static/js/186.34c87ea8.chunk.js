(window.webpackJsonpspeedlo=window.webpackJsonpspeedlo||[]).push([[186],{1449:function(e,n,t){"use strict";t.d(n,"a",function(){return l});var r=t(59),a=t(0),o=t.n(a),i=t(1447),c=t(1455),l=Object(r.observer)(function(e){var n=e.mutationName,t=e.children;return Object(i.b)(n)?o.a.createElement(o.a.Fragment,null,t):o.a.createElement(c.a,null,"No access to mutation ".concat(n))})},1457:function(e,n,t){"use strict";t.d(n,"a",function(){return b});var r=t(4),a=t(24),o=t(0),i=t.n(o),c=t(53),l=t(1496),u=t(133),d=t(19);function f(){var e=Object(r.a)(["\n    margin: 0;\n    grid-row: "," ;\n    grid-column: span 16;\n    height: "," ;\n    position: relative;\n  "]);return f=function(){return e},e}function s(){var e=Object(r.a)(["\n  position: fixed;\n  bottom: 0.5rem;\n  width: ",";\n  left: ",";\n  top: ",";"]);return s=function(){return e},e}var m=a.default.div.withConfig({displayName:"StyledPageLayoutFullHeightItem",componentId:"sc-1mean6j-0"})([""," ",""],Object(c.c)(s(),function(e){return void 0!==e.widthInColumns?"calc(("+e.widthInColumns+" * 6.22vw) - "+d.d.LayoutGridCellMargin+")":"calc(100vh - (2 * "+d.d.LayoutGridCellMargin+"))"},function(e){return void 0!==e.column?"calc(("+e.column+" * 6.22vw) + "+d.d.LayoutGridCellMargin+")":d.d.LayoutGridCellMargin},function(e){return void 0!==e.row?"calc(("+e.row+" * 3.9375rem) + "+d.d.LayoutGridCellMargin+")":"calc(3.9375rem + "+d.d.LayoutGridCellMargin+")"}),Object(c.d)(f(),function(e){return e.rowInMobile},function(e){var n=e.forcePercentHeightInMobile;return n?"calc(".concat(n,"vh - ").concat(d.d.PageHeaderHeight+.25+d.d.DefaultSizeUnit,")"):"unset"})),b=function(e){var n=e.children,t=e.row,r=void 0===t?1:t,a=e.rowInMobile,o=void 0===a?16:a,d=e.column,f=void 0===d?0:d,s=e.widthInColumns,b=void 0===s?16:s,v=e.withScrollArea,h=void 0!==v&&v,p=e.scrollAreaId,g=e.forcePercentHeightInMobile,E=Object(c.f)().isMobile;return i.a.createElement(m,{column:f,row:r,rowInMobile:o,widthInColumns:b,withScrollArea:h,forcePercentHeightInMobile:g},h&&!E?i.a.createElement(l.a,{id:p},n):i.a.createElement(u.a,{height:100,heightUnit:"%"},n))}},1459:function(e,n,t){"use strict";t.d(n,"a",function(){return o});var r=t(4);function a(){var e=Object(r.a)(["\n  display: flex;\n  flex-direction: row;\n  flex-wrap: ",";\n  justify-content: ",";\n"]);return a=function(){return e},e}var o=t(24).default.div(a(),function(e){var n=e.flexWrap;return void 0===n?"unset":n},function(e){var n=e.justify;return void 0===n?"space-between":n})},1460:function(e,n,t){"use strict";t.d(n,"a",function(){return o});var r=t(4);function a(){var e=Object(r.a)(["\n  flex: ",";\n  padding: ",";\n  margin: ",";\n"]);return a=function(){return e},e}var o=t(24).default.div(a(),function(e){var n=e.fixedWidth,t=void 0!==n&&n,r=e.width,a=e.widthGrowIndex,o=void 0===a?0:a;return t?r?"0 0 ".concat(r):"0 0":"".concat(o," 0")},function(e){var n=e.padding;return void 0===n?"0.25rem":n},function(e){var n=e.margin;return void 0===n?"":n})},1488:function(e,n,t){"use strict";t.d(n,"a",function(){return o});var r=t(4);function a(){var e=Object(r.a)(["\n  height: ",";\n"]);return a=function(){return e},e}var o=t(24).default.div(a(),function(e){var n=e.size,t=void 0===n?1:n,r=e.sizeUnit,a=void 0===r?"rem":r;return"".concat(t).concat(a)});o.displayName="VerticalGap"},1496:function(e,n,t){"use strict";t.d(n,"a",function(){return o});var r=t(4);function a(){var e=Object(r.a)(["\n  overflow-y: auto;\n  -webkit-overflow-scrolling: touch;\n  height: 100%;\n"]);return a=function(){return e},e}var o=t(24).default.div(a())},1516:function(e,n,t){"use strict";t.d(n,"a",function(){return d});var r=t(62),a=t(1803),o=t(0),i=t.n(o),c=t(319),l=t(19),u=t(132),d=function(e){var n=e.onDelete,t=e.confirmText,o=Object(r.a)(e,["onDelete","confirmText"]);return i.a.createElement(c.a,null,i.a.createElement(u.a,Object.assign({icon:a.a,color:l.a.greyMiddle,onClick:function(e){e.preventDefault(),t&&!window.confirm(t)||n()}},o)))}},1526:function(e,n,t){"use strict";t.d(n,"a",function(){return o}),t.d(n,"c",function(){return i}),t.d(n,"b",function(){return c});var r=t(1520),a=t(41);function o(e){return!e.errors||0===Object.keys(e.errors).length}function i(e){return function(n){return Object(r.isEmpty)(n+"")?a.b._("{fieldName} must be entered",{fieldName:e}):null}}function c(e){return"number"===typeof e?e:Number.parseFloat(e.replace(",","."))}},1555:function(e,n,t){"use strict";t.d(n,"a",function(){return m}),t.d(n,"b",function(){return b});var r=t(95),a=t(1519),o=t(67),i=t(59),c=t(0),l=t.n(c),u=t(64),d=t(19),f=t(55),s=(l.a.createContext(null),["places"]),m=function(e){var n=e.model,t=e.children,c={streetViewControl:!1,mapTypeControl:!1,fullscreenControl:!1},m=Object(f.b)().user,b=Object(a.e)({id:"script-loader",version:"weekly",googleMapsApiKey:u.a.googleMapsApi,libraries:s,language:m.language}),v=b.isLoaded,h=b.loadError,p=b.url,g=Reflect.has(window,"google");return h||v&&!g?(o.Sentry.withScope(function(e){e.setExtras({googleMapUrl:p}),o.Sentry.captureException(h)}),l.a.createElement("h2",null,l.a.createElement(r.Trans,{id:"Cannot load map right now. Please try again later."}))):v?l.a.createElement(i.Observer,null,function(){return l.a.createElement(a.a,{zoom:n.zoom,center:n.center,onCenterChanged:n.updatePosition,onZoomChanged:n.updateZoom,onLoad:n.setMapRef,options:c,mapContainerStyle:{borderRadius:d.c.Card,overflow:"hidden",height:"100%"}},t)}):null};function b(){var e=Object(a.d)();if(!e)throw new Error("Trying to useGoogleMap, but BaseMap is missing in the tree");return e}},1619:function(e,n,t){"use strict";t.d(n,"a",function(){return c});var r=t(4),a=t(24),o=t(19);function i(){var e=Object(r.a)(["\n  color: ",";\n  font-weight: lighter;\n  font-size: 1.2rem;\n  margin: 0.8rem 0 0.8rem 0.3rem;\n"]);return i=function(){return e},e}var c=a.default.h2(i(),o.a.greyLight)},1623:function(e,n,t){"use strict";t.d(n,"a",function(){return s});var r=t(4),a=t(2834),o=t(0),i=t.n(o),c=t(1559),l=t(24),u=t(173);function d(){var e=Object(r.a)(["\n  padding: 1rem 0.4rem;\n  cursor: grab;\n"]);return d=function(){return e},e}var f=l.default.div(d()),s=Object(c.SortableHandle)(function(){return i.a.createElement(f,null,i.a.createElement(u.a,{icon:a.a}))})},1632:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(0),a=function(e){var n=e.isShow,t=e.confirmText,a=e.onCancel,o=e.onConfirm;return Object(r.useEffect)(function(){n&&(window.confirm(t)?o():a())},[t,n,a,o]),null}},1777:function(e,n,t){"use strict";t.d(n,"a",function(){return d});var r=t(62),a=t(51),o=t(0),i=t.n(o),c=t(55),l=t(1450),u=t(41),d=function(e){var n=e.brands,t=e.selectedBrand,o=e.onSelection,d=Object(r.a)(e,["brands","selectedBrand","onSelection"]),f=Object(c.b)().user;return i.a.createElement(l.a,Object.assign({placeholder:u.b._("Select brand"),options:n||f.brands,value:t,formatOptionLabel:a.RM.prop("name"),getOptionValue:a.RM.prop("id"),getOptionLabel:a.RM.prop("name"),isClearable:!0,isSearchable:!0,onChange:function(e){return o(e)},autoFocus:!0},d))}},2838:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),o=t(72),i=t(197),c=t(320),l=t(41),u=t(1457),d=t(324),f=t(33),s=t.n(f),m=t(74),b=t(80),v=t(4),h=t(52),p=t(1452),g=t(347),E=t(24),O=t(1449),j=t(193),y=t(1632),w=t(325),C=t(55),k=t(65),x=t(46),z=t(38),I=t(195),P=t(1516),S=t(19);function B(){return Object(h.useRouterContext)().match.params.zoneId}function F(){var e=Object(C.b)(),n=e.user,t=e.zone,r=Object(h.useRouterContext)().history,o=a.a.useCallback(function(e){return"".concat(c.f,"/").concat(e)},[]);return{getRouteToZone:o,routeToZoneEdit:a.a.useCallback(function(e){t.map.panToZone(e),n.canQuery("zone")&&r.push(o(e))},[o,r,n,t.map]),routeToZoneList:a.a.useCallback(function(){r.push(c.f)},[r])}}var M=t(95),Z=t(2832),R=t(2833),L=t(62),T=t(1609),A=function(e){var n=e.field,t=e.label,r=e.defaultValue,o=(e.children,Object(L.a)(e,["field","label","defaultValue","children"]));return a.a.createElement(T.a,null,a.a.createElement(p.Checkbox,Object.assign({field:n,checked:Boolean(r)},o)),t&&a.a.createElement("label",null,t))},D=t(1499),_=t(1456),N=t(1444),V=t(1526);function G(){var e=Object(v.a)(["\n  border-left: 3px solid #707070;\n  width: 3px;\n  position: relative;\n  left: -2rem;\n  height: 4rem;\n  float: left;\n  margin: -0.5rem 0 0 0;\n"]);return G=function(){return e},e}function H(){var e=Object(v.a)(["\n  position: relative;\n  left: 4rem;\n  top: -0.3rem;\n  width: 3rem;\n"]);return H=function(){return e},e}function U(){var e=Object(v.a)(["\n  position: relative;\n  left: 8rem;\n  top: 0rem;\n"]);return U=function(){return e},e}function q(){var e=Object(v.a)(["\n  color: ",";\n"]);return q=function(){return e},e}function W(){var e=Object(v.a)(["\n  width: 3rem;\n  position: relative;\n  z-index: 4;\n"]);return W=function(){return e},e}function J(){var e=Object(v.a)(["\n  min-width: 2rem;\n  display: inline-block;\n"]);return J=function(){return e},e}var K=E.default.div(J()),$=Object(E.default)(D.a)(W()),Q=Object(E.default)($)(q(),S.a.blue),Y=E.default.div(U()),X=E.default.div(H()),ee=E.default.div(G()),ne=function(e){if("number"===typeof e)return null;var n=e.trim();return n.length&&Number.isNaN(Number.parseFloat(n))?l.b._("Must be number"):null},te=a.a.forwardRef(function(e,n){var t=e.field,r=e.label,o=e.isDeliveryPrice,i=e.autoFocus,c=void 0!==i&&i;return o?a.a.createElement(Y,null,a.a.createElement(ee,null),a.a.createElement(K,null,r),a.a.createElement(Q,{field:t,validate:ne,ref:n})):a.a.createElement(X,null,a.a.createElement($,{field:t,validate:ne,autoFocus:c}))}),re=t(134),ae=t(87),oe=t(63),ie=t(70),ce=t(85),le=t(83),ue=t(84),de=t(1450),fe=function(e){function n(){var e,t;Object(oe.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(t=Object(ce.a)(this,(e=Object(le.a)(n)).call.apply(e,[this].concat(a)))).validate=function(e){return t.props.isRequired&&!e?l.b._("{0} must be selected",{0:t.props.validatioName}):null},t}return Object(ue.a)(n,e),Object(ie.a)(n,[{key:"getControlProps",value:function(e){var n=this.props,t=n.isMulti,r=n.options,a=n.getOptionValue,o=n.defaultValue,i=e.value||o;if(t){var c=Array.isArray(i)?function(e){return i.includes(a(e))}:z.a.F;return{value:Array.isArray(r)?r.filter(c):[],onChange:function(n){e.setValue(n.map(a))}}}return{value:i&&r.find(function(e){return a(e)===i}),onChange:function(n){e.setValue(a(n))}}}},{key:"render",value:function(){var e=this,n=this.props,t=n.field,r=n.fieldIsPure,o=void 0!==r&&r,i=(n.defaultValue,Object(L.a)(n,["field","fieldIsPure","defaultValue"]));return a.a.createElement(p.Field,{field:t,validate:this.validate,pure:o},function(n){return a.a.createElement(de.a,Object.assign({},e.getControlProps(n),{onFocus:function(){return n.setTouched(!0)},styles:{control:function(e){return Boolean(n.error)?Object(ae.a)({},e,{borderColor:"red"}):e}}},i))})}}]),n}(a.a.Component);fe.defaultProps={validatioName:"Value",getItemId:z.a.prop("id")};var se=t(343),me=t(491);function be(){var e=Object(v.a)(["\n  background-color: ",";\n  color: ",";\n  width: 6rem;\n  padding: 0.4rem 1rem;\n  margin: 0;\n  height: 100%;\n"]);return be=function(){return e},e}var ve=E.default.div(be(),function(e){return e.color},S.a.white),he=Object(se.a)(me.a),pe=function(e){var n=e.field,t=void 0===n?"zoneColor.id":n;return a.a.createElement(he,{render:function(e){var n=e.zoneColors;return a.a.createElement(fe,{field:t,fieldIsPure:!0,options:Object(re.a)(n),width:8,styles:{option:function(e){return Object(ae.a)({},e,{padding:0,margin:0})},menu:function(e){return Object(ae.a)({},e,{width:"8rem",maxWidth:"8rem"})}},defaultValue:z.a.head(n),getOptionValue:z.a.prop("id"),formatOptionLabel:function(e){return a.a.createElement(ve,{color:e.color},e.code)}})}})},ge=t(1631),Ee=t(132),Oe=t(1451);function je(){var e=Object(v.a)(["\n  margin: 0 0 0 1rem;\n"]);return je=function(){return e},e}function ye(){var e=Object(v.a)(["\n  width: 3rem;\n  position: relative;\n  z-index: 4;\n"]);return ye=function(){return e},e}function we(){var e=Object(v.a)(["\n  width: 3rem;\n  display: inline-block;\n"]);return we=function(){return e},e}var Ce=E.default.div(we()),ke=Object(E.default)(Oe.a)(ye()),xe=E.default.div(je()),ze=function(e){var n=e.label,t=e.display;return a.a.createElement(xe,null,a.a.createElement(Ce,null,n),a.a.createElement(ke,{disabled:!0,placeholder:t}))};function Ie(){var e=Object(v.a)(["\n  position: relative;\n  top: -7rem;\n  left: 16rem;\n  height: 0;\n"]);return Ie=function(){return e},e}function Pe(){var e=Object(v.a)(["\n  position: relative;\n  top: -6rem;\n"]);return Pe=function(){return e},e}var Se=E.default.div(Pe()),Be=E.default.div(Ie()),Fe=function(e){var n=e.fieldApi;return a.a.createElement(a.a.Fragment,null,n.values.map(function(e,t,o){return a.a.createElement(r.Fragment,{key:t},a.a.createElement(te,{label:"za",isDeliveryPrice:!0,field:[t,"price","value"]}),t===o.length-1?a.a.createElement(ze,{display:"\u221e",label:"do"}):a.a.createElement(te,{field:[t,"toPrice","value"],autoFocus:!0}),o.length>1&&a.a.createElement(Be,null,a.a.createElement(P.a,{onDelete:function(){return n.removeValue("",t)}})))}),a.a.createElement(p.FormApi,{render:function(e){return a.a.createElement(Se,null,a.a.createElement(Ee.a,{disabled:e.submitting,width:S.d.ButtonHeight+S.d.DefaultSizeUnit,icon:ge.a,onClick:function(){return n.addValue("",{price:{value:0},toPrice:{value:0}})}}))}}))};function Me(){var e=Object(v.a)(["\n  color: ",";\n  padding-bottom: 0.2rem;\n"]);return Me=function(){return e},e}function Ze(){var e=Object(v.a)(["\n  margin: ",";\n  color: ",";\n"]);return Ze=function(){return e},e}var Re=E.default.div(Ze(),S.d.Middle,S.a.black),Le=E.default.div(Me(),S.a.greyDark),Te=function(e){return a.a.createElement(Re,null,a.a.createElement(N.a,{icon:Z.a},a.a.createElement(D.a,{field:"name",validate:Object(V.c)(l.b._("Zone name"))})),a.a.createElement(N.a,{icon:R.a},a.a.createElement(pe,null)),a.a.createElement(A,{field:"enabled",name:"enabled",label:l.b._("Is active").toLocaleLowerCase()}),a.a.createElement(M.Trans,{id:"<0>Delivery cost</0><1>according order total cost</1>",components:[a.a.createElement(_.a,{margin:"0.5rem 0 0 0"}),a.a.createElement(Le,null)]}),a.a.createElement(te,{field:"minimalOrderPrice.value"}),a.a.createElement(p.NestedField,{field:"priceRangeRules",component:Fe}))},Ae=t(1460),De=t(1459),_e=function(e){var n=e.isSubmitting,t=e.isModified,r=e.onGoBack,o=e.onSave;return a.a.createElement(De.a,null,a.a.createElement(Ae.a,{widthGrowIndex:.4,padding:"0"},a.a.createElement(Ee.a,{color:S.a.greyMiddle,onClick:r,text:l.b._("Back"),disabled:n})),a.a.createElement(Ae.a,{widthGrowIndex:.4,padding:"0"},a.a.createElement(O.a,{mutationName:"updateZone"},a.a.createElement(Ee.a,{color:S.a.green,text:l.b._("Save zone"),onClick:o,disabled:n||!t}))))},Ne=t(59),Ve=t(7);function Ge(){var e=Object(v.a)(["\n  query GZones($branchesId: [ID!]!) {\n    zones(companyBranches: $branchesId) {\n      ...FZone\n    }\n  }\n  ","\n"]);return Ge=function(){return e},e}var He=t.n(Ve)()(Ge(),k.d),Ue=Object(se.a)(He),qe=a.a.createContext(null),We=Object(Ne.observer)(function(e){var n=e.children,t=Object(C.b)().zone,r=t.branches.filter(t.branchFilterPredicate);return 0===r.length?a.a.createElement(qe.Provider,{value:[]},n):a.a.createElement(Ue,{fetchPolicy:"cache-and-network",variables:{branchesId:r.map(z.a.prop("id"))},renderLoading:!1,render:function(e,t){var r=e.zones,o=t.loading;return a.a.createElement(qe.Provider,{value:o?null:r},n)}})}),Je=function(){return Object(r.useContext)(qe)};function Ke(){var e=Object(v.a)(["\n  width: ",";\n  margin-top: ",";\n"]);return Ke=function(){return e},e}var $e=E.default.div(Ke(),S.d.ButtonHeight+S.d.DefaultSizeUnit,S.d.Middle),Qe=function(){var e=B(),n=Je(),t=Object(C.b)().zone,o=F().routeToZoneList,i=Object(r.useState)(!1),c=Object(b.a)(i,2),u=c[0],d=c[1],f=Object(r.useRef)(null),v=Object(I.a)(),E=v.enqueueError,S=v.enqueueSuccess,M=Object(k.kb)(),Z=Object(b.a)(M,1)[0],R=Object(r.useCallback)(function(){var n=Object(m.a)(s.a.mark(function n(r){return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e){n.next=5;break}return n.next=3,Z(t.getZoneVariables(e,r));case 3:n.sent&&(d(!1),o(),S(l.b._("Zone has been updated")));case 5:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}(),[S,o,e,t,Z]),L=Object(r.useCallback)(Object(m.a)(s.a.mark(function n(){return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e){n.next=3;break}return n.next=3,t.destroyZone(e);case 3:o();case 4:case"end":return n.stop()}},n)})),[o,e,t]);Object(h.useReaction)(function(){return null!==t.map.currentZonePoints},d),a.a.useEffect(function(){n&&0===n.length&&(E(l.b._("Requested zone wasn't found")),o())},[E,o,n]);var T=e&&n&&n.find(z.a.propEq("id",e))||null;return a.a.useEffect(function(){t.map.clearZonePoints()},[T,t.map]),T?a.a.createElement(p.Form,{defaultValues:T,onChange:function(e){Object(x.b)("zone form change",e.values),d(!0)},onSubmit:R,render:function(e){return f.current=e,a.a.createElement(j.a,{padding:0},a.a.createElement(_e,{isSubmitting:e.submitting,isModified:u,onSave:e.submitForm,onGoBack:o}),a.a.createElement(Te,null),a.a.createElement(O.a,{mutationName:"destroyZone"},a.a.createElement($e,null,a.a.createElement(P.a,{disabled:e.submitting,confirmText:l.b._("Remove zone {0}?",{0:T.name}),onDelete:L}))),a.a.createElement(g.b,{when:u},function(e){var n=e.isShow,t=e.handleOk,r=e.handleCancel;return a.a.createElement(y.a,{isShow:n,confirmText:l.b._("Do you want to cancel changes for the zone?"),onConfirm:t,onCancel:r})}))}}):a.a.createElement(w.a,{text:l.b._("Loading form...")})},Ye=t(20),Xe=t(1555),en=t(1519),nn=t(111);function tn(){var e=Object(v.a)(["\n    background-color: ",";\n    color: ",";\n  "]);return tn=function(){return e},e}function rn(){var e=Object(v.a)(["\n  "," font-size: 1.3rem;\n  white-space: nowrap;\n  padding: 0.2rem 0.5rem;\n"]);return rn=function(){return e},e}var an=E.default.div(rn(),function(e){var n=e.isActive;return Object(E.css)(tn(),n?S.a.green:S.a.greyLight,n?S.a.white:S.a.greyDark)}),on=function(e){var n=e.branch,t=e.isActive,r=void 0===t||t;return a.a.createElement(en.b,{getPixelPositionOffset:function(e,n){return{x:-e/2,y:-n/2}},mapPaneName:en.b.MARKER_LAYER,position:Object(nn.b)(n.gps)},a.a.createElement(an,{isActive:r},n.name))};var cn=function(e){var n=e.points,t=e.color,r=e.priority,o=e.onFocus,i=a.a.useCallback(function(e){o&&(e.stop(),o())},[o]);return a.a.createElement(en.c,{path:n.map(nn.b),options:{fillColor:t,fillOpacity:.3,strokeWeight:0,zIndex:5e3-r},editable:!1,draggable:!1,onDblClick:i})},ln=function(e){var n=e.onChange,t=e.onClear,r=e.points,o=e.color,i=a.a.useRef(null),c=a.a.useRef([]),l=a.a.useCallback(function(){if(i.current){var e=i.current.getPath();n(e.getArray().map(nn.d))}},[n]),u=a.a.useCallback(function(e){i.current=e;var n=e.getPath();c.current.push(n.addListener("set_at",l),n.addListener("insert_at",l),n.addListener("remove_at",l))},[l]),d=a.a.useCallback(function(){t(),c.current.forEach(function(e){return e.remove()}),i.current=null},[t]);return a.a.createElement(en.c,{path:r.map(nn.b),options:{fillColor:o,fillOpacity:.6,strokeWeight:2,zIndex:1e4},editable:!0,draggable:!0,onDragEnd:l,onLoad:u,onUnmount:d})};function un(){return Object(C.b)().zone}var dn=function(){var e=un(),n=B(),t=Je(),o=F().routeToZoneEdit,i=e.branches.filter(e.branchFilterPredicate),c=a.a.useCallback(function(n){return!e.hasBranchFilter||n===e.branchFilterId},[e]);a.a.useEffect(function(){return Object(Ye.autorun)(function(){e.branch&&e.map.isReady&&e.map.panToBranch(e.branch)})},[e]);var l=Object(r.useCallback)(function(e){return a.a.createElement(on,{key:"branch".concat(e.id),branch:e,isActive:c(e.id)})},[c]);return a.a.createElement(Xe.a,{model:e.map},t&&t.map(function(t){var r={key:"zone".concat(t.id),points:t.geoPolygon,priority:t.priority,color:c(t.companyBranch.id)&&t.enabled?t.zoneColor.color:S.a.greyMiddle};return t.id===n?a.a.createElement(ln,Object.assign({},r,{onChange:e.map.updateZonePoints,onClear:e.map.clearZonePoints})):a.a.createElement(cn,Object.assign({},r,{onFocus:function(){c(t.companyBranch.id)&&o(t.id)}}))}),i&&i.map(l))},fn=t(1496),sn=Object(Ne.observer)(function(e){var n=e.children;return Object(C.b)().user.hasSingleBranch?null:n}),mn=t(1467),bn=Object(Ne.observer)(function(){var e=un(),n=F().routeToZoneEdit;return a.a.createElement(Ee.a,{text:e.hasBranchFilter?l.b._("Create zone for branch"):l.b._("Select branch to create zone"),onClick:function(){return e.createZone(n)},disabled:!e.hasBranchFilter,color:S.a.turquoise,textNextToIcon:!0,height:S.d.ButtonHeight+S.d.DefaultSizeUnit,icon:ge.a})}),vn=t(1776),hn=t(1619),pn=t(462),gn=t(455),En=t(92),On=t(456),jn=t(163),yn=t(457),wn=t(461),Cn=t(458),kn=t(1559),xn=t(1909),zn=t(1623),In=t(319);function Pn(){var e=Object(v.a)(["\n  height: ",";\n"]);return Pn=function(){return e},e}function Sn(){var e=Object(v.a)(["\n  font-size: 0.875rem;\n"]);return Sn=function(){return e},e}function Bn(){var e=Object(v.a)(["\n  font-size: 1.125rem;\n  margin-top: 0.2rem;\n"]);return Bn=function(){return e},e}var Fn=E.default.div(Bn()),Mn=E.default.div(Sn()),Zn=Object(E.default)(De.a)(Pn(),S.d.ButtonHeight+S.d.DefaultSizeUnit),Rn=Object(kn.SortableElement)(function(e){var n=e.zone,t=e.branch,r=e.onEdit;return a.a.createElement(j.a,{key:n.id,padding:0,color:n.enabled?n.zoneColor.color:S.a.greyMiddle,onClick:r},a.a.createElement(Zn,null,a.a.createElement(Ae.a,{fixedWidth:!0,padding:"0 0.5rem 0 0"},a.a.createElement(In.a,null,a.a.createElement(Ee.a,{icon:xn.a}))),a.a.createElement(Ae.a,{widthGrowIndex:1},a.a.createElement(Fn,null,n.name," [P".concat(n.priority,"]")),a.a.createElement(Mn,null,t.name)),a.a.createElement(Ae.a,{padding:"0"},a.a.createElement(zn.a,null))))});function Ln(){var e=Object(v.a)(["\n  margin-top: 0.5rem;\n  cursor: arrow;\n"]);return Ln=function(){return e},e}var Tn=Object(kn.SortableContainer)(E.default.div(Ln())),An=pn.a([gn.a(En.a(["companyBranch","name"])),On.a(jn.a("priority"))]),Dn=yn.a(function(e){return e.companyBranch.id}),_n=function(e){var n,t,o=e.branches,i=e.zones,c=e.zoneModel,l=e.onZoneEdit,u=function(e,n){return a.a.createElement(Rn,{key:e.id,zone:e,branch:o.find(wn.a("id",e.companyBranch.id)),index:n,collection:e.companyBranch.id,onEdit:function(){return l(e.id)}})};if(1===o.length){var d=An(i);n=d.map(u),t=function(e){var n=e.oldIndex,t=e.newIndex,r=d[n];c.changeZonePriority(r,n,t)}}else{var f=Cn.a(An,Dn(i));n=o.map(function(e){var n=f[e.id];return n?function(e,n){return a.a.createElement(r.Fragment,{key:e.id},a.a.createElement(hn.a,null,e.name),n.map(u))}(e,n):null}),t=function(e){var n=e.oldIndex,t=e.newIndex,r=e.collection,a=f[r][n];c.changeZonePriority(a,n,t)}}return a.a.createElement(Tn,{useDragHandle:!0,lockAxis:"y",onSortEnd:t},n)},Nn=function(){var e=Je(),n=un(),t=F().routeToZoneEdit;return null===e?a.a.createElement(vn.a,{primaryOpacity:.2,secondaryOpacity:.2}):null===n.brand?a.a.createElement(hn.a,null,a.a.createElement(M.Trans,{id:"Select brand to see its zones"})):a.a.createElement(_n,{zoneModel:n,zones:e.filter(n.zoneFilterPredicate),branches:n.root.user.filterBranches(n.branchFilterPredicate),onZoneEdit:t})},Vn=t(1488),Gn=t(1498),Hn=t(1777),Un=Object(Ne.observer)(function(){var e=Object(C.b)(),n=e.user,t=e.zone,r=n.branches,o=a.a.useCallback(function(e){return null===e?[]:n.branches.filter(z.a.pathEq(["brand","id"],e.id))},[n.branches]);if(a.a.useEffect(function(){return Object(Ye.autorun)(function(){1===r.length&&t.setBranchFilter(z.a.head(r))})},[r,t]),r.length<=1)return null;var i=1===n.brands.length?z.a.head(n.brands):null;return i&&t.setBrandFilter(i,o(t.brand)),a.a.createElement(a.a.Fragment,null,!i&&a.a.createElement(Hn.a,{selectedBrand:t.brand,onSelection:function(e){null===e?t.clearBrandFilter():t.setBrandFilter(e,o(e))}}),!i&&a.a.createElement(Vn.a,null),a.a.createElement(Gn.a,{branches:o(t.brand),selectedBranch:t.branch,autoFocus:Boolean(i),formatOptionLabel:z.a.prop("name"),isClearable:!0,onSingleSelection:function(e){e?t.setBranchFilter(e):t.clearBranchFilter()}}))});function qn(){var e=Object(v.a)(["\n  flex: 1 1 0;\n  min-height: 0;\n"]);return qn=function(){return e},e}function Wn(){var e=Object(v.a)(["\n  flex: 0 0 auto;\n"]);return Wn=function(){return e},e}function Jn(){var e=Object(v.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n"]);return Jn=function(){return e},e}var Kn=E.default.div(Jn()),$n=E.default.div(Wn()),Qn=E.default.div(qn()),Yn=a.a.memo(function(){var e=Object(C.b)().zone;return Object(mn.a)(function(n){e.setBranchFilter(n)}),a.a.createElement(Kn,null,a.a.createElement($n,null,a.a.createElement(sn,null,a.a.createElement(j.a,null,a.a.createElement(Un,null))),a.a.createElement(O.a,{mutationName:"createZone"},a.a.createElement(bn,null))),a.a.createElement(Qn,null,a.a.createElement(fn.a,null,a.a.createElement(Nn,null))))}),Xn=function(e){var n=e.match,t=Boolean(n.params.zoneId);return a.a.createElement(We,null,a.a.createElement(d.a,{pageTitle:l.b._("Delivery zones"),backRoute:c.a,useBackButton:!0},a.a.createElement(u.a,{widthInColumns:6,column:10,rowInMobile:2,withScrollArea:t},t?a.a.createElement(Qe,null):a.a.createElement(Yn,null)),a.a.createElement(u.a,{widthInColumns:10,rowInMobile:1,forcePercentHeightInMobile:60},a.a.createElement(dn,null))))};t.d(n,"ZonesRouting",function(){return et});var et=function(){return a.a.createElement(o.Switch,null,a.a.createElement(o.Route,{path:"".concat(c.f,"/:zoneId?"),component:Xn}),a.a.createElement(o.Route,{component:i.a}))};n.default=et}}]);
//# sourceMappingURL=186.34c87ea8.chunk.js.map