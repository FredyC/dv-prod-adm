{"version":3,"sources":["atoms/FormInputStyled.tsx","../node_modules/@speedlo/assets/flags sync /^/.*/.svg$","../node_modules/@speedlo/assets/logos sync /^/logo/-.*/.svg$","atoms/LoginPageBackground.tsx","assets/bg_login.jpg","assets/bg_login@2x.jpg","segments/login/molecules/PasswordPageGrid.tsx","atoms/PasswordInput.tsx","segments/login/organisms/PasswordChangeForm.tsx","segments/login/pages/PasswordChangePage.tsx","segments/login/routes/PasswordChangeRoute.tsx"],"names":["FormInputStyled","styled","input","attrs","invalid","inputFullWidth","className","cn","fullWidth","Spacing","MarginAroundFormComponents","Colors","red","errorBackground","map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","LoginPageBackground","div","backgroundImage","backgroundImage2x","PasswordPageGrid","Middle","Small","PasswordInput","children","useState","password","setPassword","messages","minLen","length","i18n","maxLen","digits","uppercaseChars","getPassword","useCallback","defaultMessages","onChange","props","StyledPasswordChangeForm","PasswordChangeForm","onSubmitChange","buttonLabel","getInputProps","valid","errors","touched","isVisible","toggleShowPassword","name","placeholder","TouchButton","color","greyMiddle","onClick","icon","BlurOff","BlurOn","iconSize","MarginBox","margin","Sizer","width","green","disabled","preventDefault","key","message","PasswordChangePage","onPasswordChange","pageTitle","PageTitle","title","PageLayoutGridItem","gridRow","gridColumn","Display","PasswordChangeRoute","history","location","match","auth","useRoot","useSnackBar","enqueueError","enqueueSuccess","scope","useSentryScope","tempToken","params","token","decodedTempToken","window","atob","setExtras","useMPasswordChange","fetchPolicy","context","overrideWithToken","changePassword","logAuth","to","a","async","result","change","userId","newToken","invalidate","authenticate","Sentry","captureMessage","replace","pathname","includes"],"mappings":"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","file":"static/js/387.9f70959a.chunk.js","sourcesContent":["import { cn } from '@speedlo/ui'\nimport styled from 'styled-components/macro'\n\nimport { Colors, Spacing } from '../styling'\n\ninterface IProps {\n  invalid?: boolean\n  inputFullWidth?: boolean\n}\n\nexport const FormInputStyled = styled.input.attrs<IProps>(\n  ({ invalid = false, inputFullWidth = false }) => ({\n    className: cn({ invalid, fullWidth: inputFullWidth }),\n  }),\n)<IProps>`\n  margin: ${Spacing.MarginAroundFormComponents};\n  &.invalid {\n    border: 1px ${Colors.red} solid;\n    background-color: ${Colors.errorBackground};\n  }\n  &.fullWidth {\n    width: 100%;\n  }\n`\n\n// TODO: Rename all uses in separate commit\nexport { FormInputStyled as StyledFormInput }\n","var map = {\n\t\"./cs.svg\": 1404,\n\t\"./de.svg\": 1405,\n\t\"./en.svg\": 1406,\n\t\"./pl.svg\": 1407,\n\t\"./sk.svg\": 1408\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 1403;","var map = {\n\t\"./logo-doveze.svg\": 1410,\n\t\"./logo-gopay.svg\": 1411,\n\t\"./logo-mastercard.svg\": 1412,\n\t\"./logo-visa.svg\": 1413\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 1409;","import styled from 'styled-components'\n\nimport backgroundImage from '../assets/bg_login.jpg'\nimport backgroundImage2x from '../assets/bg_login@2x.jpg'\n\nexport const LoginPageBackground = styled.div`\n  width: 100vw;\n  height: 100vh;\n  background-image: url(${backgroundImage});\n  background-repeat: no-repeat;\n  background-attachment: fixed;\n  background-size: cover;\n\n  @media only screen and (-webkit-min-device-pixel-ratio: 1.3),\n    only screen and (min--moz-device-pixel-ratio: 1.3),\n    only screen and (-o-min-device-pixel-ratio: 2.6/2),\n    only screen and (min-device-pixel-ratio: 1.3),\n    only screen and (min-width: 1024px) {\n    background-image: url(${backgroundImage2x});\n  }\n`\n","module.exports = __webpack_public_path__ + \"static/media/bg_login.382d98be.jpg\";","module.exports = __webpack_public_path__ + \"static/media/bg_login@2x.35ab1818.jpg\";","import styled from 'styled-components/macro'\n\nimport { Spacing } from '../../../styling'\n\nexport const PasswordPageGrid = styled.div`\n  display: grid;\n  width: 100vw;\n  height: 100vh;\n  grid-gap: ${Spacing.Middle};\n  grid-template-columns: repeat(16, 1fr);\n  grid-template-rows: repeat(7, 3rem);\n  padding: 0 ${Spacing.Small} 0 ${Spacing.Small};\n`\n","import React, { HTMLAttributes, useCallback, useState } from 'react'\nimport PasswordInputComponent from 'react-password-indicator'\n\nimport { i18n } from '../i18n'\n\ninterface IProps {\n  children(props: IRenderProps): ReactNode\n}\n\ninterface IRenderProps {\n  getInputProps(): Partial<HTMLAttributes<HTMLInputElement>>\n  valid: boolean\n  errors: RoA<{ key: string; message: string }>\n  touched: boolean\n  isVisible: boolean\n  toggleShowPassword(): void\n  getPassword(): string\n}\n\nexport const PasswordInput: React.FC<IProps> = ({ children }) => {\n  const [password, setPassword] = useState('')\n  const messages = {\n    minLen: length => i18n.t`Minimal length is ${length}`,\n    maxLen: length => i18n.t`Maximal length is ${length}`,\n    digits: i18n.t`Requires at least one digit`,\n    uppercaseChars: i18n.t`Requires at least one uppercase character`,\n  }\n  const getPassword = useCallback(() => password, [password])\n  return (\n    <PasswordInputComponent\n      minLen={6}\n      maxLen={30}\n      digits={1}\n      uppercaseChars={1}\n      defaultMessages={messages}\n      onChange={setPassword}\n    >\n      {props =>\n        children({\n          ...props,\n          getPassword,\n        })\n      }\n    </PasswordInputComponent>\n  )\n}\n","import { Trans } from '@lingui/macro'\nimport { BlurOff, BlurOn } from '@material-ui/icons'\nimport React from 'react'\nimport styled from 'styled-components/macro'\n\nimport { FormInputStyled } from '../../../atoms/FormInputStyled'\nimport { MarginBox } from '../../../atoms/MarginBox'\nimport { PasswordInput } from '../../../atoms/PasswordInput'\nimport { Sizer } from '../../../atoms/Sizer'\nimport { i18n } from '../../../i18n'\nimport { TouchButton } from '../../../molecules/TouchButton'\nimport { Colors, Spacing } from '../../../styling'\n\ninterface IProps {\n  onSubmitChange(password: string): void\n  buttonLabel: string\n}\n\nconst StyledPasswordChangeForm = styled.div`\n  .password {\n    display: inline-block;\n    margin: 0.5rem;\n\n    button {\n      display: inline-block;\n      width: 3rem;\n    }\n  }\n\n  .error {\n    background-color: ${Colors.red};\n    opacity: 0.8;\n    padding: 1rem;\n    width: 31rem;\n  }\n`\n\nexport const PasswordChangeForm: React.FC<IProps> = ({\n  onSubmitChange,\n  buttonLabel,\n}) => (\n  <PasswordInput>\n    {({\n      getInputProps,\n      valid,\n      errors,\n      touched,\n      isVisible,\n      toggleShowPassword,\n      getPassword,\n    }) => (\n      <StyledPasswordChangeForm>\n        <div className=\"password\">\n          <FormInputStyled\n            {...getInputProps()}\n            name=\"password\"\n            placeholder={i18n.t`new password`}\n            invalid={touched && !valid}\n          />\n          <TouchButton\n            color={Colors.greyMiddle}\n            onClick={toggleShowPassword}\n            icon={isVisible ? BlurOff : BlurOn}\n            iconSize={2}\n          />\n        </div>\n\n        <MarginBox margin={`${Spacing.Middle} 0 0 0`}>\n          <Sizer width={14}>\n            <TouchButton\n              color={Colors.green}\n              disabled={!valid}\n              onClick={e => {\n                e.preventDefault()\n                onSubmitChange(getPassword())\n              }}\n            >\n              {buttonLabel}\n            </TouchButton>\n          </Sizer>\n        </MarginBox>\n\n        {touched && !valid && (\n          <div className=\"error\">\n            <Trans>Password is invalid due to following errors:</Trans>\n            <ul>\n              {errors.map(e => (\n                <li key={e.key}>{e.message}</li>\n              ))}\n            </ul>\n          </div>\n        )}\n      </StyledPasswordChangeForm>\n    )}\n  </PasswordInput>\n)\n","import React from 'react'\n\nimport { LoginPageBackground } from '../../../atoms/LoginPageBackground'\nimport { PageLayoutGridItem } from '../../../atoms/PageLayoutGridItem'\nimport { PageTitle } from '../../../atoms/PageTitle'\nimport { PasswordPageGrid } from '../molecules/PasswordPageGrid'\nimport { PasswordChangeForm } from '../organisms/PasswordChangeForm'\n\nexport interface IPasswordChangeProps {\n  onPasswordChange(password: string): void\n  pageTitle: string\n  buttonLabel: string\n}\n\nexport const PasswordChangePage: React.FC<IPasswordChangeProps> = ({\n  onPasswordChange,\n  pageTitle,\n  buttonLabel,\n}) => (\n  <LoginPageBackground>\n    <PageTitle title={pageTitle} />\n    <PasswordPageGrid>\n      <PageLayoutGridItem gridRow=\"2 / span 2\" gridColumn=\"6 / span 6\">\n        <PageTitle.Display />\n      </PageLayoutGridItem>\n      <PageLayoutGridItem gridRow=\"4 / span 6\" gridColumn=\"6 / span 6\">\n        <PasswordChangeForm\n          onSubmitChange={onPasswordChange}\n          buttonLabel={buttonLabel}\n        />\n      </PageLayoutGridItem>\n    </PasswordPageGrid>\n  </LoginPageBackground>\n)\n","import { Sentry, useSentryScope } from '@speedlo/sentry'\nimport React from 'react'\nimport { Redirect, RouteComponentProps } from 'react-router-dom'\n\nimport { useRoot } from '../../../atoms/RootProvider'\nimport { useMPasswordChange } from '../../../graph/generated'\nimport { logAuth } from '../../../helpers/logger'\nimport { useSnackBar } from '../../../hooks/useSnackBar'\nimport { i18n } from '../../../i18n'\nimport {\n  IPasswordChangeProps,\n  PasswordChangePage,\n} from '../pages/PasswordChangePage'\n\nexport const PasswordChangeRoute: React.FC<\n  RouteComponentProps<{ token: string }>\n> = ({ history, location, match }) => {\n  const { auth } = useRoot()\n  const { enqueueError, enqueueSuccess } = useSnackBar()\n  const scope = useSentryScope()\n\n  const { token: tempToken } = match.params\n  const decodedTempToken = window.atob(tempToken)\n\n  scope.setExtras({ tempToken, decodedTempToken })\n\n  const [changePassword] = useMPasswordChange({\n    fetchPolicy: 'no-cache',\n    context: {\n      overrideWithToken: decodedTempToken,\n    },\n  })\n\n  if (!tempToken) {\n    logAuth('no token has been passed to change password')\n    enqueueError(\n      i18n.t`Request for password update is invalid. Please try again.`,\n    )\n    return <Redirect to=\"/\" />\n  }\n\n  const onPasswordChange = async (password: string) => {\n    const result = await changePassword({\n      password,\n    })\n    if (result) {\n      const {\n        change: { userId, newToken },\n      } = result\n      auth.invalidate()\n      auth.authenticate(newToken, userId)\n      enqueueSuccess(i18n.t`Password has been updated.`)\n    } else {\n      Sentry.captureMessage('Password change failed')\n      enqueueError(\n        i18n.t`Request for password update is invalid. Please try again.`,\n      )\n    }\n    history.replace('/')\n  }\n\n  const props: IPasswordChangeProps = {\n    onPasswordChange,\n    pageTitle: '',\n    buttonLabel: '',\n  }\n\n  if (location.pathname.includes('register')) {\n    props.pageTitle = i18n.t`Set up password`\n    props.buttonLabel = i18n.t`Create password`\n  } else if (location.pathname.includes('recovery')) {\n    props.pageTitle = i18n.t`Password recovery`\n    props.buttonLabel = i18n.t`Update password`\n  } else {\n    return <Redirect to=\"/\" />\n  }\n  return <PasswordChangePage {...props} />\n}\n\nexport default PasswordChangeRoute\n"],"sourceRoot":""}